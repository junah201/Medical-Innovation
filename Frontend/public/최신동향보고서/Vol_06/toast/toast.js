define("nls/en-us/strings",{OK:"Okay",CANCEL:"Cancel",DELETE:"Delete",BUTTON_YES:"Yes",BUTTON_NO:"No",ERROR:"Error",ALERT_TITLE:"Alert",ALERT_NO_SEARCH_RESULT:"No results found.",ADD_BOOKMARK_TITILE:"Add Bookmark",REMOVE_BOOKMARK_TITILE:"Remove Bookmark",MODIFY_BOOKMARK_TITILE:"Modify Bookmark",ENTER_TEXT:"Enter text",TEXT_INPUT_PLACEHOLDER:"Enter text",ENTER_SEARCH_WORDS_PLACEHOLDER:"Enter search words ...",ENTER_PAGE_NUMBER:"Enter page number ...",ADD_MEMO_TITILE:"Add Memo",MODIFY_MEMO_TITILE:"Modify Memo",EMPTY:"Empty",SELECT_PAGE_TITLE:"Select page",LEFT_PAGE_TITLE:"Left Page",RIGHT_PAGE_TITLE:"Right Pag",NO_PAGE_SELECTED:"No pages selected.",REMOVE_ALL_MY_STORAGE:"Are you sure you want to delete all of your library?",ERROR_NOT_VALID_PAGE_NUMBER:"{0} page is not a valid page number.",MOVE_PAGE_TITLE:"Move Page",PREPARE_PRINTING:"Preparing print ...",START_SLIDESHOW:"Start Slideshow",STOP_SLIDESHOW:"Stop Slideshow",SLIDESHOW:"Slideshow",FULL_SCREEN:"Full Screen",ALL_FILES:"All Files",DEFAULT_FOLDER:"Default Folder",MASTER_FOLDER:"Master Folder",MY_STORAGE:"My Storage",TOC:"Table of Contents",TOC_LIST:"Table of Contents",ZOOM_IN_OUT:"Zoom In/Out",ZOOM_IN:"Zoom In",ZOOM_OUT:"Zoom Out",PRINT:"Print",MEMO:"Memo",SEARCH:"Search",BOOKMARK:"Bookmark",THUMBNAIL:"Thumbnail",ENTER_SEARCH_WORDS:"Enter search words ...",FIRST_PAGE:"First Page",PREVIOUS_PAGE:"Previous Page",NEXT_PAGE:"Next Page",GO_TO_PAGE:"Go To Page",NEXT:"Next",PREVIOUS:"Previous",CURRENT_PAGE:"Current Page",LAST_PAGE:"Last Page",TOGGLE_DOUBLE_PAGE:"Single/Double Toggle",DOUBLE_PAGE:"Double Page",SINGLE_PAGE:"Single Page",STARTMENU:"Start Menu",PLAY_BACKGROUND_MUSIC:"Play Background Music",STOP_BACKGROUND_MUSIC:"Stop Background Music",BACKGROUND_MUSIC:"Background Music",PDF_DOWNLOAD:"PDF Download",SEARCH_RESULTS:"Search Results",PAGE:"Page",DRAG_MODE:"Drag mode",FIT_TO_SCREEN_WIDTH:"Fit to screen width",FIT_TO_SCREEN_HEIGHT:"Fit to screen height",PRINT_MANAGER:"Print Manager",PRINT_TOTAL_PAGE:"Total pages",ALL:"All",PRINT_RANGE_EXAMPLE:"ex) 1-3, 5, 8-11",TARGET_PAGES:"Current Page",PAGER_ORIENTATION:"Orientation of Paper",PORTRAIT:"Portrait",LANDSCAPE:"Landscape",SHARE:"Share",KAKAOTALK:"kakaotalk",KAKAOSTORY:"kakaostory",FACEBOOK:"facebook",TWITTER:"twitter",GOOGLEPLUS:"google+",URL:"url",COPY_URL:"Copy Url",LONG_TAP_COPY_URL:"※ Long press. You can copy.",COPY_URL_SUCCESS_ALERT:"Web link address copied.\nPlease paste it where you want.",ZOOM_FUNCTION_CAN_NOT_BE_USED_DURING_PAGE_LOADING:"The page is loading. The zoom function can not be used during page loading.",ALERT_PAGE_ALREADY_OPEN:"The page is already open.",ALERT_FIRST_PAGE:"The current page is the first page.",ALERT_LAST_PAGE:"The current page is the last page.",EXIT_ZOOM_MODE:"Exit Zoom mode",MOVE_UP:"Move up\n(keyboard shortcut : Up)",MOVE_DOWN:"Move down\n(keyboard shortcut : Down)",MOVE_LEFT:"Move to the left\n(keyboard shortcut : Left)",MOVE_RIGHT:"Move to the right\n(keyboard shortcut : Right)",HELP:"Help",SETTINGS:"Settings",PAGE_SCREEN_FIT_SETTING:"Select screen-fit-state when starting",FIT_SCREEN_WIDTH:"Fit screen width",FIT_SCREEN_HEIGHT:"Fit screen height",CLOSE:"CLOSE",SHOW_MENU_BAR:"Open menu",ORIGINAL_SIZE:"Original size",RESET:"Reset",SUCCESS:"Success",FAILURE:"Failure",START:"Start",PLAY:"Stop",PLAY_FILE:"PlayFile",REPEAT_PLAYBACK:"Repeat playback",PAUSE:"Pause",STOP:"Stop",TOGGLE:"Toggle",END:"End",FINISH:"Finish",EXIT:"Exit",MUTE:"Mute",CHECK:"Check",UNCHECK:"Uncheck",RIGHT_ANSWER:"RightAnswer",WRONG_ANSWER:"WrongAnswer",ERROR_PREVIEW_IFRAME:"There is a limit to the use of external content in preview.",ALERT_CAN_NOT_MOVE_PAGE_UNTIL_PLAYBACK_FINISHES:"You can not move the page until playback finishes.",ERROR_NOT_VIEWABLE_PAGE_NUMBER:"{0} page is not a viewable page.",CLOSE_WINDOW_ACTION_DEFAULT_CONFIRM_MESSAGE:"Close the window."}),define("nls/ja/strings",{OK:"はい",CANCEL:"キャンセル",DELETE:"削除",BUTTON_YES:"はい",BUTTON_NO:"いいえ",ERROR:"エラ-",ALERT_TITLE:"通知",ALERT_NO_SEARCH_RESULT:"検索結果がありません.",ADD_BOOKMARK_TITILE:"ブックマ-クを追加",REMOVE_BOOKMARK_TITILE:"ブックマ-クを削除",MODIFY_BOOKMARK_TITILE:"ブックマ-クの変更",ENTER_TEXT:"コンテンツを入力してください",TEXT_INPUT_PLACEHOLDER:"テキストを入力してください",ENTER_SEARCH_WORDS_PLACEHOLDER:"検索キ-ワ-ドを入力してください...",ENTER_PAGE_NUMBER:"ペ-ジ番号を入力してください...",ADD_MEMO_TITILE:"メモの追加",MODIFY_MEMO_TITILE:"メモ修正",EMPTY:"空",SELECT_PAGE_TITLE:"ペ-ジの選択",LEFT_PAGE_TITLE:"左ペ-ジ",RIGHT_PAGE_TITLE:"右ペ-ジ",NO_PAGE_SELECTED:"選択したペ-ジがありません.",REMOVE_ALL_MY_STORAGE:"ライブラリをすべて削除しますか？",ERROR_NOT_VALID_PAGE_NUMBER:"{0} ペ-ジは、有効なペ-ジ番号がありません.",MOVE_PAGE_TITLE:"ペ-ジに移動",PREPARE_PRINTING:"印刷準備中です。しばらくお待ちください...",START_SLIDESHOW:"スライドショ-の開始",STOP_SLIDESHOW:"スライドショ-停止",SLIDESHOW:"スライドショ-",FULL_SCREEN:"フルスクリ-ン",ALL_FILES:"全ファイル",DEFAULT_FOLDER:"デフォルトのフォルダ",MASTER_FOLDER:"管理者フォルダ",MY_STORAGE:"ライブラリ",TOC:"目次",TOC_LIST:"目次リスト",ZOOM_IN_OUT:"拡大/縮小",ZOOM_IN:"拡大",ZOOM_OUT:"縮小",PRINT:"印刷",MEMO:"メモ",SEARCH:"検索",BOOKMARK:"ブックマ-ク",THUMBNAIL:"全体表示",ENTER_SEARCH_WORDS:"検索キ-ワ-ドを入力してください...",FIRST_PAGE:"最初のペ-ジ",PREVIOUS_PAGE:"前のペ-ジ",NEXT_PAGE:"次のペ-ジ",GO_TO_PAGE:"ペ-ジに移動",NEXT:"次",PREVIOUS:"前",CURRENT_PAGE:"現在のペ-ジ",LAST_PAGE:"最後のペ-ジ",TOGGLE_DOUBLE_PAGE:"片面/両面表示切り替え",DOUBLE_PAGE:"見開きペ-ジ",SINGLE_PAGE:"片面ペ-ジ",STARTMENU:"メニュ-",PLAY_BACKGROUND_MUSIC:"バックグラウンド音楽再生",STOP_BACKGROUND_MUSIC:"バックグラウンドミュ-ジック停止",BACKGROUND_MUSIC:"バックグラウンドミュージック",PDF_DOWNLOAD:"PDFダウンロ-ド",SEARCH_RESULTS:"検索リスト",PAGE:"ペ-ジ",DRAG_MODE:"ドラッグモ-ド",FIT_TO_SCREEN_WIDTH:"画面の幅に合わせ",FIT_TO_SCREEN_HEIGHT:"画面の高さに合わせる",PRINT_MANAGER:"印刷管理",PRINT_TOTAL_PAGE:"全ペ-ジ",ALL:"全体",PRINT_RANGE_EXAMPLE:"例）1-3、5、8-11",TARGET_PAGES:"対象ペ-ジ",PAGER_ORIENTATION:"用紙の向き",PORTRAIT:"縦方向",LANDSCAPE:"横方向",SHARE:"共有する",KAKAOTALK:"kakaotalk",KAKAOSTORY:"kakaostory",FACEBOOK:"Facebook",TWITTER:"ツイッタ-",GOOGLEPLUS:"グ-グルプラス",URL:"アドレス",COPY_URL:"アドレスをコピ-",LONG_TAP_COPY_URL:"※ URLを長く押しコピ-することができます.",COPY_URL_SUCCESS_ALERT:"アドレスがコピ-されました。\nご希望のブログや掲示板に貼り付けてください.",ZOOM_FUNCTION_CAN_NOT_BE_USED_DURING_PAGE_LOADING:"ペ-ジがロ-ド中です。拡大/縮小機能は、ペ-ジの読み込み中に使用することができません.",ALERT_PAGE_ALREADY_OPEN:"現在のペ-ジです.",ALERT_FIRST_PAGE:"現在のペ-ジは、最初のペ-ジです.",ALERT_LAST_PAGE:"現在のペ-ジは、最後のペ-ジです.",EXIT_ZOOM_MODE:"拡大/縮小モ-ドを終了するには、タブし.",MOVE_UP:"上（ショ-トカット：Up）",MOVE_DOWN:"下（ショ-トカット：Down)",MOVE_LEFT:"左（ショ-トカット：Left)",MOVE_RIGHT:"右（ショ-トカット：Right)",HELP:"ヘルプ",SETTINGS:"設定",PAGE_SCREEN_FIT_SETTING:"閲覧時の画面の設定",FIT_SCREEN_WIDTH:"横幅合わせ",FIT_SCREEN_HEIGHT:"全表示",CLOSE:"閉じる",SHOW_MENU_BAR:"メニュ-バ-を開く",ORIGINAL_SIZE:"元のサイズ",RESET:"リセット",SUCCESS:"Success",FAILURE:"Failure",START:"Start",PLAY:"Stop",PLAY_FILE:"PlayFile",PAUSE:"Pause",STOP:"Stop",END:"End",FINISH:"Finish",MUTE:"Mute",CHECK:"Check",UNCHECK:"Uncheck",RIGHT_ANSWER:"RightAnswer",WRONG_ANSWER:"WrongAnswer",ERROR_PREVIEW_IFRAME:"プレビューでは、外部コンテンツ利用に制限があります。",ALERT_CAN_NOT_MOVE_PAGE_UNTIL_PLAYBACK_FINISHES:"再生完了時までのページに移動することができません。",ERROR_NOT_VIEWABLE_PAGE_NUMBER:"{0}ページは閲覧可能なページがありません。"}),define("nls/root/strings",{OK:"확인",CANCEL:"취소",DELETE:"삭제",BUTTON_YES:"예",BUTTON_NO:"아니오",ERROR:"에러",ALERT_TITLE:"알림",ALERT_NO_SEARCH_RESULT:"검색 결과가 없습니다.",ADD_BOOKMARK_TITILE:"북마크 추가",REMOVE_BOOKMARK_TITILE:"북마크 제거",MODIFY_BOOKMARK_TITILE:"북마크 수정",ENTER_TEXT:"내용을 입력하세요",TEXT_INPUT_PLACEHOLDER:"텍스트를 입력하세요",ENTER_SEARCH_WORDS_PLACEHOLDER:"검색어를 입력하세요...",ENTER_PAGE_NUMBER:"페이지 번호를 입력하세요...",ADD_MEMO_TITILE:"메모 추가",MODIFY_MEMO_TITILE:"메모 수정",EMPTY:"비어 있음",SELECT_PAGE_TITLE:"페이지 선택",LEFT_PAGE_TITLE:"왼쪽 페이지",RIGHT_PAGE_TITLE:"오른쪽 페이지",NO_PAGE_SELECTED:"선택한 페이지가 없습니다.",REMOVE_ALL_MY_STORAGE:"보관함을 전부 삭제 하시겠습니까?",ERROR_NOT_VALID_PAGE_NUMBER:"{0} 페이지는 유효한 페이지 번호가 아닙니다.",MOVE_PAGE_TITLE:"페이지 이동",PREPARE_PRINTING:"인쇄 준비 중입니다. 잠시만 기다려 주세요 ...",START_SLIDESHOW:"슬라이드쇼 시작",STOP_SLIDESHOW:"슬라이드쇼 정지",SLIDESHOW:"슬라이드쇼",FULL_SCREEN:"전체화면",START_FULL_SCREEN:"전체화면 시작",STOP_FULL_SCREEN:"전체화면 종료",ALL_FILES:"전체파일",DEFAULT_FOLDER:"기본폴더",MASTER_FOLDER:"관리자 폴더",MY_STORAGE:"보관함",TOC:"목차",TOC_LIST:"목차 리스트",ZOOM_IN_OUT:"확대/축소",ZOOM_IN:"확대",ZOOM_OUT:"축소",PRINT:"인쇄",MEMO:"메모",SEARCH:"검색",BOOKMARK:"북마크",THUMBNAIL:"전체보기",ENTER_SEARCH_WORDS:"검색어를 입력하세요...",FIRST_PAGE:"첫 페이지",PREVIOUS_PAGE:"이전 페이지",NEXT_PAGE:"다음 페이지",GO_TO_PAGE:"페이지 이동",NEXT:"다음",PREVIOUS:"이전",CURRENT_PAGE:"현재 페이지",LAST_PAGE:"마지막 페이지",TOGGLE_DOUBLE_PAGE:"단면/양면 보기 토글",DOUBLE_PAGE:"양면 페이지",SINGLE_PAGE:"단면 페이지",STARTMENU:"메뉴",PLAY_BACKGROUND_MUSIC:"배경음악 재생",STOP_BACKGROUND_MUSIC:"배경음악 정지",BACKGROUND_MUSIC:"배경음악",PDF_DOWNLOAD:"PDF 다운로드",SEARCH_RESULTS:"검색 리스트",PAGE:"페이지",DRAG_MODE:"드래그 모드",FIT_TO_SCREEN_WIDTH:"화면 너비에 맞춤",FIT_TO_SCREEN_HEIGHT:"화면 높이에 맞춤",PRINT_MANAGER:"인쇄 관리자",PRINT_TOTAL_PAGE:"전체 페이지",ALL:"전체",PRINT_RANGE_EXAMPLE:"예) 1-3, 5, 8-11",TARGET_PAGES:"대상 페이지",PAGER_ORIENTATION:"용지 방향",PORTRAIT:"세로 방향",LANDSCAPE:"가로 방향",SHARE:"공유하기",KAKAOTALK:"카카오톡",KAKAOSTORY:"카카오스토리",FACEBOOK:"페이스북",TWITTER:"트위터",GOOGLEPLUS:"구글플러스",URL:"주소",COPY_URL:"주소복사",LONG_TAP_COPY_URL:"※ URL를 길게 누르시면 복사하실 수 있습니다.",COPY_URL_SUCCESS_ALERT:"주소가 복사되었습니다.\n원하시는 블로그나 게시판에 붙여넣기 하세요.",ZOOM_FUNCTION_CAN_NOT_BE_USED_DURING_PAGE_LOADING:"페이지가 로딩 중입니다. 확대/축소 기능은 페이지 로딩 중에 사용할 수 없습니다.",ALERT_PAGE_ALREADY_OPEN:"현재 페이지 입니다.",ALERT_FIRST_PAGE:"현재 페이지는 첫 페이지 입니다.",ALERT_LAST_PAGE:"현재 페이지는 마지막 페이지 입니다.",EXIT_ZOOM_MODE:"확대/축소 모드를 종료 하려면 탭하세요",MOVE_UP:"위로(단축키 : Up)",MOVE_DOWN:"아래로(단축키 : Down)",MOVE_LEFT:"왼쪽으로(단축키 : Left)",MOVE_RIGHT:"오른쪽으로(단축키 : Right)",HELP:"도움말",SETTINGS:"설정",PAGE_SCREEN_FIT_SETTING:"열람시 화면설정",FIT_SCREEN_WIDTH:"가로 너비 맞춤",FIT_SCREEN_HEIGHT:"전체 보기",CLOSE:"닫기",SHOW_MENU_BAR:"메뉴바 열기",ORIGINAL_SIZE:"원본크기",RESET:"재 설정",SUCCESS:"성공",FAILURE:"실패",START:"시작",PLAY:"재생",PLAY_FILE:"파일 재생",REPEAT_PLAYBACK:"반복 재생",PAUSE:"일시정지",STOP:"정지",TOGGLE:"토글",END:"완료",FINISH:"완료",EXIT:"종료",MUTE:"음소거",CHECK:"선택",UNCHECK:"해제",RIGHT_ANSWER:"정답",WRONG_ANSWER:"오답",ERROR_PREVIEW_IFRAME:"미리보기에서는 외부컨텐츠 이용에 제한이 있습니다.",ALERT_CAN_NOT_MOVE_PAGE_UNTIL_PLAYBACK_FINISHES:"재생 완료시까지 페이지 이동을 할 수 없습니다.",ERROR_NOT_VIEWABLE_PAGE_NUMBER:"{0} 페이지는 열람 가능한 페이지가 아닙니다.",CLOSE_WINDOW_ACTION_DEFAULT_CONFIRM_MESSAGE:"윈도우 창을 닫습니다."}),define("nls/zh-cn/strings",{OK:"确认",CANCEL:"取消",DELETE:"删除",BUTTON_YES:"是",BUTTON_NO:"没有",ERROR:"错误",ALERT_TITLE:"通知",ALERT_NO_SEARCH_RESULT:"没有找到结果。",ADD_BOOKMARK_TITILE:"添加书签",REMOVE_BOOKMARK_TITILE:"删除书签",MODIFY_BOOKMARK_TITILE:"编辑书签",ENTER_TEXT:"输入文字",TEXT_INPUT_PLACEHOLDER:"输入文字",ENTER_SEARCH_WORDS_PLACEHOLDER:"输入搜索字词...",ENTER_PAGE_NUMBER:"请输入页码...",ADD_MEMO_TITILE:"添加备注",MODIFY_MEMO_TITILE:"编辑备注",EMPTY:"空的",SELECT_PAGE_TITLE:"选择页面",LEFT_PAGE_TITLE:"左页",RIGHT_PAGE_TITLE:"右页",NO_PAGE_SELECTED:"您没有选择页面。",REMOVE_ALL_MY_STORAGE:"您确定要删除所有档案吗？",ERROR_NOT_VALID_PAGE_NUMBER:"这不是有效的页码。",MOVE_PAGE_TITLE:"转到页面",PREPARE_PRINTING:"印刷正在准备中。 请稍候...",START_SLIDESHOW:"开始幻灯片放映",STOP_SLIDESHOW:"停止幻灯片放映",SLIDESHOW:"幻灯片",FULL_SCREEN:"全屏",START_FULL_SCREEN:"全屏启动",STOP_FULL_SCREEN:"退出全屏",ALL_FILES:"所有文件",DEFAULT_FOLDER:"默认文件夹",MASTER_FOLDER:"管理员文件夹",MY_STORAGE:"我的存储空间",TOC:"目录",TOC_LIST:"目录",ZOOM_IN_OUT:"放大/缩小",ZOOM_IN:"放大",ZOOM_OUT:"缩小",PRINT:"打印",MEMO:"备忘录",SEARCH:"搜索",BOOKMARK:"书签",THUMBNAIL:"全部查看",ENTER_SEARCH_WORDS:"输入搜索字词...",FIRST_PAGE:"第一页",PREVIOUS_PAGE:"上一页",NEXT_PAGE:"下一页",GO_TO_PAGE:"转到页面",NEXT:"下一个",PREVIOUS:"前",CURRENT_PAGE:"当前页",LAST_PAGE:"最后一页",TOGGLE_DOUBLE_PAGE:"单/双视图",DOUBLE_PAGE:"双面页面",SINGLE_PAGE:"单页",STARTMENU:"菜单",PLAY_BACKGROUND_MUSIC:"播放背景音乐",STOP_BACKGROUND_MUSIC:"停止背景音乐",BACKGROUND_MUSIC:"背景音乐",PDF_DOWNLOAD:"下载PDF",SEARCH_RESULTS:"搜索列表",PAGE:"页码",DRAG_MODE:"拖动",FIT_TO_SCREEN_WIDTH:"调整以适应屏幕宽度",FIT_TO_SCREEN_HEIGHT:"调整到屏幕高度",PRINT_MANAGER:"打印经理",PRINT_TOTAL_PAGE:"总页数",ALL:"整体",PRINT_RANGE_EXAMPLE:"ex) 1-3, 5, 8-11",TARGET_PAGES:"目标页面",PAGER_ORIENTATION:"方向",PORTRAIT:"纵向方向",LANDSCAPE:"景观方向",SHARE:"分享",KAKAOTALK:"KakaoTalk",KAKAOSTORY:"kakaostory",FACEBOOK:"Facebook的",TWITTER:"叽叽喳喳",GOOGLEPLUS:"Google+的",URL:"网址",COPY_URL:"复制网址",LONG_TAP_COPY_URL:"长按要复制的URL。",COPY_URL_SUCCESS_ALERT:"Web链接地址复制。\n粘贴到你想要的地方。",ZOOM_FUNCTION_CAN_NOT_BE_USED_DURING_PAGE_LOADING:"该页面正在加载。 页面加载时缩放功能不可用。",EXIT_ZOOM_MODE:"退出缩放模式",MOVE_UP:"向上移动\n(键盘快捷键 : Up)",MOVE_DOWN:"下移\n(键盘快捷键 : Down)",MOVE_LEFT:"向左移动\n(键盘快捷键 : Left)",MOVE_RIGHT:"向右移动\n(键盘快捷键 : Right)",HELP:"帮助",SETTINGS:"设置",PAGE_SCREEN_FIT_SETTING:"打开时设置页面适合状态",FIT_SCREEN_WIDTH:"适合屏幕宽度",FIT_SCREEN_HEIGHT:"适合屏幕高度",CLOSE:"关",SHOW_MENU_BAR:"打开菜单",ORIGINAL_SIZE:"原始尺寸",RESET:"重置",SUCCESS:"Success",FAILURE:"Failure",START:"Start",PLAY:"Stop",PLAY_FILE:"PlayFile",REPEAT_PLAYBACK:"重复播放",PAUSE:"Pause",STOP:"Stop",TOGGLE:"Toggle",END:"End",FINISH:"Finish",EXIT:"Exit",MUTE:"Mute",CHECK:"Check",UNCHECK:"Uncheck",RIGHT_ANSWER:"RightAnswer",WRONG_ANSWER:"WrongAnswer",ERROR_PREVIEW_IFRAME:"预览中使用外部内容是有限制的。",ALERT_CAN_NOT_MOVE_PAGE_UNTIL_PLAYBACK_FINISHES:"在播放完成之前，您无法移动页面。",ERROR_NOT_VIEWABLE_PAGE_NUMBER:"第{0}页不是可查看的页面。",CLOSE_WINDOW_ACTION_DEFAULT_CONFIRM_MESSAGE:"关上窗户。"}),define("nls/strings",["require","exports","module"],function(a,b,c){"use strict";c.exports={root:!0,"en-us":!0,"zh-cn":!0,ja:!0}}),define("strings",["i18n!nls/strings"],function(a){"use strict";return a}),define("toast/events/KeyEvent",{DOM_VK_CANCEL:3,DOM_VK_HELP:6,DOM_VK_BACK_SPACE:8,DOM_VK_TAB:9,DOM_VK_CLEAR:12,DOM_VK_RETURN:13,DOM_VK_ENTER:14,DOM_VK_SHIFT:16,DOM_VK_CONTROL:17,DOM_VK_ALT:18,DOM_VK_PAUSE:19,DOM_VK_CAPS_LOCK:20,DOM_VK_ESCAPE:27,DOM_VK_SPACE:32,DOM_VK_PAGE_UP:33,DOM_VK_PAGE_DOWN:34,DOM_VK_END:35,DOM_VK_HOME:36,DOM_VK_LEFT:37,DOM_VK_UP:38,DOM_VK_RIGHT:39,DOM_VK_DOWN:40,DOM_VK_PRINTSCREEN:44,DOM_VK_INSERT:45,DOM_VK_DELETE:46,DOM_VK_0:48,DOM_VK_1:49,DOM_VK_2:50,DOM_VK_3:51,DOM_VK_4:52,DOM_VK_5:53,DOM_VK_6:54,DOM_VK_7:55,DOM_VK_8:56,DOM_VK_9:57,DOM_VK_A:65,DOM_VK_B:66,DOM_VK_C:67,DOM_VK_D:68,DOM_VK_E:69,DOM_VK_F:70,DOM_VK_G:71,DOM_VK_H:72,DOM_VK_I:73,DOM_VK_J:74,DOM_VK_K:75,DOM_VK_L:76,DOM_VK_M:77,DOM_VK_N:78,DOM_VK_O:79,DOM_VK_P:80,DOM_VK_Q:81,DOM_VK_R:82,DOM_VK_S:83,DOM_VK_T:84,DOM_VK_U:85,DOM_VK_V:86,DOM_VK_W:87,DOM_VK_X:88,DOM_VK_Y:89,DOM_VK_Z:90,DOM_VK_CONTEXT_MENU:93,DOM_VK_NUMPAD0:96,DOM_VK_NUMPAD1:97,DOM_VK_NUMPAD2:98,DOM_VK_NUMPAD3:99,DOM_VK_NUMPAD4:100,DOM_VK_NUMPAD5:101,DOM_VK_NUMPAD6:102,DOM_VK_NUMPAD7:103,DOM_VK_NUMPAD8:104,DOM_VK_NUMPAD9:105,DOM_VK_MULTIPLY:106,DOM_VK_ADD:107,DOM_VK_SEPARATOR:108,DOM_VK_SUBTRACT:109,DOM_VK_DECIMAL:110,DOM_VK_DIVIDE:111,DOM_VK_F1:112,DOM_VK_F2:113,DOM_VK_F3:114,DOM_VK_F4:115,DOM_VK_F5:116,DOM_VK_F6:117,DOM_VK_F7:118,DOM_VK_F8:119,DOM_VK_F9:120,DOM_VK_F10:121,DOM_VK_F11:122,DOM_VK_F12:123,DOM_VK_F13:124,DOM_VK_F14:125,DOM_VK_F15:126,DOM_VK_F16:127,DOM_VK_F17:128,DOM_VK_F18:129,DOM_VK_F19:130,DOM_VK_F20:131,DOM_VK_F21:132,DOM_VK_F22:133,DOM_VK_F23:134,DOM_VK_F24:135,DOM_VK_NUM_LOCK:144,DOM_VK_SCROLL_LOCK:145,DOM_VK_SEMICOLON:186,DOM_VK_EQUALS:187,DOM_VK_COMMA:188,DOM_VK_DASH:189,DOM_VK_PERIOD:190,DOM_VK_SLASH:191,DOM_VK_BACK_QUOTE:192,DOM_VK_OPEN_BRACKET:219,DOM_VK_BACK_SLASH:220,DOM_VK_CLOSE_BRACKET:221,DOM_VK_QUOTE:222,DOM_VK_META:224}),define("toast/events/Events",["exports"],function(a){"use strict";a.READY_BOOK="tt_bookReady",a.BOOK_READY="tt_bookReady",a.BOOK_HTML_READY="tt_bookHtmlReady",a.PAGE_DID_LOAD="tt_pageDidLoad",a.PAGE_DID_UNLOAD="tt_pageDidUnLoad",a.WILL_DISPLAY_PAGE="tt_willDisplayPage",a.WILL_MOVE_PAGE="tt_willMovePage",a.PAGE_DID_CHANGE="tt_pageDidChange",a.SHOW_PAGE="tt_showPage",a.SHOWN_PAGE="tt_shownPage",a.HIDE_PAGE="tt_hidePage",a.HIDDEN_PAGE="tt_hiddenPage",a.BEFORE_SHOW_DROPDOWN_MENU="tt_beforeShowDropdownMenu",a.MEMO_DID_CHANGE="tt_memoDidChange",a.SLIDE_DID_LOAD_COMPLETE="tt_slideDidLoadComplete",a.BOOKMARK_DID_CHANGE="tt_bookmarkDidChanged",a.ZOOM_MODE_DID_CHANGE="tt_zoomModeDidChanged",a.ZOOM_SCALE_DID_CHANGE="tt_zoomScaleDidChanged",a.ZOOM_VIEW_POSITION_AND_SIZE_DID_CHANGE="tt_zoomViewPositionAndSizeDidChanged",a.AUTOSLIDE_DID_RESUME="tt_autoSlideDidResume",a.AUTOSLIDE_DID_PAUSE="tt_autoSlideDidPause",a.ORIENTATION_DID_CHANGE="tt_orientationDidChange",a.START_MENU_DID_LOAD="tt_startmenuDidLoad",a.READY_AUTOPLAY_FOR_MOBILE="tt_readyAutoplayForMobile",a.DOUBLEPAGE_DID_CHANGE="tt_doublePageDidChange",a.STOP_ALL_SOUND="tt_stopAllSound",a.FULLSCREEN_DID_CHANGE="tt_fullscreenDidChange",a.FLIP_CORNER_START_ANIMATE="tt_flipCornerStartAnimate",a.TRANSITION_START="tt_transitionStart",a.TRANSITION_PRESSED="tt_transitionPressed",a.TRANSITION_END="tt_transitionEnd",a.IMAGEVIEWER_SHOW="tt_imageViewerShow",a.IMAGEVIEWER_SHOWN="tt_imageViewerShown",a.IMAGEVIEWER_VIEWED="tt_imageViewerViewed",a.IMAGEVIEWER_RESET="tt_imageViewerReset",a.IMAGEVIEWER_RESIZED="tt_imageViewerResized",a.IMAGEVIEWER_HIDE="tt_imageViewerHide",a.IMAGEVIEWER_HIDDEN="tt_imageViewerHidden",a.IMAGEVIEWER_ZOOM_TO="tt_imageViewerZoomTo",a.SHOW_DILAOG="show.tt.dialog",a.HIDE_DILAOG="hide.tt.dialog",a.SHOWN_DILAOG="shown.tt.dialog",a.HIDDEN_DILAOG="hidden.tt.dialog",a.SHOWN_HELP="shown.help",a.HIDDEN_HELP="hidden.help"}),define("toast/events/EventDispatcher",["exports"],function(a){"use strict";function b(a){var b=a.indexOf(".");return-1===b?{eventName:a}:{eventName:a.substring(0,b),ns:a.substring(b)}}function c(a){$.extend(a,{on:g,off:h,one:i,trigger:j,_EventDispatcher:!0})}function d(a,b,c){var d=[b].concat(c);a.trigger.apply(a,d)}function e(a,b,c){g.call(a,b,c)}function f(a,b,c){a._deprecatedEvents||(a._deprecatedEvents={}),a._deprecatedEvents[b]=c||!0}var g=function(a,c){var d,e=a.split(/\s+/).map(b);if(this._deprecatedEvents)for(d=0;d<e.length;d++){var f=this._deprecatedEvents[e[d].eventName];if(f){var g="Registering for deprecated event '"+e[d].eventName+"'.";"string"==typeof f&&(g+=" Instead, use "+f+"."),console.warn(g,(new Error).stack)}}for(d=0;d<e.length;d++){var h=e[d].eventName;this._eventHandlers||(this._eventHandlers={}),this._eventHandlers[h]||(this._eventHandlers[h]=[]),e[d].handler=c,this._eventHandlers[h].push(e[d])}return this},h=function(a,c){if(!this._eventHandlers)return this;var d,e=a.split(/\s+/).map(b),f=function(a,b){var d,e=this._eventHandlers[b];if(e){for(d=e.length-1;d>=0;d--)if(!a.ns||a.ns===e[d].ns){var f=e[d].handler;c&&c!==f&&c._eventOnceWrapper!==f||e.splice(d,1)}e.length||delete this._eventHandlers[b]}}.bind(this),g=function(a){a.eventName?f(a,a.eventName):_.forEach(this._eventHandlers,function(b,c){f(a,c)})}.bind(this);for(d=0;d<e.length;d++)g(e[d]);return this},i=function(a,b){return b._eventOnceWrapper||(b._eventOnceWrapper=function(a){a.target.off(a.type,b._eventOnceWrapper),b.apply(this,arguments)}),this.on(a,b._eventOnceWrapper)},j=function(a){var b,c={type:a,target:this},d=this._eventHandlers&&this._eventHandlers[a];if(d){d=d.slice();var e=Array.prototype.slice.call(arguments,1);for(e.unshift(c),b=0;b<d.length;b++)try{d[b].handler.apply(null,e)}catch(b){console.error("Exception in '"+a+"' listener on",this,String(b),b.stack),console.assert()}}};a.makeEventDispatcher=c,a.triggerWithArray=d,a.on_duringInit=e,a.markDeprecated=f}),define("toast/events/Commands",["exports"],function(a){"use strict";a.TOC="toc",a.THUMBNAIL="thumbnail",a.TOGGLE_ZOOM="toggleZoom",a.ZOOM_IN="zoomIn",a.ZOOM_OUT="zoomOut",a.SEARCH="search",a.TOGGLE_BOOKMARK="toggleBookmark",a.ADD_MEMO="addmemo",a.MY_STORAGE="mystorage",a.FIRST_PAGE="firstPage",a.PREVIOUS_PAGE="previousPage",a.NEXT_PAGE="nextPage",a.LAST_PAGE="lastPage",a.MOVE_TO_USER_INPUT_PAGE="moveToUserInputPage",a.FULLSCREEN="fullscreen",a.TOGGLE_AUTO_SLIDE="toggleAutoSlide",a.START_AUTO_SLIDE="startAutoSlide",a.STOP_AUTO_SLIDE="stopAutoSlide",a.DOUBLEPAGE="doublepage",a.TOGGLE_DOUBLEPAGE="toggleDoublePage",a.PRINT="print",a.HELP="help",a.CONFIG="config",a.TOGGLE_BGSOUND="toggleBgSound",a.PLAY_BGSOUND="playBgSound",a.PAUSE_BGSOUND="pauseBgSound",a.PDF_DOWNLOAD="pdfDownload",a.SHARE="share",a.SEND_FACEBOOK="sendFacebook",a.SEND_TWITTER="sendTwitter",a.SEND_GOOGLEPLUS="sendGoogleplus",a.SEND_KAKAOTALK="sendKakaotalk",a.SEND_KAKAOSTORY="sendKakaostory",a.CLOSE_POPUP_WINDOW="closePopupWindow",a.SHOW_INTRO="showIntro"}),define("toast/events/CommandManager",["exports","./EventDispatcher"],function(a,b){"use strict";function c(a,b,c){this._name=a,this._id=b,this._commandFn=c,this._checked=void 0,this._enabled=!0}function d(b,d,e,f){if(m[d])return Toast.debug&&console.log("Attempting to register an already-registered command: "+d),null;if(!b||!d||!e)return Toast.debug&&console.error("Attempting to register a command with a missing name, id, or command function:"+b+" "+d),null;var g=new c(b,d,e);return f&&(g.userKeyBinding=!0),m[d]=g,a.trigger("commandRegistered",g),g}function e(b,d,e){if(m[b])return Toast.debug&&console.log("Attempting to register an already-registered command: "+b),null;if(!b||!d)return Toast.debug&&console.error("Attempting to register an internal command with a missing id, or command function: "+b),null;var f=new c(null,b,d);return e&&(f.userKeyBinding=!0),m[b]=f,a.trigger("commandRegistered",f),f}function f(a,b){n[a]||(n[a]=[]);var d=!0;if(_.any(n[a],function(a){if(a._commandFn===b)return d=!1,!0}),d){var e=new c(null,a,b);n[a].push(e)}}function g(a,b){return m[a]&&h(a),e(a,b)}function h(a){m[a]&&(delete m[a],m[a]=null)}function i(a){return m[a]}function j(){return Object.keys(m)}function k(b){var c=m[b];if(c){Toast.debug&&console.log("execute : "+b);try{a.trigger("beforeExecuteCommand",b)}catch(a){Toast.debug&&console.error(a)}return c.execute.apply(c,Array.prototype.slice.call(arguments,1))}return(new $.Deferred).reject().promise()}function l(b){var c=n[b];if(c){Toast.debug&&console.log("execute : "+b);try{a.trigger("beforeExecuteCommand",b)}catch(a){Toast.debug&&console.error(a)}var d=arguments,e=new $.Deferred;return Toast.Async.doInParallel(c,function(a){return a.execute.apply(a,Array.prototype.slice.call(d,1))}).done(function(){e.resolve()}).fail(function(){e.reject()}),e.promise()}return(new $.Deferred).reject().promise()}var m={},n={};b.makeEventDispatcher(c.prototype),c.prototype.getID=function(){return this._id},c.prototype.execute=function(){if(!this._enabled)return(new $.Deferred).reject().promise();var a=this._commandFn.apply(this,arguments);return a||(new $.Deferred).resolve().promise()},c.prototype.getEnabled=function(){return this._enabled},c.prototype.setEnabled=function(a){var b=this._enabled!==a;this._enabled=a,b&&this.trigger("enabledStateChange")},c.prototype.setChecked=function(a){var b=this._checked!==a;this._checked=a,b&&this.trigger("checkedStateChange")},c.prototype.getChecked=function(){return this._checked},c.prototype.setName=function(a){var b=this._name!==a;this._name=a,b&&this.trigger("nameChange")},c.prototype.getName=function(){return this._name},b.makeEventDispatcher(a),a.register=d,a.registerInternal=e,a.registerGroup=f,a.inject=g,a.remove=h,a.execute=k,a.executeGroup=l,a.get=i,a.getAll=j}),define("toast/events",["./events/KeyEvent","./events/Events","./events/EventDispatcher","./events/Commands","./events/CommandManager"],function(a,b,c,d,e){Toast.KeyEvent=a,Toast.Events=b,Toast.EventDispatcher=c,Toast.Commands=d,Toast.CommandManager=e}),function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(j(a,c),b)}function f(a,b,c){return!!Array.isArray(a)&&(g(a,c[b],c),!0)}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(b,c,d){var e="DEPRECATED METHOD: "+c+"\n"+d+" AT \n";return function(){var c=new Error("get-stack-trace"),d=c&&c.stack?c.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",f=a.console&&(a.console.warn||a.console.log);return f&&f.call(a.console,e,d),b.apply(this,arguments)}}function i(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&la(d,c)}function j(a,b){return function(){return a.apply(b,arguments)}}function k(a,b){return typeof a==oa?a.apply(b?b[0]||d:d,b):a}function l(a,b){return a===d?b:a}function m(a,b,c){g(q(b),function(b){a.addEventListener(b,c,!1)})}function n(a,b,c){g(q(b),function(b){a.removeEventListener(b,c,!1)})}function o(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function p(a,b){return a.indexOf(b)>-1}function q(a){return a.trim().split(/\s+/g)}function r(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function s(a){return Array.prototype.slice.call(a,0)}function t(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];r(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function u(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ma.length;){if(c=ma[g],(e=c?c+f:b)in a)return e;g++}return d}function v(){return ua++}function w(b){var c=b.ownerDocument||b;return c.defaultView||c.parentWindow||a}function x(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){k(a.options.enable,[a])&&c.handler(b)},this.init()}function y(a){var b=a.options.inputClass;return new(b||(xa?M:ya?P:wa?R:L))(a,z)}function z(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&Ea&&d-e==0,g=b&(Ga|Ha)&&d-e==0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,A(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function A(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=D(b)),e>1&&!c.firstMultiple?c.firstMultiple=D(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=E(d);b.timeStamp=ra(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=I(h,i),b.distance=H(h,i),B(c,b),b.offsetDirection=G(b.deltaX,b.deltaY);var j=F(b.deltaTime,b.deltaX,b.deltaY);b.overallVelocityX=j.x,b.overallVelocityY=j.y,b.overallVelocity=qa(j.x)>qa(j.y)?j.x:j.y,b.scale=g?K(g.pointers,d):1,b.rotation=g?J(g.pointers,d):0,b.maxPointers=c.prevInput?b.pointers.length>c.prevInput.maxPointers?b.pointers.length:c.prevInput.maxPointers:b.pointers.length,C(c,b);var k=a.element;o(b.srcEvent.target,k)&&(k=b.srcEvent.target),b.target=k}function B(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};b.eventType!==Ea&&f.eventType!==Ga||(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function C(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Ha&&(i>Da||h.velocity===d)){var j=b.deltaX-h.deltaX,k=b.deltaY-h.deltaY,l=F(i,j,k);e=l.x,f=l.y,c=qa(l.x)>qa(l.y)?l.x:l.y,g=G(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function D(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:pa(a.pointers[c].clientX),clientY:pa(a.pointers[c].clientY)},c++;return{timeStamp:ra(),pointers:b,center:E(b),deltaX:a.deltaX,deltaY:a.deltaY}}function E(a){var b=a.length;if(1===b)return{x:pa(a[0].clientX),y:pa(a[0].clientY)};for(var c=0,d=0,e=0;e<b;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:pa(c/b),y:pa(d/b)}}function F(a,b,c){return{x:b/a||0,y:c/a||0}}function G(a,b){return a===b?Ia:qa(a)>=qa(b)?a<0?Ja:Ka:b<0?La:Ma}function H(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function I(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function J(a,b){return I(b[1],b[0],Ra)+I(a[1],a[0],Ra)}function K(a,b){return H(b[0],b[1],Ra)/H(a[0],a[1],Ra)}function L(){this.evEl=Ta,this.evWin=Ua,this.pressed=!1,x.apply(this,arguments)}function M(){this.evEl=Xa,this.evWin=Ya,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function N(){this.evTarget=$a,this.evWin=_a,this.started=!1,x.apply(this,arguments)}function O(a,b){var c=s(a.touches),d=s(a.changedTouches);return b&(Ga|Ha)&&(c=t(c.concat(d),"identifier",!0)),[c,d]}function P(){this.evTarget=bb,this.targetIds={},x.apply(this,arguments)}function Q(a,b){var c=s(a.touches),d=this.targetIds;if(b&(Ea|Fa)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=s(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return o(a.target,i)}),b===Ea)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Ga|Ha)&&delete d[g[e].identifier],e++;return h.length?[t(f.concat(h),"identifier",!0),h]:void 0}function R(){x.apply(this,arguments);var a=j(this.handler,this);this.touch=new P(this.manager,a),this.mouse=new L(this.manager,a),this.primaryTouch=null,this.lastTouches=[]}function S(a,b){a&Ea?(this.primaryTouch=b.changedPointers[0].identifier,T.call(this,b)):a&(Ga|Ha)&&T.call(this,b)}function T(a){var b=a.changedPointers[0];if(b.identifier===this.primaryTouch){var c={x:b.clientX,y:b.clientY};this.lastTouches.push(c);var d=this.lastTouches,e=function(){var a=d.indexOf(c);a>-1&&d.splice(a,1)};setTimeout(e,cb)}}function U(a){for(var b=a.srcEvent.clientX,c=a.srcEvent.clientY,d=0;d<this.lastTouches.length;d++){var e=this.lastTouches[d],f=Math.abs(b-e.x),g=Math.abs(c-e.y);if(f<=db&&g<=db)return!0}return!1}function V(a,b){this.manager=a,this.set(b)}function W(a){if(p(a,jb))return jb;var b=p(a,kb),c=p(a,lb);return b&&c?jb:b||c?b?kb:lb:p(a,ib)?ib:hb}function X(){if(!fb)return!1;var b={},c=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(d){b[d]=!c||a.CSS.supports("touch-action",d)}),b}function Y(a){this.options=la({},this.defaults,a||{}),this.id=v(),this.manager=null,this.options.enable=l(this.options.enable,!0),this.state=nb,this.simultaneous={},this.requireFail=[]}function Z(a){return a&sb?"cancel":a&qb?"end":a&pb?"move":a&ob?"start":""}function $(a){return a==Ma?"down":a==La?"up":a==Ja?"left":a==Ka?"right":""}function _(a,b){var c=b.manager;return c?c.get(a):a}function aa(){Y.apply(this,arguments)}function ba(){aa.apply(this,arguments),this.pX=null,this.pY=null}function ca(){aa.apply(this,arguments)}function da(){Y.apply(this,arguments),this._timer=null,this._input=null}function ea(){aa.apply(this,arguments)}function fa(){aa.apply(this,arguments)}function ga(){Y.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ha(a,b){return b=b||{},b.recognizers=l(b.recognizers,ha.defaults.preset),new ia(a,b)}function ia(a,b){this.options=la({},ha.defaults,b||{}),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=a,this.input=y(this),this.touchAction=new V(this,this.options.touchAction),ja(this,!0),g(this.options.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function ja(a,b){var c=a.element;if(c.style){var d;g(a.options.cssProps,function(e,f){d=u(c.style,f),b?(a.oldCssProps[d]=c.style[d],c.style[d]=e):c.style[d]=a.oldCssProps[d]||""}),b||(a.oldCssProps={})}}function ka(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var la,ma=["","webkit","Moz","MS","ms","o"],na=b.createElement("div"),oa="function",pa=Math.round,qa=Math.abs,ra=Date.now;la="function"!=typeof Object.assign?function(a){if(a===d||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var e=arguments[c];if(e!==d&&null!==e)for(var f in e)e.hasOwnProperty(f)&&(b[f]=e[f])}return b}:Object.assign;var sa=h(function(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a},"extend","Use `assign`."),ta=h(function(a,b){return sa(a,b,!0)},"merge","Use `assign`."),ua=1,va=/mobile|tablet|ip(ad|hone|od)|android/i,wa="ontouchstart"in a,xa=u(a,"PointerEvent")!==d,ya=wa&&va.test(navigator.userAgent),za="touch",Aa="pen",Ba="mouse",Ca="kinect",Da=25,Ea=1,Fa=2,Ga=4,Ha=8,Ia=1,Ja=2,Ka=4,La=8,Ma=16,Na=Ja|Ka,Oa=La|Ma,Pa=Na|Oa,Qa=["x","y"],Ra=["clientX","clientY"];x.prototype={handler:function(){},init:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(w(this.element),this.evWin,this.domHandler)}};var Sa={mousedown:Ea,mousemove:Fa,mouseup:Ga},Ta="mousedown",Ua="mousemove mouseup";i(L,x,{handler:function(a){var b=Sa[a.type];b&Ea&&0===a.button&&(this.pressed=!0),b&Fa&&1!==a.which&&(b=Ga),this.pressed&&(b&Ga&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:Ba,srcEvent:a}))}});var Va={pointerdown:Ea,pointermove:Fa,pointerup:Ga,pointercancel:Ha,pointerout:Ha},Wa={2:za,3:Aa,4:Ba,5:Ca},Xa="pointerdown",Ya="pointermove pointerup pointercancel";a.MSPointerEvent&&!a.PointerEvent&&(Xa="MSPointerDown",Ya="MSPointerMove MSPointerUp MSPointerCancel"),i(M,x,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Va[d],f=Wa[a.pointerType]||a.pointerType,g=f==za,h=r(b,a.pointerId,"pointerId");e&Ea&&(0===a.button||g)?h<0&&(b.push(a),h=b.length-1):e&(Ga|Ha)&&(c=!0),h<0||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Za={touchstart:Ea,touchmove:Fa,touchend:Ga,touchcancel:Ha},$a="touchstart",_a="touchstart touchmove touchend touchcancel";i(N,x,{handler:function(a){var b=Za[a.type];if(b===Ea&&(this.started=!0),this.started){var c=O.call(this,a,b);b&(Ga|Ha)&&c[0].length-c[1].length==0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}}});var ab={touchstart:Ea,touchmove:Fa,touchend:Ga,touchcancel:Ha},bb="touchstart touchmove touchend touchcancel";i(P,x,{handler:function(a){var b=ab[a.type],c=Q.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}});var cb=2500,db=25;i(R,x,{handler:function(a,b,c){var d=c.pointerType==za,e=c.pointerType==Ba;if(!(e&&c.sourceCapabilities&&c.sourceCapabilities.firesTouchEvents)){if(d)S.call(this,b,c);else if(e&&U.call(this,c))return;this.callback(a,b,c)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var eb=u(na.style,"touchAction"),fb=eb!==d,gb="compute",hb="auto",ib="manipulation",jb="none",kb="pan-x",lb="pan-y",mb=X();V.prototype={set:function(a){a==gb&&(a=this.compute()),fb&&this.manager.element.style&&mb[a]&&(this.manager.element.style[eb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){k(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),W(a.join(" "))},preventDefaults:function(a){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=p(d,jb)&&!mb[jb],f=p(d,lb)&&!mb[lb],g=p(d,kb)&&!mb[kb];if(e){var h=1===a.pointers.length,i=a.distance<2,j=a.deltaTime<250;if(h&&i&&j)return}return g&&f?void 0:e||f&&c&Na||g&&c&Oa?this.preventSrc(b):void 0},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var nb=1,ob=2,pb=4,qb=8,rb=qb,sb=16,tb=32;Y.prototype={defaults:{},set:function(a){return la(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=_(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=_(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=_(a,this),-1===r(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=_(a,this);var b=r(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(b,a)}var c=this,d=this.state;d<qb&&b(c.options.event+Z(d)),b(c.options.event),a.additionalEvent&&b(a.additionalEvent),d>=qb&&b(c.options.event+Z(d))},tryEmit:function(a){if(this.canEmit())return this.emit(a);this.state=tb},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(tb|nb)))return!1;a++}return!0},recognize:function(a){var b=la({},a);if(!k(this.options.enable,[this,b]))return this.reset(),void(this.state=tb);this.state&(rb|sb|tb)&&(this.state=nb),this.state=this.process(b),this.state&(ob|pb|qb|sb)&&this.tryEmit(b)},process:function(a){},getTouchAction:function(){},reset:function(){}},i(aa,Y,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(ob|pb),e=this.attrTest(a);return d&&(c&Ha||!e)?b|sb:d||e?c&Ga?b|qb:b&ob?b|pb:ob:tb}}),i(ba,aa,{defaults:{event:"pan",threshold:10,pointers:1,direction:Pa},getTouchAction:function(){var a=this.options.direction,b=[];return a&Na&&b.push(lb),a&Oa&&b.push(kb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Na?(e=0===f?Ia:f<0?Ja:Ka,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Ia:g<0?La:Ma,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return aa.prototype.attrTest.call(this,a)&&(this.state&ob||!(this.state&ob)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=$(a.direction);b&&(a.additionalEvent=this.options.event+b),this._super.emit.call(this,a)}}),i(ca,aa,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&ob)},emit:function(a){if(1!==a.scale){var b=a.scale<1?"in":"out";a.additionalEvent=this.options.event+b}this._super.emit.call(this,a)}}),i(da,Y,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[hb]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Ga|Ha)&&!f)this.reset();else if(a.eventType&Ea)this.reset(),this._timer=e(function(){this.state=rb,this.tryEmit()},b.time,this);else if(a.eventType&Ga)return rb;return tb},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===rb&&(a&&a.eventType&Ga?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=ra(),this.manager.emit(this.options.event,this._input)))}}),i(ea,aa,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&ob)}}),i(fa,aa,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Na|Oa,pointers:1},getTouchAction:function(){return ba.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Na|Oa)?b=a.overallVelocity:c&Na?b=a.overallVelocityX:c&Oa&&(b=a.overallVelocityY),this._super.attrTest.call(this,a)&&c&a.offsetDirection&&a.distance>this.options.threshold&&a.maxPointers==this.options.pointers&&qa(b)>this.options.velocity&&a.eventType&Ga},emit:function(a){var b=$(a.offsetDirection);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),i(ga,Y,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ib]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&Ea&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Ga)return this.failTimeout();var g=!this.pTime||a.timeStamp-this.pTime<b.interval,h=!this.pCenter||H(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;if(0===this.count%b.taps)return this.hasRequireFailures()?(this._timer=e(function(){this.state=rb,this.tryEmit()},b.interval,this),ob):rb}return tb},failTimeout:function(){return this._timer=e(function(){this.state=tb},this.options.interval,this),tb},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==rb&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ha.VERSION="2.0.7",ha.defaults={domEvents:!1,touchAction:gb,enable:!0,inputTarget:null,inputClass:null,preset:[[ea,{enable:!1}],[ca,{enable:!1},["rotate"]],[fa,{direction:Na}],[ba,{direction:Na},["swipe"]],[ga],[ga,{event:"doubletap",taps:2},["tap"]],[da]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ub=2;ia.prototype={set:function(a){return la(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?ub:1},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&rb)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===ub||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(ob|pb|qb)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof Y)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;if(a=this.get(a)){var b=this.recognizers,c=r(b,a);-1!==c&&(b.splice(c,1),this.touchAction.update())}return this},on:function(a,b){if(a!==d&&b!==d){var c=this.handlers;return g(q(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this}},off:function(a,b){if(a!==d){var c=this.handlers;return g(q(a),function(a){b?c[a]&&c[a].splice(r(c[a],b),1):delete c[a]}),this}},emit:function(a,b){this.options.domEvents&&ka(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ja(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},la(ha,{INPUT_START:Ea,INPUT_MOVE:Fa,INPUT_END:Ga,INPUT_CANCEL:Ha,STATE_POSSIBLE:nb,STATE_BEGAN:ob,STATE_CHANGED:pb,STATE_ENDED:qb,STATE_RECOGNIZED:rb,STATE_CANCELLED:sb,STATE_FAILED:tb,DIRECTION_NONE:Ia,DIRECTION_LEFT:Ja,DIRECTION_RIGHT:Ka,DIRECTION_UP:La,DIRECTION_DOWN:Ma,DIRECTION_HORIZONTAL:Na,DIRECTION_VERTICAL:Oa,DIRECTION_ALL:Pa,Manager:ia,Input:x,TouchAction:V,TouchInput:P,MouseInput:L,PointerEventInput:M,TouchMouseInput:R,SingleTouchInput:N,Recognizer:Y,AttrRecognizer:aa,Tap:ga,Pan:ba,Swipe:fa,Pinch:ca,Rotate:ea,Press:da,on:m,off:n,each:g,merge:ta,extend:sa,assign:la,inherit:i,bindFn:j,prefixed:u}),(void 0!==a?a:"undefined"!=typeof self?self:{}).Hammer=ha,"function"==typeof define&&define.amd?define("toast/libs/hammer",[],function(){return ha}):"undefined"!=typeof module&&module.exports?module.exports=ha:a[c]=ha}(window,document,"Hammer"),function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("Viewer requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){"use strict";function c(a){return Na.call(a).slice(8,-1).toLowerCase()}function d(a){return"string"==typeof a}function e(a){return"number"==typeof a&&!isNaN(a)}function f(a){return void 0===a}function g(a){return"object"==typeof a&&null!==a}function h(a){var b,c;if(!g(a))return!1;try{return b=a.constructor,c=b.prototype,b&&c&&Oa.call(c,"isPrototypeOf")}catch(a){return!1}}function i(a){return"function"===c(a)}function j(a){return Array.isArray?Array.isArray(a):"array"===c(a)}function k(a,b){return b=b>=0?b:0,Array.from?Array.from(a).slice(b):Pa.call(a,b)}function l(a,b){var c=-1;return b.indexOf?b.indexOf(a):(n(b,function(b,d){if(b===a)return c=d,!1}),c)}function m(a){return d(a)&&(a=a.trim?a.trim():a.replace(Ea,"1")),a}function n(a,b){var c,d;if(a&&i(b))if(j(a)||e(a.length))for(d=0,c=a.length;d<c&&!1!==b.call(a,a[d],d,a);d++);else if(g(a))for(d in a)if(a.hasOwnProperty(d)&&!1===b.call(a,a[d],d,a))break;return a}function o(a){var b;if(arguments.length>1){if(b=k(arguments),Object.assign)return Object.assign.apply(Object,b);b.shift(),n(b,function(b){n(b,function(b,c){a[c]=b})})}return a}function p(a,b){var c=k(arguments,2);return function(){return a.apply(b,c.concat(k(arguments)))}}function q(a,b){var c=a.style;n(b,function(a,b){Ca.test(b)&&e(a)&&(a+="px"),c[b]=a})}function r(b){return a.getComputedStyle?a.getComputedStyle(b,null):b.currentStyle}function s(a,b){return a.classList?a.classList.contains(b):a.className.indexOf(b)>-1}function t(a,b){var c;if(b){if(e(a.length))return n(a,function(a){t(a,b)});if(a.classList)return a.classList.add(b);c=m(a.className),c?c.indexOf(b)<0&&(a.className=c+" "+b):a.className=b}}function u(a,b){if(b)return e(a.length)?n(a,function(a){u(a,b)}):a.classList?a.classList.remove(b):void(a.className.indexOf(b)>=0&&(a.className=a.className.replace(b,"")))}function v(a,b,c){if(e(a.length))return n(a,function(a){v(a,b,c)});c?t(a,b):u(a,b)}function w(a){return a.replace(Da,"$1-$2").toLowerCase()}function x(a,b){return g(a[b])?a[b]:a.dataset?a.dataset[b]:a.getAttribute("data-"+w(b))}function y(a,b,c){g(c)?a[b]=c:a.dataset?a.dataset[b]=c:a.setAttribute("data-"+w(b),c)}function z(a,b){g(a[b])?delete a[b]:a.dataset?delete a.dataset[b]:a.removeAttribute("data-"+w(b))}function A(a,b,c,d){var e=m(b).split(Fa),f=c;if(e.length>1)return n(e,function(b){A(a,b,c)});d&&(c=function(){return B(a,b,c),f.apply(a,arguments)}),a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)}function B(a,b,c){var d=m(b).split(Fa);if(d.length>1)return n(d,function(b){B(a,b,c)});a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)}function C(a,b,c){var d;return a.dispatchEvent?(i(U)&&i(CustomEvent)?d=f(c)?new U(b,{bubbles:!0,cancelable:!0}):new CustomEvent(b,{detail:c,bubbles:!0,cancelable:!0}):f(c)?(d=T.createEvent("Event"),d.initEvent(b,!0,!0)):(d=T.createEvent("CustomEvent"),d.initCustomEvent(b,!0,!0,c)),a.dispatchEvent(d)):a.fireEvent?a.fireEvent("on"+b):void 0}function D(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function E(b){var c,d=b||a.event;return d.target||(d.target=d.srcElement||T),e(d.pageX)||(c=T.documentElement,d.pageX=d.clientX+(a.scrollX||c&&c.scrollLeft||0)-(c&&c.clientLeft||0),d.pageY=d.clientY+(a.scrollY||c&&c.scrollTop||0)-(c&&c.clientTop||0)),d}function F(b){var c=T.documentElement,d=b.getBoundingClientRect();return{left:d.left+(a.scrollX||c&&c.scrollLeft||0)-(c&&c.clientLeft||0),top:d.top+(a.scrollY||c&&c.scrollTop||0)-(c&&c.clientTop||0)}}function G(a){var b=a.length,c=0,d=0;return b&&(n(a,function(a){c+=a.pageX,d+=a.pageY}),c/=b,d/=b),{pageX:c,pageY:d}}function H(a,b){return a.getElementsByTagName(b)}function I(a,b){return a.getElementsByClassName?a.getElementsByClassName(b):a.querySelectorAll("."+b)}function J(a,b){if(b.length)return n(b,function(b){J(a,b)});a.appendChild(b)}function K(a){a.parentNode&&a.parentNode.removeChild(a)}function L(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function M(a,b){f(a.textContent)?a.innerText=b:a.textContent=b}function N(a){return a.offsetWidth}function O(a){return d(a)?a.replace(/^.*\//,"").replace(/[\?&#].*$/,""):""}function P(a,b){var c;if(a.naturalWidth)return b(a.naturalWidth,a.naturalHeight);c=T.createElement("img"),c.onload=function(){b(this.width,this.height)},c.src=a.src}function Q(a){var b=[],c=a.rotate,d=a.scaleX,f=a.scaleY;return e(c)&&b.push("rotate("+c+"deg)"),e(d)&&b.push("scaleX("+d+")"),e(f)&&b.push("scaleY("+f+")"),b.length?b.join(" "):"none"}function R(a){switch(a){case 2:return Z;case 3:return aa;case 4:return ba}}function S(a,b){var c=this;c.element=a,c.options=o({},S.DEFAULTS,h(b)&&b),c.isImg=!1,c.isBuilt=!1,c.isShown=!1,c.isViewed=!1,c.isFulled=!1,c.isPlayed=!1,c.wheeling=!1,c.playing=!1,c.fading=!1,c.tooltiping=!1,c.transitioning=!1,c.action=!1,c.target=!1,c.timeout=!1,c.index=0,c.length=0,c.init()}var T=a.document,U=a.Event,V="viewer",W=V+"-open",X=V+"-show",Y=V+"-hide",Z="viewer-hide-xs-down",aa="viewer-hide-sm-down",ba="viewer-hide-md-down",ca=V+"-fade",da=V+"-in",ea=V+"-move",fa=V+"-active",ga=V+"-invisible",ha=V+"-transition",ia=V+"-fullscreen",ja=V+"-fullscreen-exit",ka=V+"-close",la="mousedown touchstart pointerdown MSPointerDown",ma="mousemove touchmove pointermove MSPointerMove",na="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",oa="wheel mousewheel DOMMouseScroll",pa="transitionend",qa="load",ra="keydown",sa="click",ta="resize",ua="ready",va="show",wa="shown",xa="hide",ya="hidden",za="view",Aa="viewed",Ba="webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",Ca=/^(width|height|left|top|marginLeft|marginTop)$/,Da=/([a-z\d])([A-Z])/g,Ea=/^\s+(.*)\s+$/,Fa=/\s+/,Ga=void 0!==T.createElement(V).style.transition,Ha=Math.min,Ia=Math.max,Ja=Math.abs,Ka=Math.sqrt,La=Math.round,Ma=Object.prototype,Na=Ma.toString,Oa=Ma.hasOwnProperty,Pa=Array.prototype.slice;S.prototype={constructor:S,init:function(){var b=this,c=b.options,d=b.element,e="img"===d.tagName.toLowerCase(),f=e?[d]:H(d,"img"),g=f.length,h=p(b.ready,b);if(S.TEMPLATE=Mustache.render(Toast.HtmlLoader.ImageViewer,{Strings:Toast.Strings}),!x(d,V)&&(y(d,V,b),g)){i(c.ready)&&A(d,ua,c.ready,!0),Ga||(c.transition=!1),b.isImg=e,b.length=g,b.count=0,b.images=f,b.body=T.body,b.scrollbarWidth=a.innerWidth-T.body.clientWidth,c.inline?(A(d,ua,function(){b.view()},!0),n(f,function(a){a.complete?h():A(a,qa,h,!0)})):A(d,sa,b._start=p(b.start,b));A(parent?parent.document:T,Ba,b._changeFullScreen=p(b._changeFullScreen,b))}},ready:function(){var a=this;++a.count===a.length&&a.build()},build:function(){var a,b,c,d,e,f,g,h,i,j,k=this,l=k.options,m=k.element;if(!k.isBuilt){if(a=T.createElement("div"),a.innerHTML=S.TEMPLATE,k.parent=b=m.parentNode,k.viewer=c=I(a,"iviewer")[0],k.viewerWindow=I(a,"viewer-window")[0],k.canvas=I(c,"viewer-canvas")[0],k.footer=I(c,"viewer-footer")[0],k.title=g=I(c,"viewer-title")[0],k.description=h=I(c,"viewer-description")[0],k.number=i=I(c,"viewer-number")[0],k.toolbar=e=I(c,"viewer-toolbar")[0],k.navbar=f=I(c,"viewer-navbar")[0],k.button=d=I(c,"viewer-button")[0],k.tooltipBox=I(c,"viewer-tooltip")[0],k.player=I(c,"viewer-player")[0],k.list=I(c,"viewer-list")[0],k.sideNavigateButtons=j=I(c,"side-navigate-buttons")[0],t(g,l.title?R(l.title):Y),t(h,l.description?R(l.description):Y),t(i,l.number&&1!==k.images.length?R(l.number):Y),t(e,l.toolbar?R(l.toolbar):Y),t(f,l.navbar?R(l.navbar):Y),l.zoomable||$(k.toolbar).addClass("hide-zoom"),1===k.images.length){var n=I(c,"viewer-prev")[0],o=I(c,"viewer-play")[0],p=I(c,"viewer-next")[0];t(n,Y),t(o,Y),t(p,Y),t(j,Y),t(k.toolbar,"viewer-one-image"),t(k.viewer,"viewer-one-image")}else if(Toast._msieVersion&&Toast._msieVersion<11){var o=I(c,"viewer-play")[0];t(o,Y),t(k.toolbar,"viewer-play-hide")}v(d,Y,!l.button),v(e.querySelector(".viewer-one-to-one"),Y,!l.zoomable),v(e.querySelectorAll('li[class*="zoom"]'),Y,!l.zoomable),v(e.querySelectorAll(".viewer-reset"),Y,!l.zoomable),Toast.showLoading(!0,{modal:!1,el:$(k.canvas)}),l.inline?(t(d,ia),q(c,{zIndex:l.zIndexInline}),"static"===r(b).position&&q(b,{position:"relative"})):(t(d,ka),t(c,ca),t(c,Y),q(c,{zIndex:l.zIndex})),_.isEmpty(l.backgroundColor)||q(c,{backgroundColor:l.backgroundColor}),_.isEmpty(l.toolbarColor)||q(k.footer,{backgroundColor:l.toolbarColor}),b.insertBefore(c,m.nextSibling),l.inline&&(k.render(),k.bind(),k.isShown=!0),$(k.title).html(l.title),$(k.description).html(l.description),k.isBuilt=!0,C(m,ua)}},unbuild:function(){var a=this;a.isBuilt&&(a.isBuilt=!1,K(a.viewer))},bind:function(){var b=this,c=b.options,d=b.element,e=b.viewer;i(c.view)&&A(d,za,c.view),i(c.viewed)&&A(d,Aa,c.viewed),A(e,sa,b._click=p(b.click,b)),A(e,oa,b._wheel=p(b.wheel,b)),A(b.canvas,la,b._mousedown=p(b.mousedown,b)),A(T,ma,b._mousemove=p(b.mousemove,b)),A(T,na,b._mouseup=p(b.mouseup,b)),A(T,ra,b._keydown=p(b.keydown,b)),A(a,ta,b._resize=p(b.resize,b))},unbind:function(){var b=this,c=b.options,d=b.element,e=b.viewer;i(c.view)&&B(d,za,c.view),i(c.viewed)&&B(d,Aa,c.viewed),B(e,sa,b._click),B(e,oa,b._wheel),B(b.canvas,la,b._mousedown),B(T,ma,b._mousemove),B(T,na,b._mouseup),B(T,ra,b._keydown),B(a,ta,b._resize)},render:function(){var a=this;a.initContainer(),a.initViewer(),a.initList(),a.renderViewer()},initContainer:function(){this.containerData={width:a.innerWidth,height:a.innerHeight}},initViewer:function(){var a,b=this,c=b.options,d=b.parent;c.inline&&(b.parentData=a={width:Ia(d.offsetWidth,c.minWidth),height:Ia(d.offsetHeight,c.minHeight)}),!b.isFulled&&a||(a=b.containerData),b.viewerData=o({},a)},renderViewer:function(){var a=this;a.options.inline&&!a.isFulled&&q(a.viewer,a.viewerData)},initCanvas:function(){var a=this;a.viewerCanvasData={width:$(a.viewerWindow).width(),height:$(a.viewerWindow).height()-a.footer.offsetHeight}},renderCanvas:function(){var a=this;q(a.canvas,a.viewerCanvasData)},initList:function(){var a=this,b=a.options,c=(a.element,a.list),e=[];n(a.images,function(a,c){var f=a.getAttribute("data-original-url"),g=a.alt||O(f),h=b.url;f&&(d(h)?h=a.getAttribute(h):i(h)&&(h=h.call(a,a)),e.push('<li><img src="'+f+'" data-action="view" data-index="'+c+'" data-original-url="'+(h||f)+'" alt="'+g+'"></li>'))}),c.innerHTML=e.join(""),q(c,{opacity:0}),n(H(c,"img"),function(b){y(b,"filled",!0),A(b,qa,p(a.loadImage,a),!0)}),a.items=H(c,"li")},renderList:function(a){var b=this,c=b.options,d=a||b.index,e=b.items[d].offsetWidth||30,f=e+1,g=b.list.style;0==g.opacity?g.opacity=1:c.transition&&!s(b.list,ha)&&t(b.list,ha),q(b.list,{width:f*b.length,marginLeft:($(b.viewerWindow).width()-e)/2-f*d})},resetList:function(){var a=this;L(a.list),u(a.list,ha),q({marginLeft:0})},initImage:function(a){var b=this,c=b.options,d=b.image;P(d,function(e,f){var g,h,j,k,l,m=(b.viewerData,b.number),n=b.imageData||{},p=e/f;b.initCanvas(),b.renderCanvas(),b.renderList(),l=Math.min(b.viewerCanvasData.width/e,b.viewerCanvasData.height/f),g=parseInt(e*l),h=parseInt(f*l),!0!==c.extractFit&&(g=Math.min(g,e),h=Math.min(h,f)),$(m).text(b.index+1+"/"+b.images.length),j={naturalWidth:e,naturalHeight:f,aspectRatio:p,ratio:l,width:g,height:h,left:(b.viewerCanvasData.width-g)/2,top:(b.viewerCanvasData.height-h)/2},k=o({},j),c.rotatable&&(j.rotate=n.rotate||0,k.rotate=0),c.scalable&&(j.scaleX=n.scaleX||1,j.scaleY=n.scaleY||1,k.scaleX=1,k.scaleY=1),b.imageData=j,b.initialImageData=k,c.minZoomRatio=Math.min(b.viewerCanvasData.width/e,b.viewerCanvasData.height/f),c.minZoomRatio=Math.min(1,c.minZoomRatio),c.minZoomRatio>.95&&c.minZoomRatio<1.05&&(c.minZoomRatio=1),c.maxZoomRatio>.95&&c.maxZoomRatio<1.05&&(c.maxZoomRatio=1),c.minZoomRatio===c.maxZoomRatio?(u(d,ea),c.zoomable&&$(b.toolbar).addClass("hide-zoom")):(t(d,ea),c.zoomable&&$(b.toolbar).removeClass("hide-zoom")),i(a)&&a()})},renderImage:function(a){var b=this,c=b.image,d=b.imageData,e=Q(d);q(c,{width:d.width,height:d.height,marginLeft:d.left,marginTop:d.top,WebkitTransform:e,msTransform:e,transform:e}),i(a)&&(b.transitioning?A(c,pa,a,!0):a())},resetImage:function(){var a=this;a.image&&(K(a.image),a.image=null)},start:function(a){var b=this,c=E(a),d=c.target;"img"===d.tagName.toLowerCase()&&(b.target=d,b.show())},click:function(a){a.preventDefault();var b=this,c=E(a),d=c.target,e=x(d,"action"),f=b.imageData;if(!e){var g=$(d).parents("[data-action]");0!==g.length&&(e=g.attr("data-action"))}switch(e){case"mix":b.isPlayed?b.isFulled?Toast.exitFullScreen():b.stop():b.options.inline?b.isFulled?b.exit():b.full():b.hide();break;case"view":b.view(x(d,"index"));break;case"zoom-in":b.zoom(.1,!0);break;case"zoom-out":b.zoom(-.1,!0);break;case"one-to-one":b.toggle();break;case"reset":b.reset();break;case"prev":b.prev();break;case"play":b.play();break;case"next":b.next();break;case"rotate-left":b.rotate(-90);break;case"rotate-right":b.rotate(90);break;case"flip-horizontal":b.scaleX(-f.scaleX||-1);break;case"flip-vertical":b.scaleY(-f.scaleY||-1);break;default:b.isPlayed}},load:function(){var a=this,b=a.options,c=a.image,d=a.index,e=a.viewerData;a.timeout&&(clearTimeout(a.timeout),a.timeout=!1),u(c,ga),c.style.cssText="width:0;height:0;margin-left:"+e.width/2+"px;margin-top:"+e.height/2+"px;max-width:none!important;visibility:visible;",a.initImage(function(){b.minZoomRatio===b.maxZoomRatio?u(c,ea):v(c,ea,b.movable),t(c,ca),a.renderImage(function(){Toast.showLoading(!1,{modal:!1,el:$(a.canvas)});var e,f;e=I(a.canvas,"btn-side-previous")[0],f=I(a.canvas,"btn-side-next")[0],$(e).children().attr("data-action","prev"),$(f).children().attr("data-action","next"),d+1>=a.length?$(f).hide():$(f).show(),d<=0?$(e).hide():$(e).show(),q(a.footer,{opacity:1}),Toast.lazy(function(){v(c,ha,b.transition),t(c,da)},0),a.isViewed=!0,C(a.element,Aa,{originalImage:a.images[d],index:d,image:c}),Toast.send(Toast.Events.IMAGEVIEWER_VIEWED,{originalImage:a.images[d],index:d,image:c})})})},loadImage:function(a){var b=E(a),c=b.target,d=c.parentNode,e=d.offsetWidth||30,f=d.offsetHeight||50,g=!!x(c,"filled");P(c,function(a,b){var d=a/b,h=e,i=f;f*d>e?g?h=f*d:i=e/d:g?i=e/d:h=f*d,q(c,{width:h,height:i,marginLeft:(e-h)/2,marginTop:(f-i)/2})})},layout:function(){var a=this;a.initContainer(),a.initViewer(),a.renderViewer(),q(a.canvas,{bottom:$(a.footer).height()+"px"}),a.isViewed&&a.initImage(function(){a.renderImage(),Toast.lazy(function(){Toast.send(Toast.Events.IMAGEVIEWER_RESIZED)},300)}),a.isPlayed&&n(H(a.player,"img"),function(b){A(b,qa,p(a.loadImage,a),!0),C(b,qa)})},resize:function(){this._refreshTimeout=this._refreshTimeout={},TT.isMobileDevice?Toast.lazyOnce(function(){this.layout(),Toast.lazyOnce(function(){this.layout()},500,this._refreshTimeout,this)},150,this._refreshTimeout,this):this.layout()},wheel:function(a){var b=this,c=E(a),d=Number(b.options.zoomRatio)||.1,e=1;b.isViewed&&(D(c),b.wheeling||(b.wheeling=!0,setTimeout(function(){b.wheeling=!1},50),c.deltaY?e=c.deltaY>0?1:-1:c.wheelDelta?e=-c.wheelDelta/120:c.detail&&(e=c.detail>0?1:-1),b.zoom(-e*d,!0,c)))},keydown:function(a){var b=this,c=E(a),d=b.options,e=c.keyCode||c.which||c.charCode;if(b.isFulled&&d.keyboard)switch(e){case 27:b.isPlayed?b.stop():d.inline?b.isFulled&&b.exit():b.hide();break;case 32:b.isPlayed&&b.stop();break;case 37:b.prev();break;case 38:D(c),b.zoom(d.zoomRatio,!0);break;case 39:b.next();break;case 40:D(c),b.zoom(-d.zoomRatio,!0);break;case 48:case 49:(c.ctrlKey||c.shiftKey)&&(D(c),b.toggle())}},mousedown:function(a){var b,c,d=this,e=d.options,f=E(a),g=!!e.movable&&"move",h=f.touches;if(d.isViewed){if(h){if((b=h.length)>1){if(!e.zoomable||2!==b)return;c=h[1],d.startX2=c.pageX,d.startY2=c.pageY,g="zoom"}else d.isSwitchable()&&(g="switch");c=h[0]}g&&(d.action=g,d.startX=c?c.pageX:f.pageX,d.startY=c?c.pageY:f.pageY)}},mousemove:function(a){var b,c,d=this,e=d.options,f=E(a),g=d.action,h=d.image,i=f.touches;if(d.isViewed){if(i){if((b=i.length)>1){if(!e.zoomable||2!==b)return;c=i[1],d.endX2=c.pageX,d.endY2=c.pageY}c=i[0]}g&&(D(f),"move"===g&&e.transition&&s(h,ha)&&u(h,ha),d.endX=c?c.pageX:f.pageX,d.endY=c?c.pageY:f.pageY,d.change(f))}},mouseup:function(a){var b=this,c=E(a),d=b.action;if(d){if(Toast.isMobileDevice&&!_.isUndefined(c.target)){var e=c.target,f=x(e,"action");_.isUndefined(f)&&D(c)}else D(c);"move"===d&&b.options.transition&&t(b.image,ha),b.action=!1}},_changeFullScreen:function(a){var b=this,c=b.options;Toast.isFullScreen()||(b.isPlayed?b.stop():c.inline?b.isFulled&&b.exit():b.hide())},show:function(){var a,b=this,c=b.options,d=b.element;return c.inline||b.transitioning?b:(b.isBuilt||b.build(),a=b.viewer,i(c.show)&&A(d,va,c.show,!0),!1===C(d,va)?b:(b.open(),u(a,Y),Toast.send(Toast.Events.IMAGEVIEWER_SHOW),A(d,wa,function(){b.view(b.target?l(b.target,k(b.images)):b.index),b.target=!1},!0),c.transition?(b.transitioning=!0,t(a,ha),N(a),A(a,pa,p(b.shown,b),!0),t(a,da)):(t(a,da),b.shown()),b))},hide:function(){var a=this,b=a.options,c=a.element,d=a.viewer;return b.inline||a.transitioning||!a.isShown?a:(i(b.hide)&&A(c,xa,b.hide,!0),!1===C(c,xa)?a:(Toast.send(Toast.Events.IMAGEVIEWER_HIDE),a.isViewed&&b.transition?(a.transitioning=!0,A(a.image,pa,function(){A(d,pa,p(a.hidden,a),!0),u(d,da)},!0),u(a.image,da),v(a.image,ha,b.transition)):(u(d,da),a.hidden()),a))},view:function(a){var b,c,d,e,f,g=this,h=g.element,i=(g.title,g.canvas),j=g.tooltipBox,k=g.sideNavigateButtons;return a=Number(a)||0,!g.isShown||g.isPlayed||a<0||a>=g.length||g.isViewed&&a===g.index?g:(c=g.items[a],d=H(c,"img")[0],e=x(d,"originalUrl"),f=d.getAttribute("alt"),b=T.createElement("img"),b.src=e,b.alt=f,!1===C(h,za,{originalImage:g.images[a],index:a,image:b})?g:(g.image=b,g.isViewed&&u(g.items[g.index],fa),t(c,fa),g.isViewed=!1,g.index=a,g.imageData=null,L(i),J(i,b),J(i,j),J(i,k),t(b,ga),A(h,Aa,function(){var a=g.imageData;a.naturalWidth,a.naturalHeight},!0),b.complete?g.load():(A(b,qa,p(g.load,g),!0),g.timeout&&(clearTimeout(g.timeout),g.timeout=!1)),g))},prev:function(){var a=this;return a.view(Ia(a.index-1,0)),a},next:function(){var a=this;return a.view(Ha(a.index+1,a.length-1)),a},move:function(a,b){var c=this,d=c.imageData;return c.moveTo(f(a)?a:d.left+Number(a),f(b)?b:d.top+Number(b)),c},limit:function(){var a,b,c=this,d=c.imageData,e={width:d.width,height:d.height},f={width:$(c.canvas).width(),height:$(c.canvas).height()};e.width>f.width?(a=e.width-Math.abs(d.left)<f.width?f.width-e.width:Math.min(0,d.left),d.left=a):d.left=(f.width-d.width)/2,e.height>f.height?(b=e.height-Math.abs(d.top)<f.height?f.height-e.height:Math.min(0,d.top),d.top=b):d.top=(f.height-d.height)/2},moveTo:function(a,b){var c=this,d=c.imageData,g=!1;return f(b)&&(b=a),a=Number(a),b=Number(b),c.isViewed&&!c.isPlayed&&c.options.movable&&(e(a)&&(d.left=a,g=!0),e(b)&&(d.top=b,g=!0),g&&c.limit(),g&&c.renderImage()),c},zoom:function(a,b,c){var d=this,e=d.imageData;return a=Number(a),a=a<0?1/(1-a):1+a,d.zoomTo(e.width*a/e.naturalWidth,b,c),d},zoomTo:function(a,b,c,d){var f,g,h,i,j,k=this,l=k.options,m=.01,n=100,o=k.imageData;k.canvas;if(a=Ia(0,a),e(a)&&k.isViewed&&!k.isPlayed&&(d||l.zoomable)){if(d||(m=Ia(m,l.minZoomRatio),n=Ha(n,l.maxZoomRatio),a=Ha(Ia(a,m),n)),m===n)return;a>.95&&a<1.05&&(a=1),a=Math.max(a,l.minZoomRatio),f=o.naturalWidth*a,g=o.naturalHeight*a,c?(h=F(k.viewer),i=c.touches?G(c.touches):{pageX:c.pageX,pageY:c.pageY},j=F(k.viewerWindow),o.left-=(f-o.width)*((i.pageX-(h.left+j.left)-o.left)/o.width),o.top-=(g-o.height)*((i.pageY-(h.top+j.top)-o.top)/o.height)):(o.left-=(f-o.width)/2,o.top-=(g-o.height)/2),o.width=f,o.height=g,o.ratio=a,k.limit(),k.renderImage(),b&&k.tooltip(),l.zoomTo&&l.zoomTo(a,m,n),Toast.send(Toast.Events.IMAGEVIEWER_ZOOM_TO,a,m,n)}return k},rotate:function(a){var b=this;return b.rotateTo((b.imageData.rotate||0)+Number(a)),b},rotateTo:function(a){var b=this,c=b.imageData;return a=Number(a),e(a)&&b.isViewed&&!b.isPlayed&&b.options.rotatable&&(c.rotate=a,b.renderImage()),b},scale:function(a,b){var c=this,d=c.imageData,g=!1;return f(b)&&(b=a),a=Number(a),b=Number(b),c.isViewed&&!c.isPlayed&&c.options.scalable&&(e(a)&&(d.scaleX=a,g=!0),e(b)&&(d.scaleY=b,g=!0),g&&c.renderImage()),c},scaleX:function(a){var b=this;return b.scale(a,b.imageData.scaleY),b},scaleY:function(a){var b=this;return b.scale(b.imageData.scaleX,a),b},play:function(){var a,b=this,c=b.options,d=b.player,f=p(b.loadImage,b),g=[],h=0,i=0;return!b.isShown||b.isPlayed?b:(c.fullscreen&&Toast.requestFullScreen(),b.isPlayed=!0,t(d,X),n(b.items,function(a,b){var e=H(a,"img")[0],j=T.createElement("img");j.src=x(e,"originalUrl"),j.alt=e.getAttribute("alt"),h++,t(j,ca),v(j,ha,c.transition),s(a,fa)&&(t(j,da),i=b),g.push(j),A(j,qa,f,!0),J(d,j)}),e(c.interval)&&c.interval>0&&(a=function(){b.playing=setTimeout(function(){u(g[i],da),i++,i=i<h?i:0,t(g[i],da),a()},c.interval)},h>1&&a()),b)},stop:function(){var a=this,b=a.player;return a.isPlayed?(a.options.fullscreen&&Toast.exitFullScreen(),a.isPlayed=!1,clearTimeout(a.playing),u(b,X),L(b),a):a},full:function(){var a=this,b=a.options,c=a.viewer,d=a.image,e=a.list;return!a.isShown||a.isPlayed||a.isFulled||!b.inline?a:(a.isFulled=!0,a.open(),t(a.button,ja),b.transition&&(u(d,ha),u(e,ha)),c.setAttribute("style",""),q(c,{zIndex:b.zIndex}),a.initContainer(),a.viewerData=o({},a.containerData),a.initImage(function(){a.renderImage(function(){b.transition&&setTimeout(function(){t(d,ha),t(e,ha)},0)})}),a)},exit:function(){var a=this,b=a.options,c=a.viewer,d=a.image,e=a.list;return a.isFulled?(a.isFulled=!1,a.close(),u(a.button,ja),b.transition&&(u(d,ha),u(e,ha)),q(c,{zIndex:b.zIndexInline}),a.viewerData=o({},a.parentData),a.renderViewer(),a.initImage(function(){a.renderImage(function(){b.transition&&setTimeout(function(){t(d,ha),t(e,ha)},0)})}),a):a},tooltip:function(){var a=this,b=a.options,c=a.tooltipBox,d=a.imageData;return a.isViewed&&!a.isPlayed&&b.tooltip?(M(c,La(100*d.ratio)+"%"),a.tooltiping?clearTimeout(a.tooltiping):b.transition?(a.fading&&C(c,pa),t(c,X),t(c,ca),t(c,ha),N(c),t(c,da)):t(c,X),a.tooltiping=setTimeout(function(){b.transition?(A(c,pa,function(){u(c,X),u(c,ca),u(c,ha),a.fading=!1},!0),u(c,da),a.fading=!0):u(c,X),a.tooltiping=!1},1e3),a):a},toggle:function(){var a=this;return 1===a.imageData.ratio?a.zoomTo(a.initialImageData.ratio,!0):a.zoomTo(1,!0),a},reset:function(){var a=this;return a.isViewed&&!a.isPlayed&&(a.imageData=o({},a.initialImageData),a.renderImage(),Toast.send(Toast.Events.IMAGEVIEWER_RESET)),a},update:function(){var a,b=this,c=[];return b.isImg&&!b.element.parentNode?b.destroy():(b.length=b.images.length,b.isBuilt&&(n(b.items,function(a,d){var e=H(a,"img")[0],f=b.images[d];f?f.src!==e.src&&c.push(d):c.push(d)}),q(b.list,{width:"auto"}),b.initList(),b.isShown&&(b.length?b.isViewed&&(a=l(b.index,c),a>=0?(b.isViewed=!1,b.view(Ia(b.index-(a+1),0))):t(b.items[b.index],fa)):(b.image=null,b.isViewed=!1,b.index=0,b.imageData=null,L(b.canvas)))),b)},destroy:function(){var a=this,b=a.element;return a.options.inline?a.unbind():(a.isShown&&a.unbind(),B(b,sa,a._start)),B(parent?parent.document:T,Ba,a._changeFullScreen),a.unbuild(),z(b,V),a},open:function(){var a=this.body;t(a,W),a.style.paddingRight=this.scrollbarWidth+"px"},close:function(){var a=this.body;u(a,W),a.style.paddingRight=0},shown:function(){var a=this,b=a.options,c=a.element;a.transitioning=!1,a.isFulled=!0,a.isShown=!0,a.isVisible=!0,a.render(),a.bind(),i(b.shown)&&A(c,wa,b.shown,!0),C(c,wa),Toast.send(Toast.Events.IMAGEVIEWER_SHOWN,this)},hidden:function(){var a=this,b=a.options,c=a.element;a.transitioning=!1,a.isViewed=!1,a.isFulled=!1,a.isShown=!1,a.isVisible=!1,a.unbind(),a.close(),t(a.viewer,Y),a.resetList(),a.resetImage(),i(b.hidden)&&A(c,ya,b.hidden,!0),C(c,ya),Toast.send(Toast.Events.IMAGEVIEWER_HIDDEN),a.destroy()},change:function(a){var b=this,c=b.endX-b.startX,d=b.endY-b.startY;switch(b.action){case"move":b.move(c,d);break;case"zoom":b.zoom(function(a,b,c,d){var e=Ka(a*a+b*b);return(Ka(c*c+d*d)-e)/e}(Ja(b.startX-b.startX2),Ja(b.startY-b.startY2),Ja(b.endX-b.endX2),Ja(b.endY-b.endY2)),!1,a),b.startX2=b.endX2,b.startY2=b.endY2;break;case"switch":b.action="switched",Ja(c)>Ja(d)&&(c>1?b.prev():c<-1&&b.next())}b.startX=b.endX,b.startY=b.endY},isSwitchable:function(){var a=this,b=a.imageData,c=a.viewerData;return b.left>=0&&b.top>=0&&b.width<=c.width&&b.height<=c.height}},S.DEFAULTS={inline:!1,button:!0,navbar:!0,title:!0,toolbar:!0,tooltip:!0,movable:!0,zoomable:!0,rotatable:!1,scalable:!0,transition:!0,fullscreen:!0,keyboard:!0,interval:5e3,minWidth:200,minHeight:100,zoomRatio:.3,minZoomRatio:.5,maxZoomRatio:1,zIndex:9998,zIndexInline:0,url:"src",backgroundColor:"transparent",toolbarColor:"transparent",number:!0,extractFit:!1,build:null,built:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null,zoomTo:null,sender:null};var Qa=a.ImageViewer;return S.noConflict=function(){return a.ImageViewer=Qa,S},S.setDefaults=function(a){o(S.DEFAULTS,a)},"function"==typeof define&&define.amd&&define("toast/libs/ImageViewer",[],function(){return S}),b||(a.ImageViewer=S),S}),function(a,b){"function"==typeof define&&define.amd?define("toast/libs/dragdealer",b):a.Dragdealer=b()}(this,function(){"use strict";function a(a){var b="Webkit Moz ms O".split(" "),c=document.documentElement.style;if(void 0!==c[a])return a;a=a.charAt(0).toUpperCase()+a.substr(1);for(var d=0;d<b.length;d++)if(void 0!==c[b[d]+a])return b[d]+a}function b(a){k.backfaceVisibility&&k.perspective&&(a.style[k.perspective]="1000px",a.style[k.backfaceVisibility]="hidden")}var c=function(a,b){this.options=this.applyDefaults(b||{}),this.bindMethods(),this.wrapper=this.getWrapperElement(a),this.wrapper&&(this.handle=this.getHandleElement(this.wrapper,this.options.handleClass),this.handle&&(this.init(),this.bindEventListeners()))};c.prototype={defaults:{disabled:!1,horizontal:!0,vertical:!1,slide:!0,steps:0,snap:!1,loose:!1,speed:.1,xPrecision:0,yPrecision:0,handleClass:"handle-drag",css3:!0,activeClass:"active",tapping:!0},init:function(){this.options.css3&&b(this.handle),this.value={prev:[-1,-1],current:[this.options.x||0,this.options.y||0],target:[this.options.x||0,this.options.y||0]},this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]},this.change=[0,0],this.stepRatios=this.calculateStepRatios(),this.activity=!1,this.dragging=!1,this.tapping=!1,this.reflow(),this.options.disabled&&this.disable()},applyDefaults:function(a){for(var b in this.defaults)a.hasOwnProperty(b)||(a[b]=this.defaults[b]);return a},getWrapperElement:function(a){return"string"==typeof a?document.getElementById(a):a},getHandleElement:function(a,b){var c,d,e;if(a.getElementsByClassName){if(c=a.getElementsByClassName(b),c.length>0)return c[0]}else for(d=new RegExp("(^|\\s)"+b+"(\\s|$)"),c=a.getElementsByTagName("*"),e=0;e<c.length;e++)if(d.test(c[e].className))return c[e]},calculateStepRatios:function(){var a=[];if(this.options.steps>=1)for(var b=0;b<=this.options.steps-1;b++)this.options.steps>1?a[b]=b/(this.options.steps-1):a[b]=0;return a},setWrapperOffset:function(){this.offset.wrapper=j.get(this.wrapper)},calculateBounds:function(){var a={top:this.options.top||0,bottom:-(this.options.bottom||0)+this.wrapper.offsetHeight,left:this.options.left||0,right:-(this.options.right||0)+this.wrapper.offsetWidth};return a.availWidth=a.right-a.left-this.handle.offsetWidth,a.availHeight=a.bottom-a.top-this.handle.offsetHeight,a},calculateValuePrecision:function(){var a=this.options.xPrecision||Math.abs(this.bounds.availWidth),b=this.options.yPrecision||Math.abs(this.bounds.availHeight);return[a?1/a:0,b?1/b:0]},bindMethods:function(){"function"==typeof this.options.customRequestAnimationFrame?this.requestAnimationFrame=d(this.options.customRequestAnimationFrame,window):this.requestAnimationFrame=d(m,window),"function"==typeof this.options.customCancelAnimationFrame?this.cancelAnimationFrame=d(this.options.customCancelAnimationFrame,window):this.cancelAnimationFrame=d(n,window),this.animateWithRequestAnimationFrame=d(this.animateWithRequestAnimationFrame,this),this.animate=d(this.animate,this),this.onHandleMouseDown=d(this.onHandleMouseDown,this),this.onHandleTouchStart=d(this.onHandleTouchStart,this),this.onDocumentMouseMove=d(this.onDocumentMouseMove,this),this.onWrapperTouchMove=d(this.onWrapperTouchMove,this),this.onWrapperMouseDown=d(this.onWrapperMouseDown,this),this.onWrapperTouchStart=d(this.onWrapperTouchStart,this),this.onDocumentMouseUp=d(this.onDocumentMouseUp,this),this.onDocumentTouchEnd=d(this.onDocumentTouchEnd,this),this.onHandleClick=d(this.onHandleClick,this),this.onWindowResize=d(this.onWindowResize,this)},bindEventListeners:function(){e(this.handle,"mousedown",this.onHandleMouseDown),e(this.handle,"touchstart",this.onHandleTouchStart),e(document,"mousemove",this.onDocumentMouseMove),e(this.wrapper,"touchmove",this.onWrapperTouchMove),e(this.wrapper,"mousedown",this.onWrapperMouseDown),e(this.wrapper,"touchstart",this.onWrapperTouchStart),e(document,"mouseup",this.onDocumentMouseUp),e(document,"touchend",this.onDocumentTouchEnd),e(this.handle,"click",this.onHandleClick),e(window,"resize",this.onWindowResize),this.animate(!1,!0),this.interval=this.requestAnimationFrame(this.animateWithRequestAnimationFrame)},unbindEventListeners:function(){f(this.handle,"mousedown",this.onHandleMouseDown),f(this.handle,"touchstart",this.onHandleTouchStart),f(document,"mousemove",this.onDocumentMouseMove),f(this.wrapper,"touchmove",this.onWrapperTouchMove),f(this.wrapper,"mousedown",this.onWrapperMouseDown),f(this.wrapper,"touchstart",this.onWrapperTouchStart),f(document,"mouseup",this.onDocumentMouseUp),f(document,"touchend",this.onDocumentTouchEnd),f(this.handle,"click",this.onHandleClick),f(window,"resize",this.onWindowResize),this.cancelAnimationFrame(this.interval)},onHandleMouseDown:function(a){i.refresh(a),g(a),h(a),this.activity=!1,this.startDrag()},onHandleTouchStart:function(a){i.refresh(a),h(a),this.activity=!1,this.startDrag()},onDocumentMouseMove:function(a){i.refresh(a),this.dragging&&(this.activity=!0,g(a))},onWrapperTouchMove:function(a){if(i.refresh(a),!this.activity&&this.draggingOnDisabledAxis())return void(this.dragging&&this.stopDrag());g(a),this.activity=!0},onWrapperMouseDown:function(a){i.refresh(a),g(a),this.startTap()},onWrapperTouchStart:function(a){i.refresh(a),g(a),this.startTap()},onDocumentMouseUp:function(a){this.stopDrag(),this.stopTap()},onDocumentTouchEnd:function(a){this.stopDrag(),this.stopTap()},onHandleClick:function(a){this.activity&&(g(a),h(a))},onWindowResize:function(a){this.reflow()},enable:function(){this.disabled=!1,this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=!0,this.handle.className+=" disabled"},reflow:function(){this.setWrapperOffset(),this.bounds=this.calculateBounds(),this.valuePrecision=this.calculateValuePrecision(),this.updateOffsetFromValue()},getStep:function(){return[this.getStepNumber(this.value.target[0]),this.getStepNumber(this.value.target[1])]},getValue:function(){return this.value.target},setStep:function(a,b,c){this.setValue(this.options.steps&&a>1?(a-1)/(this.options.steps-1):0,this.options.steps&&b>1?(b-1)/(this.options.steps-1):0,c)},setValue:function(a,b,c){this.setTargetValue([a,b||0]),c&&(this.groupCopy(this.value.current,this.value.target),this.updateOffsetFromValue(),this.callAnimationCallback())},startTap:function(){!this.disabled&&this.options.tapping&&(this.tapping=!0,this.setWrapperOffset(),this.setTargetValueByOffset([i.x-this.offset.wrapper[0]-this.handle.offsetWidth/2,i.y-this.offset.wrapper[1]-this.handle.offsetHeight/2]))},stopTap:function(){!this.disabled&&this.tapping&&(this.tapping=!1,this.setTargetValue(this.value.current))},startDrag:function(){this.disabled||(this.dragging=!0,this.setWrapperOffset(),this.offset.mouse=[i.x-j.get(this.handle)[0],i.y-j.get(this.handle)[1]],this.wrapper.className.match(this.options.activeClass)||(this.wrapper.className+=" "+this.options.activeClass),this.callDragStartCallback())},stopDrag:function(){if(!this.disabled&&this.dragging){this.dragging=!1;var a=this.groupClone(this.value.current);if(this.options.slide){var b=this.change;a[0]+=4*b[0],a[1]+=4*b[1]}this.setTargetValue(a),this.wrapper.className=this.wrapper.className.replace(" "+this.options.activeClass,""),this.callDragStopCallback()}},callAnimationCallback:function(){var a=this.value.current;this.options.snap&&this.options.steps>1&&(a=this.getClosestSteps(a)),this.groupCompare(a,this.value.prev)||("function"==typeof this.options.animationCallback&&this.options.animationCallback.call(this,a[0],a[1]),this.groupCopy(this.value.prev,a))},callTargetCallback:function(){"function"==typeof this.options.callback&&this.options.callback.call(this,this.value.target[0],this.value.target[1])},callDragStartCallback:function(){"function"==typeof this.options.dragStartCallback&&this.options.dragStartCallback.call(this,this.value.target[0],this.value.target[1])},callDragStopCallback:function(){"function"==typeof this.options.dragStopCallback&&this.options.dragStopCallback.call(this,this.value.target[0],this.value.target[1])},animateWithRequestAnimationFrame:function(a){a?(this.timeOffset=this.timeStamp?a-this.timeStamp:0,this.timeStamp=a):this.timeOffset=25,this.animate(),this.interval=this.requestAnimationFrame(this.animateWithRequestAnimationFrame)},animate:function(a,b){if(!a||this.dragging){if(this.dragging){var c=this.groupClone(this.value.target),d=[i.x-this.offset.wrapper[0]-this.offset.mouse[0],i.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetValueByOffset(d,this.options.loose),this.change=[this.value.target[0]-c[0],this.value.target[1]-c[1]]}(this.dragging||b)&&this.groupCopy(this.value.current,this.value.target),(this.dragging||this.glide()||b)&&(this.updateOffsetFromValue(),this.callAnimationCallback())}},glide:function(){var a=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];return!(!a[0]&&!a[1])&&(Math.abs(a[0])>this.valuePrecision[0]||Math.abs(a[1])>this.valuePrecision[1]?(this.value.current[0]+=a[0]*Math.min(this.options.speed*this.timeOffset/25,1),this.value.current[1]+=a[1]*Math.min(this.options.speed*this.timeOffset/25,1)):this.groupCopy(this.value.current,this.value.target),!0)},updateOffsetFromValue:function(){this.options.snap?this.offset.current=this.getOffsetsByRatios(this.getClosestSteps(this.value.current)):this.offset.current=this.getOffsetsByRatios(this.value.current),this.groupCompare(this.offset.current,this.offset.prev)||(this.renderHandlePosition(),this.groupCopy(this.offset.prev,this.offset.current))},renderHandlePosition:function(){var a="";if(this.options.css3&&k.transform)return this.options.horizontal&&(a+="translateX("+this.offset.current[0]+"px)"),this.options.vertical&&(a+=" translateY("+this.offset.current[1]+"px)"),void(this.handle.style[k.transform]=a);this.options.horizontal&&(this.handle.style.left=this.offset.current[0]+"px"),this.options.vertical&&(this.handle.style.top=this.offset.current[1]+"px")},setTargetValue:function(a,b){var c=b?this.getLooseValue(a):this.getProperValue(a);this.groupCopy(this.value.target,c),this.offset.target=this.getOffsetsByRatios(c),this.callTargetCallback()},setTargetValueByOffset:function(a,b){var c=this.getRatiosByOffsets(a),d=b?this.getLooseValue(c):this.getProperValue(c);this.groupCopy(this.value.target,d),this.offset.target=this.getOffsetsByRatios(d)},getLooseValue:function(a){var b=this.getProperValue(a);return[b[0]+(a[0]-b[0])/4,b[1]+(a[1]-b[1])/4]},getProperValue:function(a){var b=this.groupClone(a);return b[0]=Math.max(b[0],0),b[1]=Math.max(b[1],0),b[0]=Math.min(b[0],1),b[1]=Math.min(b[1],1),(!this.dragging&&!this.tapping||this.options.snap)&&this.options.steps>1&&(b=this.getClosestSteps(b)),b},getRatiosByOffsets:function(a){return[this.getRatioByOffset(a[0],this.bounds.availWidth,this.bounds.left),this.getRatioByOffset(a[1],this.bounds.availHeight,this.bounds.top)]},getRatioByOffset:function(a,b,c){return b?(a-c)/b:0},getOffsetsByRatios:function(a){return[this.getOffsetByRatio(a[0],this.bounds.availWidth,this.bounds.left),this.getOffsetByRatio(a[1],this.bounds.availHeight,this.bounds.top)]},getOffsetByRatio:function(a,b,c){return Math.round(a*b)+c},getStepNumber:function(a){return this.getClosestStep(a)*(this.options.steps-1)+1},getClosestSteps:function(a){return[this.getClosestStep(a[0]),this.getClosestStep(a[1])]},getClosestStep:function(a){for(var b=0,c=1,d=0;d<=this.options.steps-1;d++)Math.abs(this.stepRatios[d]-a)<c&&(c=Math.abs(this.stepRatios[d]-a),b=d);return this.stepRatios[b]},groupCompare:function(a,b){return a[0]==b[0]&&a[1]==b[1]},groupCopy:function(a,b){a[0]=b[0],a[1]=b[1]},groupClone:function(a){return[a[0],a[1]]},draggingOnDisabledAxis:function(){return!this.options.horizontal&&i.xDiff>i.yDiff||!this.options.vertical&&i.yDiff>i.xDiff}};for(var d=function(a,b){return function(){return a.apply(b,arguments)}},e=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},f=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)},g=function(a){a||(a=window.event),a.preventDefault&&a.preventDefault(),a.returnValue=!1},h=function(a){a||(a=window.event),a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0},i={x:0,y:0,xDiff:0,yDiff:0,refresh:function(a){a||(a=window.event),"mousemove"==a.type?this.set(a):a.touches&&this.set(a.touches[0])},set:function(a){var b=this.x,c=this.y;a.clientX||a.clientY?(this.x=a.clientX,this.y=a.clientY):(a.pageX||a.pageY)&&(this.x=a.pageX-document.body.scrollLeft-document.documentElement.scrollLeft,this.y=a.pageY-document.body.scrollTop-document.documentElement.scrollTop),this.xDiff=Math.abs(this.x-b),this.yDiff=Math.abs(this.y-c)}},j={get:function(a){var b={left:0,top:0};return void 0!==a.getBoundingClientRect&&(b=a.getBoundingClientRect()),[b.left,b.top]}},k={transform:a("transform"),perspective:a("perspective"),backfaceVisibility:a("backfaceVisibility")},l=["webkit","moz"],m=window.requestAnimationFrame,n=window.cancelAnimationFrame,o=0;o<l.length&&!m;++o)m=window[l[o]+"RequestAnimationFrame"],n=window[l[o]+"CancelAnimationFrame"]||window[l[o]+"CancelRequestAnimationFrame"];return m||(m=function(a){return setTimeout(a,25)},n=clearTimeout),c}),function(a){"use strict";a(jQuery)}(function(a,b){"use strict";function c(b,c,d,e){for(var f=[],g=0;g<b.length;g++){var h=b[g];if(h){var i=tinycolor(h),j=i.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";j+=tinycolor.equals(c,h)?" sp-thumb-active":"";var k=i.toString(e.preferredFormat||"rgb"),l=p?"background-color:"+i.toRgbString():"filter:"+i.toFilter();f.push('<span title="'+k+'" data-color="'+i.toRgbString()+'" class="'+j+'"><span class="sp-thumb-inner" style="'+l+';" /></span>')}else{f.push(a("<div />").append(a('<span data-color="" style="background-color:transparent;" class="'+"sp-clear-display"+'"></span>').attr("title",e.noColorSelectedText)).html())}}return"<div class='sp-cf "+d+"'>"+f.join("")+"</div>"}function d(){for(var a=0;a<n.length;a++)n[a]&&n[a].hide()}function e(b,c){var d=a.extend({},m,b);return d.callbacks={move:j(d.move,c),change:j(d.change,c),show:j(d.show,c),hide:j(d.hide,c),beforeShow:j(d.beforeShow,c)},d}function f(f,h){function j(){if(T.showPaletteOnly&&(T.showPalette=!0),Ka.text(T.showPaletteOnly?T.togglePaletteMoreText:T.togglePaletteLessText),T.palette){la=T.palette.slice(0),ma=a.isArray(la[0])?la:[la],na={};for(var b=0;b<ma.length;b++)for(var c=0;c<ma[b].length;c++){var d=tinycolor(ma[b][c]).toRgbString();na[d]=!0}}va.toggleClass("sp-flat",U),va.toggleClass("sp-input-disabled",!T.showInput),va.toggleClass("sp-alpha-enabled",T.showAlpha),va.toggleClass("sp-clear-enabled",Xa),va.toggleClass("sp-buttons-disabled",!T.showButtons),va.toggleClass("sp-palette-buttons-disabled",!T.togglePaletteOnly),va.toggleClass("sp-palette-disabled",!T.showPalette),va.toggleClass("sp-palette-only",T.showPaletteOnly),va.toggleClass("sp-initial-disabled",!T.showInitial),va.addClass(T.className).addClass(T.containerClassName),N()}function m(){function b(b){return b.data&&b.data.ignore?(G(a(b.target).closest(".sp-thumb-el").data("color")),J()):(G(a(b.target).closest(".sp-thumb-el").data("color")),J(),M(!0),T.hideAfterPaletteSelect&&E()),!1}if(o&&va.find("*:not(input)").attr("unselectable","on"),j(),Na&&ta.after(Oa).hide(),Xa||Ia.hide(),U)ta.after(va).hide();else{var c="parent"===T.appendTo?ta.parent():a(T.appendTo);1!==c.length&&(c=a("body")),c.append(va)}t(),Pa.bind("click.spectrum touchstart.spectrum",function(b){ua||B(),b.stopPropagation(),a(b.target).is("input")||b.preventDefault()}),(ta.is(":disabled")||!0===T.disabled)&&R(),va.click(i),Ea.change(A),Ea.bind("paste",function(){setTimeout(A,1)}),Ea.keydown(function(a){13==a.keyCode&&A()}),Ha.text(T.cancelText),Ha.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),F(),E()}),Ia.attr("title",T.clearText),Ia.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),Wa=!0,J(),U&&M(!0)}),Ja.text(T.chooseText),Ja.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),I()&&(M(!0),E())}),Ka.text(T.showPaletteOnly?T.togglePaletteMoreText:T.togglePaletteLessText),Ka.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),T.showPaletteOnly=!T.showPaletteOnly,T.showPaletteOnly||U||va.css("left","-="+(wa.outerWidth(!0)+5)),j()}),k(Ca,function(a,b,c){ka=a/ea,Wa=!1,c.shiftKey&&(ka=Math.round(10*ka)/10),J()},y,z),k(za,function(a,b){ha=parseFloat(b/ca),Wa=!1,T.showAlpha||(ka=1),J()},y,z),k(xa,function(a,b,c){if(c.shiftKey){if(!ra){var d=ia*_,e=aa-ja*aa,f=Math.abs(a-d)>Math.abs(b-e);ra=f?"x":"y"}}else ra=null;var g=!ra||"x"===ra,h=!ra||"y"===ra;g&&(ia=parseFloat(a/_)),h&&(ja=parseFloat((aa-b)/aa)),Wa=!1,T.showAlpha||(ka=1),J()},y,z),Ra?(G(Ra),K(),Ua=Ta||tinycolor(Ra).format,u(Ra)):K(),U&&C();var d=o?"mousedown.spectrum":"click.spectrum touchstart.spectrum";Fa.delegate(".sp-thumb-el",d,b),Ga.delegate(".sp-thumb-el:nth-child(1)",d,{ignore:!0},b)}function t(){if(W&&window.localStorage){try{var b=window.localStorage[W].split(",#");b.length>1&&(delete window.localStorage[W],a.each(b,function(a,b){u(b)}))}catch(a){}try{oa=window.localStorage[W].split(";")}catch(a){}}}function u(b){if(V){var c=tinycolor(b).toRgbString();if(!na[c]&&-1===a.inArray(c,oa))for(oa.push(c);oa.length>pa;)oa.shift();if(W&&window.localStorage)try{window.localStorage[W]=oa.join(";")}catch(a){}}}function v(){var a=[];if(T.showPalette)for(var b=0;b<oa.length;b++){var c=tinycolor(oa[b]).toRgbString();na[c]||a.push(oa[b])}return a.reverse().slice(0,T.maxSelectionSize)}function w(){var b=H(),d=a.map(ma,function(a,d){return c(a,b,"sp-palette-row sp-palette-row-"+d,T)});t(),oa&&d.push(c(v(),b,"sp-palette-row sp-palette-row-selection",T)),Fa.html(d.join(""))}function x(){if(T.showInitial){var a=Sa,b=H();Ga.html(c([a,b],b,"sp-palette-row-initial",T))}}function y(){(aa<=0||_<=0||ca<=0)&&N(),va.addClass(qa),ra=null,ta.trigger("dragstart.spectrum",[H()])}function z(){va.removeClass(qa),ta.trigger("dragstop.spectrum",[H()])}function A(){var a=Ea.val();if(null!==a&&""!==a||!Xa){var b=tinycolor(a);b.isValid()?(G(b),M(!0)):Ea.addClass("sp-validation-error")}else G(null),M(!0)}function B(){$?E():C()}function C(){var b=a.Event("beforeShow.spectrum");if($)return void N();ta.trigger(b,[H()]),!1===Y.beforeShow(H())||b.isDefaultPrevented()||(d(),$=!0,a(sa).bind("click.spectrum",D),a(window).bind("resize.spectrum",Z),Oa.addClass("sp-active"),va.removeClass("sp-hidden"),N(),K(),Sa=H(),x(),Y.show(Sa),ta.trigger("show.spectrum",[Sa]))}function D(a){2!=a.button&&(Va?M(!0):F(),E())}function E(){$&&!U&&($=!1,a(sa).unbind("click.spectrum",D),a(window).unbind("resize.spectrum",Z),Oa.removeClass("sp-active"),va.addClass("sp-hidden"),Y.hide(H()),ta.trigger("hide.spectrum",[H()]))}function F(){G(Sa,!0)}function G(a,b){if(tinycolor.equals(a,H()))return void K();var c,d;!a&&Xa?Wa=!0:(Wa=!1,c=tinycolor(a),d=c.toHsv(),ha=d.h%360/360,ia=d.s,ja=d.v,ka=d.a),K(),c&&c.isValid()&&!b&&(Ua=Ta||c.getFormat())}function H(a){return a=a||{},Xa&&Wa?null:tinycolor.fromRatio({h:ha,s:ia,v:ja,a:Math.round(100*ka)/100},{format:a.format||Ua})}function I(){return!Ea.hasClass("sp-validation-error")}function J(){K(),Y.move(H()),ta.trigger("move.spectrum",[H()])}function K(){Ea.removeClass("sp-validation-error"),L();var a=tinycolor.fromRatio({h:ha,s:1,v:1});xa.css("background-color",a.toHexString());var b=Ua;ka<1&&(0!==ka||"name"!==b)&&("hex"!==b&&"hex3"!==b&&"hex6"!==b&&"name"!==b||(b="rgb"));var c=H({format:b}),d="";if(Qa.removeClass("sp-clear-display"),Qa.css("background-color","transparent"),!c&&Xa)Qa.addClass("sp-clear-display");else{var e=c.toHexString(),f=c.toRgbString();if(p||1===c.alpha?Qa.css("background-color",f):(Qa.css("background-color","transparent"),Qa.css("filter",c.toFilter())),T.showAlpha){var g=c.toRgb();g.a=0;var h=tinycolor(g).toRgbString(),i="linear-gradient(left, "+h+", "+e+")";o?Ba.css("filter",tinycolor(h).toFilter({gradientType:1},e)):(Ba.css("background","-webkit-"+i),Ba.css("background","-moz-"+i),Ba.css("background","-ms-"+i),Ba.css("background","linear-gradient(to right, "+h+", "+e+")"))}d=c.toString(b)}T.showInput&&Ea.val(d),T.showPalette&&w(),x()}function L(){var a=ia,b=ja;if(Xa&&Wa)Da.hide(),Aa.hide(),ya.hide();else{Da.show(),Aa.show(),ya.show();var c=a*_,d=aa-b*aa;c=Math.max(-ba,Math.min(_-ba,c-ba)),d=Math.max(-ba,Math.min(aa-ba,d-ba)),ya.css({top:d+"px",left:c+"px"});var e=ka*ea;Da.css({left:e-fa/2+"px"});var f=ha*ca;Aa.css({top:f-ga+"px"})}}function M(a){var b=H(),c="",d=!tinycolor.equals(b,Sa);b&&(c=b.toString(Ua),u(b)),La&&ta.val(c),a&&d&&(Y.change(b),ta.trigger("change",[b]))}function N(){_=xa.width(),aa=xa.height(),ba=ya.height(),da=za.width(),ca=za.height(),ga=Aa.height(),ea=Ca.width(),fa=Da.width(),U||(va.css("position","absolute"),T.offset?va.offset(T.offset):va.offset(g(va,Pa))),L(),T.showPalette&&w(),ta.trigger("reflow.spectrum")}function O(){ta.show(),Pa.unbind("click.spectrum touchstart.spectrum"),va.remove(),Oa.remove(),n[Ya.id]=null}function P(c,d){return c===b?a.extend({},T):d===b?T[c]:(T[c]=d,void j())}function Q(){ua=!1,ta.attr("disabled",!1),Pa.removeClass("sp-disabled")}function R(){E(),ua=!0,ta.attr("disabled",!0),Pa.addClass("sp-disabled")}function S(a){T.offset=a,N()}var T=e(h,f),U=T.flat,V=T.showSelectionPalette,W=!1===T.localStorageKey?"spectrum-"+f.id:T.localStorageKey,X=T.theme,Y=T.callbacks,Z=l(N,10),$=!1,_=0,aa=0,ba=0,ca=0,da=0,ea=0,fa=0,ga=0,ha=0,ia=0,ja=0,ka=1,la=[],ma=[],na={},oa=T.selectionPalette.slice(0),pa=T.maxSelectionSize,qa="sp-dragging",ra=null,sa=f.ownerDocument,ta=(sa.body,a(f)),ua=!1,va=a(s,sa).addClass(X),wa=va.find(".sp-picker-container"),xa=va.find(".sp-color"),ya=va.find(".sp-dragger"),za=va.find(".sp-hue"),Aa=va.find(".sp-slider"),Ba=va.find(".sp-alpha-inner"),Ca=va.find(".sp-alpha"),Da=va.find(".sp-alpha-handle"),Ea=va.find(".sp-input"),Fa=va.find(".sp-palette"),Ga=va.find(".sp-initial"),Ha=va.find(".sp-cancel"),Ia=va.find(".sp-clear"),Ja=va.find(".sp-choose"),Ka=va.find(".sp-palette-toggle"),La=ta.is("input"),Ma=La&&q&&"color"===ta.attr("type"),Na=La&&!U,Oa=Na?a(r).addClass(X).addClass(T.className).addClass(T.replacerClassName):a([]),Pa=Na?Oa:ta,Qa=Oa.find(".sp-preview-inner"),Ra=T.color||La&&ta.val(),Sa=!1,Ta=T.preferredFormat,Ua=Ta,Va=!T.showButtons||T.clickoutFiresChange,Wa=!Ra,Xa=T.allowEmpty&&!Ma;m();var Ya={show:C,hide:E,toggle:B,reflow:N,option:P,enable:Q,disable:R,offset:S,set:function(a){G(a),M()},get:H,destroy:O,container:va};return Ya.id=n.push(Ya)-1,Ya}function g(b,c){var d=0,e=b.outerWidth(),f=b.outerHeight(),g=c.outerHeight(),h=b[0].ownerDocument,i=h.documentElement,j=i.clientWidth+a(h).scrollLeft(),k=i.clientHeight+a(h).scrollTop(),l=c.offset();return l.top+=g,l.left-=Math.min(l.left,l.left+e>j&&j>e?Math.abs(l.left+e-j):0),l.top-=Math.min(l.top,l.top+f>k&&k>f?Math.abs(f+g-d):d),l}function h(){}function i(a){a.stopPropagation()}function j(a,b){var c=Array.prototype.slice,d=c.call(arguments,2);return function(){return a.apply(b,d.concat(c.call(arguments)))}}function k(b,c,d,e){function f(a){a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.returnValue=!1}function g(a){if(k){if(o&&j.documentMode<9&&!a.button)return i();var d=a.originalEvent&&a.originalEvent.touches,e=d?d[0].pageX:a.pageX,g=d?d[0].pageY:a.pageY,h=Math.max(0,Math.min(e-l.left,n)),q=Math.max(0,Math.min(g-l.top,m));p&&f(a),c.apply(b,[h,q,a])}}function h(c){(c.which?3==c.which:2==c.button)||k||!1!==d.apply(b,arguments)&&(k=!0,m=a(b).height(),n=a(b).width(),l=a(b).offset(),a(j).bind(q),a(j.body).addClass("sp-dragging"),p||g(c),f(c))}function i(){k&&(a(j).unbind(q),a(j.body).removeClass("sp-dragging"),e.apply(b,arguments)),k=!1}c=c||function(){},d=d||function(){},e=e||function(){};var j=document,k=!1,l={},m=0,n=0,p="ontouchstart"in window,q={};q.selectstart=f,q.dragstart=f,q["touchmove mousemove"]=g,q["touchend mouseup"]=i,a(b).bind("touchstart mousedown",h)}function l(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};c&&clearTimeout(d),!c&&d||(d=setTimeout(g,b))}}var m={beforeShow:h,move:h,change:h,show:h,hide:h,color:!1,flat:!1,showInput:!0,allowEmpty:!1,showButtons:!1,clickoutFiresChange:!1,showInitial:!0,showPalette:!0,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:"hex",className:"",containerClassName:"",replacerClassName:"",showAlpha:!0,theme:"sp-light",palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)","rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"]],selectionPalette:[],disabled:!1,offset:null},n=[],o=!!/msie/i.exec(window.navigator.userAgent),p=function(){function a(a,b){return!!~(""+a).indexOf(b)}var b=document.createElement("div"),c=b.style;return c.cssText="background-color:rgba(0,0,0,.5)",a(c.backgroundColor,"rgba")||a(c.backgroundColor,"hsla")}(),q=function(){var b=a("<input type='color' value='!' />")[0];return"color"===b.type&&"!"!==b.value}(),r=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<span class='caret'></span>","</div>"].join(""),s=function(){var a="";if(o)for(var b=1;b<=6;b++)a+="<div class='sp-"+b+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",a,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),t="spectrum.id";a.fn.spectrum=function(b,c){if("string"==typeof b){var d=this,e=Array.prototype.slice.call(arguments,1);return this.each(function(){var c=n[a(this).data(t)];if(c){var f=c[b];if(!f)throw new Error("Spectrum: no such method: '"+b+"'");"get"==b?d=c.get():"container"==b?d=c.container:"option"==b?d=c.option.apply(c,e):"destroy"==b?(c.destroy(),a(this).removeData(t)):f.apply(c,e)}}),d}return this.spectrum("destroy").each(function(){var c=a.extend({},b,a(this).data()),d=f(this,c);a(this).data(t,d.id)})},a.fn.spectrum.load=!0,a.fn.spectrum.loadOpts={},a.fn.spectrum.draggable=k,a.fn.spectrum.defaults=m,a.spectrum={},a.spectrum.localization={},a.spectrum.palettes={},a.fn.spectrum.processNativeColorInputs=function(){q||a("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){function a(a){var c={r:0,g:0,b:0},e=1,g=!1,h=!1;return"string"==typeof a&&(a=G(a)),"object"==typeof a&&(a.hasOwnProperty("r")&&a.hasOwnProperty("g")&&a.hasOwnProperty("b")?(c=b(a.r,a.g,a.b),g=!0,h="%"===String(a.r).substr(-1)?"prgb":"rgb"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("v")?(a.s=D(a.s),a.v=D(a.v),c=f(a.h,a.s,a.v),g=!0,h="hsv"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("l")&&(a.s=D(a.s),a.l=D(a.l),c=d(a.h,a.s,a.l),g=!0,h="hsl"),a.hasOwnProperty("a")&&(e=a.a)),e=w(e),{ok:g,format:a.format||h,r:M(255,N(c.r,0)),g:M(255,N(c.g,0)),b:M(255,N(c.b,0)),a:e}}function b(a,b,c){return{r:255*x(a,255),g:255*x(b,255),b:255*x(c,255)}}function c(a,b,c){a=x(a,255),b=x(b,255),c=x(c,255);var d,e,f=N(a,b,c),g=M(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(b<c?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}}function d(a,b,c){function d(a,b,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?a+6*(b-a)*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(a=x(a,360),b=x(b,100),c=x(c,100),0===b)e=f=g=c;else{var h=c<.5?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:255*e,g:255*f,b:255*g}}function e(a,b,c){a=x(a,255),b=x(b,255),c=x(c,255);var d,e,f=N(a,b,c),g=M(a,b,c),h=f,i=f-g;if(e=0===f?0:i/f,f==g)d=0;else{switch(f){case a:d=(b-c)/i+(b<c?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,v:h}}function f(a,b,c){a=6*x(a,360),b=x(b,100),c=x(c,100);var d=K.floor(a),e=a-d,f=c*(1-b),g=c*(1-e*b),h=c*(1-(1-e)*b),i=d%6;return{r:255*[c,g,f,f,h,c][i],g:255*[h,c,c,g,f,f][i],b:255*[f,f,h,c,c,g][i]}}function g(a,b,c,d){var e=[C(L(a).toString(16)),C(L(b).toString(16)),C(L(c).toString(16))];return d&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function h(a,b,c,d){return[C(E(d)),C(L(a).toString(16)),C(L(b).toString(16)),C(L(c).toString(16))].join("")}function i(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.s-=b/100,c.s=y(c.s),P(c)}function j(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.s+=b/100,c.s=y(c.s),P(c)}function k(a){return P(a).desaturate(100)}function l(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.l+=b/100,c.l=y(c.l),P(c)}function m(a,b){b=0===b?0:b||10;var c=P(a).toRgb();return c.r=N(0,M(255,c.r-L(-b/100*255))),c.g=N(0,M(255,c.g-L(-b/100*255))),c.b=N(0,M(255,c.b-L(-b/100*255))),P(c)}function n(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.l-=b/100,c.l=y(c.l),P(c)}function o(a,b){var c=P(a).toHsl(),d=(L(c.h)+b)%360;return c.h=d<0?360+d:d,P(c)}function p(a){var b=P(a).toHsl();return b.h=(b.h+180)%360,P(b)}function q(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+120)%360,s:b.s,l:b.l}),P({h:(c+240)%360,s:b.s,l:b.l})]}function r(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+90)%360,s:b.s,l:b.l}),P({h:(c+180)%360,s:b.s,l:b.l}),P({h:(c+270)%360,s:b.s,l:b.l})]}function s(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+72)%360,s:b.s,l:b.l}),P({h:(c+216)%360,s:b.s,l:b.l})]}function t(a,b,c){b=b||6,c=c||30;var d=P(a).toHsl(),e=360/c,f=[P(a)];for(d.h=(d.h-(e*b>>1)+720)%360;--b;)d.h=(d.h+e)%360,f.push(P(d));return f}function u(a,b){b=b||6;for(var c=P(a).toHsv(),d=c.h,e=c.s,f=c.v,g=[],h=1/b;b--;)g.push(P({h:d,s:e,v:f})),f=(f+h)%1;return g}function v(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}function w(a){return a=parseFloat(a),(isNaN(a)||a<0||a>1)&&(a=1),a}function x(a,b){A(a)&&(a="100%");var c=B(a);return a=M(b,N(0,parseFloat(a))),c&&(a=parseInt(a*b,10)/100),K.abs(a-b)<1e-6?1:a%b/parseFloat(b)}function y(a){return M(1,N(0,a))}function z(a){return parseInt(a,16)}function A(a){return"string"==typeof a&&-1!=a.indexOf(".")&&1===parseFloat(a)}function B(a){return"string"==typeof a&&-1!=a.indexOf("%")}function C(a){return 1==a.length?"0"+a:""+a}function D(a){return a<=1&&(a=100*a+"%"),a}function E(a){return Math.round(255*parseFloat(a)).toString(16)}function F(a){return z(a)/255}function G(a){a=a.replace(H,"").replace(I,"").toLowerCase();var b=!1;if(Q[a])a=Q[a],b=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0,format:"name"};var c;return(c=S.rgb.exec(a))?{r:c[1],g:c[2],b:c[3]}:(c=S.rgba.exec(a))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=S.hsl.exec(a))?{h:c[1],s:c[2],l:c[3]}:(c=S.hsla.exec(a))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=S.hsv.exec(a))?{h:c[1],s:c[2],v:c[3]}:(c=S.hsva.exec(a))?{h:c[1],s:c[2],v:c[3],a:c[4]}:(c=S.hex8.exec(a))?{a:F(c[1]),r:z(c[2]),g:z(c[3]),b:z(c[4]),format:b?"name":"hex8"}:(c=S.hex6.exec(a))?{r:z(c[1]),g:z(c[2]),b:z(c[3]),format:b?"name":"hex"}:!!(c=S.hex3.exec(a))&&{r:z(c[1]+""+c[1]),g:z(c[2]+""+c[2]),b:z(c[3]+""+c[3]),format:b?"name":"hex"}}var H=/^[\s,#]+/,I=/\s+$/,J=0,K=Math,L=K.round,M=K.min,N=K.max,O=K.random,P=function b(c,d){if(c=c||"",d=d||{},c instanceof b)return c;if(!(this instanceof b))return new b(c,d);var e=a(c);this._originalInput=c,this._r=e.r,this._g=e.g,this._b=e.b,this._a=e.a,this._roundA=L(100*this._a)/100,this._format=d.format||e.format,this._gradientType=d.gradientType,this._r<1&&(this._r=L(this._r)),this._g<1&&(this._g=L(this._g)),this._b<1&&(this._b=L(this._b)),this._ok=e.ok,this._tc_id=J++};P.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1e3},setAlpha:function(a){return this._a=w(a),this._roundA=L(100*this._a)/100,this},toHsv:function(){var a=e(this._r,this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=e(this._r,this._g,this._b),b=L(360*a.h),c=L(100*a.s),d=L(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+d+"%)":"hsva("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHsl:function(){var a=c(this._r,this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=c(this._r,this._g,this._b),b=L(360*a.h),d=L(100*a.s),e=L(100*a.l);return 1==this._a?"hsl("+b+", "+d+"%, "+e+"%)":"hsla("+b+", "+d+"%, "+e+"%, "+this._roundA+")"},toHex:function(a){return g(this._r,this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(){return h(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:L(this._r),g:L(this._g),b:L(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+L(this._r)+", "+L(this._g)+", "+L(this._b)+")":"rgba("+L(this._r)+", "+L(this._g)+", "+L(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:L(100*x(this._r,255))+"%",g:L(100*x(this._g,255))+"%",b:L(100*x(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+L(100*x(this._r,255))+"%, "+L(100*x(this._g,255))+"%, "+L(100*x(this._b,255))+"%)":"rgba("+L(100*x(this._r,255))+"%, "+L(100*x(this._g,255))+"%, "+L(100*x(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(R[g(this._r,this._g,this._b,!0)]||!1)},toFilter:function(a){var b="#"+h(this._r,this._g,this._b,this._a),c=b,d=this._gradientType?"GradientType = 1, ":"";if(a){c=P(a).toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+d+"startColorstr="+b+",endColorstr="+c+")"},toString:function(a){var b=!!a;a=a||this._format;var c=!1,d=this._a<1&&this._a>=0;return b||!d||"hex"!==a&&"hex6"!==a&&"hex3"!==a&&"name"!==a?("rgb"===a&&(c=this.toRgbString()),"prgb"===a&&(c=this.toPercentageRgbString()),"hex"!==a&&"hex6"!==a||(c=this.toHexString()),"hex3"===a&&(c=this.toHexString(!0)),"hex8"===a&&(c=this.toHex8String()),"name"===a&&(c=this.toName()),"hsl"===a&&(c=this.toHslString()),"hsv"===a&&(c=this.toHsvString()),c||this.toHexString()):"name"===a&&0===this._a?this.toName():this.toRgbString()},_applyModification:function(a,b){var c=a.apply(null,[this].concat([].slice.call(b)));return this._r=c._r,this._g=c._g,this._b=c._b,this.setAlpha(c._a),this},lighten:function(){return this._applyModification(l,arguments)},brighten:function(){return this._applyModification(m,arguments)},darken:function(){return this._applyModification(n,arguments)},desaturate:function(){return this._applyModification(i,arguments)},saturate:function(){return this._applyModification(j,arguments)},greyscale:function(){return this._applyModification(k,arguments)},spin:function(){return this._applyModification(o,arguments)},_applyCombination:function(a,b){return a.apply(null,[this].concat([].slice.call(b)))},analogous:function(){return this._applyCombination(t,arguments)},complement:function(){return this._applyCombination(p,arguments)},monochromatic:function(){return this._applyCombination(u,arguments)},splitcomplement:function(){return this._applyCombination(s,arguments)},triad:function(){return this._applyCombination(q,arguments)},tetrad:function(){return this._applyCombination(r,arguments)}},P.fromRatio=function(a,b){if("object"==typeof a){var c={};for(var d in a)a.hasOwnProperty(d)&&(c[d]="a"===d?a[d]:D(a[d]));a=c}return P(a,b)},P.equals=function(a,b){return!(!a||!b)&&P(a).toRgbString()==P(b).toRgbString()},P.random=function(){return P.fromRatio({r:O(),g:O(),b:O()})},P.mix=function(a,b,c){c=0===c?0:c||50;var d,e=P(a).toRgb(),f=P(b).toRgb(),g=c/100,h=2*g-1,i=f.a-e.a;d=h*i==-1?h:(h+i)/(1+h*i),d=(d+1)/2;var j=1-d,k={r:f.r*d+e.r*j,g:f.g*d+e.g*j,b:f.b*d+e.b*j,a:f.a*g+e.a*(1-g)};return P(k)},P.readability=function(a,b){var c=P(a),d=P(b),e=c.toRgb(),f=d.toRgb(),g=c.getBrightness(),h=d.getBrightness(),i=Math.max(e.r,f.r)-Math.min(e.r,f.r)+Math.max(e.g,f.g)-Math.min(e.g,f.g)+Math.max(e.b,f.b)-Math.min(e.b,f.b);return{brightness:Math.abs(g-h),color:i}},P.isReadable=function(a,b){var c=P.readability(a,b);return c.brightness>125&&c.color>500},P.mostReadable=function(a,b){for(var c=null,d=0,e=!1,f=0;f<b.length;f++){var g=P.readability(a,b[f]),h=g.brightness>125&&g.color>500,i=g.brightness/125*3+g.color/500;(h&&!e||h&&e&&i>d||!h&&!e&&i>d)&&(e=h,d=i,c=P(b[f]))}return c};var Q=P.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},R=P.hexNames=v(Q),S=function(){var a="[-\\+]?\\d+%?",b="[-\\+]?\\d*\\.\\d+%?",c="(?:"+b+")|(?:"+a+")",d="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?",e="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?";return{rgb:new RegExp("rgb"+d),rgba:new RegExp("rgba"+e),hsl:new RegExp("hsl"+d),hsla:new RegExp("hsla"+e),hsv:new RegExp("hsv"+d),hsva:new RegExp("hsva"+e),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=P}(),a(function(){a.fn.spectrum.load&&a.fn.spectrum.processNativeColorInputs()})}),define("toast/libs/spectrum",function(){}),function(a){"function"==typeof define&&define.amd?define("toast/libs/Drag",a):a(jQuery)}(function(){"use strict";$.fn.drag=function(a,b,c){var d="string"==typeof a?a:"",e=$.isFunction(a)?a:$.isFunction(b)?b:null;return 0!==d.indexOf("drag")&&(d="drag"+d),c=(a==e?b:c)||{},e?this.bind(d,c,e):this.trigger(d)};var a=$.event,b=a.special,c=b.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!1,click:!1},datakey:"dragdata",noBubble:!0,add:function(a){var b=$.data(this,c.datakey),d=a.data||{};b.related+=1,$.each(c.defaults,function(a,c){void 0!==d[a]&&(b[a]=d[a])})},remove:function(){$.data(this,c.datakey).related-=1},setup:function(){if(!$.data(this,c.datakey)){var b=$.extend({related:0},c.defaults);$.data(this,c.datakey,b),a.add(this,"touchstart mousedown",c.init,b),this.attachEvent&&this.attachEvent("ondragstart",c.dontstart)}},teardown:function(){($.data(this,c.datakey)||{}).related||($.removeData(this,c.datakey),a.remove(this,"touchstart mousedown",c.init),c.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",c.dontstart))},init:function(d){if(!c.touched){var e,f=d.data;if(!(0!=d.which&&f.which>0&&d.which!=f.which)&&!$(d.target).is(f.not)&&(!f.handle||$(d.target).closest(f.handle,d.currentTarget).length)&&(c.touched="touchstart"==d.type?this:null,f.propagates=1,f.mousedown=this,f.interactions=[c.interaction(this,f)],f.target=d.target,f.pageX=d.pageX,f.pageY=d.pageY,f.dragging=null,e=c.hijack(d,"draginit",f),f.propagates))return e=c.flatten(e),e&&e.length&&(f.interactions=[],$.each(e,function(){f.interactions.push(c.interaction(this,f))})),f.propagates=f.interactions.length,!1!==f.drop&&b.drop&&b.drop.handler(d,f),c.textselect(!1),c.touched?a.add(c.touched,"touchmove touchend",c.handler,f):a.add(document,"mousemove mouseup",c.handler,f),!(!c.touched||f.live)&&void 0}},interaction:function(a,b){var d=$(a)[b.relative?"position":"offset"]()||{top:0,left:0};return{drag:a,callback:new c.callback,droppable:[],offset:d}},handler:function(d){var e=d.data;switch(d.type){case!e.dragging&&"touchmove":d.preventDefault();case!e.dragging&&"mousemove":if(Math.pow(d.pageX-e.pageX,2)+Math.pow(d.pageY-e.pageY,2)<Math.pow(e.distance,2))break;d.target=e.target,c.hijack(d,"dragstart",e),e.propagates&&(e.dragging=!0);case"touchmove":d.preventDefault();case"mousemove":if(e.dragging){if(c.hijack(d,"drag",e),e.propagates){!1!==e.drop&&b.drop&&b.drop.handler(d,e);break}d.type="mouseup"}case"touchend":case"mouseup":default:c.touched?a.remove(c.touched,"touchmove touchend",c.handler):a.remove(document,"mousemove mouseup",c.handler),e.dragging&&(!1!==e.drop&&b.drop&&b.drop.handler(d,e),c.hijack(d,"dragend",e)),c.textselect(!0),!1===e.click&&e.dragging&&$.data(e.mousedown,"suppress.click",(new Date).getTime()+5),e.dragging=c.touched=!1}},hijack:function(b,d,e,f,g){if(e){var h,i,j,k={event:b.originalEvent,type:b.type},l=d.indexOf("drop")?"drag":"drop",m=f||0,n=isNaN(f)?e.interactions.length:f;b.type=d,b.originalEvent=null,e.results=[];do{if(i=e.interactions[m]){if("dragend"!==d&&i.cancelled)continue;j=c.properties(b,e,i),i.results=[],$(g||i[l]||e.droppable).each(function(f,g){if(j.target=g,b.isPropagationStopped=function(){return!1},h=g?a.dispatch.call(g,b,j):null,!1===h?("drag"==l&&(i.cancelled=!0,e.propagates-=1),"drop"==d&&(i[l][f]=null)):"dropinit"==d&&i.droppable.push(c.element(h)||g),"dragstart"==d&&(i.proxy=$(c.element(h)||i.drag)[0]),i.results.push(h),delete b.result,"dropinit"!==d)return h}),e.results[m]=c.flatten(i.results),"dropinit"==d&&(i.droppable=c.flatten(i.droppable)),"dragstart"!=d||i.cancelled||j.update()}}while(++m<n);return b.type=k.type,b.originalEvent=k.event,c.flatten(e.results)}},properties:function(a,b,d){var e=d.callback;return e.drag=d.drag,e.proxy=d.proxy||d.drag,e.startX=b.pageX,e.startY=b.pageY,e.deltaX=a.pageX-b.pageX,e.deltaY=a.pageY-b.pageY,e.originalX=d.offset.left,e.originalY=d.offset.top,e.offsetX=e.originalX+e.deltaX,e.offsetY=e.originalY+e.deltaY,e.drop=c.flatten((d.drop||[]).slice()),e.available=c.flatten((d.droppable||[]).slice()),e},element:function(a){if(a&&(a.jquery||1==a.nodeType))return a},flatten:function(a){return $.map(a,function(a){return a&&a.jquery?$.makeArray(a):a&&a.length?c.flatten(a):a})},textselect:function(a){$(document)[a?"unbind":"bind"]("selectstart",c.dontstart).css("MozUserSelect",a?"":"none"),document.unselectable=a?"off":"on"},dontstart:function(){return!1},callback:function(){}};c.callback.prototype={update:function(){b.drop&&this.available.length&&$.each(this.available,function(a){b.drop.locate(this,a)})}};var d=a.dispatch;a.dispatch=function(a){return $.data(this,"suppress."+a.type)-(new Date).getTime()>0?void $.removeData(this,"suppress."+a.type):d.apply(this,arguments)};var e=a.fixHooks.touchstart=a.fixHooks.touchmove=a.fixHooks.touchend=a.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(a,b){if(b){var c=b.touches&&b.touches[0]||b.changedTouches&&b.changedTouches[0]||null;c&&$.each(e.props,function(b,d){a[d]=c[d]})}return a}};b.draginit=b.dragstart=b.dragend=c}),function(a){"function"==typeof define&&define.amd?define("toast/libs/Drop",a):a(jQuery)}(function(){"use strict";$.fn.drop=function(a,b,c){var d="string"==typeof a?a:"",e=$.isFunction(a)?a:$.isFunction(b)?b:null;return 0!==d.indexOf("drop")&&(d="drop"+d),c=(a==e?b:c)||{},e?this.bind(d,c,e):this.trigger(d)},$.drop=function(a){a=a||{},c.multi=!0===a.multi?1/0:!1===a.multi?1:isNaN(a.multi)?c.multi:a.multi,c.delay=a.delay||c.delay,c.tolerance=$.isFunction(a.tolerance)?a.tolerance:null===a.tolerance?null:c.tolerance,c.mode=a.mode||c.mode||"intersect",a.page&&(c.page=a.page)};var a=$.event,b=a.special,c=$.event.special._drop={page:null,multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(a){$.data(this,c.datakey).related+=1},remove:function(){$.data(this,c.datakey).related-=1},setup:function(){if(!$.data(this,c.datakey)){var a={related:0,active:[],anyactive:0,winner:0,location:{}};$.data(this,c.datakey,a),c.targets.push(this)}},teardown:function(){if(!($.data(this,c.datakey)||{}).related){$.removeData(this,c.datakey);var a=this;c.targets=$.grep(c.targets,function(b){return b!==a})}},handler:function(a,d){var e;if(d)switch(a.type){case"mousedown":case"touchstart":e=$(c.targets),"string"==typeof d.drop&&(e=e.filter(d.drop)),e.each(function(){var a=$.data(this,c.datakey);a.active=[],a.anyactive=0,a.winner=0}),d.droppable=e,b.drag.hijack(a,"dropinit",d);break;case"mousemove":case"touchmove":c.event=a,c.timer||c.tolerate(d);break;case"mouseup":case"touchend":c.timer=clearTimeout(c.timer),d.propagates&&(b.drag.hijack(a,"drop",d),b.drag.hijack(a,"dropend",d))}},locate:function(a,b){var d=$.data(a,c.datakey),e=$(a),f=e.offset()||{},g=e.outerHeight(),h=e.outerWidth(),i={elem:a,width:h,height:g,top:f.top,left:f.left,right:f.left+h,bottom:f.top+g};return d&&(d.location=i,d.index=b,d.elem=a),i},contains:function(a,b){return(b[0]||b.left)>=a.left&&(b[0]||b.right)<=a.right&&(b[1]||b.top)>=a.top&&(b[1]||b.bottom)<=a.bottom},modes:{intersect:function(a,b,c){return this.contains(c,[a.pageX,a.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(a,b,c){return b=$(b.elem)[0].getBoundingClientRect(),c=$(c.elem)[0].getBoundingClientRect(),Math.max(0,Math.min(c.bottom,b.bottom)-Math.max(c.top,b.top))*Math.max(0,Math.min(c.right,b.right)-Math.max(c.left,b.left))},fit:function(a,b,c){return this.contains(c,b)?1:0},middle:function(a,b,c){return this.contains(c,[b.left+.5*b.width,b.top+.5*b.height])?1:0}},sort:function(a,b){return b.winner-a.winner||a.index-b.index},tolerate:function(a){var d,e,f,g,h,i,j,k,l=0,m=a.interactions.length,n=[c.event.pageX,c.event.pageY],o=c.tolerance||c.modes[c.mode];do{if(k=a.interactions[l]){if(!k)return;k.drop=[],h=[],i=k.droppable.length,o&&(f=c.locate(k.proxy)),d=0;do{if(j=k.droppable[d]){if(g=$.data(j,c.datakey),!(e=g.location))continue;g.winner=o?o.call(c,c.event,f,e):c.contains(e,n)?1:0,h.push(g)}}while(++d<i);h.sort(c.sort),d=0;do{(g=h[d])&&(g.winner&&k.drop.length<c.multi?(g.active[l]||g.anyactive||(!1!==b.drag.hijack(c.event,"dropstart",a,l,g.elem)[0]?(g.active[l]=1,g.anyactive+=1):g.winner=0),g.winner&&k.drop.push(g.elem)):g.active[l]&&1==g.anyactive&&(b.drag.hijack(c.event,"dropend",a,l,g.elem),g.active[l]=0,g.anyactive-=1))}while(++d<i)}}while(++l<m);c.last&&n[0]==c.last.pageX&&n[1]==c.last.pageY?delete c.timer:c.timer=setTimeout(function(){c.tolerate(a)},c.delay),c.last=c.event}};"object"!=typeof brackets&&($.event.special.drop=$.event.special._drop),b.dropinit=b.dropstart=b.dropend=c}),"undefined"==typeof gj&&(gj={}),gj.widget=function(){var a=this;a.xhr=null,a.generateGUID=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},a.mouseX=function(a){if(a){if(tt.isMobile&&(a=a.originalEvent.touches[0]),a.pageX)return a.pageX;if(a.clientX)return a.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)}return null},a.mouseY=function(a){if(a){if(tt.isMobile&&(a=a.originalEvent.touches[0]),a.pageY)return a.pageY;if(a.clientY)return a.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)}return null}},gj.widget.prototype.init=function(a,b){var c,d,e;d=$.extend(!0,{},this.getHTMLConfig()||{}),$.extend(!0,d,a||{}),e=this.getConfig(d,b),this.attr("data-guid",e.guid),this.data(e);for(c in e)gj[b].events.hasOwnProperty(c)&&(this.on(c,e[c]),delete e[c]);for(plugin in gj[b].plugins)gj[b].plugins.hasOwnProperty(plugin)&&gj[b].plugins[plugin].configure(this,e,d);return this},gj.widget.prototype.getConfig=function(a,b){var c,d,e;c=$.extend(!0,{},gj[b].config.base),d=a.uiLibrary||c.uiLibrary,gj[b].config[d]&&$.extend(!0,c,gj[b].config[d]);for(e in gj[b].plugins)gj[b].plugins.hasOwnProperty(e)&&($.extend(!0,c,gj[b].plugins[e].config.base),gj[b].plugins[e].config[d]&&$.extend(!0,c,gj[b].plugins[e].config[d]));return $.extend(!0,c,a),c.guid||(c.guid=this.generateGUID()),c},gj.widget.prototype.getHTMLConfig=function(){var a=this.data(),b=this[0].attributes;return b.width&&(a.width=b.width.nodeValue),b.height&&(a.height=b.height.nodeValue),b.align&&(a.align=b.align.nodeValue),a&&a.source&&(a.dataSource=a.source,delete a.source),a},gj.widget.prototype.createDoneHandler=function(){var a=this;return function(b){"string"==typeof b&&JSON&&(b=JSON.parse(b)),gj[a.data("type")].methods.render(a,b)}},gj.widget.prototype.createErrorHandler=function(){return function(a){a&&a.statusText&&"abort"!==a.statusText&&alert(a)}},gj.widget.prototype.reload=function(a){var b,c,d=this.data();return void 0===d.dataSource&&gj[this.data("type")].methods.useHtmlDataSource(this,d),$.extend(d.params,a),$.isArray(d.dataSource)?(c=gj[this.data("type")].methods.filter(this),gj[this.data("type")].methods.render(this,c)):"string"==typeof d.dataSource?(b={url:d.dataSource,data:d.params},this.xhr&&this.xhr.abort(),this.xhr=$.ajax(b).done(this.createDoneHandler()).fail(this.createErrorHandler())):"object"==typeof d.dataSource&&(d.dataSource.data||(d.dataSource.data={}),$.extend(d.dataSource.data,d.params),b=$.extend(!0,{},d.dataSource),"json"===b.dataType&&"object"==typeof b.data&&(b.data=JSON.stringify(b.data)),b.success||(b.success=this.createDoneHandler()),b.error||(b.error=this.createErrorHandler()),this.xhr&&this.xhr.abort(),this.xhr=$.ajax(b)),this},gj.documentManager={events:{},subscribeForEvent:function(a,b,c){if(gj.documentManager.events[a]&&0!==gj.documentManager.events[a].length){if(gj.documentManager.events[a][b])throw"Event "+a+" for widget with guid='"+b+"' is already attached.";gj.documentManager.events[a].push({widgetId:b,callback:c})}else gj.documentManager.events[a]=[{widgetId:b,callback:c}],$(document).on(a,gj.documentManager.executeCallbacks)},executeCallbacks:function(a){var b=gj.documentManager.events[a.type];if(b)for(var c=0;c<b.length;c++)b[c].callback(a)},unsubscribeForEvent:function(a,b){var c=!1,d=gj.documentManager.events[a];if(d){for(var e=0;e<d.length;e++)d[e].widgetId===b&&($(document).off(a,d[e].callback),d.splice(e,1),c=!0);0===d.length&&delete gj.documentManager.events[a]}if(!c)throw'The "'+a+'" for widget with guid="'+b+"\" can't be removed."}},void 0===gj.dialog&&(gj.dialog={plugins:{},messages:[]}),gj.dialog.messages["en-us"]={Close:"Close",DefaultTitle:"Dialog"},gj.dialog.config={base:{autoOpen:!0,closeOnEscape:!0,closeButtonInHeader:!0,draggable:!0,height:"auto",locale:"en-us",minHeight:void 0,maxHeight:void 0,width:300,minWidth:void 0,maxWidth:void 0,modal:!1,resizable:!1,title:void 0,uiLibrary:void 0,style:{modal:"gj-modal",content:"gj-content",header:"gj-header",headerTitle:"gj-title gj-unselectable",headerCloseButton:"gj-close",body:"gj-body",footer:"gj-dialog-footer gj-footer"}},bootstrap:{style:{modal:"modal",content:"modal-content",header:"modal-header",headerTitle:"modal-title",headerCloseButton:"close",body:"modal-body",footer:"gj-dialog-footer modal-footer"}},jqueryui:{style:{modal:"gj-modal",content:"ui-widget ui-widget-content gj-dialog-content",header:"gj-dialog-ui-header ui-widget-header",headerTitle:"gj-dialog-ui-title",headerCloseButton:"gj-dialog-ui-close ui-button ui-widget ui-state-default ui-corner-all",body:"gj-dialog-ui-body",footer:"gj-dialog-footer"}},foundation:{style:{modal:"reveal-modal-bg",content:"reveal-modal gj-dialog-fd-content",header:"",headerTitle:"gj-dialog-fd-title gj-unselectable",headerCloseButton:"close-reveal-modal right gj-dialog-fd-close",body:"gj-dialog-fd-body",footer:"gj-dialog-footer gj-dialog-fd-footer"}},materialdesign:{style:{modal:"gj-modal",content:"mdl-dialog gj-dialog-mdl-content",header:"",headerTitle:"mdl-dialog__title gj-unselectable",headerCloseButton:"gj-dialog-mdl-close",body:"mdl-dialog__content",footer:"gj-dialog-footer"}}},gj.dialog.events={initialized:function(a){a.trigger("initialized")},opening:function(a){a.trigger("opening")},opened:function(a){a.trigger("opened")},closing:function(a){a.trigger("closing")},closed:function(a){a.trigger("closed")},drag:function(a){a.trigger("drag")},dragStart:function(a){a.trigger("dragStart")},dragStop:function(a){a.trigger("dragStop")},resize:function(a){a.trigger("resize")},resizeStart:function(a){a.trigger("resizeStart")},resizeStop:function(a){a.trigger("resizeStop")}},gj.dialog.methods={init:function(a){return this.attr("data-type","dialog"),gj.widget.prototype.init.call(this,a,"dialog"),gj.dialog.methods.localization(this),gj.dialog.methods.initialize(this),gj.dialog.events.initialized(this),this},localization:function(a){var b=a.data();void 0===b.title&&(b.title=gj.dialog.messages[b.locale].DefaultTitle)},getHTMLConfig:function(){var a=gj.widget.prototype.getHTMLConfig.call(this),b=this[0].attributes;return b.title&&(a.title=b.title.nodeValue),a},initialize:function(a){var b,c,d=a.data();a.addClass(d.style.content),gj.dialog.methods.setSize(a),d.closeOnEscape&&$(document).keyup(function(b){27===b.keyCode&&a.close()}),c=a.children('div[data-role="body"]'),0===c.length?(c=$('<div data-role="body"/>').addClass(d.style.body),a.wrapInner(c)):c.addClass(d.style.body),b=gj.dialog.methods.renderHeader(a),a.children('div[data-role="footer"]').addClass(d.style.footer),a.find('[data-role="close"]').on("click",function(){a.close()}),d.draggable&&$.fn.draggable&&gj.dialog.methods.draggable(a,b),d.resizable&&$.fn.draggable&&gj.dialog.methods.resizable(a),gj.dialog.methods.setPosition(a),d.modal&&a.wrapAll('<div data-role="modal" class="'+d.style.modal+'"/>'),d.autoOpen&&a.open()},setSize:function(a){var b=a.data();b.width&&a.css("width",b.width),b.height&&a.css("height",b.height)},renderHeader:function(a){var b,c,d,e=a.data();return b=a.children('div[data-role="header"]'),0===b.length&&(b=$('<div data-role="header" />'),a.prepend(b)),b.addClass(e.style.header),c=b.find('[data-role="title"]'),0===c.length&&(c=$('<h4 data-role="title">'+e.title+"</h4>"),b.append(c)),c.addClass(e.style.headerTitle),d=b.find('[data-role="close"]'),0===d.length&&e.closeButtonInHeader?(d=$('<button type="button" data-role="close" title="'+gj.dialog.messages[e.locale].Close+'"><span>×</span></button>'),d.addClass(e.style.headerCloseButton),b.prepend(d)):d.length>0&&!1===e.closeButtonInHeader&&d.hide(),b},setPosition:function(a){var b=$(window).width()/2-a.width()/2,c=$(window).height()/2-a.height()/2;a.css("position","absolute"),a.css("left",b>0?b:0),a.css("top",c>0?c:0)},draggable:function(a,b){a.appendTo("body"),b.addClass("gj-draggable"),a.draggable({handle:b,start:function(){a.addClass("gj-unselectable"),gj.dialog.events.dragStart(a)},stop:function(){a.removeClass("gj-unselectable"),gj.dialog.events.dragStop(a)}})},resizable:function(a){var b={drag:gj.dialog.methods.resize,start:function(){a.addClass("gj-unselectable"),gj.dialog.events.resizeStart(a)},stop:function(){this.removeAttribute("style"),a.removeClass("gj-unselectable"),gj.dialog.events.resizeStop(a)}};a.append($('<div class="gj-resizable-handle gj-resizable-n"></div>').draggable($.extend(!0,{horizontal:!1},b))),a.append($('<div class="gj-resizable-handle gj-resizable-e"></div>').draggable($.extend(!0,{vertical:!1},b))),a.append($('<div class="gj-resizable-handle gj-resizable-s"></div>').draggable($.extend(!0,{horizontal:!1},b))),a.append($('<div class="gj-resizable-handle gj-resizable-w"></div>').draggable($.extend(!0,{vertical:!1},b))),a.append($('<div class="gj-resizable-handle gj-resizable-ne"></div>').draggable($.extend(!0,{},b))),a.append($('<div class="gj-resizable-handle gj-resizable-nw"></div>').draggable($.extend(!0,{},b))),a.append($('<div class="gj-resizable-handle gj-resizable-sw"></div>').draggable($.extend(!0,{},b))),a.append($('<div class="gj-resizable-handle gj-resizable-se"></div>').draggable($.extend(!0,{},b)))},resize:function(a,b){var c,d,e,f,g,h,i,j=!1;return c=$(this),d=c.parent(),e=d.data(),c.hasClass("gj-resizable-n")?(f=d.height()-b.top,h=d.offset().top+b.top):c.hasClass("gj-resizable-e")?g=d.width()+b.left:c.hasClass("gj-resizable-s")?f=d.height()+b.top:c.hasClass("gj-resizable-w")?(g=d.width()-b.left,i=d.offset().left+b.left):c.hasClass("gj-resizable-ne")?(f=d.height()-b.top,h=d.offset().top+b.top,g=d.width()+b.left):c.hasClass("gj-resizable-nw")?(f=d.height()-b.top,h=d.offset().top+b.top,g=d.width()-b.left,i=d.offset().left+b.left):c.hasClass("gj-resizable-se")?(f=d.height()+b.top,g=d.width()+b.left):c.hasClass("gj-resizable-sw")&&(f=d.height()+b.top,g=d.width()-b.left,i=d.offset().left+b.left),f&&(!e.minHeight||f>=e.minHeight)&&(!e.maxHeight||f<=e.maxHeight)&&(d.height(f),h&&d.css("top",h),j=!0),g&&(!e.minWidth||g>=e.minWidth)&&(!e.maxWidth||g<=e.maxWidth)&&(d.width(g),i&&d.css("left",i),j=!0),j&&gj.dialog.events.resize(d),!1},open:function(a){var b;return gj.dialog.events.opening(a),a.css("display","block"),a.closest('div[data-role="modal"]').css("display","block"),b=a.children('div[data-role="footer"]'),b.length&&b.outerHeight()&&a.children('div[data-role="body"]').css("margin-bottom",b.outerHeight()),gj.dialog.events.opened(a),a},close:function(a){return a.is(":visible")&&(gj.dialog.events.closing(a),a.css("display","none"),a.closest('div[data-role="modal"]').css("display","none"),gj.dialog.events.closed(a)),a},isOpen:function(a){return a.is(":visible")}},gj.dialog.widget=function(a,arguments){var b=this,c=gj.dialog.methods;return b.open=function(){return c.open(this)},b.close=function(){return c.close(this)},b.isOpen=function(){return c.isOpen(this)},$.extend(a,b),"dialog"!==a.attr("data-type")&&c.init.apply(a,arguments),a},gj.dialog.widget.prototype=new gj.widget,gj.dialog.widget.constructor=gj.dialog.widget,gj.dialog.widget.prototype.getHTMLConfig=gj.dialog.methods.getHTMLConfig,function(a){a.fn.dialog=function(a){var b;if(this&&this.length){if("object"!=typeof a&&a){if(b=new gj.dialog.widget(this,null),b[a])return b[a].apply(this,Array.prototype.slice.call(arguments,1));throw"Method "+a+" does not exist."}return new gj.dialog.widget(this,arguments)}}}(jQuery),define("toast/libs/dialog",function(){}),"undefined"==typeof gj&&(gj={}),gj.widget=function(){var a=this;a.xhr=null,a.generateGUID=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},a.mouseX=function(a){if(a){if(tt.isMobile&&(a=a.originalEvent.touches[0]),a.pageX)return a.pageX;if(a.clientX)return a.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)}return null},a.mouseY=function(a){if(a){if(tt.isMobile&&(a=a.originalEvent.touches[0]),a.pageY)return a.pageY;if(a.clientY)return a.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)}return null}},gj.widget.prototype.init=function(a,b){var c,d,e;d=$.extend(!0,{},this.getHTMLConfig()||{}),$.extend(!0,d,a||{}),e=this.getConfig(d,b),this.attr("data-guid",e.guid),this.data(e);for(c in e)gj[b].events.hasOwnProperty(c)&&(this.on(c,e[c]),delete e[c]);for(plugin in gj[b].plugins)gj[b].plugins.hasOwnProperty(plugin)&&gj[b].plugins[plugin].configure(this,e,d);return this},gj.widget.prototype.getConfig=function(a,b){var c,d,e;c=$.extend(!0,{},gj[b].config.base),d=a.uiLibrary||c.uiLibrary,gj[b].config[d]&&$.extend(!0,c,gj[b].config[d]);for(e in gj[b].plugins)gj[b].plugins.hasOwnProperty(e)&&($.extend(!0,c,gj[b].plugins[e].config.base),gj[b].plugins[e].config[d]&&$.extend(!0,c,gj[b].plugins[e].config[d]));return $.extend(!0,c,a),c.guid||(c.guid=this.generateGUID()),c},gj.widget.prototype.getHTMLConfig=function(){var a=this.data(),b=this[0].attributes;return b.width&&(a.width=b.width.nodeValue),b.height&&(a.height=b.height.nodeValue),b.align&&(a.align=b.align.nodeValue),a&&a.source&&(a.dataSource=a.source,delete a.source),a},gj.widget.prototype.createDoneHandler=function(){var a=this;return function(b){"string"==typeof b&&JSON&&(b=JSON.parse(b)),gj[a.data("type")].methods.render(a,b)}},gj.widget.prototype.createErrorHandler=function(){return function(a){a&&a.statusText&&"abort"!==a.statusText&&alert(a)}},gj.widget.prototype.reload=function(a){var b,c,d=this.data();return void 0===d.dataSource&&gj[this.data("type")].methods.useHtmlDataSource(this,d),$.extend(d.params,a),$.isArray(d.dataSource)?(c=gj[this.data("type")].methods.filter(this),gj[this.data("type")].methods.render(this,c)):"string"==typeof d.dataSource?(b={url:d.dataSource,data:d.params},this.xhr&&this.xhr.abort(),this.xhr=$.ajax(b).done(this.createDoneHandler()).fail(this.createErrorHandler())):"object"==typeof d.dataSource&&(d.dataSource.data||(d.dataSource.data={}),$.extend(d.dataSource.data,d.params),b=$.extend(!0,{},d.dataSource),"json"===b.dataType&&"object"==typeof b.data&&(b.data=JSON.stringify(b.data)),b.success||(b.success=this.createDoneHandler()),b.error||(b.error=this.createErrorHandler()),this.xhr&&this.xhr.abort(),this.xhr=$.ajax(b)),this},gj.documentManager={events:{},subscribeForEvent:function(a,b,c){if(gj.documentManager.events[a]&&0!==gj.documentManager.events[a].length){if(gj.documentManager.events[a][b])throw"Event "+a+" for widget with guid='"+b+"' is already attached.";gj.documentManager.events[a].push({widgetId:b,callback:c})}else gj.documentManager.events[a]=[{widgetId:b,callback:c}],$(document).on(a,gj.documentManager.executeCallbacks)},executeCallbacks:function(a){var b=gj.documentManager.events[a.type];if(b)for(var c=0;c<b.length;c++)b[c].callback(a)},unsubscribeForEvent:function(a,b){var c=!1,d=gj.documentManager.events[a];if(d){for(var e=0;e<d.length;e++)d[e].widgetId===b&&($(document).off(a,d[e].callback),d.splice(e,1),c=!0);0===d.length&&delete gj.documentManager.events[a]}if(!c)throw'The "'+a+'" for widget with guid="'+b+"\" can't be removed."}},void 0===gj.draggable&&(gj.draggable={}),gj.draggable.config={base:{handle:void 0,vertical:!0,horizontal:!0}},gj.draggable.methods={init:function(a){var b,c=this;return gj.widget.prototype.init.call(this,a,"draggable"),c.attr("data-draggable","true"),b=gj.draggable.methods.getHandleElement(c),b.on(gj.draggable.events.types.start,function(a){$(a.target).hasClass(".close")||0!==$(a.target).parents(".close").length||(a.originalEvent.preventDefault(),c.attr("data-draggable-dragging",!0),c.removeAttr("data-draggable-x"),c.removeAttr("data-draggable-y"),c.css("position","absolute"))}),gj.documentManager.subscribeForEvent(gj.draggable.events.types.move,c.data("guid"),gj.draggable.methods.createMouseMoveHandler(c)),gj.documentManager.subscribeForEvent(gj.draggable.events.types.end,c.data("guid"),gj.draggable.methods.createMouseUpHandler(c)),c},getHandleElement:function(a){var b=a.data("handle");return b&&b.length?b:a},createMouseUpHandler:function(a){return function(b){"true"===a.attr("data-draggable-dragging")&&(a.attr("data-draggable-dragging",!1),gj.draggable.events.stop(a,{left:a.mouseX(b),top:a.mouseY(b)}))}},createMouseMoveHandler:function(a){return function(b){var c,d,e,f,g,h;"true"===a.attr("data-draggable-dragging")&&(c=a.mouseX(b),d=a.mouseY(b),g=a.attr("data-draggable-x"),h=a.attr("data-draggable-y"),g&&h?(e=a.data("horizontal")?c-parseInt(g,10):0,f=a.data("vertical")?d-parseInt(h,10):0,!1!==gj.draggable.events.drag(a,e,f,c,d)&&gj.draggable.methods.move(a,e,f)):gj.draggable.events.start(a),a.attr("data-draggable-x",c),a.attr("data-draggable-y",d))}},move:function(a,b,c){var d=a.get(0),e=d.style.top?parseInt(d.style.top):a.position().top,f=d.style.left?parseInt(d.style.left):a.position().left;d.style.top=e+c+"px",d.style.left=f+b+"px"},destroy:function(a){return"true"===a.attr("data-draggable")&&(gj.documentManager.unsubscribeForEvent(gj.draggable.events.types.end,a.data("guid")),gj.documentManager.unsubscribeForEvent(gj.draggable.events.types.move,a.data("guid")),a.removeData(),a.removeAttr("data-guid"),a.removeAttr("data-draggable"),a.off("drag").off("start").off("stop"),gj.draggable.methods.getHandleElement(a).off(gj.draggable.events.types.start)),a}},gj.draggable.events={types:"ontouchstart"in window?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},drag:function(a,b,c,d,e){return a.triggerHandler("drag",[{top:c,left:b},{top:e,left:d}])},start:function(a){a.triggerHandler("start")},stop:function(a,b){a.triggerHandler("stop",[b])}},gj.draggable.widget=function(a,arguments){var b=this,c=gj.draggable.methods;return b.destroy=function(){return c.destroy(this)},$.extend(a,b),"true"!==a.attr("data-draggable")&&c.init.apply(a,arguments),a},gj.draggable.widget.prototype=new gj.widget,gj.draggable.widget.constructor=gj.draggable.widget,function(a){a.fn.draggable=function(a){var b;if(this&&this.length){if("object"!=typeof a&&a){if(b=new gj.draggable.widget(this,null),b[a])return b[a].apply(this,Array.prototype.slice.call(arguments,1));throw"Method "+a+" does not exist."}return new gj.draggable.widget(this,arguments)}}}(jQuery),define("toast/libs/draggable",function(){}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("toast/libs/Sketchpad",b):a.Spinner=b()}(this,function(){function a(a){for(var b in this.constructor.prototype)this[b]=this[b].bind(this);if(!a.hasOwnProperty("element"))return void console.error("SKETCHPAD ERROR: No element selected");"string"==typeof a.element?this.element=$(a.element):this.element=a.element,this.penModes={draw:0,eraser:1},this._width=a.width||this.element.attr("data-width")||0,this._height=a.height||this.element.attr("data-height")||0,this.color=a.color||this.element.attr("data-color")||"#000000",this.penSize=a.penSize||this.element.attr("data-penSize")||5,this.penMode=a.penMode||this.element.attr("data-penMode")||this.penModes.draw,this.scale=1,this.readOnly=a.readOnly||this.element.attr("data-readOnly")||!1,this.readOnly||this.element.css({cursor:"crosshair"}),this.strokes=a.strokes||[],this._currentStroke={color:null,size:null,penMode:this.penMode,lines:[]},this.undoHistory=a.undoHistory||[],this.animateIds=[],this._sketching=!1,this._isModified=!1,this.reset()}return a.prototype._cursorPosition=function(a){return{x:(a.pageX-$(this.canvas).offset().left)/this.scale,y:(a.pageY-$(this.canvas).offset().top)/this.scale}},a.prototype._draw=function(a,b,c,d){Toast.IS_ZOOM_DRAG_MODE||this._stroke(a,b,c,d,"source-over")},a.prototype._erase=function(a,b,c,d){Toast.IS_ZOOM_DRAG_MODE||this._stroke(a,b,c,d,"destination-out")},a.prototype._stroke=function(a,b,c,d,e){this.context.save(),this.context.lineJoin="round",this.context.lineCap="round",this.context.strokeStyle=c,this.context.lineWidth=d,this.context.globalCompositeOperation=e,this.context.beginPath(),this.context.moveTo(a.x,a.y),this.context.lineTo(b.x,b.y),this.context.closePath(),this.context.stroke(),this.context.restore()},a.prototype._mouseDown=function(a){a.stopPropagation(),this._lastPosition=this._cursorPosition(a),this._currentStroke.color=this.color,this._currentStroke.size=this.penSize,this._currentStroke.penMode=this.penMode,this._currentStroke.lines=[],this._sketching=!0,this._isModified=!0,document.addEventListener("mousemove",this._mouseMove)},a.prototype._mouseUp=function(a){this._sketching&&(this.strokes.push($.extend(!0,{},this._currentStroke)),this._sketching=!1),document.removeEventListener("mousemove",this._mouseMove)},a.prototype._mouseMove=function(a){var b=this._cursorPosition(a);this.penMode===this.penModes.draw?this._draw(this._lastPosition,b,this.color,this.penSize):this._erase(this._lastPosition,b,this.color,this.penSize),this._currentStroke.lines.push({start:$.extend(!0,{},this._lastPosition),end:$.extend(!0,{},b)}),this._lastPosition=b},a.prototype._touchStart=function(a){this._sketching||(a.preventDefault(),this._lastPosition=this._cursorPosition(a.changedTouches[0]),this._currentStroke.color=this.color,this._currentStroke.size=this.penSize,this._currentStroke.penMode=this.penMode,this._currentStroke.lines=[],this._sketching=!0,this._isModified=!0,document.addEventListener("touchmove",this._touchMove,!1))},a.prototype._touchEnd=function(a){this._sketching&&(a.preventDefault(),this.strokes.push($.extend(!0,{},this._currentStroke)),this._sketching=!1),document.removeEventListener("touchmove",this._touchMove)},a.prototype._touchCancel=function(a){this._sketching&&(a.preventDefault(),this.strokes.push($.extend(!0,{},this._currentStroke)),this._sketching=!1),document.removeEventListener("touchmove",this._touchMove)},a.prototype._touchLeave=function(a){a.preventDefault(),this._sketching&&(this.strokes.push($.extend(!0,{},this._currentStroke)),this._sketching=!1),document.removeEventListener("touchmove",this._touchMove)},a.prototype._touchMove=function(a){a.preventDefault();var b=this._cursorPosition(a.changedTouches[0]);this.penMode===this.penModes.draw?this._draw(this._lastPosition,b,this.color,this.penSize):this._erase(this._lastPosition,b,this.color,this.penSize),this._currentStroke.lines.push({start:$.extend(!0,{},this._lastPosition),end:$.extend(!0,{},b)}),this._lastPosition=b},a.prototype.reset=function(){this.canvas=this.element[0],this.canvas.width=this._width,this.canvas.height=this._height,this.context=this.canvas.getContext("2d"),this.redraw(this.strokes),this.readOnly||(this.canvas.addEventListener("mousedown",this._mouseDown),document.addEventListener("mouseup",this._mouseUp),this.canvas.addEventListener("touchstart",this._touchStart),document.addEventListener("touchend",this._touchEnd))},a.prototype.drawStroke=function(a){for(var b=0;b<a.lines.length;b++){var c=a.lines[b];a.penMode&&a.penMode===this.penModes.eraser?this._erase(c.start,c.end,a.color,a.size):this._draw(c.start,c.end,a.color,a.size)}},a.prototype.redraw=function(a){this.strokes=[],this._isModified=!1;for(var b=0;b<a.length;b++)this.strokes.push($.extend(!0,{},a[b])),this.drawStroke(a[b])},a.prototype.toObject=function(){return{width:this.canvas.width,height:this.canvas.height,strokes:this.strokes,undoHistory:this.undoHistory}},a.prototype.isEmpty=function(){return!this.strokes.length},a.prototype.toJSON=function(){return JSON.stringify(this.toObject())},a.prototype.animate=function(a,b,c){this.clear();for(var d=a,e=null,f=0;f<this.strokes.length;f++)for(var g=this.strokes[f],h=0;h<g.lines.length;h++){var i=g.lines[h];e=this._draw.bind(this,i.start,i.end,g.color,g.size),this.animateIds.push(setTimeout(e,d)),d+=a}b&&(c=c||0,e=this.animate.bind(this,a,b,c),this.animateIds.push(setTimeout(e,d+c)))},a.prototype.cancelAnimation=function(){for(var a=0;a<this.animateIds.length;a++)clearTimeout(this.animateIds[a])},a.prototype.clear=function(a){a||(a={}),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),a.force&&(this.strokes.length&&(this._isModified=!0),this.strokes=[],this.undoHistory=[])},a.prototype.undo=function(){this.clear();var a=this.strokes.pop();a&&(this.undoHistory.push(a),this.redraw(this.strokes))},a.prototype.redo=function(){var a=this.undoHistory.pop();a&&(this.strokes.push(a),this.drawStroke(a))},a.prototype.isModified=function(){return this._isModified},a}),function(a){"function"==typeof define&&define.amd?define("toast/libs/Scrollbar",a):"undefined"!=typeof module&&module.exports?module.exports=a:a(window,document)}(function(){!function(a){var b="function"==typeof define&&define.amd,c="undefined"!=typeof module&&module.exports;!b&&c&&require("jquery-mousewheel")($),a()}(function(){var a,b="mCustomScrollbar",c="mCS",d=".mCustomScrollbar",e={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,documentTouchScroll:!0,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:"auto",autoUpdateTimeout:60},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},f=0,g={},h=window.attachEvent&&!window.addEventListener?1:0,i=!1,j=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],k={init:function(a){var a=$.extend(!0,{},e,a),b=l.call(this);if(a.live){var h=a.liveSelector||this.selector||d,i=$(h);if("off"===a.live)return void n(h);g[h]=setTimeout(function(){i.mCustomScrollbar(a),"once"===a.live&&i.length&&n(h)},500)}else n(h);return a.setWidth=a.set_width?a.set_width:a.setWidth,a.setHeight=a.set_height?a.set_height:a.setHeight,a.axis=a.horizontalScroll?"x":o(a.axis),a.scrollInertia=a.scrollInertia>0&&a.scrollInertia<17?17:a.scrollInertia,"object"!=typeof a.mouseWheel&&1==a.mouseWheel&&(a.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),a.mouseWheel.scrollAmount=a.mouseWheelPixels?a.mouseWheelPixels:a.mouseWheel.scrollAmount,a.mouseWheel.normalizeDelta=a.advanced.normalizeMouseWheelDelta?a.advanced.normalizeMouseWheelDelta:a.mouseWheel.normalizeDelta,a.scrollButtons.scrollType=p(a.scrollButtons.scrollType),m(a),$(b).each(function(){var b=$(this);if(!b.data(c)){b.data(c,{idx:++f,opt:a,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:b.css("direction"),cbOffsets:null,trigger:null,poll:{size:{o:0,n:0},img:{o:0,n:0},change:{o:0,n:0}}});var d=b.data(c),e=d.opt,g=b.data("mcs-axis"),h=b.data("mcs-scrollbar-position"),i=b.data("mcs-theme");g&&(e.axis=g),h&&(e.scrollbarPosition=h),i&&(e.theme=i,m(e)),q.call(this),d&&e.callbacks.onCreate&&"function"==typeof e.callbacks.onCreate&&e.callbacks.onCreate.call(this),$("#mCSB_"+d.idx+"_container img:not(."+j[2]+")").addClass(j[2]),k.update.call(null,b)}})},update:function(a,b){var d=a||l.call(this);return $(d).each(function(){var a=$(this);if(a.data(c)){var d=a.data(c),e=d.opt,f=$("#mCSB_"+d.idx+"_container"),g=$("#mCSB_"+d.idx),h=[$("#mCSB_"+d.idx+"_dragger_vertical"),$("#mCSB_"+d.idx+"_dragger_horizontal")];if(!f.length)return;d.tweenRunning&&V(a),b&&d&&e.callbacks.onBeforeUpdate&&"function"==typeof e.callbacks.onBeforeUpdate&&e.callbacks.onBeforeUpdate.call(this),a.hasClass(j[3])&&a.removeClass(j[3]),a.hasClass(j[4])&&a.removeClass(j[4]),g.css("max-height","none"),g.height()!==a.height()&&g.css("max-height",a.height()),s.call(this),"y"===e.axis||e.advanced.autoExpandHorizontalScroll||f.css("width",r(f)),d.overflowed=x.call(this),B.call(this),e.autoDraggerLength&&u.call(this),v.call(this),z.call(this);var i=[Math.abs(f[0].offsetTop),Math.abs(f[0].offsetLeft)];"x"!==e.axis&&(d.overflowed[0]?h[0].height()>h[0].parent().height()?y.call(this):(W(a,i[0].toString(),{dir:"y",dur:0,overwrite:"none"}),d.contentReset.y=null):(y.call(this),"y"===e.axis?A.call(this):"yx"===e.axis&&d.overflowed[1]&&W(a,i[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==e.axis&&(d.overflowed[1]?h[1].width()>h[1].parent().width()?y.call(this):(W(a,i[1].toString(),{dir:"x",dur:0,overwrite:"none"}),d.contentReset.x=null):(y.call(this),"x"===e.axis?A.call(this):"yx"===e.axis&&d.overflowed[0]&&W(a,i[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),b&&d&&(2===b&&e.callbacks.onImageLoad&&"function"==typeof e.callbacks.onImageLoad?e.callbacks.onImageLoad.call(this):3===b&&e.callbacks.onSelectorChange&&"function"==typeof e.callbacks.onSelectorChange?e.callbacks.onSelectorChange.call(this):e.callbacks.onUpdate&&"function"==typeof e.callbacks.onUpdate&&e.callbacks.onUpdate.call(this)),T.call(this)}})},scrollTo:function(a,b){if(void 0!==a&&null!=a){var d=l.call(this);return $(d).each(function(){var d=$(this);if(d.data(c)){var e=d.data(c),f=e.opt,g={trigger:"external",scrollInertia:f.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},h=$.extend(!0,{},g,b),i=R.call(this,a),j=h.scrollInertia>0&&h.scrollInertia<17?17:h.scrollInertia;i[0]=S.call(this,i[0],"y"),i[1]=S.call(this,i[1],"x"),h.moveDragger&&(i[0]*=e.scrollRatio.y,i[1]*=e.scrollRatio.x),h.dur=ea()?0:j,setTimeout(function(){null!==i[0]&&void 0!==i[0]&&"x"!==f.axis&&e.overflowed[0]&&(h.dir="y",h.overwrite="all",W(d,i[0].toString(),h)),null!==i[1]&&void 0!==i[1]&&"y"!==f.axis&&e.overflowed[1]&&(h.dir="x",h.overwrite="none",W(d,i[1].toString(),h))},h.timeout)}})}},stop:function(){var a=l.call(this);return $(a).each(function(){var a=$(this);a.data(c)&&V(a)})},disable:function(a){var b=l.call(this);return $(b).each(function(){var b=$(this);if(b.data(c)){b.data(c);T.call(this,"remove"),A.call(this),a&&y.call(this),B.call(this,!0),b.addClass(j[3])}})},destroy:function(){var a=l.call(this);return $(a).each(function(){var d=$(this);if(d.data(c)){var e=d.data(c),f=e.opt,g=$("#mCSB_"+e.idx),h=$("#mCSB_"+e.idx+"_container"),i=$(".mCSB_"+e.idx+"_scrollbar");f.live&&n(f.liveSelector||$(a).selector),T.call(this,"remove"),A.call(this),y.call(this),d.removeData(c),_(this,"mcs"),i.remove(),h.find("img."+j[2]).removeClass(j[2]),g.replaceWith(h.contents()),d.removeClass(b+" _"+c+"_"+e.idx+" "+j[6]+" "+j[7]+" "+j[5]+" "+j[3]).addClass(j[4])}})}},l=function(){return"object"!=typeof $(this)||$(this).length<1?d:this},m=function(a){var b=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],c=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],d=["minimal","minimal-dark"],e=["minimal","minimal-dark"],f=["minimal","minimal-dark"];a.autoDraggerLength=!($.inArray(a.theme,b)>-1)&&a.autoDraggerLength,a.autoExpandScrollbar=!($.inArray(a.theme,c)>-1)&&a.autoExpandScrollbar,a.scrollButtons.enable=!($.inArray(a.theme,d)>-1)&&a.scrollButtons.enable,a.autoHideScrollbar=$.inArray(a.theme,e)>-1||a.autoHideScrollbar,a.scrollbarPosition=$.inArray(a.theme,f)>-1?"outside":a.scrollbarPosition},n=function(a){g[a]&&(clearTimeout(g[a]),_(g,a))},o=function(a){return"yx"===a||"xy"===a||"auto"===a?"yx":"x"===a||"horizontal"===a?"x":"y"},p=function(a){return"stepped"===a||"pixels"===a||"step"===a||"click"===a?"stepped":"stepless"},q=function(){var a=$(this),d=a.data(c),e=d.opt,f=e.autoExpandScrollbar?" "+j[1]+"_expand":"",g=["<div id='mCSB_"+d.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+d.idx+"_scrollbar mCS-"+e.theme+" mCSB_scrollTools_vertical"+f+"'><div class='"+j[12]+"'><div id='mCSB_"+d.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+d.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+d.idx+"_scrollbar mCS-"+e.theme+" mCSB_scrollTools_horizontal"+f+"'><div class='"+j[12]+"'><div id='mCSB_"+d.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],h="yx"===e.axis?"mCSB_vertical_horizontal":"x"===e.axis?"mCSB_horizontal":"mCSB_vertical",i="yx"===e.axis?g[0]+g[1]:"x"===e.axis?g[1]:g[0],k="yx"===e.axis?"<div id='mCSB_"+d.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",l=e.autoHideScrollbar?" "+j[6]:"",m="x"!==e.axis&&"rtl"===d.langDir?" "+j[7]:"";e.setWidth&&a.css("width",e.setWidth),e.setHeight&&a.css("height",e.setHeight),e.setLeft="y"!==e.axis&&"rtl"===d.langDir?"989999px":e.setLeft,a.addClass(b+" _"+c+"_"+d.idx+l+m).wrapInner("<div id='mCSB_"+d.idx+"' class='mCustomScrollBox mCS-"+e.theme+" "+h+"'><div id='mCSB_"+d.idx+"_container' class='mCSB_container' style='position:relative; top:"+e.setTop+"; left:"+e.setLeft+";' dir='"+d.langDir+"' /></div>");var n=$("#mCSB_"+d.idx),o=$("#mCSB_"+d.idx+"_container");"y"===e.axis||e.advanced.autoExpandHorizontalScroll||o.css("width",r(o)),"outside"===e.scrollbarPosition?("static"===a.css("position")&&a.css("position","relative"),a.css("overflow","visible"),n.addClass("mCSB_outside").after(i)):(n.addClass("mCSB_inside").append(i),o.wrap(k)),t.call(this);var p=[$("#mCSB_"+d.idx+"_dragger_vertical"),$("#mCSB_"+d.idx+"_dragger_horizontal")];p[0].css("min-height",p[0].height()),p[1].css("min-width",p[1].width())},r=function(a){var b=[a[0].scrollWidth,Math.max.apply(Math,a.children().map(function(){return $(this).outerWidth(!0)}).get())],c=a.parent().width();return b[0]>c?b[0]:b[1]>c?b[1]:"100%"},s=function(){var a=$(this),b=a.data(c),d=b.opt,e=$("#mCSB_"+b.idx+"_container");if(d.advanced.autoExpandHorizontalScroll&&"y"!==d.axis){e.css({width:"auto","min-width":0,"overflow-x":"scroll"});var f=Math.ceil(e[0].scrollWidth);3===d.advanced.autoExpandHorizontalScroll||2!==d.advanced.autoExpandHorizontalScroll&&f>e.parent().width()?e.css({width:f,"min-width":"100%","overflow-x":"inherit"}):e.css({"overflow-x":"inherit",position:"absolute"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(e[0].getBoundingClientRect().right+.4)-Math.floor(e[0].getBoundingClientRect().left),"min-width":"100%",position:"relative"}).unwrap()}},t=function(){var a=$(this),b=a.data(c),d=b.opt,e=$(".mCSB_"+b.idx+"_scrollbar:first"),f=ca(d.scrollButtons.tabindex)?"tabindex='"+d.scrollButtons.tabindex+"'":"",g=["<a href='#' class='"+j[13]+"' "+f+" />","<a href='#' class='"+j[14]+"' "+f+" />","<a href='#' class='"+j[15]+"' "+f+" />","<a href='#' class='"+j[16]+"' "+f+" />"],h=["x"===d.axis?g[2]:g[0],"x"===d.axis?g[3]:g[1],g[2],g[3]];d.scrollButtons.enable&&e.prepend(h[0]).append(h[1]).next(".mCSB_scrollTools").prepend(h[2]).append(h[3])},u=function(){var a=$(this),b=a.data(c),d=$("#mCSB_"+b.idx),e=$("#mCSB_"+b.idx+"_container"),f=[$("#mCSB_"+b.idx+"_dragger_vertical"),$("#mCSB_"+b.idx+"_dragger_horizontal")],g=[d.height()/e.outerHeight(!1),d.width()/e.outerWidth(!1)],i=[parseInt(f[0].css("min-height")),Math.round(g[0]*f[0].parent().height()),parseInt(f[1].css("min-width")),Math.round(g[1]*f[1].parent().width())],j=h&&i[1]<i[0]?i[0]:i[1],k=h&&i[3]<i[2]?i[2]:i[3];f[0].css({height:j,"max-height":f[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":i[0]+"px"}),f[1].css({width:k,"max-width":f[1].parent().width()-10})},v=function(){var a=$(this),b=a.data(c),d=$("#mCSB_"+b.idx),e=$("#mCSB_"+b.idx+"_container"),f=[$("#mCSB_"+b.idx+"_dragger_vertical"),$("#mCSB_"+b.idx+"_dragger_horizontal")],g=[e.outerHeight(!1)-d.height(),e.outerWidth(!1)-d.width()],h=[g[0]/(f[0].parent().height()-f[0].height()),g[1]/(f[1].parent().width()-f[1].width())];b.scrollRatio={y:h[0],x:h[1]}},w=function(a,b,c){var d=c?j[0]+"_expanded":"",e=a.closest(".mCSB_scrollTools");"active"===b?(a.toggleClass(j[0]+" "+d),e.toggleClass(j[1]),a[0]._draggable=a[0]._draggable?0:1):a[0]._draggable||("hide"===b?(a.removeClass(j[0]),e.removeClass(j[1])):(a.addClass(j[0]),e.addClass(j[1])))},x=function(){var a=$(this),b=a.data(c),d=$("#mCSB_"+b.idx),e=$("#mCSB_"+b.idx+"_container"),f=null==b.overflowed?e.height():e.outerHeight(!1),g=null==b.overflowed?e.width():e.outerWidth(!1),h=e[0].scrollHeight,i=e[0].scrollWidth;return h>f&&(f=h),i>g&&(g=i),[f>d.height(),g>d.width()]},y=function(){var a=$(this),b=a.data(c),d=b.opt,e=$("#mCSB_"+b.idx),f=$("#mCSB_"+b.idx+"_container"),g=[$("#mCSB_"+b.idx+"_dragger_vertical"),$("#mCSB_"+b.idx+"_dragger_horizontal")];if(V(a),("x"!==d.axis&&!b.overflowed[0]||"y"===d.axis&&b.overflowed[0])&&(g[0].add(f).css("top",0),W(a,"_resetY")),"y"!==d.axis&&!b.overflowed[1]||"x"===d.axis&&b.overflowed[1]){var h=dx=0;"rtl"===b.langDir&&(h=e.width()-f.outerWidth(!1),dx=Math.abs(h/b.scrollRatio.x)),f.css("left",h),g[1].css("left",dx),W(a,"_resetX")}},z=function(){function a(){f=setTimeout(function(){$.event.special.mousewheel?(clearTimeout(f),G.call(b[0])):a()},100)}var b=$(this),d=b.data(c),e=d.opt;if(!d.bindEvents){if(D.call(this),e.contentTouchScroll&&E.call(this),F.call(this),e.mouseWheel.enable){var f;a()}L.call(this),N.call(this),e.advanced.autoScrollOnFocus&&M.call(this),e.scrollButtons.enable&&O.call(this),e.keyboard.enable&&P.call(this),d.bindEvents=!0}},A=function(){var a=$(this),b=a.data(c),d=b.opt,e=c+"_"+b.idx,f=".mCSB_"+b.idx+"_scrollbar",g=$("#mCSB_"+b.idx+",#mCSB_"+b.idx+"_container,#mCSB_"+b.idx+"_container_wrapper,"+f+" ."+j[12]+",#mCSB_"+b.idx+"_dragger_vertical,#mCSB_"+b.idx+"_dragger_horizontal,"+f+">a"),h=$("#mCSB_"+b.idx+"_container");d.advanced.releaseDraggableSelectors&&g.add($(d.advanced.releaseDraggableSelectors)),d.advanced.extraDraggableSelectors&&g.add($(d.advanced.extraDraggableSelectors)),b.bindEvents&&($(document).add($(!I()||top.document)).unbind("."+e),g.each(function(){$(this).unbind("."+e)}),clearTimeout(a[0]._focusTimeout),_(a[0],"_focusTimeout"),clearTimeout(b.sequential.step),_(b.sequential,"step"),clearTimeout(h[0].onCompleteTimeout),_(h[0],"onCompleteTimeout"),b.bindEvents=!1)},B=function(a){var b=$(this),d=b.data(c),e=d.opt,f=$("#mCSB_"+d.idx+"_container_wrapper"),g=f.length?f:$("#mCSB_"+d.idx+"_container"),h=[$("#mCSB_"+d.idx+"_scrollbar_vertical"),$("#mCSB_"+d.idx+"_scrollbar_horizontal")],i=[h[0].find(".mCSB_dragger"),h[1].find(".mCSB_dragger")];"x"!==e.axis&&(d.overflowed[0]&&!a?(h[0].add(i[0]).add(h[0].children("a")).css("display","block"),g.removeClass(j[8]+" "+j[10])):(e.alwaysShowScrollbar?(2!==e.alwaysShowScrollbar&&i[0].css("display","none"),g.removeClass(j[10])):(h[0].css("display","none"),g.addClass(j[10])),g.addClass(j[8]))),"y"!==e.axis&&(d.overflowed[1]&&!a?(h[1].add(i[1]).add(h[1].children("a")).css("display","block"),g.removeClass(j[9]+" "+j[11])):(e.alwaysShowScrollbar?(2!==e.alwaysShowScrollbar&&i[1].css("display","none"),g.removeClass(j[11])):(h[1].css("display","none"),g.addClass(j[11])),g.addClass(j[9]))),d.overflowed[0]||d.overflowed[1]?b.removeClass(j[5]):b.addClass(j[5])},C=function(a){var b=a.type,c=a.target.ownerDocument!==document&&null!==frameElement?[$(frameElement).offset().top,$(frameElement).offset().left]:null,d=I()&&a.target.ownerDocument!==top.document&&null!==frameElement?[$(a.view.frameElement).offset().top,$(a.view.frameElement).offset().left]:[0,0];switch(b){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return c?[a.originalEvent.pageY-c[0]+d[0],a.originalEvent.pageX-c[1]+d[1],!1]:[a.originalEvent.pageY,a.originalEvent.pageX,!1];case"touchstart":case"touchmove":case"touchend":var e=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0],f=a.originalEvent.touches.length||a.originalEvent.changedTouches.length;return a.target.ownerDocument!==document?[e.screenY,e.screenX,f>1]:[e.pageY,e.pageX,f>1];default:return c?[a.pageY-c[0]+d[0],a.pageX-c[1]+d[1],!1]:[a.pageY,a.pageX,!1]}},D=function(){function a(a,c,d,e){if(m[0].idleTimer=j.scrollInertia<233?250:0,b.attr("id")===l[1])var h="x",i=(b[0].offsetLeft-c+e)*g.scrollRatio.x;else var h="y",i=(b[0].offsetTop-a+d)*g.scrollRatio.y;W(f,i.toString(),{dir:h,drag:!0})}var b,d,e,f=$(this),g=f.data(c),j=g.opt,k=c+"_"+g.idx,l=["mCSB_"+g.idx+"_dragger_vertical","mCSB_"+g.idx+"_dragger_horizontal"],m=$("#mCSB_"+g.idx+"_container"),n=$("#"+l[0]+",#"+l[1]),o=j.advanced.releaseDraggableSelectors?n.add($(j.advanced.releaseDraggableSelectors)):n,p=j.advanced.extraDraggableSelectors?$(!I()||top.document).add($(j.advanced.extraDraggableSelectors)):$(!I()||top.document);n.bind("contextmenu."+k,function(a){a.preventDefault()}).bind("mousedown."+k+" touchstart."+k+" pointerdown."+k+" MSPointerDown."+k,function(a){if(a.stopImmediatePropagation(),a.preventDefault(),aa(a)){i=!0,h&&(document.onselectstart=function(){return!1}),J.call(m,!1),V(f),b=$(this);var c=b.offset(),g=C(a)[0]-c.top,k=C(a)[1]-c.left,l=b.height()+c.top,n=b.width()+c.left;g<l&&g>0&&k<n&&k>0&&(d=g,e=k),w(b,"active",j.autoExpandScrollbar)}}).bind("touchmove."+k,function(c){c.stopImmediatePropagation(),c.preventDefault();var f=b.offset(),g=C(c)[0]-f.top,h=C(c)[1]-f.left;a(d,e,g,h)}),$(document).add(p).bind("mousemove."+k+" pointermove."+k+" MSPointerMove."+k,function(c){if(b){var f=b.offset(),g=C(c)[0]-f.top,h=C(c)[1]-f.left;if(d===g&&e===h)return;a(d,e,g,h)}}).add(o).bind("mouseup."+k+" touchend."+k+" pointerup."+k+" MSPointerUp."+k,function(a){b&&(w(b,"active",j.autoExpandScrollbar),b=null),i=!1,h&&(document.onselectstart=null),J.call(m,!0)})},E=function(){function b(b){if(!ba(b)||i||C(b)[2])return void(a=0);a=1,v=0,w=0,j=1,x.removeClass("mCS_touch_action");var c=D.offset();k=C(b)[0]-c.top,l=C(b)[1]-c.left,K=[C(b)[0],C(b)[1]]}function d(a){if(ba(a)&&!i&&!C(a)[2]&&(z.documentTouchScroll||a.preventDefault(),a.stopImmediatePropagation(),(!w||v)&&j)){p=Y();var b=B.offset(),c=C(a)[0]-b.top,d=C(a)[1]-b.left,e="mcsLinearOut";if(F.push(c),G.push(d),K[2]=Math.abs(C(a)[0]-K[0]),K[3]=Math.abs(C(a)[1]-K[1]),y.overflowed[0])var f=E[0].parent().height()-E[0].height(),g=k-c>0&&c-k>-f*y.scrollRatio.y&&(2*K[3]<K[2]||"yx"===z.axis);if(y.overflowed[1])var m=E[1].parent().width()-E[1].width(),n=l-d>0&&d-l>-m*y.scrollRatio.x&&(2*K[2]<K[3]||"yx"===z.axis);g||n?(N||a.preventDefault(),v=1):(w=1,x.addClass("mCS_touch_action")),N&&a.preventDefault(),t="yx"===z.axis?[k-c,l-d]:"x"===z.axis?[null,l-d]:[k-c,null],D[0].idleTimer=250,y.overflowed[0]&&h(t[0],H,e,"y","all",!0),y.overflowed[1]&&h(t[1],H,e,"x",J,!0)}}function e(b){if(!ba(b)||i||C(b)[2])return void(a=0);a=1,b.stopImmediatePropagation(),V(x),o=Y();var c=B.offset();m=C(b)[0]-c.top,n=C(b)[1]-c.left,F=[],G=[]}function f(a){if(ba(a)&&!i&&!C(a)[2]){j=0,a.stopImmediatePropagation(),v=0,w=0,q=Y();var b=B.offset(),c=C(a)[0]-b.top,d=C(a)[1]-b.left;if(!(q-p>30)){s=1e3/(q-o);var e="mcsEaseOut",f=s<2.5,k=f?[F[F.length-2],G[G.length-2]]:[0,0];r=f?[c-k[0],d-k[1]]:[c-m,d-n];var l=[Math.abs(r[0]),Math.abs(r[1])];s=f?[Math.abs(r[0]/4),Math.abs(r[1]/4)]:[s,s];var x=[Math.abs(D[0].offsetTop)-r[0]*g(l[0]/s[0],s[0]),Math.abs(D[0].offsetLeft)-r[1]*g(l[1]/s[1],s[1])];t="yx"===z.axis?[x[0],x[1]]:"x"===z.axis?[null,x[1]]:[x[0],null],u=[4*l[0]+z.scrollInertia,4*l[1]+z.scrollInertia];var A=parseInt(z.contentTouchScroll)||0;t[0]=l[0]>A?t[0]:0,t[1]=l[1]>A?t[1]:0,y.overflowed[0]&&h(t[0],u[0],e,"y",J,!1),y.overflowed[1]&&h(t[1],u[1],e,"x",J,!1)}}}function g(a,b){var c=[1.5*b,2*b,b/1.5,b/2];return a>90?b>4?c[0]:c[3]:a>60?b>3?c[3]:c[2]:a>30?b>8?c[1]:b>6?c[0]:b>4?b:c[2]:b>8?b:c[3]}function h(a,b,c,d,e,f){a&&W(x,a.toString(),{dur:b,scrollEasing:c,dir:d,overwrite:e,drag:f})}var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=$(this),y=x.data(c),z=y.opt,A=c+"_"+y.idx,B=$("#mCSB_"+y.idx),D=$("#mCSB_"+y.idx+"_container"),E=[$("#mCSB_"+y.idx+"_dragger_vertical"),$("#mCSB_"+y.idx+"_dragger_horizontal")],F=[],G=[],H=0,J="yx"===z.axis?"none":"all",K=[],L=D.find("iframe"),M=["touchstart."+A+" pointerdown."+A+" MSPointerDown."+A,"touchmove."+A+" pointermove."+A+" MSPointerMove."+A,"touchend."+A+" pointerup."+A+" MSPointerUp."+A],N=void 0!==document.body.style.touchAction&&""!==document.body.style.touchAction;D.bind(M[0],function(a){b(a)}).bind(M[1],function(a){d(a)}),B.bind(M[0],function(a){e(a)}).bind(M[2],function(a){f(a)}),L.length&&L.each(function(){$(this).bind("load",function(){I(this)&&$(this.contentDocument||this.contentWindow.document).bind(M[0],function(a){b(a),e(a)}).bind(M[1],function(a){d(a)}).bind(M[2],function(a){f(a)})})})},F=function(){},G=function(){function a(a,c){if(V(b),!K(b,a.target)){var f="auto"!==e.mouseWheel.deltaFactor?parseInt(e.mouseWheel.deltaFactor):h&&a.deltaFactor<100?100:a.deltaFactor||100,j=e.scrollInertia;if("x"===e.axis||"x"===e.mouseWheel.axis)var k="x",l=[Math.round(f*d.scrollRatio.x),parseInt(e.mouseWheel.scrollAmount)],m="auto"!==e.mouseWheel.scrollAmount?l[1]:l[0]>=g.width()?.9*g.width():l[0],n=Math.abs($("#mCSB_"+d.idx+"_container")[0].offsetLeft),o=i[1][0].offsetLeft,p=i[1].parent().width()-i[1].width(),q="y"===e.mouseWheel.axis?a.deltaY||c:a.deltaX;else var k="y",l=[Math.round(f*d.scrollRatio.y),parseInt(e.mouseWheel.scrollAmount)],m="auto"!==e.mouseWheel.scrollAmount?l[1]:l[0]>=g.height()?.9*g.height():l[0],n=Math.abs($("#mCSB_"+d.idx+"_container")[0].offsetTop),o=i[0][0].offsetTop,p=i[0].parent().height()-i[0].height(),q=a.deltaY||c;"y"===k&&!d.overflowed[0]||"x"===k&&!d.overflowed[1]||((e.mouseWheel.invert||a.webkitDirectionInvertedFromDevice)&&(q=-q),e.mouseWheel.normalizeDelta&&(q=q<0?-1:1),(q>0&&0!==o||q<0&&o!==p||e.mouseWheel.preventDefault)&&(a.stopImmediatePropagation(),a.preventDefault()),a.deltaFactor<5&&!e.mouseWheel.normalizeDelta&&(m=a.deltaFactor,j=17),W(b,(n-q*m).toString(),{dir:k,dur:j}))}}if($(this).data(c)){var b=$(this),d=b.data(c),e=d.opt,f=c+"_"+d.idx,g=$("#mCSB_"+d.idx),i=[$("#mCSB_"+d.idx+"_dragger_vertical"),$("#mCSB_"+d.idx+"_dragger_horizontal")],j=$("#mCSB_"+d.idx+"_container").find("iframe");j.length&&j.each(function(){$(this).bind("load",function(){I(this)&&$(this.contentDocument||this.contentWindow.document).bind("mousewheel."+f,function(b,c){a(b,c)})})}),g.bind("mousewheel."+f,function(b,c){a(b,c)})}},H=new Object,I=function(a){var b=!1,c=!1,d=null;if(void 0===a?c="#empty":void 0!==$(a).attr("id")&&(c=$(a).attr("id")),!1!==c&&void 0!==H[c])return H[c];if(a){try{var e=a.contentDocument||a.contentWindow.document;d=e.body.innerHTML}catch(a){}b=null!==d}else{try{var e=top.document;d=e.body.innerHTML}catch(a){}b=null!==d}return!1!==c&&(H[c]=b),b},J=function(a){var b=this.find("iframe");if(b.length){var c=a?"auto":"none";b.css("pointer-events",c)}},K=function(a,b){var d=b.nodeName.toLowerCase(),e=a.data(c).opt.mouseWheel.disableOver,f=["select","textarea"];return $.inArray(d,e)>-1&&!($.inArray(d,f)>-1&&!$(b).is(":focus"))},L=function(){var a,b=$(this),d=b.data(c),e=c+"_"+d.idx,f=$("#mCSB_"+d.idx+"_container"),g=f.parent(),h=$(".mCSB_"+d.idx+"_scrollbar ."+j[12]);h.bind("mousedown."+e+" touchstart."+e+" pointerdown."+e+" MSPointerDown."+e,function(b){i=!0,$(b.target).hasClass("mCSB_dragger")||(a=1)}).bind("touchend."+e+" pointerup."+e+" MSPointerUp."+e,function(a){i=!1}).bind("click."+e,function(c){if(a&&(a=0,$(c.target).hasClass(j[12])||$(c.target).hasClass("mCSB_draggerRail"))){V(b);var e=$(this),h=e.find(".mCSB_dragger");if(e.parent(".mCSB_scrollTools_horizontal").length>0){if(!d.overflowed[1])return;var i="x",k=c.pageX>h.offset().left?-1:1,l=Math.abs(f[0].offsetLeft)-k*(.9*g.width())}else{if(!d.overflowed[0])return;var i="y",k=c.pageY>h.offset().top?-1:1,l=Math.abs(f[0].offsetTop)-k*(.9*g.height())}W(b,l.toString(),{dir:i,scrollEasing:"mcsEaseInOut"})}})},M=function(){},N=function(){var a=$(this),b=a.data(c),d=c+"_"+b.idx,e=$("#mCSB_"+b.idx+"_container").parent();e.bind("scroll."+d,function(a){0===e.scrollTop()&&0===e.scrollLeft()||$(".mCSB_"+b.idx+"_scrollbar").css("visibility","hidden")})},O=function(){var a=$(this),b=a.data(c),d=b.opt,e=b.sequential,f=c+"_"+b.idx,g=".mCSB_"+b.idx+"_scrollbar";$(g+">a").bind("contextmenu."+f,function(a){a.preventDefault()}).bind("mousedown."+f+" touchstart."+f+" pointerdown."+f+" MSPointerDown."+f+" mouseup."+f+" touchend."+f+" pointerup."+f+" MSPointerUp."+f+" mouseout."+f+" pointerout."+f+" MSPointerOut."+f+" click."+f,function(c){function f(b,c){e.scrollAmount=d.scrollButtons.scrollAmount,Q(a,b,c)}if(c.preventDefault(),aa(c)){var g=$(this).attr("class");switch(e.type=d.scrollButtons.scrollType,c.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===e.type)return;i=!0,b.tweenRunning=!1,f("on",g);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===e.type)return;i=!1,e.dir&&f("off",g);break;case"click":if("stepped"!==e.type||b.tweenRunning)return;f("on",g)}}})},P=function(){function a(a){function c(a,c){f.type=e.keyboard.scrollType,f.scrollAmount=e.keyboard.scrollAmount,"stepped"===f.type&&d.tweenRunning||Q(b,a,c)}switch(a.type){case"blur":d.tweenRunning&&f.dir&&c("off",null);break;case"keydown":case"keyup":var g=a.keyCode?a.keyCode:a.which,h="on";if("x"!==e.axis&&(38===g||40===g)||"y"!==e.axis&&(37===g||39===g)){if((38===g||40===g)&&!d.overflowed[0]||(37===g||39===g)&&!d.overflowed[1])return;"keyup"===a.type&&(h="off"),$(document.activeElement).is(k)||(a.preventDefault(),a.stopImmediatePropagation(),c(h,g))}else if(33===g||34===g){if((d.overflowed[0]||d.overflowed[1])&&(a.preventDefault(),a.stopImmediatePropagation()),"keyup"===a.type){V(b);var l=34===g?-1:1;if("x"===e.axis||"yx"===e.axis&&d.overflowed[1]&&!d.overflowed[0])var m="x",n=Math.abs(i[0].offsetLeft)-l*(.9*j.width());else var m="y",n=Math.abs(i[0].offsetTop)-l*(.9*j.height());W(b,n.toString(),{dir:m,scrollEasing:"mcsEaseInOut"})}}else if((35===g||36===g)&&!$(document.activeElement).is(k)&&((d.overflowed[0]||d.overflowed[1])&&(a.preventDefault(),a.stopImmediatePropagation()),"keyup"===a.type)){if("x"===e.axis||"yx"===e.axis&&d.overflowed[1]&&!d.overflowed[0])var m="x",n=35===g?Math.abs(j.width()-i.outerWidth(!1)):0;else var m="y",n=35===g?Math.abs(j.height()-i.outerHeight(!1)):0;W(b,n.toString(),{dir:m,scrollEasing:"mcsEaseInOut"})}}}var b=$(this),d=b.data(c),e=d.opt,f=d.sequential,g=c+"_"+d.idx,h=$("#mCSB_"+d.idx),i=$("#mCSB_"+d.idx+"_container"),j=i.parent(),k="input,textarea,select,datalist,keygen,[contenteditable='true']",l=i.find("iframe"),m=["blur."+g+" keydown."+g+" keyup."+g];l.length&&l.each(function(){$(this).bind("load",function(){I(this)&&$(this.contentDocument||this.contentWindow.document).bind(m[0],function(b){a(b)})})}),h.attr("tabindex","0").bind(m[0],function(b){a(b)})},Q=function(a,b,d,e,f){function g(b){k.snapAmount&&(l.scrollAmount=k.snapAmount instanceof Array?"x"===l.dir[0]?k.snapAmount[1]:k.snapAmount[0]:k.snapAmount);var c="stepped"!==l.type,d=f||(b?c?o/1.5:p:1e3/60),h=b?c?7.5:40:2.5,j=[Math.abs(m[0].offsetTop),Math.abs(m[0].offsetLeft)],n=[i.scrollRatio.y>10?10:i.scrollRatio.y,i.scrollRatio.x>10?10:i.scrollRatio.x],q="x"===l.dir[0]?j[1]+l.dir[1]*(n[1]*h):j[0]+l.dir[1]*(n[0]*h),r="x"===l.dir[0]?j[1]+l.dir[1]*parseInt(l.scrollAmount):j[0]+l.dir[1]*parseInt(l.scrollAmount),s="auto"!==l.scrollAmount?r:q,t=e||(b?c?"mcsLinearOut":"mcsEaseInOut":"mcsLinear"),u=!!b;if(b&&d<17&&(s="x"===l.dir[0]?j[1]:j[0]),W(a,s.toString(),{dir:l.dir[0],scrollEasing:t,dur:d,onComplete:u}),b)return void(l.dir=!1);clearTimeout(l.step),l.step=setTimeout(function(){g()},d)}function h(){clearTimeout(l.step),_(l,"step"),V(a)}var i=a.data(c),k=i.opt,l=i.sequential,m=$("#mCSB_"+i.idx+"_container"),n="stepped"===l.type,o=k.scrollInertia<26?26:k.scrollInertia,p=k.scrollInertia<1?17:k.scrollInertia;switch(b){case"on":if(l.dir=[d===j[16]||d===j[15]||39===d||37===d?"x":"y",d===j[13]||d===j[15]||38===d||37===d?-1:1],V(a),ca(d)&&"stepped"===l.type)return;g(n);break;case"off":h(),(n||i.tweenRunning&&l.dir)&&g(!0)}},R=function(a){var b=$(this).data(c).opt,d=[];return"function"==typeof a&&(a=a()),a instanceof Array?d=a.length>1?[a[0],a[1]]:"x"===b.axis?[null,a[0]]:[a[0],null]:(d[0]=a.y?a.y:a.x||"x"===b.axis?null:a,d[1]=a.x?a.x:a.y||"y"===b.axis?null:a),"function"==typeof d[0]&&(d[0]=d[0]()),"function"==typeof d[1]&&(d[1]=d[1]()),d},S=function(a,b){if(null!=a&&void 0!==a){var d=$(this),e=d.data(c),f=e.opt,g=$("#mCSB_"+e.idx+"_container"),h=g.parent(),i=typeof a;b||(b="x"===f.axis?"x":"y");var j="x"===b?g.outerWidth(!1)-h.width():g.outerHeight(!1)-h.height(),l="x"===b?g[0].offsetLeft:g[0].offsetTop,m="x"===b?"left":"top";switch(i){case"function":return a();case"object":var n=a.jquery?a:$(a);if(!n.length)return;return"x"===b?da(n)[1]:da(n)[0];case"string":case"number":if(ca(a))return Math.abs(a);if(-1!==a.indexOf("%"))return Math.abs(j*parseInt(a)/100);if(-1!==a.indexOf("-="))return Math.abs(l-parseInt(a.split("-=")[1]));if(-1!==a.indexOf("+=")){var o=l+parseInt(a.split("+=")[1]);return o>=0?0:Math.abs(o)}if(-1!==a.indexOf("px")&&ca(a.split("px")[0]))return Math.abs(a.split("px")[0]);if("top"===a||"left"===a)return 0;if("bottom"===a)return Math.abs(h.height()-g.outerHeight(!1));if("right"===a)return Math.abs(h.width()-g.outerWidth(!1));if("first"===a||"last"===a){var n=g.find(":"+a);return"x"===b?da(n)[1]:da(n)[0]}return $(a).length?"x"===b?da($(a))[1]:da($(a))[0]:(g.css(m,a),void k.update.call(null,d[0]))}}},T=function(a){function b(){if(clearTimeout(l[0].autoUpdate),0===g.parents("html").length)return void(g=null);l[0].autoUpdate=setTimeout(function(){return i.advanced.updateOnSelectorChange&&(h.poll.change.n=e(),h.poll.change.n!==h.poll.change.o)?(h.poll.change.o=h.poll.change.n,void f(3)):i.advanced.updateOnContentResize&&(h.poll.size.n=g[0].scrollHeight+g[0].scrollWidth+l[0].offsetHeight+g[0].offsetHeight+g[0].offsetWidth,h.poll.size.n!==h.poll.size.o)?(h.poll.size.o=h.poll.size.n,void f(1)):!i.advanced.updateOnImageLoad||"auto"===i.advanced.updateOnImageLoad&&"y"===i.axis||(h.poll.img.n=l.find("img").length,h.poll.img.n===h.poll.img.o)?void((i.advanced.updateOnSelectorChange||i.advanced.updateOnContentResize||i.advanced.updateOnImageLoad)&&b()):(h.poll.img.o=h.poll.img.n,void l.find("img").each(function(){d(this)}))},i.advanced.autoUpdateTimeout)}function d(a){function b(a,b){return function(){return b.apply(a,arguments)}}function c(){this.onload=null,$(a).addClass(j[2]),f(2)}if($(a).hasClass(j[2]))return void f();var d=new Image;d.onload=b(d,c),d.src=a.src}function e(){!0===i.advanced.updateOnSelectorChange&&(i.advanced.updateOnSelectorChange="*");var a=0,b=l.find(i.advanced.updateOnSelectorChange);return i.advanced.updateOnSelectorChange&&b.length>0&&b.each(function(){a+=this.offsetHeight+this.offsetWidth}),a}function f(a){clearTimeout(l[0].autoUpdate),k.update.call(null,g[0],a)}var g=$(this),h=g.data(c),i=h.opt,l=$("#mCSB_"+h.idx+"_container");if(a)return clearTimeout(l[0].autoUpdate),void _(l[0],"autoUpdate");b()},U=function(a,b,c){return Math.round(a/b)*b-c},V=function(a){var b=a.data(c);$("#mCSB_"+b.idx+"_container,#mCSB_"+b.idx+"_container_wrapper,#mCSB_"+b.idx+"_dragger_vertical,#mCSB_"+b.idx+"_dragger_horizontal").each(function(){Z.call(this)})},W=function(a,b,d){function e(a){return h&&i.callbacks[a]&&"function"==typeof i.callbacks[a]}function f(){return[i.callbacks.alwaysTriggerOffsets||t>=u[0]+x,i.callbacks.alwaysTriggerOffsets||t<=-y]}function g(){var b=[m[0].offsetTop,m[0].offsetLeft],c=[r[0].offsetTop,r[0].offsetLeft],e=[m.outerHeight(!1),m.outerWidth(!1)],f=[l.height(),l.width()];a[0].mcs={content:m,top:b[0],left:b[1],draggerTop:c[0],draggerLeft:c[1],topPct:Math.round(100*Math.abs(b[0])/(Math.abs(e[0])-f[0])),leftPct:Math.round(100*Math.abs(b[1])/(Math.abs(e[1])-f[1])),direction:d.dir}}var h=a.data(c),i=h.opt,j={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:i.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},d=$.extend(j,d),k=[d.dur,d.drag?0:d.dur],l=$("#mCSB_"+h.idx),m=$("#mCSB_"+h.idx+"_container"),n=m.parent(),o=i.callbacks.onTotalScrollOffset?R.call(a,i.callbacks.onTotalScrollOffset):[0,0],p=i.callbacks.onTotalScrollBackOffset?R.call(a,i.callbacks.onTotalScrollBackOffset):[0,0];if(h.trigger=d.trigger,0===n.scrollTop()&&0===n.scrollLeft()||($(".mCSB_"+h.idx+"_scrollbar").css("visibility","visible"),n.scrollTop(0).scrollLeft(0)),"_resetY"!==b||h.contentReset.y||(e("onOverflowYNone")&&i.callbacks.onOverflowYNone.call(a[0]),h.contentReset.y=1),"_resetX"!==b||h.contentReset.x||(e("onOverflowXNone")&&i.callbacks.onOverflowXNone.call(a[0]),h.contentReset.x=1),"_resetY"!==b&&"_resetX"!==b){if(!h.contentReset.y&&a[0].mcs||!h.overflowed[0]||(e("onOverflowY")&&i.callbacks.onOverflowY.call(a[0]),h.contentReset.x=null),!h.contentReset.x&&a[0].mcs||!h.overflowed[1]||(e("onOverflowX")&&i.callbacks.onOverflowX.call(a[0]),h.contentReset.x=null),i.snapAmount){var q=i.snapAmount instanceof Array?"x"===d.dir?i.snapAmount[1]:i.snapAmount[0]:i.snapAmount;b=U(b,q,i.snapOffset)}switch(d.dir){case"x":var r=$("#mCSB_"+h.idx+"_dragger_horizontal"),s="left",t=m[0].offsetLeft,u=[l.width()-m.outerWidth(!1),r.parent().width()-r.width()],v=[b,0===b?0:b/h.scrollRatio.x],x=o[1],y=p[1],z=x>0?x/h.scrollRatio.x:0,A=y>0?y/h.scrollRatio.x:0;break;case"y":var r=$("#mCSB_"+h.idx+"_dragger_vertical"),s="top",t=m[0].offsetTop,u=[l.height()-m.outerHeight(!1),r.parent().height()-r.height()],v=[b,0===b?0:b/h.scrollRatio.y],x=o[0],y=p[0],z=x>0?x/h.scrollRatio.y:0,A=y>0?y/h.scrollRatio.y:0}v[1]<0||0===v[0]&&0===v[1]?v=[0,0]:v[1]>=u[1]?v=[u[0],u[1]]:v[0]=-v[0],a[0].mcs||(g(),e("onInit")&&i.callbacks.onInit.call(a[0])),clearTimeout(m[0].onCompleteTimeout),X(r[0],s,Math.round(v[1]),k[1],d.scrollEasing),!h.tweenRunning&&(0===t&&v[0]>=0||t===u[0]&&v[0]<=u[0])||X(m[0],s,Math.round(v[0]),k[0],d.scrollEasing,d.overwrite,{onStart:function(){d.callbacks&&d.onStart&&!h.tweenRunning&&(e("onScrollStart")&&(g(),i.callbacks.onScrollStart.call(a[0])),h.tweenRunning=!0,w(r),h.cbOffsets=f())},onUpdate:function(){d.callbacks&&d.onUpdate&&e("whileScrolling")&&(g(),i.callbacks.whileScrolling.call(a[0]))},onComplete:function(){if(d.callbacks&&d.onComplete){"yx"===i.axis&&clearTimeout(m[0].onCompleteTimeout);var b=m[0].idleTimer||0;m[0].onCompleteTimeout=setTimeout(function(){e("onScroll")&&(g(),i.callbacks.onScroll.call(a[0])),e("onTotalScroll")&&v[1]>=u[1]-z&&h.cbOffsets[0]&&(g(),i.callbacks.onTotalScroll.call(a[0])),e("onTotalScrollBack")&&v[1]<=A&&h.cbOffsets[1]&&(g(),i.callbacks.onTotalScrollBack.call(a[0])),h.tweenRunning=!1,m[0].idleTimer=0,w(r,"hide")},b)}}})}},X=function(a,b,c,d,e,f,g){function h(){v.stop||(s||o.call(),s=Y()-r,i(),s>=v.time&&(v.time=s>v.time?s+m-(s-v.time):s+m-1,v.time<s+1&&(v.time=s+1)),v.time<d?v.id=n(h):q.call())}function i(){d>0?(v.currVal=l(v.time,t,w,d,e),u[b]=Math.round(v.currVal)+"px"):u[b]=c+"px",p.call()}function j(){m=1e3/60,v.time=s+m,n=window.requestAnimationFrame?window.requestAnimationFrame:function(a){return i(),setTimeout(a,.01)},v.id=n(h)}function k(){null!=v.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(v.id):clearTimeout(v.id),v.id=null)}function l(a,b,c,d,e){switch(e){case"linear":case"mcsLinear":return c*a/d+b;case"mcsLinearOut":return a/=d,a--,c*Math.sqrt(1-a*a)+b;case"easeInOutSmooth":return(a/=d/2)<1?c/2*a*a+b:(a--,-c/2*(a*(a-2)-1)+b);case"easeInOutStrong":return(a/=d/2)<1?c/2*Math.pow(2,10*(a-1))+b:(a--,c/2*(2-Math.pow(2,-10*a))+b);case"easeInOut":case"mcsEaseInOut":return(a/=d/2)<1?c/2*a*a*a+b:(a-=2,c/2*(a*a*a+2)+b);case"easeOutSmooth":return a/=d,a--,-c*(a*a*a*a-1)+b;case"easeOutStrong":return c*(1-Math.pow(2,-10*a/d))+b;case"easeOut":case"mcsEaseOut":default:var f=(a/=d)*a,g=f*a;return b+c*(.499999999999997*g*f+-2.5*f*f+5.5*g+-6.5*f+4*a)}}a._mTween||(a._mTween={top:{},left:{}});var m,n,g=g||{},o=g.onStart||function(){},p=g.onUpdate||function(){},q=g.onComplete||function(){},r=Y(),s=0,t=a.offsetTop,u=a.style,v=a._mTween[b];"left"===b&&(t=a.offsetLeft);var w=c-t;v.stop=0,"none"!==f&&k(),j()},Y=function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},Z=function(){var a=this;a._mTween||(a._mTween={top:{},left:{}});for(var b=["top","left"],c=0;c<b.length;c++){var d=b[c];a._mTween[d].id&&(window.requestAnimationFrame?window.cancelAnimationFrame(a._mTween[d].id):clearTimeout(a._mTween[d].id),a._mTween[d].id=null,a._mTween[d].stop=1)}},_=function(a,b){try{delete a[b]}catch(c){a[b]=null}},aa=function(a){return!(a.which&&1!==a.which)},ba=function(a){var b=a.originalEvent.pointerType;return!(b&&"touch"!==b&&2!==b)},ca=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},da=function(a){var b=a.parents(".mCSB_container");return[a.offset().top-b.offset().top,a.offset().left-b.offset().left]},ea=function(){function a(){var a=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var b=0;b<a.length;b++)if(a[b]+"Hidden"in document)return a[b]+"Hidden";return null}var b=a();return!!b&&document[b]};$.fn[b]=function(a){return k[a]?k[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?void $.error("Method "+a+" does not exist"):k.init.apply(this,arguments)},$[b]=function(a){return k[a]?k[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?void $.error("Method "+a+" does not exist"):k.init.apply(this,arguments)},$[b].defaults=e,window[b]=!0,$(window).bind("load",function(){$(d)[b](),$.extend($.expr[":"],{mcsInView:$.expr[":"].mcsInView||function(a){var b,c,d=$(a),e=d.parents(".mCSB_container");if(e.length)return b=e.parent(),c=[e[0].offsetTop,e[0].offsetLeft],c[0]+da(d)[0]>=0&&c[0]+da(d)[0]<b.height()-d.outerHeight(!1)&&c[1]+da(d)[1]>=0&&c[1]+da(d)[1]<b.width()-d.outerWidth(!1)},mcsInSight:$.expr[":"].mcsInSight||function(a,b,c){var d,e,f,g,h=$(a),i=h.parents(".mCSB_container"),j="exact"===c[3]?[[1,0],[1,0]]:[[.9,.1],[.6,.4]];if(i.length)return d=[h.outerHeight(!1),h.outerWidth(!1)],f=[i[0].offsetTop+da(h)[0],i[0].offsetLeft+da(h)[1]],e=[i.parent()[0].offsetHeight,i.parent()[0].offsetWidth],g=[d[0]<e[0]?j[0]:j[1],d[1]<e[1]?j[0]:j[1]],f[0]-e[0]*g[0][0]<0&&f[0]+d[0]-e[0]*g[0][1]>=0&&f[1]-e[1]*g[1][0]<0&&f[1]+d[1]-e[1]*g[1][1]>=0},mcsOverflow:$.expr[":"].mcsOverflow||function(a){var b=$(a).data(c);if(b)return b.overflowed[0]||b.overflowed[1]}})})})}),function(a,b,c){"use strict";!function(a){"function"==typeof define&&define.amd?define("toast/libs/popover",a):"object"==typeof exports?module.exports=a():a()}(function(){function a(a,b){return this.$element=$(a),b&&("string"!==$.type(b.delay)&&"number"!==$.type(b.delay)||(b.delay={show:b.delay,hide:b.delay})),this.options=$.extend({},h,b),this._defaults=h,this._name=e,this._targetclick=!1,this.init(),j.push(this.$element),this}var d,e="popover",f="popover",g="toast.popover",h={placement:"auto",container:null,width:"auto",height:"auto",trigger:"click",style:"",selector:!1,delay:{show:null,hide:300},async:{type:"GET",before:null,success:null,error:null},cache:!1,multi:!1,arrow:!0,title:"",content:"",closeable:!1,padding:!0,url:"",type:"html",direction:"",animation:null,template:'<div class="popover"><div class="popover-arrow"></div><div class="popover-inner"><a href="#" class="close"></a><h3 class="popover-title"></h3><div class="popover-content"><i class="icon-refresh"></i> <p>&nbsp;</p></div></div></div>',backdrop:!1,dismissible:!0,onShow:null,onHide:null,abortXHR:!0,autoHide:!1,offsetTop:0,offsetLeft:0,iframeOptions:{frameborder:"0",allowtransparency:"true",id:"",name:"",scrolling:"",onload:"",height:"",width:""},hideEmpty:!1,className:null},i=f+"-rtl",j=[],k=$('<div class="popover-backdrop"></div>'),l=0,m=!1,n=-2e3,o=$(b),p=function(a,b){return isNaN(a)?b||0:Number(a)},q=function(a){return a.data("plugin_"+e)},r=function(){for(var a=null,b=0;b<j.length;b++)(a=q(j[b]))&&a.hide(!0);o.trigger("hiddenAll."+g),t?o.off("touchstart.popover"):(o.off("keyup.popover"),o.off("click.popover")),o.off("touchend.popover"),d&&d(),m=!1},s=function(a){for(var b=null,c=0;c<j.length;c++)(b=q(j[c]))&&b.id!==a.id&&b.hide(!0);o.trigger("hiddenAll."+g)},t="ontouchstart"in b.documentElement&&/Mobi/.test(navigator.userAgent),u=function(a){var b={x:0,y:0};if("touchstart"===a.type||"touchmove"===a.type||"touchend"===a.type||"touchcancel"===a.type){var c=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0];b.x=c.pageX,b.y=c.pageY}else"mousedown"!==a.type&&"mouseup"!==a.type&&"click"!==a.type||(b.x=a.pageX,b.y=a.pageY);return b};a.prototype={init:function(){if(this.$element[0]instanceof b.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");"manual"!==this.getTrigger()&&(t?this.$element.off("touchend",this.options.selector).on("touchend",this.options.selector,$.proxy(this.toggle,this)):"click"===this.getTrigger()?this.$element.off("click",this.options.selector).on("click",this.options.selector,$.proxy(this.toggle,this)):"hover"===this.getTrigger()&&this.$element.off("mouseenter mouseleave click",this.options.selector).on("mouseenter",this.options.selector,$.proxy(this.mouseenterHandler,this)).on("mouseleave",this.options.selector,$.proxy(this.mouseleaveHandler,this))),this._poped=!1,this._inited=!0,this._opened=!1,this._idSeed=l,this.id=e+this._idSeed,this.options.container=$(this.options.container||b.body).first(),this.options.backdrop&&k.appendTo(this.options.container).hide(),l++,"sticky"===this.getTrigger()&&this.show(),this.options.selector&&(this._options=$.extend({},this.options,{selector:""}))},destroy:function(){for(var a=-1,b=0;b<j.length;b++)if(j[b]===this.$element){a=b;break}j.splice(a,1),this.hide(),this.$element.data("plugin_"+e,null),"click"===this.getTrigger()?this.$element.off("click"):"hover"===this.getTrigger()&&this.$element.off("mouseenter mouseleave"),this.$target&&this.$target.remove()},getDelegateOptions:function(){var a={};return this._options&&$.each(this._options,function(b,c){h[b]!==c&&(a[b]=c)}),a},hide:function(a,b){if((a||"sticky"!==this.getTrigger())&&this._opened){b&&(b.preventDefault(),b.stopPropagation()),this.xhr&&!0===this.options.abortXHR&&(this.xhr.abort(),this.xhr=null);var c=$.Event("hide."+g);if(this.$element.trigger(c,[this.$target]),this.$target){this.$target.removeClass("in").addClass(this.getHideAnimation());var d=this;setTimeout(function(){d.$target.hide(),d.getCache()||d.$target.remove()},d.getHideDelay())}this.options.backdrop&&k.hide(),this._opened=!1,this.$element.trigger("hidden."+g,[this.$target]),this.options.onHide&&this.options.onHide(this.$target)}},resetAutoHide:function(){var a=this,b=a.getAutoHide();b&&(a.autoHideHandler&&clearTimeout(a.autoHideHandler),a.autoHideHandler=setTimeout(function(){a.hide()},b))},delegate:function(b){var c=$(b).data("plugin_"+e);return c||(c=new a(b,this.getDelegateOptions()),$(b).data("plugin_"+e,c)),c},toggle:function(a){var b=this;a&&(a.preventDefault(),a.stopPropagation(),this.options.selector&&(b=this.delegate(a.currentTarget))),b[b.getTarget().hasClass("in")?"hide":"show"]()},hideAll:function(){r()},hideOthers:function(){s(this)},show:function(){if(!this._opened){var a=this.getTarget().removeClass().addClass(f).addClass(this._customTargetClass);if(this.options.className&&a.addClass(this.options.className),this.options.multi||this.hideOthers(),!this.getCache()||!this._poped||""===this.content){if(this.content="",this.setTitle(this.getTitle()),this.options.closeable||a.find(".close").off("click").remove(),this.isAsync()?this.setContentASync(this.options.content):this.setContent(this.getContent()),this.canEmptyHide()&&""===this.content)return;a.show()}this.displayContent(),this.options.onShow&&this.options.onShow(a),this.bindBodyEvents(),this.options.backdrop&&k.show(),this._opened=!0,this.resetAutoHide()}},displayContent:function(){var a=this.getElementPosition(),b=this.getTarget().removeClass().addClass(f).addClass(this._customTargetClass),c=this.getContentElement(),d=b[0].offsetWidth,e=b[0].offsetHeight,h="bottom",j=$.Event("show."+g);if(this.options.className&&b.addClass(this.options.className),this.canEmptyHide()){var k=c.children().html();if(null!==k&&0===k.trim().length)return}this.$element.trigger(j,[b]);var l=this.$element.data("width")||this.options.width;""===l&&(l=this._defaults.width),"auto"!==l&&b.width(l);var m=this.$element.data("height")||this.options.height;""===m&&(m=this._defaults.height),"auto"!==m&&c.height(m),this.options.style&&this.$target.addClass(f+"-"+this.options.style),"rtl"!==this.options.direction||c.hasClass(i)||c.addClass(i),this.options.arrow||b.find(".popover-arrow").remove(),b.detach().css({top:n,left:n,display:"block"}),this.getAnimation()&&b.addClass(this.getAnimation()),b.appendTo(this.options.container),h=this.getPlacement(a),this.$element.trigger("added."+g),this.initTargetEvents(),this.options.padding||("auto"!==this.options.height&&c.css("height",c.outerHeight()),this.$target.addClass("popover-no-padding")),this.options.maxHeight&&c.css("maxHeight",this.options.maxHeight),this.options.maxWidth&&c.css("maxWidth",this.options.maxWidth),d=b[0].offsetWidth,e=b[0].offsetHeight;var o=this.getTargetPositin(a,h,d,e);if(this.$target.css(o.position).addClass(h).addClass("in"),"iframe"===this.options.type){var p=b.find("iframe"),q=b.width(),r=p.parent().height();""!==this.options.iframeOptions.width&&"auto"!==this.options.iframeOptions.width&&(q=this.options.iframeOptions.width),""!==this.options.iframeOptions.height&&"auto"!==this.options.iframeOptions.height&&(r=this.options.iframeOptions.height),p.width(q).height(r)}if(this.options.arrow||this.$target.css({margin:0}),this.options.arrow){var s=this.$target.find(".popover-arrow");s.removeAttr("style"),"left"===h||"right"===h?s.css({top:this.$target.height()/2}):"top"!==h&&"bottom"!==h||s.css({left:this.$target.width()/2}),o.arrowOffset&&(-1===o.arrowOffset.left||-1===o.arrowOffset.top?s.hide():s.css(o.arrowOffset))}this._poped=!0,this.$element.trigger("shown."+g,[this.$target])},isTargetLoaded:function(){return 0===this.getTarget().find("i.glyphicon-refresh").length},getTriggerElement:function(){return this.$element},getTarget:function(){if(!this.$target){var a=e+this._idSeed;this.$target=$(this.options.template).attr("id",a),this._customTargetClass=this.$target.attr("class")!==f?this.$target.attr("class"):null,this.getTriggerElement().attr("data-target",a)}return this.$target.data("trigger-element")||this.$target.data("trigger-element",this.getTriggerElement()),this.$target},removeTarget:function(){this.$target.remove(),this.$target=null,this.$contentElement=null},getTitleElement:function(){return this.getTarget().find("."+f+"-title")},getContentElement:function(){return this.$contentElement||(this.$contentElement=this.getTarget().find("."+f+"-content")),this.$contentElement},getTitle:function(){return this.$element.attr("data-title")||this.options.title||this.$element.attr("title")},getUrl:function(){return this.$element.attr("data-url")||this.options.url},getAutoHide:function(){return this.$element.attr("data-auto-hide")||this.options.autoHide},getOffsetTop:function(){return p(this.$element.attr("data-offset-top"))||this.options.offsetTop},getOffsetLeft:function(){return p(this.$element.attr("data-offset-left"))||this.options.offsetLeft},getCache:function(){var a=this.$element.attr("data-cache");if(void 0!==a)switch(a.toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":return!1}return this.options.cache},getTrigger:function(){return this.$element.attr("data-trigger")||this.options.trigger},getDelayShow:function(){var a=this.$element.attr("data-delay-show");return void 0!==a?a:0===this.options.delay.show?0:this.options.delay.show||100},getHideDelay:function(){var a=this.$element.attr("data-delay-hide");return void 0!==a?a:0===this.options.delay.hide?0:this.options.delay.hide||100},getAnimation:function(){return this.$element.attr("data-animation")||this.options.animation},getHideAnimation:function(){var a=this.getAnimation();return a?a+"-out":"out"},setTitle:function(a){var b=this.getTitleElement();a?("rtl"!==this.options.direction||b.hasClass(i)||b.addClass(i),b.html(a)):b.remove()},hasContent:function(){return this.getContent()},canEmptyHide:function(){return this.options.hideEmpty&&"html"===this.options.type},getIframe:function(){var a=$("<iframe></iframe>").attr("src",this.getUrl()),b=this;return $.each(this._defaults.iframeOptions,function(c){void 0!==b.options.iframeOptions[c]&&a.attr(c,b.options.iframeOptions[c])}),a},getContent:function(){if(this.getUrl())switch(this.options.type){case"iframe":this.content=this.getIframe();break;case"html":try{this.content=$(this.getUrl()),this.content.is(":visible")||this.content.show()}catch(a){throw new Error("Unable to get popover content. Invalid selector specified.")}}else if(!this.content){var a="";if(a=$.isFunction(this.options.content)?this.options.content.apply(this.$element[0],[this]):this.options.content,this.content=this.$element.attr("data-content")||a,!this.content){var b=this.$element.next();b&&b.hasClass(f+"-content")&&(this.content=b)}}return this.content},setContent:function(a){var b=this.getTarget(),c=this.getContentElement();"string"==typeof a?c.html(a):a instanceof $&&(c.html(""),this.options.cache?a.removeClass(f+"-content").appendTo(c):a.clone(!0,!0).removeClass(f+"-content").appendTo(c)),this.$target=b},isAsync:function(){return"async"===this.options.type},setContentASync:function(a){var b=this;this.xhr||(this.xhr=$.ajax({url:this.getUrl(),type:this.options.async.type,cache:this.getCache(),beforeSend:function(a,c){b.options.async.before&&b.options.async.before(b,a,c)},success:function(c){b.bindBodyEvents(),a&&$.isFunction(a)?b.content=a.apply(b.$element[0],[c]):b.content=c,b.setContent(b.content),b.getContentElement().removeAttr("style"),b.displayContent(),b.options.async.success&&b.options.async.success(b,c)},complete:function(){b.xhr=null},error:function(a,c){b.options.async.error&&b.options.async.error(b,a,c)}}))},bindBodyEvents:function(){m||(this.options.dismissible?t?o.off("touchstart.popover").on("touchstart.popover",$.proxy(this.bodyTouchStartHandler,this)):(o.off("keyup.popover").on("keyup.popover",$.proxy(this.escapeHandler,this)),o.off("click.popover").on("click.popover",$.proxy(this.bodyClickHandler,this))):"hover"===this.getTrigger()&&o.off("touchend.popover").on("touchend.popover",$.proxy(this.bodyClickHandler,this)))},mouseenterHandler:function(a){var b=this;a&&this.options.selector&&(b=this.delegate(a.currentTarget)),b._timeout&&clearTimeout(b._timeout),b._enterTimeout=setTimeout(function(){b.getTarget().is(":visible")||b.show()},this.getDelayShow())},mouseleaveHandler:function(){var a=this;clearTimeout(a._enterTimeout),a._timeout=setTimeout(function(){a.hide()},this.getHideDelay())},escapeHandler:function(a){27===a.keyCode&&this.hideAll()},bodyTouchStartHandler:function(a){var b=this,c=$(a.currentTarget);c.on("touchend",function(a){b.bodyClickHandler(a),c.off("touchend")}),c.on("touchmove",function(){c.off("touchend")})},bodyClickHandler:function(a){m=!0;for(var b=!0,c=0;c<j.length;c++){var d=q(j[c]);if(d&&d._opened){var e=d.getTarget().offset(),f=e.left,g=e.top,h=e.left+d.getTarget().width(),i=e.top+d.getTarget().height(),k=u(a);if(k.x>=f&&k.x<=h&&k.y>=g&&k.y<=i){b=!1;break}}}b&&r()},initTargetEvents:function(){"hover"===this.getTrigger()&&this.$target.off("mouseenter mouseleave").on("mouseenter",$.proxy(this.mouseenterHandler,this)).on("mouseleave",$.proxy(this.mouseleaveHandler,this)),this.$target.find(".close").off("click").on("click",$.proxy(this.hide,this,!0))},getPlacement:function(a){var b,c=this.options.container,d=c.innerWidth(),e=c.innerHeight(),f=c.scrollTop(),g=c.scrollLeft(),h=Math.max(0,a.left-g),i=Math.max(0,a.top-f);b="function"==typeof this.options.placement?this.options.placement.call(this,this.getTarget()[0],this.$element[0]):this.$element.data("placement")||this.options.placement;var j="horizontal"===b,k="vertical"===b;return"auto"===b||j||k?b=h<d/3?i<e/3?j?"right-bottom":"bottom-right":i<2*e/3?k?i<=e/2?"bottom-right":"top-right":"right":j?"right-top":"top-right":h<2*d/3?i<e/3?j?h<=d/2?"right-bottom":"left-bottom":"bottom":i<2*e/3?j?h<=d/2?"right":"left":i<=e/2?"bottom":"top":j?h<=d/2?"right-top":"left-top":"top":i<e/3?j?"left-bottom":"bottom-left":i<2*e/3?k?i<=e/2?"bottom-left":"top-left":"left":j?"left-top":"top-left":"auto-top"===b?b=h<d/3?"top-right":h<2*d/3?"top":"top-left":"auto-bottom"===b?b=h<d/3?"bottom-right":h<2*d/3?"bottom":"bottom-left":"auto-left"===b?b=i<e/3?"left-top":i<2*e/3?"left":"left-bottom":"auto-right"===b&&(b=i<e/3?"right-bottom":i<2*e/3?"right":"right-top"),b},getElementPosition:function(){var a=this.$element[0].getBoundingClientRect(),c=this.options.container,d=c.css("position");if(c.is(b.body)||"static"===d)return $.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth||a.width,height:this.$element[0].offsetHeight||a.height});if("fixed"===d){var e=c[0].getBoundingClientRect();return{top:a.top-e.top+c.scrollTop(),left:a.left-e.left+c.scrollLeft(),width:a.width,height:a.height}}return"relative"===d?{top:this.$element.offset().top-c.offset().top,left:this.$element.offset().left-c.offset().left,width:this.$element[0].offsetWidth||a.width,height:this.$element[0].offsetHeight||a.height}:void 0},getTargetPositin:function(a,c,d,e){var f=a,g=this.options.container,h=this.$element.outerWidth(),i=this.$element.outerHeight(),j=b.documentElement.scrollTop+g.scrollTop(),k=b.documentElement.scrollLeft+g.scrollLeft(),l={},m=null,o=this.options.arrow?20:0,p=10,q=h<o+p?o:0,r=i<o+p?o:0,s=0,t=b.documentElement.clientHeight+j,u=b.documentElement.clientWidth+k,v=f.left+f.width/2-q>0,w=f.left+f.width/2+q<u,x=f.top+f.height/2-r>0,y=f.top+f.height/2+r<t;switch(c){case"bottom":l={top:f.top+f.height,left:f.left+f.width/2-d/2};break;case"top":l={top:f.top-e,left:f.left+f.width/2-d/2};break;case"left":l={top:f.top+f.height/2-e/2,left:f.left-d};break;case"right":l={top:f.top+f.height/2-e/2,left:f.left+f.width};break;case"top-right":l={top:f.top-e,left:v?f.left-q:p},m={left:v?Math.min(h,d)/2+q:n};break;case"top-left":s=w?q:-p,l={top:f.top-e,left:f.left-d+f.width+s},m={left:w?d-Math.min(h,d)/2-q:n};break;case"bottom-right":l={top:f.top+f.height,left:v?f.left-q:p},m={left:v?Math.min(h,d)/2+q:n};break;case"bottom-left":s=w?q:-p,l={top:f.top+f.height,left:f.left-d+f.width+s},m={left:w?d-Math.min(h,d)/2-q:n};break;case"right-top":s=y?r:-p,l={top:f.top-e+f.height+s,left:f.left+f.width},m={top:y?e-Math.min(i,e)/2-r:n};break;case"right-bottom":l={top:x?f.top-r:p,left:f.left+f.width},m={top:x?Math.min(i,e)/2+r:n};break;case"left-top":s=y?r:-p,l={top:f.top-e+f.height+s,left:f.left-d},m={top:y?e-Math.min(i,e)/2-r:n};break;case"left-bottom":l={top:x?f.top-r:p,left:f.left-d},m={top:x?Math.min(i,e)/2+r:n}}return l.top+=this.getOffsetTop(),l.left+=this.getOffsetLeft(),{position:l,arrowOffset:m}}},$.fn[e]=function(b,c){var d=[],f=this.each(function(){var f=$.data(this,"plugin_"+e);f?"destroy"===b?f.destroy():"string"==typeof b&&d.push(f[b]()):(b?"string"==typeof b?"destroy"!==b&&(c||(f=new a(this,null),d.push(f[b]()))):"object"==typeof b&&(f=new a(this,b)):f=new a(this,null),$.data(this,"plugin_"+e,f))});return d.length?d:f};var v=function(){var a=function(){r()},b=function(a){d=a},f=function(a,b){b=b||{},$(a).popover(b)},g=function(a){var b=!0;return $(a).each(function(a,d){b=b&&$(d).data("plugin_"+e)!==c}),b},i=function(a,b){b?$(a).popover(b).popover("show"):$(a).popover("show")},j=function(a){$(a).popover("hide")},k=function(a){h=$.extend({},h,a)};return{show:i,hide:j,create:f,isCreated:g,hideAll:a,onHideAll:b,updateContent:function(a,b){var c=$(a).data("plugin_"+e);if(c){var d=c.getCache();c.options.cache=!1,c.options.content=b,c._opened?(c._opened=!1,c.show()):c.isAsync()?c.setContentASync(b):c.setContent(b),c.options.cache=d}},updateContentAsync:function(a,b){var c=$(a).data("plugin_"+e);if(c){var d=c.getCache(),f=c.options.type;c.options.cache=!1,c.options.url=b,c._opened?(c._opened=!1,c.show()):(c.options.type="async",c.setContentASync(c.content)),c.options.cache=d,c.options.type=f}},setDefaultOptions:k}}();Toast.Popovers=v})}(window,document),function(a){"use strict";"function"==typeof define&&define.amd?define("toast/libs/rangeslider",a):"object"==typeof exports?module.exports=a(require()):a()}(function(){"use strict";function a(){var a=document.createElement("input");return a.setAttribute("type","range"),"text"!==a.type}function b(a,b){var c=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)}function c(a,b){return b=b||100,function(){if(!a.debouncing){var c=Array.prototype.slice.apply(arguments);a.lastReturnVal=a.apply(window,c),a.debouncing=!0}return clearTimeout(a.debounceTimeout),a.debounceTimeout=setTimeout(function(){a.debouncing=!1},b),a.lastReturnVal}}function d(a){return a&&(0===a.offsetWidth||0===a.offsetHeight||!1===a.open)}function e(a){for(var b=[],c=a.parentNode;d(c);)b.push(c),c=c.parentNode;return b}function f(a,b){function c(a){void 0!==a.open&&(a.open=!a.open)}var d=e(a),f=d.length,g=[],h=a[b];if(f){for(var i=0;i<f;i++)g[i]=d[i].style.cssText,d[i].style.setProperty?d[i].style.setProperty("display","block","important"):d[i].style.cssText+=";display: block !important",d[i].style.height="0",d[i].style.overflow="hidden",d[i].style.visibility="hidden",c(d[i]);h=a[b];for(var j=0;j<f;j++)d[j].style.cssText=g[j],c(d[j])}return h}function g(a,b){var c=parseFloat(a);return Number.isNaN(c)?b:c}function h(a){return a.charAt(0).toUpperCase()+a.substr(1)}function i(a,d){if(this.$window=$(window),this.$document=$(document),this.$element=$(a),this.options=$.extend({},m,d),this.polyfill=this.options.polyfill,this.orientation=this.$element[0].getAttribute("data-orientation")||this.options.orientation,this.onInit=this.options.onInit,this.onSlide=this.options.onSlide,this.onSlideEnd=this.options.onSlideEnd,this.onHandleDown=this.options.onHandleDown,this.onHandleMove=this.options.onHandleMove,this.DIMENSION=n.orientation[this.orientation].dimension,this.DIRECTION=n.orientation[this.orientation].direction,this.DIRECTION_STYLE=n.orientation[this.orientation].directionStyle,this.COORDINATE=n.orientation[this.orientation].coordinate,this.polyfill&&l)return!1;this.identifier="js-"+j+"-"+k++,this.startEvent=this.options.startEvent.join("."+this.identifier+" ")+"."+this.identifier,this.moveEvent=this.options.moveEvent.join("."+this.identifier+" ")+"."+this.identifier,this.endEvent=this.options.endEvent.join("."+this.identifier+" ")+"."+this.identifier,this.toFixed=(this.step+"").replace(".","").length-1,this.$fill=$('<div class="'+this.options.fillClass+'" />'),this.$handle=$('<div class="'+this.options.handleClass+'" />'),this.$range=$('<div class="'+this.options.rangeClass+" "+this.options[this.orientation+"Class"]+'" id="'+this.identifier+'" />').insertAfter(this.$element).prepend(this.$fill,this.$handle),this.$element.css({position:"absolute",width:"1px",height:"1px",overflow:"hidden",opacity:"0"}),this.handleDown=$.proxy(this.handleDown,this),this.handleMove=$.proxy(this.handleMove,this),this.handleEnd=$.proxy(this.handleEnd,this),this.init();var e=this;this.$window.on("resize."+this.identifier,c(function(){b(function(){e.update(!1,!1)},300)},20)),this.$document.on(this.startEvent,"#"+this.identifier+":not(."+this.options.disabledClass+")",this.handleDown),this.$element.on("change."+this.identifier,function(a,b){if(!b||b.origin!==e.identifier){var c=a.target.value,d=e.getPositionFromValue(c);e.setPosition(d)}})}Number.isNaN=Number.isNaN||function(a){return"number"==typeof a&&a!==a};var j="rangeslider",k=0,l=a(),m={polyfill:!0,orientation:"horizontal",rangeClass:"rangeslider",disabledClass:"rangeslider--disabled",activeClass:"rangeslider--active",horizontalClass:"rangeslider--horizontal",verticalClass:"rangeslider--vertical",fillClass:"rangeslider__fill",handleClass:"rangeslider__handle",startEvent:["mousedown","touchstart","pointerdown"],moveEvent:["mousemove","touchmove","pointermove"],endEvent:["mouseup","touchend","pointerup"]},n={orientation:{horizontal:{dimension:"width",direction:"left",directionStyle:"left",coordinate:"x"},vertical:{dimension:"height",direction:"top",directionStyle:"bottom",coordinate:"y"}}};return i.prototype.init=function(){this.update(!0,!1),this.onInit&&"function"==typeof this.onInit&&this.onInit()},i.prototype.update=function(a,b){this.$handle&&this.$range&&this.$element&&(a=a||!1,a&&(this.min=g(this.$element[0].getAttribute("min"),0),this.max=g(this.$element[0].getAttribute("max"),100),this.value=g(this.$element[0].value,Math.round(this.min+(this.max-this.min)/2)),this.step=g(this.$element[0].getAttribute("step"),1)),this._contentScale=this.$element.attr("data-content-scale"),this._contentScale||(this._contentScale=1),this.handleDimension=f(this.$handle[0],"offset"+h(this.DIMENSION)),this.rangeDimension=f(this.$range[0],"offset"+h(this.DIMENSION)),this.maxHandlePos=this.rangeDimension-this.handleDimension,this.grabPos=this.handleDimension*this._contentScale/2,this.position=this.getPositionFromValue(this.value),this.$element[0].disabled?this.$range.addClass(this.options.disabledClass):this.$range.removeClass(this.options.disabledClass),this.setPosition(this.position,b))},i.prototype.handleDown=function(a){if(a.preventDefault(),!a.button||0===a.button){this.$document.on(this.moveEvent,this.handleMove),this.$document.on(this.endEvent,this.handleEnd),this.$range.addClass(this.options.activeClass),this._contentScale=this.$element.attr("data-content-scale"),this._contentScale||(this._contentScale=1),(" "+a.target.className+" ").replace(/[\n\t]/g," ").indexOf(this.options.handleClass);var b=this.getRelativePosition(a),c=this.$range[0].getBoundingClientRect()[this.DIRECTION],d=this.getPositionFromNode(this.$handle[0])-c,e="vertical"===this.orientation?this.maxHandlePos-(b-this.grabPos):b-this.grabPos;e/=this._contentScale,this.setPosition(e),b>=d&&b<d+this.handleDimension&&(this.grabPos=b-d),this.onHandleDown&&"function"==typeof this.onHandleDown&&this.onHandleDown(this.value)}},i.prototype.handleMove=function(a){a.preventDefault();var b=this.getRelativePosition(a),c="vertical"===this.orientation?this.maxHandlePos-(b-this.grabPos):b-this.grabPos;c/=this._contentScale,this.setPosition(c),this.onHandleMove&&"function"==typeof this.onHandleMove&&this.onHandleMove(this.value)},i.prototype.handleEnd=function(a){a.preventDefault(),this.$document.off(this.moveEvent,this.handleMove),this.$document.off(this.endEvent,this.handleEnd),this.$range.removeClass(this.options.activeClass),this.$element.trigger("change",{origin:this.identifier}),this.onSlideEnd&&"function"==typeof this.onSlideEnd&&this.onSlideEnd(this.position,this.value)},i.prototype.cap=function(a,b,c){return a<b?b:a>c?c:a},i.prototype.setPosition=function(a,b){var c,d;void 0===b&&(b=!0),c=this.getValueFromPosition(this.cap(a,0,this.maxHandlePos)),d=this.getPositionFromValue(c),this.$fill[0].style[this.DIMENSION]=d+this.grabPos+"px",this.$handle[0].style[this.DIRECTION_STYLE]=d+"px",this.setValue(c),this.position=d,this.value=c,b&&this.onSlide&&"function"==typeof this.onSlide&&this.onSlide(d,c)},i.prototype.getPositionFromNode=function(a){for(var b=0;null!==a;)b+=a.offsetLeft,a=a.offsetParent;return b},i.prototype.getRelativePosition=function(a){var b=h(this.COORDINATE),c=this.$range[0].getBoundingClientRect()[this.DIRECTION],d=0;return void 0!==a.originalEvent["client"+b]?d=a.originalEvent["client"+b]:a.originalEvent.touches&&a.originalEvent.touches[0]&&void 0!==a.originalEvent.touches[0]["client"+b]?d=a.originalEvent.touches[0]["client"+b]:a.currentPoint&&void 0!==a.currentPoint[this.COORDINATE]&&(d=a.currentPoint[this.COORDINATE]),d-c},i.prototype.getPositionFromValue=function(a){var b;return b=(a-this.min)/(this.max-this.min),Number.isNaN(b)?0:b*this.maxHandlePos},i.prototype.getValueFromPosition=function(a){var b,c;return b=a/(this.maxHandlePos||1),c=this.step*Math.round(b*(this.max-this.min)/this.step)+this.min,Number(c.toFixed(this.toFixed))},i.prototype.setValue=function(a){a===this.value&&""!==this.$element[0].value||this.$element.val(a).trigger("input",{origin:this.identifier})},i.prototype.destroy=function(){this.$document.off("."+this.identifier),this.$window.off("."+this.identifier),this.$element.off("."+this.identifier).removeAttr("style").removeData("plugin_"+j),this.$range&&this.$range.length&&this.$range[0].parentNode.removeChild(this.$range[0]),this.$element.remove()},$.fn[j]=function(a){var b=Array.prototype.slice.call(arguments,1);return this.each(function(){var c=$(this),d=c.data("plugin_"+j);d||c.data("plugin_"+j,d=new i(this,a)),"string"==typeof a&&d[a].apply(d,b)})},"rangeslider.js is available in jQuery context e.g $(selector).rangeslider(options);"}),function(a){"function"==typeof define&&define.amd?define("toast/libs/jquery.jscrollpane",a):a(jQuery)}(function(){$.fn.jScrollPane=function(a){function b(a,b){function c(b){var f,h,j,k,l,o,p,q,r=!1,s=!1;if(N=b,void 0===O)l=a.scrollTop(),o=a.scrollLeft(),a.css({overflow:"hidden",padding:0}),P=a.innerWidth()+sa,Q=a.innerHeight(),a.width(P),O=$('<div class="jspPane" />').css("padding",ra).append(a.children()),R=$('<div class="jspContainer" />').css({width:P+"px",height:Q+"px"}).append(O).appendTo(a);else{if(a.css("width",""),R.css({width:"auto",height:"auto"}),O.css("position","static"),p=a.innerWidth()+sa,q=a.innerHeight(),O.css("position","absolute"),r=N.stickToBottom&&A(),s=N.stickToRight&&B(),k=p!==P||q!==Q,P=p,Q=q,R.css({width:P,height:Q}),!k&&ta==S&&O.outerHeight()==T)return void a.width(P);ta=S,O.css("width",""),a.width(P),R.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}O.css("overflow","auto"),S=b.contentWidth?b.contentWidth:O[0].scrollWidth,T=O[0].scrollHeight,O.css("overflow",""),U=S/P,V=T/Q,W=V>1||N.alwaysShowVScroll,X=U>1||N.alwaysShowHScroll,X||W?(a.addClass("jspScrollable"),f=N.maintainPosition&&(_||ca),f&&(h=y(),j=z()),e(),g(),i(),f&&(w(s?S-P:h,!1),v(r?T-Q:j,!1)),F(),C(),L(),N.enableKeyboardNavigation&&H(),N.clickOnTrack&&m(),J(),N.hijackInternalLinks&&K()):(a.removeClass("jspScrollable"),O.css({top:0,left:0,width:R.width()-sa}),D(),G(),I(),n()),N.resizeSensor||!N.autoReinitialise||qa?N.resizeSensor||N.autoReinitialise||!qa||clearInterval(qa):qa=setInterval(function(){c(N)},N.autoReinitialiseDelay),N.resizeSensor&&!Aa&&(d(O,Ca),d(a,Ca),d(a.parent(),Ca),window.addEventListener("resize",Ca),Aa=!0),l&&a.scrollTop(0)&&v(l,!1),o&&a.scrollLeft(0)&&w(o,!1),a.trigger("jsp-initialised",[X||W])}function d(a,b){var c,d,e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),i=document.createElement("div");e.style.cssText="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: scroll; z-index: -1; visibility: hidden;",f.style.cssText="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: scroll; z-index: -1; visibility: hidden;",h.style.cssText="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: scroll; z-index: -1; visibility: hidden;",g.style.cssText="position: absolute; left: 0; top: 0;",i.style.cssText="position: absolute; left: 0; top: 0; width: 200%; height: 200%;";var j=function(){g.style.width=f.offsetWidth+10+"px",g.style.height=f.offsetHeight+10+"px",f.scrollLeft=f.scrollWidth,f.scrollTop=f.scrollHeight,h.scrollLeft=h.scrollWidth,h.scrollTop=h.scrollHeight,c=a.width(),d=a.height()},k=function(){(a.width()>c||a.height()>d)&&b.apply(this,[]),j()},l=function(){(a.width()<c||a.height()<d)&&b.apply(this,[]),j()};f.addEventListener("scroll",k.bind(this)),h.addEventListener("scroll",l.bind(this)),f.appendChild(g),h.appendChild(i),e.appendChild(f),e.appendChild(h),a.append(e),"static"===window.getComputedStyle(a[0],null).getPropertyValue("position")&&(a[0].style.position="relative"),j()}function e(){W&&(R.append($('<div class="jspVerticalBar" />').append($('<div class="jspCap jspCapTop" />'),$('<div class="jspTrack" />').append($('<div class="jspTrackInner" />'),$('<div class="jspDrag" />').append($('<div class="jspDragInner" />'),$('<div class="jspDragTop" />'),$('<div class="jspDragBottom" />'))),$('<div class="jspCap jspCapBottom" />'))),da=R.find(">.jspVerticalBar"),ea=da.find(">.jspTrack"),Y=ea.find(">.jspDrag"),N.showArrows&&(ia=$('<a class="jspArrow jspArrowUp" />').on("mousedown.jsp",k(0,-1)).on("click.jsp",E),ja=$('<a class="jspArrow jspArrowDown" />').on("mousedown.jsp",k(0,1)).on("click.jsp",E),N.arrowScrollOnHover&&(ia.on("mouseover.jsp",k(0,-1,ia)),ja.on("mouseover.jsp",k(0,1,ja))),j(ea,N.verticalArrowPositions,ia,ja)),ga=Q,R.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){ga-=$(this).outerHeight()}),Y.on("mouseenter",function(){Y.addClass("jspHover")}).on("mouseleave",function(){Y.removeClass("jspHover")}).on("mousedown.jsp",function(a){$("html").on("dragstart.jsp selectstart.jsp",E),Y.addClass("jspActive");var b=a.pageY-Y.position().top;return $("html").on("mousemove.jsp",function(a){p(a.pageY-b,!1)}).on("mouseup.jsp mouseleave.jsp",o),!1}),f())}function f(){ea.height(ga+"px"),_=0,fa=N.verticalGutter+ea.outerWidth(),O.width(P-fa-sa);try{0===da.position().left&&O.css("margin-left",fa+"px")}catch(a){}}function g(){X&&(R.append($('<div class="jspHorizontalBar" />').append($('<div class="jspCap jspCapLeft" />'),$('<div class="jspTrack" />').append($('<div class="jspTrackInner" />'),$('<div class="jspDrag" />').append($('<div class="jspDragInner" />'),$('<div class="jspDragLeft" />'),$('<div class="jspDragRight" />'))),$('<div class="jspCap jspCapRight" />'))),ka=R.find(">.jspHorizontalBar"),la=ka.find(">.jspTrack"),aa=la.find(">.jspDrag"),N.showArrows&&(oa=$('<a class="jspArrow jspArrowLeft" />').on("mousedown.jsp",k(-1,0)).on("click.jsp",E),pa=$('<a class="jspArrow jspArrowRight" />').on("mousedown.jsp",k(1,0)).on("click.jsp",E),N.arrowScrollOnHover&&(oa.on("mouseover.jsp",k(-1,0,oa)),pa.on("mouseover.jsp",k(1,0,pa))),j(la,N.horizontalArrowPositions,oa,pa)),aa.on("mouseenter",function(){aa.addClass("jspHover")}).on("mouseleave",function(){aa.removeClass("jspHover")}).on("mousedown.jsp",function(a){$("html").on("dragstart.jsp selectstart.jsp",E),aa.addClass("jspActive");var b=a.pageX-aa.position().left;return $("html").on("mousemove.jsp",function(a){r(a.pageX-b,!1)}).on("mouseup.jsp mouseleave.jsp",o),!1}),ma=R.innerWidth(),h())}function h(){R.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){ma-=$(this).outerWidth()}),la.width(ma+"px"),ca=0}function i(){if(X&&W){var a=la.outerHeight(),b=ea.outerWidth();ga-=a,$(ka).find(">.jspCap:visible,>.jspArrow").each(function(){ma+=$(this).outerWidth()}),ma-=b,Q-=b,P-=a,la.parent().append($('<div class="jspCorner" />').css("width",a+"px")),f(),h()}X&&O.width(R.outerWidth()-sa+"px"),T=O.outerHeight(),V=T/Q,X&&(na=Math.ceil(1/U*ma),na>N.horizontalDragMaxWidth?na=N.horizontalDragMaxWidth:na<N.horizontalDragMinWidth&&(na=N.horizontalDragMinWidth),aa.css("width",na+"px"),ba=ma-na,s(ca)),W&&(ha=Math.ceil(1/V*ga),ha>N.verticalDragMaxHeight?ha=N.verticalDragMaxHeight:ha<N.verticalDragMinHeight&&(ha=N.verticalDragMinHeight),Y.css("height",ha+"px"),Z=ga-ha,q(_))}function j(a,b,c,d){var e,f="before",g="after";"os"==b&&(b=/Mac/.test(navigator.platform)?"after":"split"),b==f?g=b:b==g&&(f=b,e=c,c=d,d=e),a[f](c)[g](d)}function k(a,b,c){return function(){return l(a,b,this,c),this.blur(),!1}}function l(a,b,c,d){c=$(c).addClass("jspActive");var e,f,g=!0,h=function(){0!==a&&ua.scrollByX(a*N.arrowButtonSpeed),0!==b&&ua.scrollByY(b*N.arrowButtonSpeed),f=setTimeout(h,g?N.initialDelay:N.arrowRepeatFreq),g=!1};h(),e=d?"mouseout.jsp":"mouseup.jsp",d=d||$("html"),d.on(e,function(){c.removeClass("jspActive"),f&&clearTimeout(f),f=null,d.off(e)})}function m(){n(),W&&ea.on("mousedown.jsp",function(a){if(void 0===a.originalTarget||a.originalTarget==a.currentTarget){var b,c=$(this),d=c.offset(),e=a.pageY-d.top-_,f=!0,g=function(){var d=c.offset(),i=a.pageY-d.top-ha/2,j=Q*N.scrollPagePercent,k=Z*j/(T-Q);if(e<0)_-k>i?ua.scrollByY(-j):p(i);else{if(!(e>0))return void h();_+k<i?ua.scrollByY(j):p(i)}b=setTimeout(g,f?N.initialDelay:N.trackClickRepeatFreq),f=!1},h=function(){b&&clearTimeout(b),b=null,$(document).off("mouseup.jsp",h)};return g(),$(document).on("mouseup.jsp",h),!1}}),X&&la.on("mousedown.jsp",function(a){if(void 0===a.originalTarget||a.originalTarget==a.currentTarget){var b,c=$(this),d=c.offset(),e=a.pageX-d.left-ca,f=!0,g=function(){var d=c.offset(),i=a.pageX-d.left-na/2,j=P*N.scrollPagePercent,k=ba*j/(S-P);if(e<0)ca-k>i?ua.scrollByX(-j):r(i);else{if(!(e>0))return void h();ca+k<i?ua.scrollByX(j):r(i)}b=setTimeout(g,f?N.initialDelay:N.trackClickRepeatFreq),f=!1},h=function(){b&&clearTimeout(b),b=null,$(document).off("mouseup.jsp",h)};return g(),$(document).on("mouseup.jsp",h),!1}})}function n(){la&&la.off("mousedown.jsp"),ea&&ea.off("mousedown.jsp")}function o(){$("html").off("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),Y&&Y.removeClass("jspActive"),aa&&aa.removeClass("jspActive")}function p(b,c){if(W){b<0?b=0:b>Z&&(b=Z);var d=new $.Event("jsp-will-scroll-y");if(a.trigger(d,[b]),!d.isDefaultPrevented()){var e=b||0,f=0===e,g=e==Z,h=b/Z,i=-h*(T-Q);void 0===c&&(c=N.animateScroll),c?ua.animate(Y,"top",b,q,function(){a.trigger("jsp-user-scroll-y",[-i,f,g])}):(Y.css("top",b),q(b),a.trigger("jsp-user-scroll-y",[-i,f,g]))}}}function q(b){void 0===b&&(b=Y.position().top),R.scrollTop(0),_=b||0;var c=0===_,d=_==Z,e=b/Z,f=-e*(T-Q);va==c&&xa==d||(va=c,xa=d,a.trigger("jsp-arrow-change",[va,xa,wa,ya])),t(c,d),O.css("top",f),a.trigger("jsp-scroll-y",[-f,c,d]).trigger("scroll")}function r(b,c){if(X){b<0?b=0:b>ba&&(b=ba);var d=new $.Event("jsp-will-scroll-x");if(a.trigger(d,[b]),!d.isDefaultPrevented()){var e=b||0,f=0===e,g=e==ba,h=b/ba,i=-h*(S-P);void 0===c&&(c=N.animateScroll),c?ua.animate(aa,"left",b,s,function(){a.trigger("jsp-user-scroll-x",[-i,f,g])}):(aa.css("left",b),s(b),a.trigger("jsp-user-scroll-x",[-i,f,g]))}}}function s(b){void 0===b&&(b=aa.position().left),R.scrollTop(0),ca=b||0;var c=0===ca,d=ca==ba,e=b/ba,f=-e*(S-P);wa==c&&ya==d||(wa=c,ya=d,a.trigger("jsp-arrow-change",[va,xa,wa,ya])),u(c,d),O.css("left",f),a.trigger("jsp-scroll-x",[-f,c,d]).trigger("scroll")}function t(a,b){N.showArrows&&(ia[a?"addClass":"removeClass"]("jspDisabled"),ja[b?"addClass":"removeClass"]("jspDisabled"))}function u(a,b){N.showArrows&&(oa[a?"addClass":"removeClass"]("jspDisabled"),pa[b?"addClass":"removeClass"]("jspDisabled"))}function v(a,b){p(a/(T-Q)*Z,b)}function w(a,b){r(a/(S-P)*ba,b)}function x(a,b,c){var d,e,f,g,h,i,j,k,l,m=0,n=0;try{d=$(a)}catch(a){return}for(e=d.outerHeight(),f=d.outerWidth(),R.scrollTop(0),R.scrollLeft(0);!d.is(".jspPane");)if(m+=d.position().top,n+=d.position().left,d=d.offsetParent(),/^body|html$/i.test(d[0].nodeName))return;g=z(),i=g+Q,m<g||b?k=m-N.horizontalGutter:m+e>i&&(k=m-Q+e+N.horizontalGutter),isNaN(k)||v(k,c),h=y(),j=h+P,n<h||b?l=n-N.horizontalGutter:n+f>j&&(l=n-P+f+N.horizontalGutter),isNaN(l)||w(l,c)}function y(){return-O.position().left}function z(){return-O.position().top}function A(){var a=T-Q;return a>20&&a-z()<10}function B(){var a=S-P;return a>20&&a-y()<10}function C(){R.off(Ba).on(Ba,function(a,b,c,d){ca||(ca=0),_||(_=0);var e=ca,f=_,g=a.deltaFactor||N.mouseWheelSpeed;return ua.scrollBy(c*g,-d*g,!1),e==ca&&f==_})}function D(){R.off(Ba)}function E(){return!1}function F(){O.find(":input,a").off("focus.jsp").on("focus.jsp",function(a){x(a.target,!1)})}function G(){O.find(":input,a").off("focus.jsp")}function H(){function b(){var a=ca,b=_;switch(c){case 40:ua.scrollByY(N.keyboardSpeed,!1);break;case 38:ua.scrollByY(-N.keyboardSpeed,!1);break;case 34:case 32:ua.scrollByY(Q*N.scrollPagePercent,!1);break;case 33:ua.scrollByY(-Q*N.scrollPagePercent,!1);break;case 39:ua.scrollByX(N.keyboardSpeed,!1);break;case 37:ua.scrollByX(-N.keyboardSpeed,!1)}return d=a!=ca||b!=_}var c,d,e=[];X&&e.push(ka[0]),W&&e.push(da[0]),O.on("focus.jsp",function(){a.focus()}),a.attr("tabindex",0).off("keydown.jsp keypress.jsp").on("keydown.jsp",function(a){if(a.target===this||e.length&&$(a.target).closest(e).length){var f=ca,g=_;switch(a.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:c=a.keyCode,b();break;case 35:v(T-Q),c=null;break;case 36:v(0),c=null}return!(d=a.keyCode==c&&f!=ca||g!=_)}}).on("keypress.jsp",function(a){if(a.keyCode==c&&b(),a.target===this||e.length&&$(a.target).closest(e).length)return!d}),N.hideFocus?(a.css("outline","none"),"hideFocus"in R[0]&&a.attr("hideFocus",!0)):(a.css("outline",""),"hideFocus"in R[0]&&a.attr("hideFocus",!1))}function I(){a.attr("tabindex","-1").removeAttr("tabindex").off("keydown.jsp keypress.jsp"),O.off(".jsp")}function J(){if(location.hash&&location.hash.length>1){var a,b,c=escape(location.hash.substr(1));try{a=$("#"+c+', a[name="'+c+'"]')}catch(a){return}a.length&&O.find(c)&&(0===R.scrollTop()?b=setInterval(function(){R.scrollTop()>0&&(x(a,!0),$(document).scrollTop(R.position().top),clearInterval(b))},50):(x(a,!0),$(document).scrollTop(R.position().top)))}}function K(){$(document.body).data("jspHijack")||($(document.body).data("jspHijack",!0),$(document.body).delegate('a[href*="#"]',"click",function(a){var b,c,d,e,f,g,h=this.href.substr(0,this.href.indexOf("#")),i=location.href;if(-1!==location.href.indexOf("#")&&(i=location.href.substr(0,location.href.indexOf("#"))),h===i){b=escape(this.href.substr(this.href.indexOf("#")+1));try{c=$("#"+b+', a[name="'+b+'"]')}catch(a){return}c.length&&(d=c.closest(".jspScrollable"),e=d.data("jsp"),e.scrollToElement(c,!0),d[0].scrollIntoView&&(f=$(window).scrollTop(),((g=c.offset().top)<f||g>f+$(window).height())&&d[0].scrollIntoView()),a.preventDefault())}}))}function L(){var a,b,c,d,e,f=!1;R.off("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").on("touchstart.jsp",function(g){var h=g.originalEvent.touches[0];a=y(),b=z(),c=h.pageX,d=h.pageY,e=!1,f=!0}).on("touchmove.jsp",function(g){if(f){var h=g.originalEvent.touches[0],i=ca,j=_;return ua.scrollTo(a+c-h.pageX,b+d-h.pageY),e=e||Math.abs(c-h.pageX)>5||Math.abs(d-h.pageY)>5,i==ca&&j==_}}).on("touchend.jsp",function(a){f=!1}).on("click.jsp-touchclick",function(a){if(e)return e=!1,!1})}function M(){var b=z(),c=y();a.removeClass("jspScrollable").off(".jsp"),O.off(".jsp"),a.replaceWith(za.append(O.children())),za.scrollTop(b),za.scrollLeft(c),qa&&clearInterval(qa)}var N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua=this,va=!0,wa=!0,xa=!1,ya=!1,za=a.clone(!1,!1).empty(),Aa=!1,Ba=$.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp",Ca=function(){N.resizeSensorDelay>0?setTimeout(function(){c(N)},N.resizeSensorDelay):c(N)};"border-box"===a.css("box-sizing")?(ra=0,sa=0):(ra=a.css("paddingTop")+" "+a.css("paddingRight")+" "+a.css("paddingBottom")+" "+a.css("paddingLeft"),sa=(parseInt(a.css("paddingLeft"),10)||0)+(parseInt(a.css("paddingRight"),10)||0)),$.extend(ua,{reinitialise:function(a){a=$.extend({},N,a),c(a)},scrollToElement:function(a,b,c){x(a,b,c)},scrollTo:function(a,b,c){w(a,c),v(b,c)},scrollToX:function(a,b){w(a,b)},scrollToY:function(a,b){v(a,b)},scrollToPercentX:function(a,b){w(a*(S-P),b)},scrollToPercentY:function(a,b){v(a*(T-Q),b)},scrollBy:function(a,b,c){ua.scrollByX(a,c),ua.scrollByY(b,c)},scrollByX:function(a,b){r((y()+Math[a<0?"floor":"ceil"](a))/(S-P)*ba,b)},scrollByY:function(a,b){p((z()+Math[a<0?"floor":"ceil"](a))/(T-Q)*Z,b)},positionDragX:function(a,b){r(a,b)},positionDragY:function(a,b){p(a,b)},animate:function(a,b,c,d,e){var f={};f[b]=c,a.animate(f,{duration:N.animateDuration,easing:N.animateEase,queue:!1,step:d,complete:e})},getContentPositionX:function(){return y()},getContentPositionY:function(){return z()},getContentWidth:function(){return S},getContentHeight:function(){return T},getPercentScrolledX:function(){return y()/(S-P)},getPercentScrolledY:function(){return z()/(T-Q)},getIsScrollableH:function(){return X},getIsScrollableV:function(){return W},getContentPane:function(){return O},scrollToBottom:function(a){p(Z,a)},hijackInternalLinks:$.noop,destroy:function(){M()}}),c(b)}return a=$.extend({},$.fn.jScrollPane.defaults,a),$.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){a[this]=a[this]||a.speed}),this.each(function(){var c=$(this),d=c.data("jsp");d?d.reinitialise(a):($("script",c).filter('[type="text/javascript"],:not([type])').remove(),d=new b(c,a),c.data("jsp",d))})},$.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:void 0,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8,alwaysShowVScroll:!1,alwaysShowHScroll:!1,resizeSensor:!1,resizeSensorDelay:0}}),define("toast/libs",["./libs/hammer","./libs/ImageViewer","./libs/dragdealer","./libs/spectrum","./libs/Drag","./libs/Drop","./libs/dialog","./libs/draggable","./libs/Sketchpad","./libs/Scrollbar","./libs/popover","./libs/rangeslider","./libs/jquery.jscrollpane"],function(a,b,c){Toast.Hammer=a,Toast.ImageViewer=b,Toast.Dragdealer=c}),define("toast/core",["exports","strings","./events","./libs"],function(a,b){return Toast.version="5.9.114",Toast.setdev=function(a,b){Toast.dev=a,Toast.debug=Toast.dev,Toast.debug?$(document.body).removeAttr("oncontextmenu"):$(document.body).attr("oncontextmenu","return false;"),!0===Toast.debug&&window.console&&window.console.log?Toast._msieVersion&&Toast._msieVersion<10?Toast.log=Function.prototype.bind.call(console.log,console):Toast.log=console.log.bind(console):Toast.log=function(){},Toast.send("setdev",a)},Toast.Strings=b,Toast.getModule=require,Toast.load=require,void 0===window.isMobileDevice&&void 0===window.isMobile||(Toast.isMobile=Toast.isMobileDevice=window.isMobileDevice?window.isMobileDevice:window.isMobile,Toast.isMobileDevice&&(Toast.isMobileDevice=!0)),void 0!==window.isTablet&&(Toast.isTablet=window.isTablet),void 0!==window.isAndroid&&(Toast.isAndroid=window.isAndroid,Toast.isAndroid&&(Toast.isAndroid=!0)),Toast}),define("toast/core/Model",["../core"],function(a){"use strict";var b=Backbone.Model.extend({initialize:function(a){for(var b in this.attributes)b!=this.idAttribute&&this.defineProperty(b)},moveUp:function(a){var b=this.__children__.indexOf(a);return-1!=b?(this.__children__.splice(b-1,0,this.__children__.splice(b,1)[0]),b-1):-1},moveFirst:function(a){return this.moveAtIndex(a,0)},moveDown:function(a){var b=this.__children__.indexOf(a);return-1!=b?(this.__children__.splice(b+1,0,this.__children__.splice(b,1)[0]),b+1):-1},moveLast:function(a){return this.moveAtIndex(a,this.__children__.length-1)},moveAtIndex:function(a,b){var c=this.__children__.indexOf(a);return-1!=c?(this.__children__.splice(b,0,this.__children__.splice(c,1)[0]),b):-1},remove:function(a){var b=this.__children__.indexOf(a);-1!=b&&(a.__children__=[],this.__children__.splice(b,1))},childIndexOf:function(a){return this.__children__.indexOf(a)},hasChildren:function(){return this.__children__&&this.__children__.length>0},topParent:function(){for(var a=this;;){if(!a.__parent__)break;a=a.__parent__}return a},rect:function(){return{left:this.get("left"),top:this.get("top"),width:this.get("width"),height:this.get("height")}},isDraggable:function(){return!this.get("locked")&&!this.get("hidden")&&this.get("draggable")},isRemovable:function(){return!(this.get("locked")||this.get("hidden")||this.get("readonly")||!this.get("removable"))},copyAttrs:function(a){this.set("locked",a.get("locked")),this.set("hidden",a.get("hidden")),this.set("selected",a.get("selected")),this.set("draggable",!0),this.set("isModified",!1),this.set("copyable",a.get("copyable")),this.set("removable",a.get("removable")),this.set("droppable",a.get("droppable"))},cleanAttrs:function(a){delete a.__parent__,delete a.__children__,delete a.selected,delete a.draggable,delete a.isModified,a.copyable&&delete a.copyable,a.removable&&delete a.removable,a.droppable&&delete a.droppable,a.thumbUrl&&delete a.thumbUrl,a.orgid&&delete a.orgid},output:function(a){var b=_.clone(this.attributes);return b.children=[],this.cleanAttrs(b),b.subpages&&(b.subpages=JSON.parse(JSON.stringify(b.subpages))),this.__children__&&this.__children__.length>0&&this._output(this,b),b},_output:function(a,b){_.each(a.__children__,function(a){var c=_.clone(a.attributes);c.children=[],this.cleanAttrs(c),b.children.push(c),a.__children__.length>0&&this._output(a,c)},this)}});return a.Model=b}),define("toast/core/Collection",["../core","./Model"],function(a,b){"use strict";var c=Backbone.Collection.extend({attributes:{},initialize:function(a){a||(a={}),arguments.length>1&&(a=arguments[1]),this.attributes=_.extend({},a.attributes);for(var b in this.attributes)this.hasOwnProperty(b)||this.defineProperty(b)},attr:function(a){if(2!=arguments.length)return this.attributes[a];this.attributes[a]=arguments[1]},moveUp:function(a){var b=this.indexOf(a);return b>1?(this.remove(a,{silent:!0}),this.add(a,{at:b-1,silent:!0}),b-1):-1},moveFirst:function(a){return this.moveAtIndex(a,0)},moveDown:function(a){var b=this.indexOf(a);return b<this.models.length?(this.remove(a,{silent:!0}),this.add(a,{at:b+1,silent:!0}),b+1):-1},moveLast:function(a){return this.moveAtIndex(a,this.length-1)},moveAtIndex:function(a,b){return b<this.models.length?(this.remove(a,{silent:!1}),this.add(a,{at:b,silent:!1}),b):-1},remove:function(a,b){if(_.isArray(a))for(var c=0,d=a.length;c<d;c++){var e=a[c],f=this.indexOf(e);e.modelIndex=f}else{var f=this.indexOf(a);a.modelIndex=f}Backbone.Collection.prototype.remove.call(this,a,b)},load:function(a,b){},createWithAttrs:function(a,b){b||(b={}),a=$.extend(!0,{},a);var c=new this.model(a);return this.createChildren(c,a),c.unset("children",{silent:!0}),this.add(c,b),c},createChildren:function(a,b){var c=b.children;_.each(c,function(b){b=$.extend(!0,{},b);var c=new this.model(b);c.__parent__=a,a.__children__||(a.__children__=[]),a.__children__.push(c),b.children&&this.createChildren(c,b)},this)},isEmpty:function(){if(!this.length)return!0;if(1===this.length){if(this.at(0).__attributes__)return!0}return!1},isFirst:function(a){var b=this.indexOf(a);return!!(this.at(0).__attributes__&&1===b||0===b)},isLast:function(a){return this.indexOf(a)+1===this.length},output:function(a){return this.map(function(b){return b.output(a)})}});return c.Attributes=Backbone.Model.extend({initialize:function(a){this.__attributes__=!0;for(var b in this.attributes)b!=this.idAttribute&&this.defineProperty(b)},hasChildren:function(){return!1},output:function(a){return this.toJSON()}}),a.Collection=c}),define("toast/core/Contents",["../core","./Collection","./Model"],function(a,b,c){"use strict";var d=(b.prototype,b.extend());return _.extend(d.prototype,{load:function(a,c){this.reset(),"string"==typeof a&&(a=JSON.parse(a));var d=$.extend(!0,{},a.contents);a.contents&&delete a.contents;var e=this.attributes;this.attributes=_.extend(e,a);for(var f in this.attributes)this.hasOwnProperty(f)||this.defineProperty(f);e=new b.Attributes(_.merge({},this.attributes)),e.view=this.view,this.view._model=e,this.add(e,{silent:!0}),_.each(d,function(a){var b=new this.model(a);this.createChildren(b,a),b.unset("children",{silent:!0}),this.add(b,c)},this)},moveAtIndex:function(a,b){return b<this.models.length?(b=Math.max(1,b),this.remove(a,{silent:!0}),this.add(a,{at:b,silent:!0}),b):-1}}),a.Contents=d}),define("toast/actions/Action",["../core"],function(Toast){"use strict";var Action=Toast.Action=function(a,b,c){b||(b={}),c||(c={}),this.id=Toast.UUID4().prefix("a"),this.view=a,this.properties=b,this.options=c,this.initialize.apply(this,arguments)};return _.extend(Action.prototype,Backbone.Events,{initialize:function(a,b,c){},execute:function(){}}),_.extend(Action,{create:function(view,action,options){var Action=eval("Toast.Action."+action.name);if(!Action)return null;var instance=new Action(view,action.properties,options);return instance}}),Action.extend=Toast.extend,Toast.Action=Action}),define("toast/actions/LinkUrl",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){var b;if(this.properties.file)b=a.FileAssets.url(this.properties.file);else{if(b=this.properties.url,_.isEmpty(b))return;if(b.length>7&&"mailto:"===b.substr(0,7).toLowerCase())return void(window.location.href=b);if(b.length>4&&"tel:"===b.substr(0,4).toLowerCase())return void(window.location.href=b);var c=a.urlParams.get("preview");(a.player||c&&(c=c.trim().toLowerCase())&&"true"==c)&&-1===b.indexOf("../")&&-1===b.indexOf("./")&&"http:"!==b.protocol()&&"https"!==b.protocol()&&(b="http://"+this.properties.url)}if(!_.isEmpty(b)){if(_.find(a.FileAssets.fileTypes,function(a){if(a.toLowerCase()===b.getFileExtension().toLowerCase())return!0})&&a.isDownloadFileType(b.getFileExtension())){var d=b.getBaseName();return void a.SaveToDisk(b,d)}if(_.isEmpty(this.properties.formData))this.properties.openWindow?window.open(b):window.location.href=b;else{var e=$("<form />",{name:"linkPopupForm"});_.each(this.properties.formData,function(a){if(!_.isEmpty(a.name)&&!_.isEmpty(a.value)){var b=$("<input />",{type:"hidden",name:a.name});e.append(b)}}),$(document.body).append(e),window.open("","linkUrlPopup_"+this.id);var f=document.linkPopupForm;f.action=b,f.method=this.properties.formMethod,f.target="linkUrlPopup_"+this.id,_.each(this.properties.formData,function(a){_.isEmpty(a.name)||_.isEmpty(a.value)||(f[a.name].value=a.value)}),f.submit(),e.remove()}}}}),a.Action.LinkUrl=d}),define("toast/actions/GotoPage",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){if(_.isUndefined(this.properties.pageLabel))_.isEmpty(this.properties.selectPage)?_.isUndefined(this.properties.pageNumber)||(a.BookZoom._off(),a.Book.move(this.properties.pageNumber,{isLogical:!0,silent:!1}),a.lazy(function(){a.BookZoom._on()},300)):(a.BookZoom._off(),"firstPage"===this.properties.selectPage?a.Book.moveToFirst():"previousPage"===this.properties.selectPage?a.Book.previous():"back"===this.properties.selectPage?a.Book.back():"nextPage"===this.properties.selectPage?a.Book.next():"lastPage"===this.properties.selectPage&&a.Book.moveToLast(),a.lazy(function(){a.BookZoom._on()},300));else{var b=a.project.findPage({name:"label",value:this.properties.pageLabel});b&&(a.BookZoom._off(),a.Book.move(b.index+1),a.lazy(function(){a.BookZoom._on()},300))}}}),a.Action.GotoPage=d}),define("toast/actions/Visible",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d),_.isUndefined(this.properties.visible)&&(this.properties.visible="toggle"),_.isEmpty(this.properties.targets)&&(this.properties.targets=[a.model.id])},execute:function(){var b;_.each(this.properties.targets,function(c){var d=a.Book.find({id:c});d&&("toggle"===this.properties.visible?(d.properties.visible=!d.properties.visible,d.view.toggle()):"visible"===this.properties.visible?(d.properties.visible=!0,d.view.show()):(d.properties.visible=!1,d.view.hide()),d.block&&(b=d))},this),b&&b.view.viewController.topParentViewController().responsiveLayout()}}),a.Action.Visible=d}),define("toast/actions/StopAllSound",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d),this.options.excludes||(this.options.excludes=[])},execute:function(){var a=$("audio");_.each(a,function(a){var b=$(a),c=b.closest(".toast-object");if(0!==c.length){var d=this.view.viewController._find({id:c.attr("id")});if(d&&d.view&&!this._skip(c)&&"function"==typeof d.view.stop)return d.view.stop(),!0}0!==a.readyState&&(this._skip(b)||"tt-bgsound"===b.attr("id")||(a.pause(),!0!==this.options.reset||_.isUndefined(a.currentTime)||(a.currentTime=0)))},this)},_skip:function(a){var b;return _.any(this.options.excludes,function(c){if(c===a.attr("id"))return b=!0,!0}),b}}),a.Action.StopAllSound=d}),define("toast/actions/ToggleSound",["../core","./Action","./StopAllSound"],function(a,b,c){"use strict";var d=b.prototype,e=b.extend();return _.extend(e.prototype,d,{initialize:function(b,c,e){d.initialize.call(this,b,c,e),this._asset=a.AudioAssets.get(this.properties.asset),_.isEmpty(this._asset)||(_.isEmpty(this._asset.id)?_.isEmpty(this.properties.url)||(this._assetid=this.properties.url.getBaseName().getFilenameWithoutExtension()):this._assetid=this._asset.id,this._assetid&&(this._$audio=this.view.viewController.$el.children("#"+this._assetid),_.isUndefined(this._$audio[0])&&(this._$audio=$("<audio />"),this._$audio.attr({id:this._assetid,src:this._getUrl()}),this._$audio.hide(),this.view.viewController.$el.append(this._$audio),this.view.__on__(a.Events.PAGE_DID_CHANGE,this._onPageDidChange,this))))},execute:function(){_.isEmpty(this._assetid)||(this._stopAllSoundOnce(),this._playAndPause())},_getUrl:function(){var b;return this._asset.url?b=this._asset.url:this.properties.url&&(b=this.properties.url,-1===b.indexOf("../")&&-1===b.indexOf("./")&&"http:"!==b.protocol()&&"https"!==b.protocol()&&(b="http://"+this.properties.url)),b&&(b=a.StringUtils.replaceTemplate(b).encodeFilePath()),b},_stopAllSoundOnce:function(){new c(this.view,this.properties,{excludes:[this._asset.id],reset:!0}).execute()},_playAndPause:function(){this._$audio[0].paused?this._$audio[0].play():this._$audio[0].pause()},_onPageDidChange:function(a,b){_.isUndefined(this._$audio[0])||0===this._$audio[0].readyState||this.view.viewController.current()||(this._$audio[0].pause(),_.isUndefined(this._$audio[0].currentTime)||(this._$audio[0].currentTime=0))},_onEnded:function(a){this._ended=!0}}),a.Action.ToggleSound=e}),define("toast/actions/PlaySound",["../core","./Action","./StopAllSound"],function(a,b,c){"use strict";var d=b.prototype,e=b.extend();return _.extend(e.prototype,d,{initialize:function(b,c,e){if(d.initialize.call(this,b,c,e),this._audioPlayer=this.properties.audioPlayer,!this._audioPlayer){if(this._asset=a.AudioAssets.get(this.properties.asset),_.isEmpty(this._asset))return;_.isEmpty(this._asset.id)?_.isEmpty(this.properties.url)||(this._assetid=this.properties.url.getBaseName().getFilenameWithoutExtension()):this._assetid=this._asset.id,this._assetid&&(this._$audio=this.view.viewController.$el.children("#"+this._assetid),_.isUndefined(this._$audio[0])&&(this._$audio=$("<audio />"),this._$audio.attr({id:this._assetid,src:this._getUrl()}),this._$audio.hide(),this.view.viewController.$el.append(this._$audio),this.view.__on__(a.Events.PAGE_DID_CHANGE,this._onPageDidChange,this)))}},execute:function(){if(this._audioPlayer){var b=a.Book.find({id:this._audioPlayer[0]});return void(b&&b.view&&(_.isEmpty(this.properties.asset)&&_.isEmpty(this.properties.url)||b.view.playFile(this.properties.asset,this.properties.url,{replay:this.properties.replay})))}_.isEmpty(this._assetid)||(this._stopAllSoundOnce(),this._play())},_getUrl:function(){var b;return this._asset.url?b=this._asset.url:this.properties.url&&(b=this.properties.url,-1===b.indexOf("../")&&-1===b.indexOf("./")&&"http:"!==b.protocol()&&"https"!==b.protocol()&&(b="http://"+this.properties.url)),b&&(b=a.StringUtils.replaceTemplate(b).encodeFilePath()),b},_stopAllSoundOnce:function(){new c(this.view,this.properties,{excludes:[this._asset.id],reset:!0}).execute()},_play:function(){0!==this._$audio[0].readyState&&(this._$audio[0].pause(),this.properties.replay&&!_.isUndefined(this._$audio[0].currentTime)&&(this._$audio[0].currentTime=0),this._$audio[0].play())},_stop:function(){_.isUndefined(this._$audio[0])||0===this._$audio[0].readyState||(this._$audio[0].pause(),_.isUndefined(this._$audio[0].currentTime)||(this._$audio[0].currentTime=0))},_onPageDidChange:function(a,b){this.view.viewController.current()||this._stop()}}),a.Action.PlaySound=e}),define("toast/actions/ToggleAudioPlayer",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){_.each(this.properties.targets,function(b){var c=a.Book.find({id:b});c&&(c.view.isVisible()?(c.view.hide(),c.view.pause()):(c.view.show(),!0===this.properties.autoplay&&c.view.play()))},this)}}),a.Action.ToggleAudioPlayer=d}),define("toast/actions/StopSound",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){var a=$("audio");_.each(a,function(a){var b=$(a);_.any(this.properties.assets,function(c){if(c===b.attr("id"))return 0!==a.readyState&&(a.pause(),!0!==this.properties.reset||_.isUndefined(a.currentTime)||(a.currentTime=0)),!0;if(c===b.attr("data-audio-id")){0!==a.readyState&&a.pause();return b.parents(".audioplayer").removeClass("audioplayer-playing"),!0!==this.properties.reset||_.isUndefined(a.currentTime)||(a.currentTime=0),b.trigger("timeupdate"),!0}},this)},this)}}),a.Action.StopSound=d}),define("toast/utils/StringUtils",["../core"],function(a){"use strict";_.extend(String.prototype,{trim:function(){return this.replace(/^\s+|\s+$/g,"")},repeat:function(){return new Array(1+n).join(this)},isNumeric:function(){return!jQuery.isArray(this)&&this-parseFloat(this)+1>=0},encodeFilePath:function(){if("file:"!==window.document.location.href.substr(0,5))return this;var b=this.split("/");b=b.map(function(a){return encodeURIComponent(a)});var c=b.join("/");return a.isBrackets&&"win"===a.platform&&(c="file:///"+c),c},protocol:function(){return this.substr(0,5)},camelCase:function(){return this.replace(/(?:^|\s)\w/g,function(a){return a.toUpperCase()})},pascalCase:function(a,b){return arguments.length<2&&(b=""),this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(a,b){return 0==b?a.toUpperCase():a.toLowerCase()}).replace(/\-/g,b)},isTag:function(){if(!this.length)return!1;var a=this.trim();return"<"===a.substr(0,1)&&">"===a.substr(a.length-1,1)},url:function(){if(this.isTag(this)){var a=this.match(/\bhttps?:\/\/\S+/gi);if(a)return a[0]}return this},removeTags:function(a){a=(((a||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var b=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,c=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return this.replace(c,"").replace(b,function(b,c){return a.indexOf("<"+c.toLowerCase()+">")>-1?b:""})},getBaseName:function(){var a=this,b=a.lastIndexOf("/");if(b===a.length-1)return a.slice(a.lastIndexOf("/",a.length-2)+1,-1);if(-1!==b)return a.slice(b+1);var c=a.lastIndexOf("}");return-1!==c?a.slice(c+1):a},getDirectoryPath:function(){return this.substr(0,this.lastIndexOf("/")+1)},getParentPath:function(){var a=this;return"/"===a?"":a.substring(0,a.lastIndexOf("/",a.length-2)+1)},getFileExtension:function(){var a=this.lastIndexOf(".");return-1===a?"":this.substr(a+1)},getFilenameWithoutExtension:function(){var a=this.lastIndexOf(".");return-1===a?this:this.slice(0,a)},prefix:function(a){return a+this},suffix:function(a){return this+a},namespace:function(a,b){for(var c=this.split(b||"."),d=window,e="",f=0,g=c.length;f<g;f++)e=c[f],d[e]=d[e]||{},d=d[e];return a&&(d[e]=a),d},isMultibyte:function(){for(var a=0,b=this.length;a<b;a++)if(this.charCodeAt(a)>255)return!0;return!1},replaceAll:function(a,b){return this.split(a).join(b)},secondsToTime:function(){var a=this.timeToSeconds(),b=Math.floor(a/3600),c=Math.floor(a%3600/60),d=Math.ceil(a%3600%60);return(0==b?"":(b>0&&b.toString().length,b+":"))+(c.toString().length,c)+":"+(d.toString().length<2?"0"+d:d)},timeToSeconds:function(){var a=this.split(":"),b=0,c=0,d=0;return a.length>=3?(b=Number(a[0].trim()),c=Number(a[1].trim()),d=Number(a[2].trim())):2==a.length?(c=Number(a[0].trim()),d=Number(a[1].trim())):a.length<2&&(d=Number(a[0].trim())),360*b+60*c+d},zeropad:function(a){var b=this+"";return b.length>=a?b:new Array(a-b.length+1).join("0")+b}});var b=a.StringUtils={templateStrings:{}};return _.extend(b,{trim:function(a){return a.replace(/^\s+|\s+$/g,"")},repeat:function(a){return new Array(1+n).join(a)},isNumeric:function(a){return!jQuery.isArray(a)&&a-parseFloat(a)+1>=0},encodeFilePath:function(b){if("file:"!==window.document.location.href.substr(0,5))return b;var c=b.split("/");c=c.map(function(a){return encodeURIComponent(a)});var d=c.join("/");return a.isBrackets&&"win"===a.platform&&(d="file:///"+d),d},format:function(a){var b=[].slice.call(arguments,1);return a.replace(/\{(\d+)\}/g,function(a,c){return void 0!==b[c]?b[c]:a})},replaceTemplate:function(a,b,c){if(1==arguments.length){if(_.isEmpty(a))return"";var d=a;return _.any(this.templateStrings,function(a,b){if(-1!==d.indexOf("{"+b+"}"))return d=d.replace(new RegExp("{"+b+"}","g"),a),!0}),d}return a.replace(new RegExp("{"+b+"}","g"),c)},regexEscape:function(a){return a.replace(/([.?*+\^$\[\]\\(){}|\-])/g,"\\$1")},jQueryIdEscape:function(a){return a.replace(/\./g,"\\.")},getLines:function(a){return a.split("\n")},offsetToLineNum:function(a,b){if(Array.isArray(a)){var c,d=a,e=0;for(c=0;c<d.length;c++){if(!(e<b))return e===b?c:c-1;e+=d[c].length+1}return b<=e?c-1:void 0}return a.substr(0,b).split("\n").length-1},endsWith:function(a,b){return-1!==a.indexOf(b,a.length-b.length)},urlSort:function(a,b){function c(a){return a.lastIndexOf("/")+1<a.length}var d,e;return"win"===Sunshine.platform?(d=(c(a)?"1":"0")+a.toLowerCase(),e=(c(b)?"1":"0")+b.toLowerCase()):(d=a.toLowerCase(),e=b.toLowerCase()),d===e?0:d>e?1:-1},breakableUrl:function(a){return _.escape(a).replace(new RegExp(this.regexEscape("/"),"g"),"/&#8203;")},prettyPrintBytes:function(a,b){var c=1024,d=1024*c,e=1024*d,f=1024*e,g=a;if(a>=0&&a<c)g=a+" B";else if(a<d)g=(a/c).toFixed(b)+" KB";else if(a<e)g=(a/d).toFixed(b)+" MB";else if(a<f)g=(a/e).toFixed(b)+" GB";else if(a>=f)return(a/f).toFixed(b)+" TB";return g},truncate:function(a,b){if(a.length>b){a=a.substr(0,b);var c=a.lastIndexOf(" ");return c<b&&c>-1&&(a=a.substr(0,c)),a}},prettyXml:function(a){var b=/(>)\s*(<)(\/*)/g,c=/ *(.*) +\n/g,d=/(<.+>)(.+\n)/g;a=a.replace(b,"$1\n$2$3").replace(c,"$1\n").replace(d,"$1\n$2");for(var e="",f=a.split("\n"),g=0,h="other",i={"single->single":0,"single->closing":-1,"single->opening":0,"single->other":0,"closing->single":0,"closing->closing":-1,"closing->opening":0,"closing->other":0,"opening->single":1,"opening->closing":0,"opening->opening":1,"opening->other":1,"other->single":0,"other->closing":-1,"other->opening":0,"other->other":0},j=0;j<f.length;j++){var k=f[j];if(k.match(/\s*<\?xml/))e+=k+"\n";else{var l=Boolean(k.match(/<.+\/>/)),m=Boolean(k.match(/<\/.+>/)),n=Boolean(k.match(/<[^!].*>/)),o=l?"single":m?"closing":n?"opening":"other",p=h+"->"+o;h=o;var q="";g+=i[p];for(var r=0;r<g;r++)q+="\t";"opening->closing"==p?e=e.substr(0,e.length-1)+k+"\n":e+=q+k+"\n"}}return e},naturalCompare:function(a,b){function c(a,b,e){if(e){for(d=b;(e=c(a,d))<76&&e>65;)++d;return+a.slice(b-1,d)}return e=i&&i.indexOf(a.charAt(b)),e>-1?e+76:(e=a.charCodeAt(b)||0)<45||e>127?e:e<46?65:e<48?e-1:e<58?e+18:e<65?e-11:e<91?e+11:e<97?e-37:e<123?e+5:e-63}var d,e,f=1,g=0,h=0,i=String.alphabet;if((a+="")!=(b+=""))for(;f;)if(e=c(a,g++),f=c(b,h++),e<76&&f<76&&e>66&&f>66&&(e=c(a,g,g),f=c(b,h,g=d),h=d),e!=f)return e<f?-1:1;return 0}}),b}),define("toast/actions/PopupActionBase",["../core","./Action"],function(a,b){"use strict";var c,d=b.prototype,e=b.extend();return _.extend(e.prototype,d,{initialize:function(b,e,f){c=a.HtmlLoader.Popup,d.initialize.call(this,b,e,f)},execute:function(){var b={modalDialogMaxWidth:this.properties.width},d=Mustache.render(c,b);this.$el=$(d),$(document.body).append(this.$el),a.showLoading(!0,{el:this.$el.find(".modal-body")}),this.$container=$("<div />",{class:"popup-container"}),_.isEmpty(this.properties.width)||this.$container.css("width",this.properties.width+"px"),_.isEmpty(this.properties.height)||this.$container.css("height",this.properties.height+"px"),this.$container.append(this._$render=this._render()),!0===this.properties.scrollbarHidden?(this.$container.css("overflow","hidden"),"IFRAME"===this._$render[0].tagName&&this._$render.attr("scrolling","no")):TT.isMobileDevice&&(this.$container.css({"overflow-y":"auto","-webkit-overflow-scrolling":"touch"}),this.$container.css("width","auto")),this._$render.hide(),this.$el.find(".modal-body").append(this.$container),this.$modalContent=this.$el.find(".modal-content"),this.$modalContent.css({left:"50%"}),this.$el.find(".close").on("click",$.proxy(this._dismiss,this)),this.$el.on("click",$.proxy(this._dismiss,this)),$(window).on("resize",$.proxy(this._didResize,this)),this._updateSize(),"IFRAME"===this._$render[0].tagName?TT.lazy(function(){this._$render.on("load",$.proxy(this._didLoadContent,this)),this._didPopupMount()},0,this):this._didPopupMount()},_render:function(){return $("<div />")},_didPopupMount:function(){},_didLoadContent:function(){this._$render.show(),a.showLoading(!1,{el:this.$el.find(".modal-body")}),this.$modalContent.css({left:"50%"}),this._updateSize()},_didResize:function(a){this._updateSize()},_updateSize:function(){var a=window.innerWidth,b=window.innerHeight;if(0!==this.$el.find(".modal-body").children(".close").length&&(a-=50),!_.isUndefined(this._$render)){var c,d,e=Math.max(this.properties.width/a,this.properties.height/b);this.properties.extractFit?(c=this.properties.width/e,d=this.properties.height/e):this.properties.width>a||this.properties.height>b?(c=this.properties.width/e,d=this.properties.height/e):(c=this.properties.width,d=this.properties.height),this.$container.css({width:c+"px",height:d+"px"}),this.$modalContent.css({width:this.$container.width()+"px",marginLeft:-this.$container.width()/2+"px"})}},_dismiss:function(a){$(window).off("resize",$.proxy(this._didResize,this)),"IFRAME"===this._$render[0].tagName&&this._$render.off("load",$.proxy(this._didLoadContent,this)),this.$el.remove(),this.$el=null}}),e}),define("toast/actions/PopupMovie",["../core","../utils/StringUtils","./PopupActionBase"],function(a,b,c){"use strict";var d=c.prototype,e=c.extend();return _.extend(e.prototype,d,{initialize:function(a,b,c){d.initialize.call(this,a,b,c),_.isUndefined(this.properties.scrollbarHidden)&&(this.properties.scrollbarHidden=!0)},execute:function(){d.execute.call(this)},_render:function(){return"youtube"==this.properties.playerType?this._renderYoutube():this._renderDefaltVideo()},_renderDefaltVideo:function(){var a=$('<video controls preload="auto" />').css({margin:0,padding:0});return this.properties.autoplay&&a.attr("autoplay","autoplay"),a},_renderYoutube:function(){return $("<iframe />",{frameborder:0,allowfullscreen:""})},_didPopupMount:function(){var b;b=1===a.project.parsedVersion.VERSION_MAJOR&&a.project.parsedVersion.VERSION_MINOR<9?this.properties.openWindow:this.properties.playerType;var c;if("youtube"==b?c=this.properties.url:this.properties.asset?c=a.MovieAssets.url(this.properties.asset):this.properties.url&&(c=a.StringUtils.replaceTemplate(this.properties.url).encodeFilePath()),"youtube"==this.properties.playerType){var d;-1!=c.substring(1,7).indexOf("iframe")&&(d=$(c).attr("src")),-1==c.indexOf("/embed/")&&(d=c.replace("youtu.be/","www.youtube.com/embed/")),this.properties.autoplay&&(d+="?autoplay=1"),this._$render.attr("src",d)}else{var e=$("<source >");e.attr("type","video/mp4"),e.attr("src",c),this._$render.append(e),this._$render.on("loadeddata",$.proxy(this._didLoadContent,this)),this._$render.load()}this._$render.on("click",$.proxy(this._videoClicked,this))},_didLoadContent:function(){d._didLoadContent.call(this)},_updateSize:function(){d._updateSize.call(this),this._$render.css({width:parseFloat(this.$container.css("width"))+"px",height:parseFloat(this.$container.css("height"))-50+"px"})},_dismiss:function(a){"default"===this.properties.playerType&&this._$render[0].removeEventListener("loadeddata",$.proxy(this._videoDidLoaded,this),!1),d._dismiss.call(this,a)},_videoClicked:function(a){a.stopPropagation()}}),a.Action.PopupMovie=e}),define("toast/actions/PopupImage",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){d||(d={start:0}),c.initialize.call(this,a,b,d),_.isUndefined(this.options.start)&&(this.options.start=0)},execute:function(){var b=this.properties.assets;if(!_.isUndefined(b)&&0!=b.length){var c=$("<ul />",{class:"iviewer-ul"});c.hide(),_.each(b,function(b){var d=a.ImageAssets.url(b);c.append('<li><img data-original-url="'+d+'" data-title="'+this.properties.title+'"></li>')},this),$(document.body).append(c);var d,e=!1,f=!0,g=1,h=!1;_.isUndefined(a.config.iviewer)||_.isUndefined(a.config.iviewer.zoomable)?_.isUndefined(this.properties.zoomable)||(e=this.properties.zoomable):e=a.config.iviewer.zoomable,d=e,_.isUndefined(a.config.iviewer)||_.isUndefined(a.config.iviewer.thumbnail)?_.isUndefined(this.properties.thumbnail)||(f=this.properties.thumbnail):f=a.config.iviewer.thumbnail,_.isUndefined(a.config.iviewer)||_.isUndefined(a.config.iviewer.defaultMaxZoomRatio)?_.isNumber(this.properties.maxZoomRatio)&&(g=Number(this.properties.maxZoomRatio)/100):g=a.config.iviewer.defaultMaxZoomRatio/100,_.isUndefined(a.config.iviewer)||_.isUndefined(a.config.iviewer.extractFit)||(h=a.config.iviewer.extractFit);var i=this,j={sender:this,url:"data-original",zoomable:e,movable:d,title:this.properties.title,description:this.properties.description,backgroundColor:this.properties.backgroundColor,toolbarColor:this.properties.toolbarColor,number:!!_.isUndefined(this.properties.number)||this.properties.number,maxZoomRatio:g,extractFit:h,navbar:f,zIndex:99991,shown:function(a){i.__iviewer__.view(i.options.start)},hidden:function(b){c.remove(),a.Book.enableAction(!0)}};this.__iviewer__=new a.ImageViewer(c[0],j),this.__iviewer__.show()}}}),a.Action.PopupImage=d}),define("toast/actions/PopupWindow",["../core","../utils/StringUtils","./Action"],function(a,b,c){"use strict";var d=c.prototype,e=c.extend();return _.extend(e.prototype,d,{initialize:function(a,b,c){d.initialize.call(this,a,b,c)},execute:function(){var c;if(_.isEmpty(this.properties.url))if(_.isUndefined(this.properties.relativePath)||_.isEmpty(this.properties.relativePath)){if(!_.isUndefined(this.properties.htmlfolder)&&!_.isEmpty(this.properties.htmlfolder)){var d=a.FolderAssets.get(this.properties.htmlfolder);c=b.replaceTemplate(d.url+"/"+d.htmlFilename).encodeFilePath()}}else{var e=this.properties.relativePath;c=b.replaceTemplate("{ASSETS_DIR}"+e).encodeFilePath()}else c=this.properties.url,c.isTag()&&(c=c.url()),-1===c.indexOf("../")&&-1===c.indexOf("./")&&"http:"!==c.protocol()&&"https"!==c.protocol()&&(c="http://"+this.properties.url);var f=screen.width/2-this.properties.width/2,g=screen.height/2-this.properties.height/2;if(_.isEmpty(window.__nw__))window.open(c,this.properties.title,"toolbar=no, location=no, top="+g+", left="+f+", width="+this.properties.width+", height="+this.properties.height);else{var h=window.__nw__.require("nw.gui"),i=h.Window.open(c,{title:this.properties.title,focus:!0,toolbar:!1});i.moveTo(f,g),i.resizeTo(this.properties.width,this.properties.height)}}}),a.Action.PopupWindow=e}),define("toast/actions/PopupLayper",["../core","../utils/StringUtils","./PopupActionBase"],function(a,b,c){"use strict";var d=c.prototype,e=c.extend();return _.extend(e.prototype,d,{initialize:function(a,b,c){d.initialize.call(this,a,b,c),_.isUndefined(this.properties.extractFit)&&(this.properties.extractFit=!1)},_render:function(){return $("<iframe />",{allowTransparency:!0}).css({margin:0,padding:0,width:"100%",height:"100%",border:0,display:"none"})},_didPopupMount:function(){var c;if(_.isUndefined(this.properties.url)||_.isEmpty(this.properties.url))if(_.isUndefined(this.properties.relativePath)||_.isEmpty(this.properties.relativePath)){if(!_.isUndefined(this.properties.htmlfolder)&&!_.isEmpty(this.properties.htmlfolder)){var d=a.FolderAssets.get(this.properties.htmlfolder);c=b.replaceTemplate(d.url+"/"+d.htmlFilename).encodeFilePath()}}else{var e=this.properties.relativePath;c=b.replaceTemplate("{ASSETS_DIR}"+e).encodeFilePath()}else c=this.properties.url,c.isTag()&&(c=c.url()),-1===c.indexOf("../")&&-1===c.indexOf("./")&&"http:"!==c.protocol()&&"https"!==c.protocol()&&(c="http://"+this.properties.url);this._$render.attr("src",c)}}),a.Action.PopupLayper=e}),define("toast/actions/PopupFlash",["../core","./PopupActionBase"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d),_.isUndefined(this.properties.scrollbarHidden)&&(this.properties.scrollbarHidden=!0)},execute:function(){a.isMobileDevice||c.execute.call(this)},_render:function(){return $("<div />",{id:this.id+"-flash"}).css({margin:0,padding:0,width:this.properties.width+"px",height:this.properties.height+"px"})},_didPopupMount:function(){var b;_.isUndefined(this.properties.asset)||_.isEmpty(this.properties.asset)?_.isUndefined(this.properties.url)||_.isEmpty(this.properties.url)||(b=this.properties.url,-1===b.indexOf("../")&&-1===b.indexOf("./")&&"http:"!==b.protocol()&&"https"!==b.protocol()&&(b="http://"+this.properties.url)):b=a.FlashAssets.url(this.properties.asset);var c={},d={scale:"exactFit",allowScriptAccess:"always"},e={};_.isEmpty(this.properties.bgcolor)?d.wmode="transparent":d.bgcolor=this._rgb2hex(this.properties.bgcolor),swfobject.embedSWF(b,this.id+"-flash","100%","100%","10",!1,c,d,e,$.proxy(this._swfLoadEvent,this))},_didLoadContent:function(){this._$render=this.$el.find("#"+this.id+"-flash"),c._didLoadContent.call(this)},_swfLoadEvent:function(a){if(!a.success||!a.ref)return!1;var b=this,c=setInterval(function(){if(void 0!==a.ref.PercentLoaded&&a.ref.PercentLoaded()){clearInterval(c);var d=setInterval(function(){100===a.ref.PercentLoaded()&&(b._didLoadContent(),clearInterval(d))},5)}},5)},_rgb2hex:function(a){return a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),a&&4===a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):""}}),a.Action.PopupFlash=d}),define("toast/actions/PopupMenu",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(b,d,e){if(c.initialize.call(this,b,d,e),!_.isEmpty(this.properties.targets)){this._openFn=$.proxy(this.open,this),this._closeFn=$.proxy(this.close,this);var f=a.Book.find({id:this.properties.targets[0]});if(f&&f.view)this.doInit(f);else var g=0,h=this,i=setInterval(function(){++g>=3&&clearInterval(i);var b=a.Book.find({id:h.properties.targets[0]});b&&b.view&&(h.doInit(b),clearInterval(i))},500)}},doInit:function(a){switch(a.properties.visible=!1,this._popup=a.view,this.setPosition(),a.view.hide(),this._popup.$parent.css("zIndex",1050),this.options.eventType){case"mouseover":this._popup.$parent.hover(this._openFn,this._closeFn),this.view.$parent.on("mouseout",this._closeFn)}},setPosition:function(){if(!_.isUndefined(this._popup)){var a={};switch(this.properties.position){case"rightCenter":a={left:this.view.model.width,top:(this.view.model.height-this._popup.model.height)/2};break;case"rightBottom":a={left:this.view.model.width,top:this.view.model.height-this._popup.model.height};break;case"leftTop":a={left:-this._popup.model.width,top:0};break;case"leftCenter":a={left:-this._popup.model.width,top:(this.view.model.height-this._popup.model.height)/2};break;case"leftBottom":a={left:-this._popup.model.width,top:this.view.model.height-this._popup.model.height};break;case"topLeft":a={left:0,top:-this._popup.model.height};break;case"topCenter":a={left:(this.view.model.width-this._popup.model.width)/2,top:-this._popup.model.height};break;case"topRight":a={left:this.view.model.width-this._popup.model.width,top:-this._popup.model.height};break;case"bottomLeft":a={left:0,top:this.view.model.height};break;case"bottomCenter":a={left:(this.view.model.width-this._popup.model.width)/2,top:this.view.model.height};break;case"bottomRight":a={left:this.view.model.width,top:this.view.model.height};break;default:a={left:this.view.model.width,top:0}}a.left+=this.view.model.left,_.isUndefined(this.properties.offsetX)||isNaN(this.properties.offsetX)||(a.left+=this.properties.offsetX),a.top+=this.view.model.top,_.isUndefined(this.properties.offsetY)||isNaN(this.properties.offsetY)||(a.top+=this.properties.offsetY),this._popup.position(a)}},execute:function(){if(this._popup)return this.isPopup?void("click"===this.options.eventType&&this.close()):void this.open()},open:function(){this.isPopup=!0,a.common.setActivePopupMenu(this),this._popup.show(),this._popup.$parent.addClass("__popup__")},close:function(){this.isPopup=!1,this._popup.hide(),this._popup.$parent.removeClass("__popup__")}}),a.Action.PopupMenu=d}),define("toast/actions/CloseWindow",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){if(this.properties.confirm){var b=this.properties.message;_.isEmpty(b)&&(b=a.Strings.CLOSE_WINDOW_ACTION_DEFAULT_CONFIRM_MESSAGE);1==confirm(b)&&("undefined"!=typeof external&&void 0!==external.appExit?external.appExit():a.topWindow().close())}else"undefined"!=typeof external&&void 0!==external.appExit?external.appExit():a.topWindow().close()}}),a.Action.CloseWindow=d}),define("toast/actions/OpenPartialZoom",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){if(!_.isUndefined(this.properties.targets)&&!_.isEmpty(this.properties.targets)){var b=this.properties.targets[0],c=a.Book.find({id:b});_.isNull(c)||_.isUndefined(c.view)||_.isUndefined(this.properties.targets)||_.isUndefined(c.view.$el.closest("#partial-zoom-modal")[0])&&c.view.open()}}}),a.Action.OpenPartialZoom=d}),define("toast/utils/PopupSubpage",["exports","../core"],function(a,b){"use strict";function c(a){var b;return _.each(k,function(c){if(c.model.id==a)return b=c,!1}),b}function d(a){return 0!==$(document.body).children("#"+a+"-dialog").length}function e(a){var c=k.indexOf(a);k.splice(c,1),0===k.length&&($(window).off("resize",f),a.options.modal&&b.Book.enableAction(!0))}function f(a){j||b.lazyOnce(function(){_.each(k,function(a){a._layout()})},5,m,this)}function g(a,b){if(!d(b.subpage)){var c=new l(a,b);c.open(),k.push(c),1===k.length&&$(window).on("resize",f)}}function h(a){var b=c(a);b&&b.close()}function i(){_.each(k,function(a){a.close()}),k=[]}var j,k=b.popups=[],l=function(a,b){this.initialize.apply(this,arguments)};_.extend(l.prototype,{initialize:function(a,b){this.model=a,this.view=b.view,this.options=b},open:function(){if(!_.isEmpty(this.model)&&!this._isOpen()){this.options.autoClose&&(this._pageDidChangeHandlerProxy=$.proxy(this._pageDidChangeHandler,this),b.on(b.Events.PAGE_DID_CHANGE,this._pageDidChangeHandlerProxy)),this.options.modal&&b.Book.enableAction(!1),this._createHTMLDocument();var a=$(document.body).children("#"+this._getDialogId()),c=this;this.dialogInstance=a.dialog({title:this.options.title,autoOpen:!0,uiLibrary:"bootstrap",draggable:this.options.draggable,resizable:this.options.resizable,modal:this.options.modal,dragStart:function(a){c._isDrag=!0,c._bringToMostTop()},dragStop:function(a){c._isDrag||c._bringToMostTop(),c._setInitTargetSize(),c._setPageOffset(),c._isDrag&&c._setCenterOffset(),c._isDrag=!1},resizeStart:function(a){j=!0},resize:function(a){c._setDialogBody(),tt.Book.fitPage(c.viewController)},resizeStop:function(a){j=!1,c._setInitTargetSize(),c._setInitDialogSize(),c._setCenterOffset(),c._setPageOffset(),c._setNaturalSize()},closed:function(a){c.close()}}),this.dialogInstance.parent().hasClass("modal")?(this.dialogInstance.parent().addClass("subpage-modal white-background"),this.dialogInstance.parent().css("zIndex",99990)):this.dialogInstance.css("zIndex",99990),this.dialogInstance.addClass("subpage-modal-content"),this._setModalConfig(),this.dialogInstance.open(),this.dialogInstance.data({minWidth:this._getMinSize().width,minHeight:this._getMinSize().height}),this._setInitTargetSize(),this._setDialogBestSize(),this._setInitDialogSize(),this._setDialogBody(this.dialogInstance.find(".modal-body")),this._render(),this._setPosition(),this._setPageOffset(),this._setCenterOffset(),this._layout(),this.dialogInstance.off("draginit drag dragstart dragend")}},_setModalConfig:function(){var a=this.dialogInstance.find(".modal-header");if(0!==a.length){this.options.hiddenTitlebar&&a.hide(),this.options.headerBackgroundColor&&a.css("backgroundColor",this.options.headerBackgroundColor),this.options.titleTextColor&&(a.css("color",this.options.titleTextColor),a.find(".close").css("color",this.options.titleTextColor));var b=this.dialogInstance.find(".modal-body");this.options.bodyBackgroundColor&&b.css("backgroundColor",this.options.bodyBackgroundColor)}},_setInitTargetSize:function(){var a=this._getTargetInfo();this._initTargetSize={width:a.width,height:a.height}},_setInitDialogSize:function(){this._initDialogSize={width:this.dialogInstance.outerWidth(),height:this.dialogInstance.outerHeight()}},_setDialogSize:function(a){this.dialogInstance.css({width:a.width+"px",height:a.height+"px"})},_setDialogBestSize:function(){this._setDialogSize(this._getBestSize())},_setMagneticDialogSize:function(){if(!this.options.resizable)return this._setDialogSize({width:this.viewController.$el.width(),height:this.viewController.$el.height()+this._getHeaderFooterHeight()}),void this._setDialogBody();var a={width:this.dialogInstance.outerWidth(),height:this.dialogInstance.outerHeight()},b=Math.min(a.width/this._initDialogSize.width,a.height/this._initDialogSize.height),c={left:this._pageOffset.left*b,top:this._pageOffset.top*b};Math.floor(c.left)<=4?a.width=this.viewController.$el.width():a.width=this.viewController.$el.width()+2*c.left,Math.floor(c.top)<=4?a.height=this.viewController.$el.height()+this._getHeaderFooterHeight():a.height=this.viewController.$el.height()+this._getHeaderFooterHeight()+2*c.top,this._setDialogSize(a),this._setDialogBody(),tt.Book.fitPage(this.viewController)},_setDialogBody:function(a){a&&(this.$modalBody=a);var b=this.dialogInstance.height();b-=this._getHeaderFooterHeight(),this.$modalBody.css({width:"100%",margin:0,padding:0,height:b+"px"})},_getTargetInfo:function(){var a;a="window"===this.options.positionTarget?$(window):b.Book.$getBook();var c={width:a.width(),height:a.height(),offset:"window"===this.options.positionTarget?{left:0,top:0}:a.offset()};return c.center={x:c.offset.left+a.width()/2,y:c.offset.top+a.height()/2},c},_setPosition:function(){var a,b;this.dialogInstance.css("position","absolute");var c=this._getTargetInfo(),d={width:this.dialogInstance.outerWidth(),height:this.dialogInstance.outerHeight()};"auto"===this.options.position?(a=this.view.$el.parent().offset().left+this.view.$el.parent().width()/2-this.dialogInstance.width()/2,b=this.view.$el.parent().offset().top+this.view.$el.parent().height()/2-this.dialogInstance.height()/2):"center"===this.options.position?(a=c.center.x-d.width/2,b=c.center.y-d.height/2):"leftTop"===this.options.position?(a=c.offset.left+10,b=c.offset.top+10):"leftCenter"===this.options.position?(a=c.offset.left+10,b=c.center.y-d.height/2):"leftBottom"===this.options.position?(a=c.offset.left+10,b=c.offset.top+c.height-(d.height+10)):"rightTop"===this.options.position?(a=c.offset.left+c.width-(d.width+10),b=c.offset.top):"rightCenter"===this.options.position?(a=c.offset.left+c.width-(d.width+10),b=c.center.y-this.dialogInstance.height()/2):"rightBottom"===this.options.position?(a=c.offset.left+c.width-(d.width+10),b=c.offset.top+c.height-(d.height+10)):"centerTop"===this.options.position?(a=c.center.x-d.width/2,b=c.offset.top+10):"centerBottom"===this.options.position?(a=c.center.x-d.width/2,b=c.offset.top+c.height-(d.height+10)):(a=c.center.x-d.width/2,b=c.center.y-d.height/2);var e=this._getShowAllAvalidOffset({left:a,top:b});this.dialogInstance.css("left",e.left+"px"),this.dialogInstance.css("top",e.top+"px")},_getDialogId:function(){return this.options.subpage+"-dialog"},_getHeaderHeight:function(){var a=0,b=this.dialogInstance.find(".modal-header");return 0!==b.length&&(a=b.outerHeight()),a},_getHeaderFooterHeight:function(){var a=0,b=this.dialogInstance.find(".modal-header");0===b.length||this.options.hiddenTitlebar||(a=b.outerHeight());var c=this.dialogInstance.find(".modal-footer");return 0!==c.length&&(a+=c.outerHeight()),a},_setNaturalSize:function(){var a=(Math.max(this.model.width,this.dialogInstance.outerWidth()),this.dialogInstance.outerWidth()/this.dialogInstance.outerHeight());this.__naturalSize__.width=this.dialogInstance.outerWidth(),this.__naturalSize__.height=Math.floor(this.dialogInstance.outerWidth()/a)},_getBestSize:function(){var a={};this.__naturalSize__?a={width:this.dialogInstance.outerWidth(),height:this.dialogInstance.outerHeight()}:(this.__naturalSize__={width:Number(this.model.width),height:Number(this.model.height)+this._getHeaderFooterHeight()},a=this.__naturalSize__);var b=Math.min(($(window).width()-20)/a.width,($(window).height()-20)/a.height);return this.options.extractFit?{width:Math.max(this.__naturalSize__.width,a.width*b),height:Math.max(this.__naturalSize__.height,a.height*b)}:{width:Math.min(this.__naturalSize__.width,a.width*b),height:Math.min(this.__naturalSize__.height,a.height*b)}},_getTargetScale:function(){var a=this._getTargetInfo();return Math.min(a.width/this._initTargetSize.width,a.height/this._initTargetSize.height)},_createHTMLDocument:function(){var a=$("<div />",{id:this._getDialogId()});a.hide(),$(document.body).append(a)},_isOpen:function(){return 0!==$(document.body).children("#"+this._getDialogId()).length},_render:function(){var a=$("<div />",{id:this.model.id,class:"toast-ctrl "+b.CURRENT_PAGE});this.$modalBody.append(a);var c=new tt.ViewController({el:a});c.load(this.model.toJSON(),{htmlRender:!1,showLoader:!0,readyonly:!0}),c.modal=!0,c.willAppear(),c.ready(function(){c.$el.css("opacity",1),tt.Book.fitPage(c),c.appear()}),this.model.background&&this.model.background.color&&this.dialogInstance.css("backgroundColor",this.model.background.color),this.dialogInstance.css("width",c.$el.width()+"px"),this.dialogInstance.css("height",c.$el.height()+this._getHeaderFooterHeight()+"px"),this.$modalBody.css({height:c.$el.height()+"px"}),this.viewController=c},_bringToMostTop:function(){var a=this.dialogInstance.parent().children(".subpage-modal-content").last();a.attr("id")!==this.dialogInstance.attr("id")&&a.after(this.dialogInstance)},_setPageOffset:function(){this._pageOffset={left:Math.abs(this.viewController.$el.offset().left-this.$modalBody.offset().left),top:Math.abs(this.viewController.$el.offset().top-this.$modalBody.offset().top)}},_setCenterOffset:function(){var a=this._getTargetInfo();this._centerOffset={x:a.center.x-(this.dialogInstance.offset().left+this.dialogInstance.outerWidth()/2),y:a.center.y-(this.dialogInstance.offset().top+this.dialogInstance.outerHeight()/2)}},_getAvalidOffset:function(a){return a.left=Math.max(-(this.dialogInstance.outerWidth()-50),a.left),a.top=Math.max(10,a.top),a.top=Math.min($(window).height()-(this._getHeaderHeight()+30),a.top),a},_getShowAllAvalidOffset:function(a){return a||(a=this.dialogInstance.offset()),a.left=Math.min($(window).width()-(this.dialogInstance.outerWidth()+10),a.left),a.left=Math.max(10,a.left),a.top=Math.min($(window).height()-(this.dialogInstance.outerHeight()+10),a.top),a.top=Math.max(10,a.top),a},_getMaxSize:function(){return{width:Number(this.model.width),height:Number(this.model.height)+this._getHeaderFooterHeight()}},_getMinSize:function(){return{width:100,height:this.model.height*(100/this.model.width)+this._getHeaderFooterHeight()}},_layout:function(){this._getMaxSize(),this._getMinSize();this._setDialogBestSize(),this._setDialogBody(),tt.Book.fitPage(this.viewController),this._setMagneticDialogSize();var a={width:this.dialogInstance.outerWidth(),height:this.dialogInstance.outerHeight()},b=this._getTargetInfo(),c=this._getTargetScale(),d={x:b.center.x-this._centerOffset.x*c,y:b.center.y-this._centerOffset.y*c},e={left:d.x-a.width/2,top:d.y-a.height/2};e=this._getShowAllAvalidOffset(e),this.dialogInstance.css("left",e.left+"px"),this.dialogInstance.css("top",e.top+"px")},_pageDidChangeHandler:function(){this.options.autoClose&&this.close()},close:function(){var a;this.dialogInstance.parent().hasClass("modal")&&(a=this.dialogInstance.parent()),this.viewController&&(this.viewController.reset(),delete this.viewController),this.dialogInstance.draggable().destroy(),this.dialogInstance.remove(),this.$modalBody=null,a&&a.remove(),this.__naturalSize__=null,this._pageDidChangeHandlerProxy&&b.off(b.Events.PAGE_DID_CHANGE,this._pageDidChangeHandlerProxy),e(this)}});var m={};a.open=g,a.close=h,a.closeAll=i,b.PopupSubpage=a}),define("toast/actions/OpenPopupSubpage",["../core","../utils/PopupSubpage","./Action"],function(a,b,c){"use strict";var d=c.prototype,e=c.extend();return _.extend(e.prototype,d,{initialize:function(a,b,c){d.initialize.call(this,a,b,c)},execute:function(){var c=this.view.viewController.findSubpage(this.properties.subpage);if(c||(c=_.find(a.project.subpages.models,{id:this.properties.subpage})),!c&&a.view&&(c=a.view.findSubpage(this.properties.subpage)),c){var d=_.extend({view:this.view},this.properties);b.open(c,d)}}}),a.Action.OpenPopupSubpage=e}),define("toast/actions/ClosePopupSubpage",["../core","../utils/PopupSubpage","./Action"],function(a,b,c){"use strict";var d=c.prototype,e=c.extend();return _.extend(e.prototype,d,{initialize:function(a,b,c){d.initialize.call(this,a,b,c)},execute:function(){b.close(this.properties.subpage)}}),a.Action.ClosePopupSubpage=e}),define("toast/actions/OpenSubpage",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){var b=this.view.viewController.findSubpage(this.properties.subpage);if(b||(b=_.find(a.project.subpages.models,{id:this.properties.subpage})),b){_.extend({view:this.view},this.properties)}}}),a.Action.OpenSubpage=d}),define("toast/actions/CloseSubpage",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){var b=this.view.viewController.findSubpage(this.properties.subpage);if(b||(b=_.find(a.project.subpages.models,{id:this.properties.subpage})),b){_.extend({view:this.view},this.properties)}}}),a.Action.CloseSubpage=d}),define("toast/actions/WidgetAction",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(b,d,e){c.initialize.call(this,b,d,e),a.lazy(function(){this._lazyInitialize()},5,this)},_lazyInitialize:function(){this._widget=this._findWidget(),this._widget&&this._widget.view&&(this._widget.view.on("changeState",$.proxy(this.widgetChangeState,this)),this.widgetChangeState(this.properties.widgetActionName,this._widget.properties[this.properties.widgetActionName]))},_findWidget:function(){return a.Book.find({id:this.properties.widgetId})},widgetChangeState:function(b,c){this.properties.widgetActionName===b&&(this.view instanceof a.UIButton||this.view instanceof a.UIImageButton)&&(c&&c!==this.properties.widgetActionParameter?this.view.setState("normal"):this.view.setState("selected"))},execute:function(){_.isEmpty(this.properties.widgetId)||_.isEmpty(this.properties.widgetActionName)||(this._widget||(this._widget=this._findWidget()),this._widget&&this._widget.view&&a.hasFunctionByName(this.properties.widgetActionName,this._widget.view)&&a.executeFunctionByName(this.properties.widgetActionName,this._widget.view,this.properties.widgetActionParameter,this._widget.view))}}),a.Action.WidgetAction=d}),define("toast/actions/ChangeState",["../core","../utils/PopupSubpage","./Action"],function(a,b,c){"use strict";var d=c.prototype,e=c.extend();return _.extend(e.prototype,d,{initialize:function(a,b,c){d.initialize.call(this,a,b,c),_.isEmpty(this.properties.targets)&&(this._target=a.model)},execute:function(){this._target||(this._target=a.Book.find({id:this.properties.targets[0]})),this._target&&(_.isEmpty(this.properties.state)||this._target.view.state(this.properties.state))}}),a.Action.ChangeState=e}),define("toast/actions/SetTextStyle",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){_.each(this.properties.targets,function(b){var c=a.Book.find({id:b});if(c&&!c.__attributes__){var d={color:this.properties.color,fontSize:this.properties.size};this.properties.bold&&(d.fontWeight="bold"),c.view.setTextStyle(d)}},this)}}),a.Action.SetTextStyle=d}),define("toast/actions/ChangeOrder",["../core","../utils/PopupSubpage","./Action"],function(a,b,c){"use strict";var d=c.prototype,e=c.extend();return _.extend(e.prototype,d,{initialize:function(a,b,c){d.initialize.call(this,a,b,c),_.isEmpty(this.properties.targets)&&(this.properties.targets=[a.model.id])},getIndex:function(a){a||(a={q:"top"});var b="top"===a.q?1:-1,c=this.view.viewController.$contents.children();return _.each(c,function(c){var d=$(c),e=Number(d.css("zIndex"));isNaN(e)||("top"===a.q?e>=b&&(b=e+1):e<=b&&(b=e-1))},this),b},execute:function(){var b;"top"===this.properties.order?b=this.getIndex({q:"top"}):"bottom"===this.properties.order&&(b=this.getIndex({q:"bottom"})),_.each(this.properties.targets,function(c){var d=a.Book.find({id:c});if(d){var e=d.view.$parent.css("zIndex"),f=d.view.$parent.attr("data-zindex");e&&!f&&d.view.$parent.attr("data-zindex",e),"top"===this.properties.order?d.view.$parent.css("zIndex",b++):"bottom"===this.properties.order?d.view.$parent.css("zIndex",b--):"restore"===this.properties.order&&(f?d.view.$parent.css("zIndex",f):d.view.$parent.css("zIndex",""))}},this)}}),a.Action.ChangeOrder=e}),define("toast/actions/Reset",["../core","../utils/PopupSubpage","./Action"],function(a,b,c){"use strict";var d=c.prototype,e=c.extend();return _.extend(e.prototype,d,{initialize:function(a,b,c){d.initialize.call(this,a,b,c)},execute:function(){if(_.isEmpty(this.properties.targets))return void _.each(this.view.viewController.collection.models,function(a){a.view&&!a.__attributes__&&a.view.reset()},this);_.each(this.properties.targets,function(b){var c=a.Book.find({id:b});c&&!c.__attributes__&&c.view.reset()},this)}}),a.Action.Reset=e}),define("toast/actions/SendDropResult",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){}}),a.Action.SendDropResult=d}),define("toast/actions/SaveWidgetData",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){}}),a.Action.SaveWidgetData=d}),define("toast/actions/SetWidgetData",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){}}),a.Action.SetWidgetData=d}),define("toast/actions/ScrollTo",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){if(this.properties.top)return void(window.location.hash="scroll-top-el");var a=String(this.properties.position);if(!_.isEmpty(a)){if("#"===a.substr(0,1)){var b=a.substr(1);return void(window.location.hash=b)}switch(a){case"top":window.location.hash="scroll-top-el"}}}}),a.Action.ScrollTo=d}),define("toast/actions/FunctionCall",["../core","./Action"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,d){c.initialize.call(this,a,b,d)},execute:function(){if(!_.isEmpty(this.properties.name)&&a.hasFunctionByName(this.properties.name,window)){for(var b=this.properties.args,c=this.properties.name.split("."),d=c.pop(),e=window,f=0;f<c.length;f++)e=e[c[f]];e[d].apply(e,b)}}}),a.Action.FunctionCall=d}),define("toast/actions",["exports","./core","./actions/LinkUrl","./actions/GotoPage","./actions/Visible","./actions/ToggleSound","./actions/PlaySound","./actions/ToggleAudioPlayer","./actions/StopAllSound","./actions/StopSound","./actions/PopupMovie","./actions/PopupImage","./actions/PopupWindow","./actions/PopupLayper","./actions/PopupFlash","./actions/PopupMenu","./actions/CloseWindow","./actions/OpenPartialZoom","./actions/OpenPopupSubpage","./actions/ClosePopupSubpage","./actions/OpenSubpage","./actions/CloseSubpage","./actions/WidgetAction","./actions/ChangeState","./actions/SetTextStyle","./actions/ChangeOrder","./actions/Reset","./actions/SendDropResult","./actions/SaveWidgetData","./actions/SetWidgetData","./actions/ScrollTo","./actions/FunctionCall"],function(a,b){}),function(a){"use strict";function b(a){var b=a.length,d=c.type(a);return"function"!==d&&!c.isWindow(a)&&(!(1!==a.nodeType||!b)||("array"===d||0===b||"number"==typeof b&&b>0&&b-1 in a))}if(!a.jQuery){var c=function(a,b){return new c.fn.init(a,b)};c.isWindow=function(a){return a&&a===a.window},c.type=function(a){return a?"object"==typeof a||"function"==typeof a?e[g.call(a)]||"object":typeof a:a+""},c.isArray=Array.isArray||function(a){return"array"===c.type(a)},c.isPlainObject=function(a){var b;if(!a||"object"!==c.type(a)||a.nodeType||c.isWindow(a))return!1;try{if(a.constructor&&!f.call(a,"constructor")&&!f.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(a){return!1}for(b in a);return void 0===b||f.call(a,b)},c.each=function(a,c,d){var e=0,f=a.length,g=b(a);if(d){if(g)for(;e<f&&!1!==c.apply(a[e],d);e++);else for(e in a)if(a.hasOwnProperty(e)&&!1===c.apply(a[e],d))break}else if(g)for(;e<f&&!1!==c.call(a[e],e,a[e]);e++);else for(e in a)if(a.hasOwnProperty(e)&&!1===c.call(a[e],e,a[e]))break;return a},c.data=function(a,b,e){if(void 0===e){var f=a[c.expando],g=f&&d[f];if(void 0===b)return g;if(g&&b in g)return g[b]}else if(void 0!==b){var h=a[c.expando]||(a[c.expando]=++c.uuid);return d[h]=d[h]||{},d[h][b]=e,e}},c.removeData=function(a,b){var e=a[c.expando],f=e&&d[e];f&&(b?c.each(b,function(a,b){delete f[b]}):delete d[e])},c.extend=function(){var a,b,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[i]||{},i++),"object"!=typeof h&&"function"!==c.type(h)&&(h={}),i===j&&(h=this,i--);i<j;i++)if(f=arguments[i])for(e in f)f.hasOwnProperty(e)&&(a=h[e],d=f[e],h!==d&&(k&&d&&(c.isPlainObject(d)||(b=c.isArray(d)))?(b?(b=!1,g=a&&c.isArray(a)?a:[]):g=a&&c.isPlainObject(a)?a:{},h[e]=c.extend(k,g,d)):void 0!==d&&(h[e]=d)));return h},c.queue=function(a,d,e){function f(a,c){var d=c||[];return a&&(b(Object(a))?function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;)a[e++]=b[d++];if(c!==c)for(;void 0!==b[d];)a[e++]=b[d++];a.length=e}(d,"string"==typeof a?[a]:a):[].push.call(d,a)),d}if(a){d=(d||"fx")+"queue";var g=c.data(a,d);return e?(!g||c.isArray(e)?g=c.data(a,d,f(e)):g.push(e),g):g||[]}},c.dequeue=function(a,b){c.each(a.nodeType?[a]:a,function(a,d){b=b||"fx";var e=c.queue(d,b),f=e.shift();"inprogress"===f&&(f=e.shift()),f&&("fx"===b&&e.unshift("inprogress"),f.call(d,function(){c.dequeue(d,b)}))})},c.fn=c.prototype={init:function(a){if(a.nodeType)return this[0]=a,this;throw new Error("Not a DOM node.")},offset:function(){var b=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:b.top+(a.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:b.left+(a.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function a(a){for(var b=a.offsetParent;b&&"html"!==b.nodeName.toLowerCase()&&b.style&&"static"===b.style.position;)b=b.offsetParent;return b||document}var b=this[0],d=a(b),e=this.offset(),f=/^(?:body|html)$/i.test(d.nodeName)?{top:0,left:0}:c(d).offset();return e.top-=parseFloat(b.style.marginTop)||0,e.left-=parseFloat(b.style.marginLeft)||0,d.style&&(f.top+=parseFloat(d.style.borderTopWidth)||0,f.left+=parseFloat(d.style.borderLeftWidth)||0),{top:e.top-f.top,left:e.left-f.left}}};var d={};c.expando="velocity"+(new Date).getTime(),c.uuid=0;for(var e={},f=e.hasOwnProperty,g=e.toString,h="Boolean Number String Function Array Date RegExp Object Error".split(" "),i=0;i<h.length;i++)e["[object "+h[i]+"]"]=h[i].toLowerCase();c.fn.init.prototype=c.fn,a.Velocity={Utilities:c}}}(window),function(a){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=a():"function"==typeof define&&define.amd?define("toast/animations/_velocity",a):a()}(function(){"use strict";return function(a,b,c,d){function e(a){for(var b=-1,c=a?a.length:0,d=[];++b<c;){var e=a[b];e&&d.push(e)}return d}function f(a){return u.isWrapped(a)?a=s.call(a):u.isNode(a)&&(a=[a]),a}function g(a){var b=o.data(a,"velocity");return null===b?d:b}function h(a,b){var c=g(a);c&&c.delayTimer&&!c.delayPaused&&(c.delayRemaining=c.delay-b+c.delayBegin,c.delayPaused=!0,clearTimeout(c.delayTimer.setTimeout))}function i(a,b){var c=g(a);c&&c.delayTimer&&c.delayPaused&&(c.delayPaused=!1,c.delayTimer.setTimeout=setTimeout(c.delayTimer.next,c.delayRemaining))}function j(a){return function(b){return Math.round(b*a)*(1/a)}}function k(a,c,d,e){function f(a,b){return 1-3*b+3*a}function g(a,b){return 3*b-6*a}function h(a){return 3*a}function i(a,b,c){return((f(b,c)*a+g(b,c))*a+h(b))*a}function j(a,b,c){return 3*f(b,c)*a*a+2*g(b,c)*a+h(b)}function k(b,c){for(var e=0;e<p;++e){var f=j(c,a,d);if(0===f)return c;c-=(i(c,a,d)-b)/f}return c}function l(){for(var b=0;b<t;++b)x[b]=i(b*u,a,d)}function m(b,c,e){var f,g,h=0;do{g=c+(e-c)/2,f=i(g,a,d)-b,f>0?e=g:c=g}while(Math.abs(f)>r&&++h<s);return g}function n(b){for(var c=0,e=1,f=t-1;e!==f&&x[e]<=b;++e)c+=u;--e;var g=(b-x[e])/(x[e+1]-x[e]),h=c+g*u,i=j(h,a,d);return i>=q?k(b,h):0===i?h:m(b,c,c+u)}function o(){y=!0,a===c&&d===e||l()}var p=4,q=.001,r=1e-7,s=10,t=11,u=1/(t-1),v="Float32Array"in b;if(4!==arguments.length)return!1;for(var w=0;w<4;++w)if("number"!=typeof arguments[w]||isNaN(arguments[w])||!isFinite(arguments[w]))return!1;a=Math.min(a,1),d=Math.min(d,1),a=Math.max(a,0),d=Math.max(d,0);var x=v?new Float32Array(t):new Array(t),y=!1,z=function(b){return y||o(),a===c&&d===e?b:0===b?0:1===b?1:i(n(b),c,e)};z.getControlPoints=function(){return[{x:a,y:c},{x:d,y:e}]};var A="generateBezier("+[a,c,d,e]+")";return z.toString=function(){return A},z}function l(a,b){var c=a;return u.isString(a)?y.Easings[a]||(c=!1):c=u.isArray(a)&&1===a.length?j.apply(null,a):u.isArray(a)&&2===a.length?z.apply(null,a.concat([b])):!(!u.isArray(a)||4!==a.length)&&k.apply(null,a),!1===c&&(c=y.Easings[y.defaults.easing]?y.defaults.easing:x),c}function m(a){if(a){var b=y.timestamp&&!0!==a?a:r.now(),c=y.State.calls.length;c>1e4&&(y.State.calls=e(y.State.calls),c=y.State.calls.length);for(var f=0;f<c;f++)if(y.State.calls[f]){var h=y.State.calls[f],i=h[0],j=h[2],k=h[3],l=!!k,q=null,s=h[5],t=h[6];if(k||(k=y.State.calls[f][3]=b-16),s){if(!0!==s.resume)continue;k=h[3]=Math.round(b-t-16),h[5]=null}t=h[6]=b-k;for(var v=Math.min(t/j.duration,1),w=0,x=i.length;w<x;w++){var z=i[w],B=z.element;if(g(B)){var D=!1;if(j.display!==d&&null!==j.display&&"none"!==j.display){if("flex"===j.display){var E=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];o.each(E,function(a,b){A.setPropertyValue(B,"display",b)})}A.setPropertyValue(B,"display",j.display)}j.visibility!==d&&"hidden"!==j.visibility&&A.setPropertyValue(B,"visibility",j.visibility);for(var F in z)if(z.hasOwnProperty(F)&&"element"!==F){var G,H=z[F],I=u.isString(H.easing)?y.Easings[H.easing]:H.easing;if(u.isString(H.pattern)){var J=1===v?function(a,b,c){var d=H.endValue[b];return c?Math.round(d):d}:function(a,b,c){var d=H.startValue[b],e=H.endValue[b]-d,f=d+e*I(v,j,e);return c?Math.round(f):f};G=H.pattern.replace(/{(\d+)(!)?}/g,J)}else if(1===v)G=H.endValue;else{var K=H.endValue-H.startValue;G=H.startValue+K*I(v,j,K)}if(!l&&G===H.currentValue)continue;if(H.currentValue=G,"tween"===F)q=G;else{var L;if(A.Hooks.registered[F]){L=A.Hooks.getRoot(F);var M=g(B).rootPropertyValueCache[L];M&&(H.rootPropertyValue=M)}var N=A.setPropertyValue(B,F,H.currentValue+(p<9&&0===parseFloat(G)?"":H.unitType),H.rootPropertyValue,H.scrollData);A.Hooks.registered[F]&&(A.Normalizations.registered[L]?g(B).rootPropertyValueCache[L]=A.Normalizations.registered[L]("extract",null,N[1]):g(B).rootPropertyValueCache[L]=N[1]),"transform"===N[0]&&(D=!0)}}j.mobileHA&&g(B).transformCache.translate3d===d&&(g(B).transformCache.translate3d="(0px, 0px, 0px)",D=!0),D&&A.flushTransformCache(B)}}j.display!==d&&"none"!==j.display&&(y.State.calls[f][2].display=!1),j.visibility!==d&&"hidden"!==j.visibility&&(y.State.calls[f][2].visibility=!1),j.progress&&j.progress.call(h[1],h[1],v,Math.max(0,k+j.duration-b),k,q),1===v&&n(f)}}y.State.isTicking&&C(m)}function n(a,b){if(!y.State.calls[a])return!1;for(var c=y.State.calls[a][0],e=y.State.calls[a][1],f=y.State.calls[a][2],h=y.State.calls[a][4],i=!1,j=0,k=c.length;j<k;j++){var l=c[j].element;b||f.loop||("none"===f.display&&A.setPropertyValue(l,"display",f.display),"hidden"===f.visibility&&A.setPropertyValue(l,"visibility",f.visibility));var m=g(l);if(!0!==f.loop&&(o.queue(l)[1]===d||!/\.velocityQueueEntryFlag/i.test(o.queue(l)[1]))&&m){m.isAnimating=!1,m.rootPropertyValueCache={};var n=!1;o.each(A.Lists.transforms3D,function(a,b){var c=/^scale/.test(b)?1:0,e=m.transformCache[b];m.transformCache[b]!==d&&new RegExp("^\\("+c+"[^.]").test(e)&&(n=!0,delete m.transformCache[b])}),f.mobileHA&&(n=!0,delete m.transformCache.translate3d),n&&A.flushTransformCache(l),A.Values.removeClass(l,"velocity-animating")}if(!b&&f.complete&&!f.loop&&j===k-1)try{f.complete.call(e,e)}catch(a){setTimeout(function(){throw a},1)}h&&!0!==f.loop&&h(e),m&&!0===f.loop&&!b&&(o.each(m.tweensContainer,function(a,b){if(/^rotate/.test(a)&&(parseFloat(b.startValue)-parseFloat(b.endValue))%360==0){var c=b.startValue;b.startValue=b.endValue,b.endValue=c}/^backgroundPosition/.test(a)&&100===parseFloat(b.endValue)&&"%"===b.unitType&&(b.endValue=0,b.startValue=100)}),y(l,"reverse",{loop:!0,delay:f.delay})),!1!==f.queue&&o.dequeue(l,f.queue)}y.State.calls[a]=!1;for(var p=0,q=y.State.calls.length;p<q;p++)if(!1!==y.State.calls[p]){i=!0;break}!1===i&&(y.State.isTicking=!1,delete y.State.calls,y.State.calls=[])}var o,p=function(){if(c.documentMode)return c.documentMode;for(var a=7;a>4;a--){var b=c.createElement("div");if(b.innerHTML="\x3c!--[if IE "+a+"]><span></span><![endif]--\x3e",b.getElementsByTagName("span").length)return b=null,a}return d}(),q=function(){var a=0;return b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||function(b){var c,d=(new Date).getTime();return c=Math.max(0,16-(d-a)),a=d+c,setTimeout(function(){b(d+c)},c)}}(),r=function(){var a=b.performance||{};if("function"!=typeof a.now){var c=a.timing&&a.timing.navigationStart?a.timing.navigationStart:(new Date).getTime();a.now=function(){return(new Date).getTime()-c}}return a}(),s=function(){var a=Array.prototype.slice;try{return a.call(c.documentElement),a}catch(b){return function(b,c){var d=this.length;if("number"!=typeof b&&(b=0),"number"!=typeof c&&(c=d),this.slice)return a.call(this,b,c);var e,f=[],g=b>=0?b:Math.max(0,d+b),h=c<0?d+c:Math.min(c,d),i=h-g;if(i>0)if(f=new Array(i),this.charAt)for(e=0;e<i;e++)f[e]=this.charAt(g+e);else for(e=0;e<i;e++)f[e]=this[g+e];return f}}}(),t=function(){return Array.prototype.includes?function(a,b){return a.includes(b)}:Array.prototype.indexOf?function(a,b){return a.indexOf(b)>=0}:function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1}},u={isNumber:function(a){return"number"==typeof a},isString:function(a){return"string"==typeof a},isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)},isNode:function(a){return a&&a.nodeType},isWrapped:function(a){return a&&a!==b&&u.isNumber(a.length)&&!u.isString(a)&&!u.isFunction(a)&&!u.isNode(a)&&(0===a.length||u.isNode(a[0]))},isSVG:function(a){return b.SVGElement&&a instanceof b.SVGElement},isEmptyObject:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}},v=!1;if(a.fn&&a.fn.jquery?(o=a,v=!0):o=b.Velocity.Utilities,p<=8&&!v)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(p<=7)return void(jQuery.fn.velocity=jQuery.fn.animate);var w=400,x="swing",y={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:b.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:c.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[],delayedElements:{count:0}},CSS:{},Utilities:o,Redirects:{},Easings:{},Promise:b.Promise,defaults:{queue:"",duration:w,easing:x,begin:d,complete:d,progress:d,display:d,visibility:d,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0,promiseRejectEmpty:!0},init:function(a){o.data(a,"velocity",{isSVG:u.isSVG(a),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:5,patch:0},debug:!1,timestamp:!0,pauseAll:function(a){var b=(new Date).getTime();o.each(y.State.calls,function(b,c){if(c){if(a!==d&&(c[2].queue!==a||!1===c[2].queue))return!0;c[5]={resume:!1}}}),o.each(y.State.delayedElements,function(a,c){c&&h(c,b)})},resumeAll:function(a){var b=(new Date).getTime();o.each(y.State.calls,function(b,c){if(c){if(a!==d&&(c[2].queue!==a||!1===c[2].queue))return!0;c[5]&&(c[5].resume=!0)}}),o.each(y.State.delayedElements,function(a,c){c&&i(c,b)})}};b.pageYOffset!==d?(y.State.scrollAnchor=b,y.State.scrollPropertyLeft="pageXOffset",y.State.scrollPropertyTop="pageYOffset"):(y.State.scrollAnchor=c.documentElement||c.body.parentNode||c.body,y.State.scrollPropertyLeft="scrollLeft",y.State.scrollPropertyTop="scrollTop");var z=function(){function a(a){return-a.tension*a.x-a.friction*a.v}function b(b,c,d){var e={x:b.x+d.dx*c,v:b.v+d.dv*c,tension:b.tension,friction:b.friction};return{dx:e.v,dv:a(e)}}function c(c,d){var e={dx:c.v,dv:a(c)},f=b(c,.5*d,e),g=b(c,.5*d,f),h=b(c,d,g),i=1/6*(e.dx+2*(f.dx+g.dx)+h.dx),j=1/6*(e.dv+2*(f.dv+g.dv)+h.dv);return c.x=c.x+i*d,c.v=c.v+j*d,c}return function a(b,d,e){var f,g,h,i={x:-1,v:0,tension:null,friction:null},j=[0],k=0,l=1e-4,m=.016;for(b=parseFloat(b)||500,d=parseFloat(d)||20,e=e||null,i.tension=b,i.friction=d,f=null!==e,f?(k=a(b,d),g=k/e*m):g=m;;)if(h=c(h||i,g),j.push(1+h.x),k+=16,!(Math.abs(h.x)>l&&Math.abs(h.v)>l))break;return f?function(a){return j[a*(j.length-1)|0]}:k}}();y.Easings={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},spring:function(a){return 1-Math.cos(4.5*a*Math.PI)*Math.exp(6*-a)}},o.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["ease-out-in",[.465,.183,.153,.946]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(a,b){y.Easings[b[0]]=k.apply(null,b[1])});var A=y.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"],units:["%","em","ex","ch","rem","vw","vh","vmin","vmax","cm","mm","Q","in","pc","pt","px","deg","grad","rad","turn","s","ms"],colorNames:{aliceblue:"240,248,255",antiquewhite:"250,235,215",aquamarine:"127,255,212",aqua:"0,255,255",azure:"240,255,255",beige:"245,245,220",bisque:"255,228,196",black:"0,0,0",blanchedalmond:"255,235,205",blueviolet:"138,43,226",blue:"0,0,255",brown:"165,42,42",burlywood:"222,184,135",cadetblue:"95,158,160",chartreuse:"127,255,0",chocolate:"210,105,30",coral:"255,127,80",cornflowerblue:"100,149,237",cornsilk:"255,248,220",crimson:"220,20,60",cyan:"0,255,255",darkblue:"0,0,139",darkcyan:"0,139,139",darkgoldenrod:"184,134,11",darkgray:"169,169,169",darkgrey:"169,169,169",darkgreen:"0,100,0",darkkhaki:"189,183,107",darkmagenta:"139,0,139",darkolivegreen:"85,107,47",darkorange:"255,140,0",darkorchid:"153,50,204",darkred:"139,0,0",darksalmon:"233,150,122",darkseagreen:"143,188,143",darkslateblue:"72,61,139",darkslategray:"47,79,79",darkturquoise:"0,206,209",darkviolet:"148,0,211",deeppink:"255,20,147",deepskyblue:"0,191,255",dimgray:"105,105,105",dimgrey:"105,105,105",dodgerblue:"30,144,255",firebrick:"178,34,34",floralwhite:"255,250,240",forestgreen:"34,139,34",fuchsia:"255,0,255",gainsboro:"220,220,220",ghostwhite:"248,248,255",gold:"255,215,0",goldenrod:"218,165,32",gray:"128,128,128",grey:"128,128,128",greenyellow:"173,255,47",green:"0,128,0",honeydew:"240,255,240",hotpink:"255,105,180",indianred:"205,92,92",indigo:"75,0,130",ivory:"255,255,240",khaki:"240,230,140",lavenderblush:"255,240,245",lavender:"230,230,250",lawngreen:"124,252,0",lemonchiffon:"255,250,205",lightblue:"173,216,230",lightcoral:"240,128,128",lightcyan:"224,255,255",lightgoldenrodyellow:"250,250,210",lightgray:"211,211,211",lightgrey:"211,211,211",lightgreen:"144,238,144",lightpink:"255,182,193",lightsalmon:"255,160,122",lightseagreen:"32,178,170",lightskyblue:"135,206,250",lightslategray:"119,136,153",lightsteelblue:"176,196,222",lightyellow:"255,255,224",limegreen:"50,205,50",lime:"0,255,0",linen:"250,240,230",magenta:"255,0,255",maroon:"128,0,0",mediumaquamarine:"102,205,170",mediumblue:"0,0,205",mediumorchid:"186,85,211",mediumpurple:"147,112,219",mediumseagreen:"60,179,113",mediumslateblue:"123,104,238",mediumspringgreen:"0,250,154",mediumturquoise:"72,209,204",mediumvioletred:"199,21,133",midnightblue:"25,25,112",mintcream:"245,255,250",mistyrose:"255,228,225",moccasin:"255,228,181",navajowhite:"255,222,173",navy:"0,0,128",oldlace:"253,245,230",olivedrab:"107,142,35",olive:"128,128,0",orangered:"255,69,0",orange:"255,165,0",orchid:"218,112,214",palegoldenrod:"238,232,170",palegreen:"152,251,152",paleturquoise:"175,238,238",palevioletred:"219,112,147",papayawhip:"255,239,213",peachpuff:"255,218,185",peru:"205,133,63",pink:"255,192,203",plum:"221,160,221",powderblue:"176,224,230",purple:"128,0,128",red:"255,0,0",rosybrown:"188,143,143",royalblue:"65,105,225",saddlebrown:"139,69,19",salmon:"250,128,114",sandybrown:"244,164,96",seagreen:"46,139,87",seashell:"255,245,238",sienna:"160,82,45",silver:"192,192,192",skyblue:"135,206,235",slateblue:"106,90,205",slategray:"112,128,144",snow:"255,250,250",springgreen:"0,255,127",steelblue:"70,130,180",tan:"210,180,140",teal:"0,128,128",thistle:"216,191,216",tomato:"255,99,71",turquoise:"64,224,208",violet:"238,130,238",wheat:"245,222,179",whitesmoke:"245,245,245",white:"255,255,255",yellowgreen:"154,205,50",yellow:"255,255,0"}},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var a=0;a<A.Lists.colors.length;a++){var b="color"===A.Lists.colors[a]?"0 0 0 1":"255 255 255 1";A.Hooks.templates[A.Lists.colors[a]]=["Red Green Blue Alpha",b]}var c,d,e;if(p)for(c in A.Hooks.templates)if(A.Hooks.templates.hasOwnProperty(c)){d=A.Hooks.templates[c],e=d[0].split(" ");var f=d[1].match(A.RegEx.valueSplit);"Color"===e[0]&&(e.push(e.shift()),f.push(f.shift()),A.Hooks.templates[c]=[e.join(" "),f.join(" ")])}for(c in A.Hooks.templates)if(A.Hooks.templates.hasOwnProperty(c)){d=A.Hooks.templates[c],e=d[0].split(" ");for(var g in e)if(e.hasOwnProperty(g)){var h=c+e[g],i=g;A.Hooks.registered[h]=[c,i]}}},getRoot:function(a){var b=A.Hooks.registered[a];return b?b[0]:a},getUnit:function(a,b){var c=(a.substr(b||0,5).match(/^[a-z%]+/)||[])[0]||"";return c&&t(A.Lists.units,c)?c:""},fixColors:function(a){return a.replace(/(rgba?\(\s*)?(\b[a-z]+\b)/g,function(a,b,c){return A.Lists.colorNames.hasOwnProperty(c)?(b||"rgba(")+A.Lists.colorNames[c]+(b?"":",1)"):b+c})},cleanRootPropertyValue:function(a,b){return A.RegEx.valueUnwrap.test(b)&&(b=b.match(A.RegEx.valueUnwrap)[1]),A.Values.isCSSNullValue(b)&&(b=A.Hooks.templates[a][1]),b},extractValue:function(a,b){var c=A.Hooks.registered[a];if(c){var d=c[0],e=c[1];return b=A.Hooks.cleanRootPropertyValue(d,b),b.toString().match(A.RegEx.valueSplit)[e]}return b},injectValue:function(a,b,c){var d=A.Hooks.registered[a];if(d){var e,f=d[0],g=d[1];return c=A.Hooks.cleanRootPropertyValue(f,c),e=c.toString().match(A.RegEx.valueSplit),e[g]=b,e.join(" ")}return c}},Normalizations:{registered:{clip:function(a,b,c){switch(a){case"name":return"clip";case"extract":var d;return A.RegEx.wrappedValueAlreadyExtracted.test(c)?d=c:(d=c.toString().match(A.RegEx.valueUnwrap),d=d?d[1].replace(/,(\s+)?/g," "):c),d;case"inject":return"rect("+c+")"}},blur:function(a,b,c){switch(a){case"name":return y.State.isFirefox?"filter":"-webkit-filter";case"extract":var d=parseFloat(c);if(!d&&0!==d){var e=c.toString().match(/blur\(([0-9]+[A-z]+)\)/i);d=e?e[1]:0}return d;case"inject":return parseFloat(c)?"blur("+c+")":"none"}},opacity:function(a,b,c){if(p<=8)switch(a){case"name":return"filter";case"extract":var d=c.toString().match(/alpha\(opacity=(.*)\)/i);return c=d?d[1]/100:1;case"inject":return b.style.zoom=1,parseFloat(c)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(c),10)+")"}else switch(a){case"name":return"opacity";case"extract":case"inject":return c}}},register:function(){function a(a,b,c){if("border-box"===A.getPropertyValue(b,"boxSizing").toString().toLowerCase()===(c||!1)){var d,e,f=0,g="width"===a?["Left","Right"]:["Top","Bottom"],h=["padding"+g[0],"padding"+g[1],"border"+g[0]+"Width","border"+g[1]+"Width"];for(d=0;d<h.length;d++)e=parseFloat(A.getPropertyValue(b,h[d])),isNaN(e)||(f+=e);return c?-f:f}return 0}function b(b,c){return function(d,e,f){switch(d){case"name":return b;case"extract":return parseFloat(f)+a(b,e,c);case"inject":return parseFloat(f)-a(b,e,c)+"px"}}}p&&!(p>9)||y.State.isGingerbread||(A.Lists.transformsBase=A.Lists.transformsBase.concat(A.Lists.transforms3D));for(var c=0;c<A.Lists.transformsBase.length;c++)!function(){var a=A.Lists.transformsBase[c];A.Normalizations.registered[a]=function(b,c,e){switch(b){case"name":return"transform";case"extract":return g(c)===d||g(c).transformCache[a]===d?/^scale/i.test(a)?1:0:g(c).transformCache[a].replace(/[()]/g,"");case"inject":var f=!1;switch(a.substr(0,a.length-1)){case"translate":f=!/(%|px|em|rem|vw|vh|\d)$/i.test(e);break;case"scal":case"scale":y.State.isAndroid&&g(c).transformCache[a]===d&&e<1&&(e=1),f=!/(\d)$/i.test(e);break;case"skew":case"rotate":f=!/(deg|\d)$/i.test(e)}return f||(g(c).transformCache[a]="("+e+")"),g(c).transformCache[a]}}}();for(var e=0;e<A.Lists.colors.length;e++)!function(){var a=A.Lists.colors[e];A.Normalizations.registered[a]=function(b,c,e){switch(b){case"name":return a;case"extract":var f;if(A.RegEx.wrappedValueAlreadyExtracted.test(e))f=e;else{var g,h={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(e)?g=h[e]!==d?h[e]:h.black:A.RegEx.isHex.test(e)?g="rgb("+A.Values.hexToRgb(e).join(" ")+")":/^rgba?\(/i.test(e)||(g=h.black),f=(g||e).toString().match(A.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return(!p||p>8)&&3===f.split(" ").length&&(f+=" 1"),f;case"inject":return/^rgb/.test(e)?e:(p<=8?4===e.split(" ").length&&(e=e.split(/\s+/).slice(0,3).join(" ")):3===e.split(" ").length&&(e+=" 1"),(p<=8?"rgb":"rgba")+"("+e.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")")}}}();A.Normalizations.registered.innerWidth=b("width",!0),A.Normalizations.registered.innerHeight=b("height",!0),A.Normalizations.registered.outerWidth=b("width"),A.Normalizations.registered.outerHeight=b("height")}},Names:{camelCase:function(a){return a.replace(/-(\w)/g,function(a,b){return b.toUpperCase()})},SVGAttribute:function(a){var b="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(p||y.State.isAndroid&&!y.State.isChrome)&&(b+="|transform"),new RegExp("^("+b+")$","i").test(a)},prefixCheck:function(a){if(y.State.prefixMatches[a])return[y.State.prefixMatches[a],!0];for(var b=["","Webkit","Moz","ms","O"],c=0,d=b.length;c<d;c++){var e;if(e=0===c?a:b[c]+a.replace(/^\w/,function(a){return a.toUpperCase()}),u.isString(y.State.prefixElement.style[e]))return y.State.prefixMatches[a]=e,[e,!0]}return[a,!1]}},Values:{hexToRgb:function(a){var b,c=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return a=a.replace(c,function(a,b,c,d){return b+b+c+c+d+d}),b=d.exec(a),b?[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]:[0,0,0]},isCSSNullValue:function(a){return!a||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(a)},getUnitType:function(a){return/^(rotate|skew)/i.test(a)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(a)?"":"px"},getDisplayType:function(a){var b=a&&a.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(b)?"inline":/^(li)$/i.test(b)?"list-item":/^(tr)$/i.test(b)?"table-row":/^(table)$/i.test(b)?"table":/^(tbody)$/i.test(b)?"table-row-group":"block"},addClass:function(a,b){if(a)if(a.classList)a.classList.add(b);else if(u.isString(a.className))a.className+=(a.className.length?" ":"")+b;else{var c=a.getAttribute(p<=7?"className":"class")||"";a.setAttribute("class",c+(c?" ":"")+b)}},removeClass:function(a,b){if(a)if(a.classList)a.classList.remove(b);else if(u.isString(a.className))a.className=a.className.toString().replace(new RegExp("(^|\\s)"+b.split(" ").join("|")+"(\\s|$)","gi")," ");else{var c=a.getAttribute(p<=7?"className":"class")||"";a.setAttribute("class",c.replace(new RegExp("(^|s)"+b.split(" ").join("|")+"(s|$)","gi")," "))}}},getPropertyValue:function(a,c,e,f){function h(a,c){var e=0;if(p<=8)e=o.css(a,c);else{var i=!1;/^(width|height)$/.test(c)&&0===A.getPropertyValue(a,"display")&&(i=!0,A.setPropertyValue(a,"display",A.Values.getDisplayType(a)));var j=function(){i&&A.setPropertyValue(a,"display","none")};if(!f){if("height"===c&&"border-box"!==A.getPropertyValue(a,"boxSizing").toString().toLowerCase()){var k=a.offsetHeight-(parseFloat(A.getPropertyValue(a,"borderTopWidth"))||0)-(parseFloat(A.getPropertyValue(a,"borderBottomWidth"))||0)-(parseFloat(A.getPropertyValue(a,"paddingTop"))||0)-(parseFloat(A.getPropertyValue(a,"paddingBottom"))||0);return j(),k}if("width"===c&&"border-box"!==A.getPropertyValue(a,"boxSizing").toString().toLowerCase()){var l=a.offsetWidth-(parseFloat(A.getPropertyValue(a,"borderLeftWidth"))||0)-(parseFloat(A.getPropertyValue(a,"borderRightWidth"))||0)-(parseFloat(A.getPropertyValue(a,"paddingLeft"))||0)-(parseFloat(A.getPropertyValue(a,"paddingRight"))||0);return j(),l}}var m;m=g(a)===d?b.getComputedStyle(a,null):g(a).computedStyle?g(a).computedStyle:g(a).computedStyle=b.getComputedStyle(a,null),"borderColor"===c&&(c="borderTopColor"),e=9===p&&"filter"===c?m.getPropertyValue(c):m[c],""!==e&&null!==e||(e=a.style[c]),j()}if("auto"===e&&/^(top|right|bottom|left)$/i.test(c)){var n=h(a,"position");("fixed"===n||"absolute"===n&&/top|left/i.test(c))&&(e=o(a).position()[c]+"px")}return e}var i;if(A.Hooks.registered[c]){var j=c,k=A.Hooks.getRoot(j);e===d&&(e=A.getPropertyValue(a,A.Names.prefixCheck(k)[0])),A.Normalizations.registered[k]&&(e=A.Normalizations.registered[k]("extract",a,e)),i=A.Hooks.extractValue(j,e)}else if(A.Normalizations.registered[c]){var l,m;l=A.Normalizations.registered[c]("name",a),"transform"!==l&&(m=h(a,A.Names.prefixCheck(l)[0]),A.Values.isCSSNullValue(m)&&A.Hooks.templates[c]&&(m=A.Hooks.templates[c][1])),i=A.Normalizations.registered[c]("extract",a,m)}if(!/^[\d-]/.test(i)){var n=g(a);if(n&&n.isSVG&&A.Names.SVGAttribute(c))if(/^(height|width)$/i.test(c))try{i=a.getBBox()[c]}catch(a){i=0}else i=a.getAttribute(c);else i=h(a,A.Names.prefixCheck(c)[0])}return A.Values.isCSSNullValue(i)&&(i=0),y.debug>=2&&console.log("Get "+c+": "+i),i},setPropertyValue:function(a,c,d,e,f){var h=c;if("scroll"===c)f.container?f.container["scroll"+f.direction]=d:"Left"===f.direction?b.scrollTo(d,f.alternateValue):b.scrollTo(f.alternateValue,d);else if(A.Normalizations.registered[c]&&"transform"===A.Normalizations.registered[c]("name",a))A.Normalizations.registered[c]("inject",a,d),h="transform",d=g(a).transformCache[c];else{if(A.Hooks.registered[c]){var i=c,j=A.Hooks.getRoot(c);e=e||A.getPropertyValue(a,j),d=A.Hooks.injectValue(i,d,e),c=j}if(A.Normalizations.registered[c]&&(d=A.Normalizations.registered[c]("inject",a,d),c=A.Normalizations.registered[c]("name",a)),h=A.Names.prefixCheck(c)[0],p<=8)try{a.style[h]=d}catch(a){y.debug&&console.log("Browser does not support ["+d+"] for ["+h+"]")}else{var k=g(a);k&&k.isSVG&&A.Names.SVGAttribute(c)?a.setAttribute(c,d):a.style[h]=d}y.debug>=2&&console.log("Set "+c+" ("+h+"): "+d)}return[h,d]},flushTransformCache:function(a){var b="",c=g(a);if((p||y.State.isAndroid&&!y.State.isChrome)&&c&&c.isSVG){var d=function(b){return parseFloat(A.getPropertyValue(a,b))},e={translate:[d("translateX"),d("translateY")],skewX:[d("skewX")],skewY:[d("skewY")],scale:1!==d("scale")?[d("scale"),d("scale")]:[d("scaleX"),d("scaleY")],rotate:[d("rotateZ"),0,0]};o.each(g(a).transformCache,function(a){/^translate/i.test(a)?a="translate":/^scale/i.test(a)?a="scale":/^rotate/i.test(a)&&(a="rotate"),e[a]&&(b+=a+"("+e[a].join(" ")+") ",delete e[a])})}else{var f,h;o.each(g(a).transformCache,function(c){if(f=g(a).transformCache[c],"transformPerspective"===c)return h=f,!0;9===p&&"rotateZ"===c&&(c="rotate"),b+=c+f+" "}),h&&(b="perspective"+h+" "+b)}A.setPropertyValue(a,"transform",b)}};A.Hooks.register(),A.Normalizations.register(),y.hook=function(a,b,c){var e;return a=f(a),o.each(a,function(a,f){if(g(f)===d&&y.init(f),c===d)e===d&&(e=A.getPropertyValue(f,b));else{var h=A.setPropertyValue(f,b,c);"transform"===h[0]&&y.CSS.flushTransformCache(f),e=h}}),e};var B=function(){function a(){return k?z.promise||null:p}function e(a,e){function f(f){var k,n;if(i.begin&&0===D)try{i.begin.call(r,r)}catch(a){setTimeout(function(){throw a},1)}if("scroll"===G){var p,q,w,x=/^x$/i.test(i.axis)?"Left":"Top",B=parseFloat(i.offset)||0;i.container?u.isWrapped(i.container)||u.isNode(i.container)?(i.container=i.container[0]||i.container,p=i.container["scroll"+x],w=p+o(a).position()[x.toLowerCase()]+B):i.container=null:(p=y.State.scrollAnchor[y.State["scrollProperty"+x]],q=y.State.scrollAnchor[y.State["scrollProperty"+("Left"===x?"Top":"Left")]],w=o(a).offset()[x.toLowerCase()]+B),j={scroll:{rootPropertyValue:!1,startValue:p,currentValue:p,endValue:w,unitType:"",easing:i.easing,scrollData:{container:i.container,direction:x,alternateValue:q}},element:a},y.debug&&console.log("tweensContainer (scroll): ",j.scroll,a)}else if("reverse"===G){if(!(k=g(a)))return;if(!k.tweensContainer)return void o.dequeue(a,i.queue);"none"===k.opts.display&&(k.opts.display="auto"),"hidden"===k.opts.visibility&&(k.opts.visibility="visible"),k.opts.loop=!1,k.opts.begin=null,k.opts.complete=null,v.easing||delete i.easing,v.duration||delete i.duration,i=o.extend({},k.opts,i),n=o.extend(!0,{},k?k.tweensContainer:null);for(var E in n)if(n.hasOwnProperty(E)&&"element"!==E){var F=n[E].startValue;n[E].startValue=n[E].currentValue=n[E].endValue,n[E].endValue=F,u.isEmptyObject(v)||(n[E].easing=i.easing),y.debug&&console.log("reverse tweensContainer ("+E+"): "+JSON.stringify(n[E]),a)}j=n}else if("start"===G){k=g(a),k&&k.tweensContainer&&!0===k.isAnimating&&(n=k.tweensContainer);var H=function(b,c){var d,f,g;return u.isFunction(b)&&(b=b.call(a,e,C)),u.isArray(b)?(d=b[0],!u.isArray(b[1])&&/^[\d-]/.test(b[1])||u.isFunction(b[1])||A.RegEx.isHex.test(b[1])?g=b[1]:u.isString(b[1])&&!A.RegEx.isHex.test(b[1])&&y.Easings[b[1]]||u.isArray(b[1])?(f=c?b[1]:l(b[1],i.duration),g=b[2]):g=b[1]||b[2]):d=b,c||(f=f||i.easing),u.isFunction(d)&&(d=d.call(a,e,C)),u.isFunction(g)&&(g=g.call(a,e,C)),[d||0,f,g]},I=function(e,f){var g,l=A.Hooks.getRoot(e),m=!1,p=f[0],q=f[1],r=f[2];if(!(k&&k.isSVG||"tween"===l||!1!==A.Names.prefixCheck(l)[1]||A.Normalizations.registered[l]!==d))return void(y.debug&&console.log("Skipping ["+l+"] due to a lack of browser support."));(i.display!==d&&null!==i.display&&"none"!==i.display||i.visibility!==d&&"hidden"!==i.visibility)&&/opacity|filter/.test(e)&&!r&&0!==p&&(r=0),i._cacheValues&&n&&n[e]?(r===d&&(r=n[e].endValue+n[e].unitType),m=k.rootPropertyValueCache[l]):A.Hooks.registered[e]?r===d?(m=A.getPropertyValue(a,l),r=A.getPropertyValue(a,e,m)):m=A.Hooks.templates[l][1]:r===d&&(r=A.getPropertyValue(a,e));var s,t,v,w=!1,x=function(a,b){var c,d;return d=(b||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(a){return c=a,""}),c||(c=A.Values.getUnitType(a)),[d,c]};if(r!==p&&u.isString(r)&&u.isString(p)){g="";var z=0,B=0,C=[],D=[],E=0,F=0,G=0;for(r=A.Hooks.fixColors(r),p=A.Hooks.fixColors(p);z<r.length&&B<p.length;){var H=r[z],I=p[B];if(/[\d\.-]/.test(H)&&/[\d\.-]/.test(I)){for(var J=H,K=I,L=".",N=".";++z<r.length;){if((H=r[z])===L)L="..";else if(!/\d/.test(H))break;J+=H}for(;++B<p.length;){if((I=p[B])===N)N="..";else if(!/\d/.test(I))break;K+=I}var O=A.Hooks.getUnit(r,z),P=A.Hooks.getUnit(p,B);if(z+=O.length,B+=P.length,O===P)J===K?g+=J+O:(g+="{"+C.length+(F?"!":"")+"}"+O,C.push(parseFloat(J)),D.push(parseFloat(K)));else{var Q=parseFloat(J),R=parseFloat(K);g+=(E<5?"calc":"")+"("+(Q?"{"+C.length+(F?"!":"")+"}":"0")+O+" + "+(R?"{"+(C.length+(Q?1:0))+(F?"!":"")+"}":"0")+P+")",Q&&(C.push(Q),D.push(0)),R&&(C.push(0),D.push(R))}}else{if(H!==I){E=0;break}g+=H,z++,B++,0===E&&"c"===H||1===E&&"a"===H||2===E&&"l"===H||3===E&&"c"===H||E>=4&&"("===H?E++:(E&&E<5||E>=4&&")"===H&&--E<5)&&(E=0),0===F&&"r"===H||1===F&&"g"===H||2===F&&"b"===H||3===F&&"a"===H||F>=3&&"("===H?(3===F&&"a"===H&&(G=1),F++):G&&","===H?++G>3&&(F=G=0):(G&&F<(G?5:4)||F>=(G?4:3)&&")"===H&&--F<(G?5:4))&&(F=G=0)}}z===r.length&&B===p.length||(y.debug&&console.error('Trying to pattern match mis-matched strings ["'+p+'", "'+r+'"]'),g=d),g&&(C.length?(y.debug&&console.log('Pattern found "'+g+'" -> ',C,D,"["+r+","+p+"]"),r=C,p=D,t=v=""):g=d)}g||(s=x(e,r),r=s[0],v=s[1],s=x(e,p),p=s[0].replace(/^([+-\/*])=/,function(a,b){return w=b,""}),t=s[1],r=parseFloat(r)||0,p=parseFloat(p)||0,"%"===t&&(/^(fontSize|lineHeight)$/.test(e)?(p/=100,t="em"):/^scale/.test(e)?(p/=100,t=""):/(Red|Green|Blue)$/i.test(e)&&(p=p/100*255,t="")));var S=function(){var d={myParent:a.parentNode||c.body,position:A.getPropertyValue(a,"position"),fontSize:A.getPropertyValue(a,"fontSize")},e=d.position===M.lastPosition&&d.myParent===M.lastParent,f=d.fontSize===M.lastFontSize;M.lastParent=d.myParent,M.lastPosition=d.position,M.lastFontSize=d.fontSize;var g=100,h={};if(f&&e)h.emToPx=M.lastEmToPx,h.percentToPxWidth=M.lastPercentToPxWidth,h.percentToPxHeight=M.lastPercentToPxHeight;else{var i=k&&k.isSVG?c.createElementNS("http://www.w3.org/2000/svg","rect"):c.createElement("div");y.init(i),d.myParent.appendChild(i),o.each(["overflow","overflowX","overflowY"],function(a,b){y.CSS.setPropertyValue(i,b,"hidden")}),y.CSS.setPropertyValue(i,"position",d.position),y.CSS.setPropertyValue(i,"fontSize",d.fontSize),y.CSS.setPropertyValue(i,"boxSizing","content-box"),o.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(a,b){y.CSS.setPropertyValue(i,b,g+"%")}),y.CSS.setPropertyValue(i,"paddingLeft",g+"em"),h.percentToPxWidth=M.lastPercentToPxWidth=(parseFloat(A.getPropertyValue(i,"width",null,!0))||1)/g,h.percentToPxHeight=M.lastPercentToPxHeight=(parseFloat(A.getPropertyValue(i,"height",null,!0))||1)/g,h.emToPx=M.lastEmToPx=(parseFloat(A.getPropertyValue(i,"paddingLeft"))||1)/g,d.myParent.removeChild(i)}return null===M.remToPx&&(M.remToPx=parseFloat(A.getPropertyValue(c.body,"fontSize"))||16),null===M.vwToPx&&(M.vwToPx=parseFloat(b.innerWidth)/100,M.vhToPx=parseFloat(b.innerHeight)/100),h.remToPx=M.remToPx,h.vwToPx=M.vwToPx,h.vhToPx=M.vhToPx,y.debug>=1&&console.log("Unit ratios: "+JSON.stringify(h),a),h};if(/[\/*]/.test(w))t=v;else if(v!==t&&0!==r)if(0===p)t=v;else{h=h||S();var T=/margin|padding|left|right|width|text|word|letter/i.test(e)||/X$/.test(e)||"x"===e?"x":"y";switch(v){case"%":r*="x"===T?h.percentToPxWidth:h.percentToPxHeight;break;case"px":break;default:r*=h[v+"ToPx"]}switch(t){case"%":r*=1/("x"===T?h.percentToPxWidth:h.percentToPxHeight);break;case"px":break;default:r*=1/h[t+"ToPx"]}}switch(w){case"+":p=r+p;break;case"-":p=r-p;break;case"*":p*=r;break;case"/":p=r/p}j[e]={rootPropertyValue:m,startValue:r,currentValue:r,endValue:p,unitType:t,easing:q},g&&(j[e].pattern=g),y.debug&&console.log("tweensContainer ("+e+"): "+JSON.stringify(j[e]),a)};for(var J in s)if(s.hasOwnProperty(J)){var K=A.Names.camelCase(J),L=H(s[J]);if(t(A.Lists.colors,K)){var O=L[0],P=L[1],Q=L[2];if(A.RegEx.isHex.test(O)){for(var R=["Red","Green","Blue"],S=A.Values.hexToRgb(O),T=Q?A.Values.hexToRgb(Q):d,U=0;U<R.length;U++){var V=[S[U]];P&&V.push(P),T!==d&&V.push(T[U]),I(K+R[U],V)}continue}}I(K,L)}j.element=a}j.element&&(A.Values.addClass(a,"velocity-animating"),N.push(j),k=g(a),k&&(""===i.queue&&(k.tweensContainer=j,k.opts=i),k.isAnimating=!0),D===C-1?(y.State.calls.push([N,r,i,null,z.resolver,null,0]),!1===y.State.isTicking&&(y.State.isTicking=!0,m())):D++)}var h,i=o.extend({},y.defaults,v),j={};switch(g(a)===d&&y.init(a),parseFloat(i.delay)&&!1!==i.queue&&o.queue(a,i.queue,function(b){y.velocityQueueEntryFlag=!0;var c=y.State.delayedElements.count++;y.State.delayedElements[c]=a;var d=function(a){return function(){y.State.delayedElements[a]=!1,b&&b()}}(c);g(a).delayBegin=(new Date).getTime(),g(a).delay=parseFloat(i.delay),g(a).delayTimer={setTimeout:setTimeout(b,parseFloat(i.delay)),next:d}}),i.duration.toString().toLowerCase()){case"fast":i.duration=200;break;case"normal":i.duration=w;break;case"slow":i.duration=600;break;default:i.duration=parseFloat(i.duration)||1}if(!1!==y.mock&&(!0===y.mock?i.duration=i.delay=1:(i.duration*=parseFloat(y.mock)||1,i.delay*=parseFloat(y.mock)||1)),i.easing=l(i.easing,i.duration),i.begin&&!u.isFunction(i.begin)&&(i.begin=null),i.progress&&!u.isFunction(i.progress)&&(i.progress=null),i.complete&&!u.isFunction(i.complete)&&(i.complete=null),i.display!==d&&null!==i.display&&(i.display=i.display.toString().toLowerCase(),"auto"===i.display&&(i.display=y.CSS.Values.getDisplayType(a))),i.visibility!==d&&null!==i.visibility&&(i.visibility=i.visibility.toString().toLowerCase()),i.mobileHA=i.mobileHA&&y.State.isMobile&&!y.State.isGingerbread,!1===i.queue)if(i.delay){var k=y.State.delayedElements.count++;y.State.delayedElements[k]=a;var n=function(a){return function(){y.State.delayedElements[a]=!1,f()}}(k);g(a).delayBegin=(new Date).getTime(),g(a).delay=parseFloat(i.delay),g(a).delayTimer={setTimeout:setTimeout(f,parseFloat(i.delay)),next:n}}else f();else o.queue(a,i.queue,function(a,b){if(!0===b)return z.promise&&z.resolver(r),!0;y.velocityQueueEntryFlag=!0,f(a)});""!==i.queue&&"fx"!==i.queue||"inprogress"===o.queue(a)[0]||o.dequeue(a)}var j,k,p,q,r,s,v,x=arguments[0]&&(arguments[0].p||o.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||u.isString(arguments[0].properties));u.isWrapped(this)?(k=!1,q=0,r=this,p=this):(k=!0,q=1,r=x?arguments[0].elements||arguments[0].e:arguments[0]);var z={promise:null,resolver:null,rejecter:null};if(k&&y.Promise&&(z.promise=new y.Promise(function(a,b){z.resolver=a,z.rejecter=b})),x?(s=arguments[0].properties||arguments[0].p,v=arguments[0].options||arguments[0].o):(s=arguments[q],v=arguments[q+1]),!(r=f(r)))return void(z.promise&&(s&&v&&!1===v.promiseRejectEmpty?z.resolver():z.rejecter()));var C=r.length,D=0;if(!/^(stop|finish|finishAll|pause|resume)$/i.test(s)&&!o.isPlainObject(v)){var E=q+1;v={};for(var F=E;F<arguments.length;F++)u.isArray(arguments[F])||!/^(fast|normal|slow)$/i.test(arguments[F])&&!/^\d/.test(arguments[F])?u.isString(arguments[F])||u.isArray(arguments[F])?v.easing=arguments[F]:u.isFunction(arguments[F])&&(v.complete=arguments[F]):v.duration=arguments[F]}var G;switch(s){case"scroll":G="scroll";break;case"reverse":G="reverse";break;case"pause":var H=(new Date).getTime();return o.each(r,function(a,b){h(b,H)}),o.each(y.State.calls,function(a,b){var c=!1;b&&o.each(b[1],function(a,e){var f=v===d?"":v;return!0!==f&&b[2].queue!==f&&(v!==d||!1!==b[2].queue)||(o.each(r,function(a,d){if(d===e)return b[5]={resume:!1},c=!0,!1}),!c&&void 0)})}),a();case"resume":return o.each(r,function(a,b){i(b,H)}),o.each(y.State.calls,function(a,b){var c=!1;b&&o.each(b[1],function(a,e){var f=v===d?"":v;return!0!==f&&b[2].queue!==f&&(v!==d||!1!==b[2].queue)||(!b[5]||(o.each(r,function(a,d){if(d===e)return b[5].resume=!0,c=!0,!1}),!c&&void 0))})}),a();case"finish":case"finishAll":case"stop":o.each(r,function(a,b){g(b)&&g(b).delayTimer&&(clearTimeout(g(b).delayTimer.setTimeout),g(b).delayTimer.next&&g(b).delayTimer.next(),delete g(b).delayTimer),"finishAll"!==s||!0!==v&&!u.isString(v)||(o.each(o.queue(b,u.isString(v)?v:""),function(a,b){u.isFunction(b)&&b()}),o.queue(b,u.isString(v)?v:"",[]))});var I=[];return o.each(y.State.calls,function(a,b){b&&o.each(b[1],function(c,e){var f=v===d?"":v;if(!0!==f&&b[2].queue!==f&&(v!==d||!1!==b[2].queue))return!0;o.each(r,function(c,d){if(d===e)if((!0===v||u.isString(v))&&(o.each(o.queue(d,u.isString(v)?v:""),function(a,b){u.isFunction(b)&&b(null,!0)}),o.queue(d,u.isString(v)?v:"",[])),"stop"===s){var h=g(d);h&&h.tweensContainer&&!1!==f&&o.each(h.tweensContainer,function(a,b){b.endValue=b.currentValue}),I.push(a)}else"finish"!==s&&"finishAll"!==s||(b[2].duration=1)})})}),"stop"===s&&(o.each(I,function(a,b){n(b,!0)}),z.promise&&z.resolver(r)),a();default:if(!o.isPlainObject(s)||u.isEmptyObject(s)){if(u.isString(s)&&y.Redirects[s]){j=o.extend({},v);var J=j.duration,K=j.delay||0;return!0===j.backwards&&(r=o.extend(!0,[],r).reverse()),o.each(r,function(a,b){parseFloat(j.stagger)?j.delay=K+parseFloat(j.stagger)*a:u.isFunction(j.stagger)&&(j.delay=K+j.stagger.call(b,a,C)),j.drag&&(j.duration=parseFloat(J)||(/^(callout|transition)/.test(s)?1e3:w),j.duration=Math.max(j.duration*(j.backwards?1-a/C:(a+1)/C),.75*j.duration,200)),y.Redirects[s].call(b,b,j||{},a,C,r,z.promise?z:d)}),a()}var L="Velocity: First argument ("+s+") was not a property map, a known action, or a registered redirect. Aborting.";return z.promise?z.rejecter(new Error(L)):b.console&&console.log(L),a()}G="start"}var M={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},N=[];o.each(r,function(a,b){u.isNode(b)&&e(b,a)}),j=o.extend({},y.defaults,v),j.loop=parseInt(j.loop,10);var O=2*j.loop-1;if(j.loop)for(var P=0;P<O;P++){var Q={delay:j.delay,progress:j.progress};P===O-1&&(Q.display=j.display,Q.visibility=j.visibility,Q.complete=j.complete),B(r,"reverse",Q)}return a()};y=o.extend(B,y),y.animate=B;var C=b.requestAnimationFrame||q;if(!y.State.isMobile&&c.hidden!==d){var D=function(){c.hidden?(C=function(a){return setTimeout(function(){a(!0)},16)},m()):C=b.requestAnimationFrame||q};D(),c.addEventListener("visibilitychange",D)}return a.Velocity=y,a!==b&&(a.fn.velocity=B,a.fn.velocity.defaults=y.defaults),o.each(["Down","Up"],function(a,b){y.Redirects["slide"+b]=function(a,c,e,f,g,h){var i=o.extend({},c),j=i.begin,k=i.complete,l={},m={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""};i.display===d&&(i.display="Down"===b?"inline"===y.CSS.Values.getDisplayType(a)?"inline-block":"block":"none"),i.begin=function(){0===e&&j&&j.call(g,g);for(var c in m)if(m.hasOwnProperty(c)){l[c]=a.style[c];var d=A.getPropertyValue(a,c);m[c]="Down"===b?[d,0]:[0,d]}l.overflow=a.style.overflow,a.style.overflow="hidden"},i.complete=function(){for(var b in l)l.hasOwnProperty(b)&&(a.style[b]=l[b]);e===f-1&&(k&&k.call(g,g),h&&h.resolver(g))},y(a,m,i)}}),o.each(["In","Out"],function(a,b){y.Redirects["fade"+b]=function(a,c,e,f,g,h){var i=o.extend({},c),j=i.complete,k={opacity:"In"===b?1:0};0!==e&&(i.begin=null),i.complete=e!==f-1?null:function(){j&&j.call(g,g),h&&h.resolver(g)},i.display===d&&(i.display="In"===b?"auto":"none"),y(this,k,i)}}),y}(window.jQuery||window.Zepto||window,window,window?window.document:void 0)}),function(a){"use strict";"function"==typeof require&&"object"==typeof exports?module.exports=a():"function"==typeof define&&define.amd?define("toast/animations/_velocity.ui",["./_velocity"],a):a()}(function(){"use strict";return function(a,b,c,d){function e(a,b){var c=[];return!(!a||!b)&&(g.each([a,b],function(a,b){var d=[];g.each(b,function(a,b){for(;b.toString().length<5;)b="0"+b;d.push(b)}),c.push(d.join(""))}),parseFloat(c[0])>parseFloat(c[1]))}var f=a.Velocity;if(!f||!f.Utilities)return void(b.console&&console.log("Velocity UI Pack: Velocity must be loaded first. Aborting."));var g=f.Utilities;if(e({major:1,minor:1,patch:0},f.version)){var h="Velocity UI Pack: You need to update Velocity (velocity.js) to a newer version. Visit http://github.com/julianshapiro/velocity.";throw alert(h),new Error(h)}f.RegisterEffect=f.RegisterUI=function(a,b){function c(a,b,c,d){var e,h=0;g.each(a.nodeType?[a]:a,function(a,b){d&&(c+=a*d),e=b.parentNode;var i=["height","paddingTop","paddingBottom","marginTop","marginBottom"];"border-box"===f.CSS.getPropertyValue(b,"boxSizing").toString().toLowerCase()&&(i=["height"]),g.each(i,function(a,c){h+=parseFloat(f.CSS.getPropertyValue(b,c))})}),f.animate(e,{height:("In"===b?"+":"-")+"="+h},{queue:!1,easing:"ease-in-out",duration:c*("In"===b?.6:1)})}return f.Redirects[a]=function(e,h,i,j,k,l,m){var n=i===j-1,o=0;m=m||b.loop,"function"==typeof b.defaultDuration?b.defaultDuration=b.defaultDuration.call(k,k):b.defaultDuration=parseFloat(b.defaultDuration);for(var p=0;p<b.calls.length;p++)"number"==typeof(u=b.calls[p][1])&&(o+=u);var q=o>=1?0:b.calls.length?(1-o)/b.calls.length:1;for(p=0;p<b.calls.length;p++){var r=b.calls[p],s=r[0],t=1e3,u=r[1],v=r[2]||{},w={};if(h.duration!==d?t=h.duration:b.defaultDuration!==d&&(t=b.defaultDuration),w.duration=t*("number"==typeof u?u:q),w.queue=h.queue||"",w.easing=v.easing||"ease",w.delay=parseFloat(v.delay)||0,w.loop=!b.loop&&v.loop,w._cacheValues=v._cacheValues||!0,0===p){if(w.delay+=parseFloat(h.delay)||0,0===i&&(w.begin=function(){h.begin&&h.begin.call(k,k);var b=a.match(/(In|Out)$/);b&&"In"===b[0]&&s.opacity!==d&&g.each(k.nodeType?[k]:k,function(a,b){f.CSS.setPropertyValue(b,"opacity",0)}),h.animateParentHeight&&b&&c(k,b[0],t+w.delay,h.stagger)}),null!==h.display)if(h.display!==d&&"none"!==h.display)w.display=h.display;else if(/In$/.test(a)){var x=f.CSS.Values.getDisplayType(e);w.display="inline"===x?"inline-block":x}h.visibility&&"hidden"!==h.visibility&&(w.visibility=h.visibility)}if(p===b.calls.length-1){var y=function(){h.display!==d&&"none"!==h.display||!/Out$/.test(a)||g.each(k.nodeType?[k]:k,function(a,b){f.CSS.setPropertyValue(b,"display","none")}),h.complete&&h.complete.call(k,k),l&&l.resolver(k||e)};w.complete=function(){if(m&&f.Redirects[a](e,h,i,j,k,l,!0===m||Math.max(0,m-1)),b.reset){for(var c in b.reset)if(b.reset.hasOwnProperty(c)){var g=b.reset[c];f.CSS.Hooks.registered[c]!==d||"string"!=typeof g&&"number"!=typeof g||(b.reset[c]=[b.reset[c],b.reset[c]])}var o={duration:0,queue:!1};n&&(o.complete=y),f.animate(e,b.reset,o)}else n&&y()},"hidden"===h.visibility&&(w.visibility=h.visibility)}f.animate(e,s,w)}},f},f.RegisterEffect.packagedEffects={"callout.bounce":{defaultDuration:550,calls:[[{translateY:-30},.25],[{translateY:0},.125],[{translateY:-15},.125],[{translateY:0},.25]]},"callout.shake":{defaultDuration:800,calls:[[{translateX:-11}],[{translateX:11}],[{translateX:-11}],[{translateX:11}],[{translateX:-11}],[{translateX:11}],[{translateX:-11}],[{translateX:0}]]},"callout.flash":{defaultDuration:1100,calls:[[{opacity:[0,"easeInOutQuad",1]}],[{opacity:[1,"easeInOutQuad"]}],[{opacity:[0,"easeInOutQuad"]}],[{opacity:[1,"easeInOutQuad"]}]]},"callout.pulse":{defaultDuration:825,calls:[[{scaleX:1.1,scaleY:1.1},.5,{easing:"easeInExpo"}],[{scaleX:1,scaleY:1},.5]]},"callout.swing":{defaultDuration:950,calls:[[{rotateZ:15}],[{rotateZ:-10}],[{rotateZ:5}],[{rotateZ:-5}],[{rotateZ:0}]]},"callout.tada":{defaultDuration:1e3,calls:[[{scaleX:.9,scaleY:.9,rotateZ:-3},.1],[{scaleX:1.1,scaleY:1.1,rotateZ:3},.1],[{scaleX:1.1,scaleY:1.1,rotateZ:-3},.1],["reverse",.125],["reverse",.125],["reverse",.125],["reverse",.125],["reverse",.125],[{scaleX:1,scaleY:1,rotateZ:0},.2]]},"transition.fadeIn":{defaultDuration:500,calls:[[{opacity:[1,0]}]]},"transition.fadeOut":{defaultDuration:500,calls:[[{opacity:[0,1]}]]},"transition.flipXIn":{defaultDuration:700,calls:[[{opacity:[1,0],transformPerspective:[800,800],rotateY:[0,-55]}]],reset:{transformPerspective:0}},"transition.flipXOut":{defaultDuration:700,calls:[[{opacity:[0,1],transformPerspective:[800,800],rotateY:55}]],reset:{transformPerspective:0,rotateY:0}},"transition.flipYIn":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],rotateX:[0,-45]}]],reset:{transformPerspective:0}},"transition.flipYOut":{defaultDuration:800,calls:[[{opacity:[0,1],transformPerspective:[800,800],rotateX:25}]],reset:{transformPerspective:0,rotateX:0}},"transition.flipBounceXIn":{defaultDuration:900,calls:[[{opacity:[.725,0],transformPerspective:[400,400],rotateY:[-10,90]},.5],[{opacity:.8,rotateY:10},.25],[{opacity:1,rotateY:0},.25]],reset:{transformPerspective:0}},"transition.flipBounceXOut":{defaultDuration:800,calls:[[{opacity:[.9,1],transformPerspective:[400,400],rotateY:-10}],[{opacity:0,rotateY:90}]],reset:{transformPerspective:0,rotateY:0}},"transition.flipBounceYIn":{defaultDuration:850,calls:[[{opacity:[.725,0],transformPerspective:[400,400],rotateX:[-10,90]},.5],[{opacity:.8,rotateX:10},.25],[{opacity:1,rotateX:0},.25]],reset:{transformPerspective:0}},"transition.flipBounceYOut":{defaultDuration:800,calls:[[{opacity:[.9,1],transformPerspective:[400,400],rotateX:-15}],[{opacity:0,rotateX:90}]],reset:{transformPerspective:0,rotateX:0}},"transition.swoopIn":{defaultDuration:850,calls:[[{opacity:[1,0],transformOriginX:["100%","50%"],transformOriginY:["100%","100%"],scaleX:[1,0],scaleY:[1,0],translateX:[0,-700],translateZ:0}]],reset:{transformOriginX:"50%",transformOriginY:"50%"}},"transition.swoopOut":{defaultDuration:850,calls:[[{opacity:[0,1],transformOriginX:["50%","100%"],transformOriginY:["100%","100%"],scaleX:0,scaleY:0,translateX:-700,translateZ:0}]],reset:{transformOriginX:"50%",transformOriginY:"50%",scaleX:1,scaleY:1,translateX:0},resetEffectName:"transition.swoopIn"},"transition.whirlIn":{defaultDuration:850,calls:[[{opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:[1,0],scaleY:[1,0],rotateY:[0,160]},1,{easing:"easeInOutSine"}]]},"transition.whirlOut":{defaultDuration:750,calls:[[{opacity:[0,"easeInOutQuint",1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:0,scaleY:0,rotateY:160},1,{easing:"swing"}]],reset:{scaleX:1,scaleY:1,rotateY:0},resetEffectName:"transition.whirlIn"},"transition.shrinkIn":{defaultDuration:750,calls:[[{opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:[1,1.5],scaleY:[1,1.5],translateZ:0}]]},"transition.shrinkOut":{defaultDuration:600,calls:[[{opacity:[0,1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:1.3,scaleY:1.3,translateZ:0}]],reset:{scaleX:1,scaleY:1},resetEffectName:"transition.shrinkIn"},"transition.expandIn":{defaultDuration:700,calls:[[{opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:[1,.625],scaleY:[1,.625],translateZ:0}]]},"transition.expandOut":{defaultDuration:700,calls:[[{opacity:[0,1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:.5,scaleY:.5,translateZ:0}]],reset:{scaleX:1,scaleY:1},resetEffectName:"transition.expandIn"},"transition.bounceIn":{defaultDuration:800,calls:[[{opacity:[1,0],scaleX:[1.05,.3],scaleY:[1.05,.3]},.35],[{scaleX:.9,scaleY:.9,translateZ:0},.2],[{scaleX:1,scaleY:1},.45]]},"transition.bounceOut":{defaultDuration:800,calls:[[{scaleX:.95,scaleY:.95},.35],[{scaleX:1.1,scaleY:1.1,translateZ:0},.35],[{opacity:[0,1],scaleX:.3,scaleY:.3},.3]],reset:{scaleX:1,scaleY:1},resetEffectName:"transition.bounceIn"},"transition.bounceUpIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateY:[-30,1e3]},.6,{easing:"easeOutCirc"}],[{translateY:10},.2],[{translateY:0},.2]]},"transition.bounceUpOut":{defaultDuration:1e3,calls:[[{translateY:20},.2],[{opacity:[0,"easeInCirc",1],translateY:-1e3},.8]],reset:{translateY:0},resetEffectName:"transition.bounceUpIn"},"transition.bounceDownIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateY:[30,-1e3]},.6,{easing:"easeOutCirc"}],[{translateY:-10},.2],[{translateY:0},.2]]},"transition.bounceDownOut":{defaultDuration:1e3,calls:[[{translateY:-20},.2],[{opacity:[0,"easeInCirc",1],translateY:1e3},.8]],reset:{translateY:0},resetEffectName:"transition.bounceDownIn"},"transition.bounceLeftIn":{defaultDuration:750,calls:[[{opacity:[1,0],translateX:[30,-1250]},.6,{easing:"easeOutCirc"}],[{translateX:-10},.2],[{translateX:0},.2]]},"transition.bounceLeftOut":{defaultDuration:750,calls:[[{translateX:30},.2],[{opacity:[0,"easeInCirc",1],translateX:-1250},.8]],reset:{translateX:0},resetEffectName:"transition.bounceLeftIn"},"transition.bounceRightIn":{defaultDuration:750,calls:[[{opacity:[1,0],translateX:[-30,1250]},.6,{easing:"easeOutCirc"}],[{translateX:10},.2],[{translateX:0},.2]]},"transition.bounceRightOut":{defaultDuration:750,calls:[[{translateX:-30},.2],[{opacity:[0,"easeInCirc",1],translateX:1250},.8]],reset:{translateX:0},resetEffectName:"transition.bounceRightIn"},"transition.slideUpIn":{defaultDuration:900,calls:[[{opacity:[1,0],translateY:[0,"100%"],translateZ:0}]]},"transition.slideUpOut":{defaultDuration:900,calls:[[{opacity:[0,1],translateY:"-100%",translateZ:0}]],reset:{translateY:0},resetEffectName:"transition.slideUpIn"},"transition.slideDownIn":{defaultDuration:900,calls:[[{opacity:[1,0],translateY:[0,"-100%"],translateZ:0}]]},"transition.slideDownOut":{defaultDuration:900,calls:[[{opacity:[0,1],translateY:"100%",translateZ:0}]],reset:{translateY:0},resetEffectName:"transition.slideDownIn"},"transition.slideLeftIn":{defaultDuration:1e3,calls:[[{opacity:[1,0],translateX:[0,"-100%"],translateZ:0}]]},"transition.slideLeftOut":{defaultDuration:1050,calls:[[{opacity:[0,1],translateX:"-100%",translateZ:0}]],reset:{translateX:0},resetEffectName:"transition.slideLeftIn"},"transition.slideRightIn":{defaultDuration:1e3,calls:[[{opacity:[1,0],translateX:[0,"100%"],translateZ:0}]]},"transition.slideRightOut":{defaultDuration:1050,calls:[[{opacity:[0,1],translateX:"100%",translateZ:0}]],reset:{translateX:0},resetEffectName:"transition.slideRightIn"},"transition.slideUpBigIn":{defaultDuration:850,calls:[[{opacity:[1,0],translateY:[0,"-100%"],translateZ:0}]]},"transition.slideUpBigOut":{defaultDuration:800,calls:[[{opacity:[0,1],translateY:"-100%",translateZ:0}]],reset:{translateY:0},resetEffectName:"transition.slideUpBigIn"},"transition.slideDownBigIn":{defaultDuration:850,calls:[[{opacity:[1,0],translateY:[0,"-100%"],translateZ:0}]]},"transition.slideDownBigOut":{defaultDuration:800,calls:[[{opacity:[0,1],translateY:"100%",translateZ:0}]],reset:{translateY:0},resetEffectName:"transition.slideDownBigIn"},"transition.slideLeftBigIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateX:[0,"-100%"],translateZ:0}]]},"transition.slideLeftBigOut":{defaultDuration:750,calls:[[{opacity:[0,1],translateX:"-100%",translateZ:0}]],reset:{translateX:0},resetEffectName:"transition.slideLeftBigIn"},"transition.slideRightBigIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateX:[0,"100%"],translateZ:0}]]},"transition.slideRightBigOut":{defaultDuration:750,calls:[[{opacity:[0,1],translateX:"100%",translateZ:0}]],reset:{translateX:0},resetEffectName:"transition.slideRightBigIn"},"transition.perspectiveUpIn":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:["100%","100%"],rotateX:[0,-180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveUpOut":{defaultDuration:850,calls:[[{opacity:[0,1],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:["100%","100%"],rotateX:-180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateX:0},resetEffectName:"transition.perspectiveUpIn"},"transition.perspectiveDownIn":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:[0,0],rotateX:[0,180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveDownOut":{defaultDuration:850,calls:[[{opacity:[0,1],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:[0,0],rotateX:180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateX:0},resetEffectName:"transition.perspectiveDownIn"},"transition.perspectiveLeftIn":{defaultDuration:950,calls:[[{opacity:[1,0],transformPerspective:[2e3,2e3],transformOriginX:[0,0],transformOriginY:[0,0],rotateY:[0,-180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveLeftOut":{defaultDuration:950,calls:[[{opacity:[0,1],transformPerspective:[2e3,2e3],transformOriginX:[0,0],transformOriginY:[0,0],rotateY:-180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateY:0},resetEffectName:"transition.perspectiveLeftIn"},"transition.perspectiveRightIn":{defaultDuration:950,calls:[[{opacity:[1,0],transformPerspective:[2e3,2e3],transformOriginX:["100%","100%"],transformOriginY:[0,0],rotateY:[0,180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveRightOut":{defaultDuration:950,calls:[[{opacity:[0,1],transformPerspective:[2e3,2e3],transformOriginX:["100%","100%"],transformOriginY:[0,0],rotateY:180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateY:0},resetEffectName:"transition.perspectiveRightIn"}};for(var i in f.RegisterEffect.packagedEffects)f.RegisterEffect.packagedEffects.hasOwnProperty(i)&&f.RegisterEffect(i,f.RegisterEffect.packagedEffects[i]);f.RunSequence=function(a){var b=g.extend(!0,[],a);b.length>1&&(g.each(b.reverse(),function(a,c){var d=b[a+1];if(d){var e=c.o||c.options,h=d.o||d.options,i=e&&!1===e.sequenceQueue?"begin":"complete",j=h&&h[i],k={};k[i]=function(){var a=d.e||d.elements,b=a.nodeType?[a]:a;j&&j.call(b,b),f(c)},d.o?d.o=g.extend({},h,k):d.options=g.extend({},h,k)}}),b.reverse()),f(b[0])}}(window.jQuery||window.Zepto||window,window,window&&window.document)}),define("toast/animations/Animation",["../core","./_velocity","./_velocity.ui"],function(Toast,Velocity){"use strict";var STATUS_NONE=-1,STATUS_PLAYING=1,STATUS_REVERING=2,STATUS_COMPLETED=3,Animation=Toast.Animation=function(a,b,c){a||(a=[]),c||(c={}),this.id=Toast.UUID4().prefix("ani"),this.view=a,this.$el=this.view.$parent,this.options=c,this.initialize.apply(this,arguments)};return Toast.Animation.STATUS_NONE=STATUS_NONE,Toast.Animation.STATUS_PLAYING=STATUS_PLAYING,Toast.Animation.STATUS_REVERING=STATUS_REVERING,Toast.Animation.STATUS_COMPLETED=STATUS_COMPLETED,Toast.Animation.DURATION_DEFAULT=500,Toast.Animation.EASING_DEFAULT="ease-out-in",_.extend(Animation.prototype,{initialize:function(view,model,options){var Model=eval("Toast.Animation.Model."+model.name);Model&&(this.model=new Model(view,model),this.model.options.complete=$.proxy(this._complete,this)),this.playCount=0},play:function(){var a=_.extend({},this.model.options);this.isAnimating()&&(a.queue=!1),this.$el.velocity(this.model.properties(),a),this.setAnimating(!0),this.ref(),this.status(this.id,STATUS_PLAYING),this.playCount++;var b=this.data("animations");b||(this.data("animations",[]),b=this.data("animations")),b.push(this)},isAnimating:function(){return this.data("isAnimating-"+this.view.model.id)},setAnimating:function(a){this.data("isAnimating-"+this.view.model.id,a)},stop:function(){this.isAnimating()&&(this.$el.velocity("stop"),this.reset()),this.$el.velocity(this.model.reverses(),{duration:0})},stopImmediately:function(){this.$el.velocity("stop",!0),this.reset(),this.$el.velocity(this.model.reverses(),{duration:0})},count:function(a){return a?this.data("count-"+a+"-"+this.view.model.id):this.data("count-"+this.view.model.id)},ref:function(a){var b;b=a?a+"-"+this.view.model.id:this.view.model.id;var c=this.data("count-"+b);return c?c++:c=1,this.data("count-"+b,c),c},unref:function(a){var b;b=a?a+"-"+this.view.model.id:this.view.model.id;var c=this.data("count-"+b);return c?c--:c=1,c=Math.max(0,c),this.data("count-"+b,c),c},status:function(a,b){var c="status";if(a&&(c+="-"+a),1===arguments.length)return this.data(c);this.data(c,b)},reset:function(){this.removeData("animations"),this.removeData("count-"+this.view.model.id),this.setAnimating(!1),this.status(this.view.model.id,STATUS_NONE),this.status(this.id,STATUS_NONE),this.playCount=0},data:function(a,b){if(1===arguments.length)return this.$el.data(a);2===arguments.length&&this.$el.data(a,b)},removeData:function(a){this.$el.removeData(a)},_complete:function(a){var b=this.unref();if(!this.model.options._loop&&this.model.options.count===this.playCount&&this.status(this.id)===STATUS_REVERING)return this.playCount=0,this.status(this.view.model.id,STATUS_NONE),this.status(this.id,STATUS_NONE),void(this.options.completeCallback&&this.options.completeCallback(this.data("animations")));if(this.model.options._reverse||this.model.options._loop||this.model.options.count>1){if(this.status(this.id)===STATUS_REVERING&&(this.model.options._loop||this.model.options.count>1))return void this.play();var c=_.extend({},this.model.options);this.status(this.view.model.id)===STATUS_REVERING?c.queue=!1:this.status(this.view.model.id,STATUS_REVERING),this.status(this.id,STATUS_REVERING),this.model.options._reverse||(c.duration=0),this.$el.velocity(this.model.reverses(),c)}else 0==b&&this.options.completeCallback&&this.options.completeCallback(this.data("animations"))}}),_.extend(Animation,{create:function(a,b,c){return c||(c={}),c.effect?new Toast.Animation.Effect(a,b,c):new Animation(a,b,c)}}),Toast.Velocity=Velocity,Animation.extend=Toast.extend,Toast.Animation=Animation}),define("toast/animations/Effect",["../core","./Animation"],function(Toast,Animation){"use strict";var __super__=Animation.prototype,Effect=Animation.extend();return _.extend(Effect.prototype,__super__,{initialize:function(view,model,options){var Model=eval("Toast.Animation.Model");Model&&(this.model=new Model(view,model),this.model.options.complete=$.proxy(this._complete,this)),this.name=this.model._.name;var registerEffect=Toast.Velocity.RegisterEffect.packagedEffects[this.name];if(registerEffect){if(!model.properties.inputDuration&&model.properties.namedDurations){var defaultDuration=Toast.Velocity.RegisterEffect.packagedEffects[this.name].defaultDuration,model_=this.model._;switch(model_.properties.namedDurations){case"fast":this.model.options.duration=.7*defaultDuration;break;case"normal":this.model.options.duration=defaultDuration;break;case"slow":this.model.options.duration=defaultDuration+1.5;break;default:this.model.options.duration=defaultDuration}}this.isRegisterEffect=!0}this.playCount=0},play:function(){this.isRegisterEffect&&(this.data("org-style")||this.data("org-style",this.$el.attr("style")),this.$el.show(),this.$el.velocity(this.name,this.model.options))},stop:function(){this.isRegisterEffect&&(this.$el.velocity("stop"),this.reset(),this.$el.attr("style",this.data("org-style")),"showpage"===this.model._.event.type&&this.$el.hide())},stopImmediately:function(){this.isRegisterEffect&&(this.$el.velocity("stop",!0),this.reset(),this.$el.attr("style",this.data("org-style")),"showpage"===this.model._.event.type&&this.$el.hide())},_complete:function(a){if(this.model.options._loop||this.playCount<this.model.options.count-1){var b=Toast.Velocity.RegisterEffect.packagedEffects[this.name].resetEffectName;if(b&&this.status(this.id)!==Toast.Animation.STATUS_REVERING){var c=_.extend({queue:!1},this.model.options);this.status(this.id,Toast.Animation.STATUS_REVERING),this.$el.velocity(b,c)}else this.playCount++,this.status(this.id,Toast.Animation.STATUS_PLAYING),this.play()}}}),Toast.Animation.Effect=Effect}),define("toast/animations/Model",["../core","./Animation"],function(a,b){"use strict";var c=500,d=function(a,b){if(this.view=a,this._=b,this.options={},b.properties.easing&&(this.options.easing=b.properties.easing),b.properties.inputDuration)this.options.duration=b.properties.duration;else if(b.properties.namedDurations)switch(b.properties.namedDurations){case"fast":this.options.duration=300;break;case"normal":this.options.duration=c;break;case"slow":this.options.duration=800;break;default:this.options.duration=c}_.isUndefined(this.options.duration)&&(this.options.duration=c),b.properties.delay&&(this.options.delay=b.properties.delay),b.properties.reverse&&(this.options._reverse=b.properties.reverse),_.isUndefined(b.properties.count)?this.options.count=1:this.options.count=Number(b.properties.count),b.properties.loop&&(this.options._loop=b.properties.loop),this.initialize.apply(this,arguments)};return _.extend(d.prototype,{initialize:function(a,b,c){},properties:function(){return{}},reverses:function(){return{}}}),d.extend=a.extend,a.Animation.Model=d}),define("toast/animations/Opacity",["../core","./Model"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,c){_.isUndefined(a.style.opacity)?this._opacity=1:this._opacity=a.style.opacity},properties:function(){return{opacity:this._.properties.opacity/100}},reverses:function(){return{opacity:this._opacity}}}),a.Animation.Model.Opacity=d}),define("toast/animations/Position",["../core","./Model"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,c){var d,e=a.$parent.css("display");a.$parent.is(":visible")||"none"!==e||(a.$parent.show(),d=!0),this._left=parseInt(a.$parent.css("left")),this._top=parseInt(a.$parent.css("top")),d&&a.$parent.hide(),_.isEmpty(String(this._.properties.curve))||isNaN(this._.properties.curve)||(this.options.progress=$.proxy(this._progress,this))},properties:function(){if(this._.properties.offset){var a={};return a.left=parseInt(this.view.$parent.position().left/this.view.viewController.contentScale)+this._.properties.left,a.top=parseInt(this.view.$parent.position().top/this.view.viewController.contentScale)+this._.properties.top,a}return{left:this._.properties.left,top:this._.properties.top}},reverses:function(){return{left:this._left,top:this._top}},_progress:function(a,b,c,d,e){var f=this._.properties.curve,g=parseInt($(a).css("top"))-f,h=parseInt($(a).css("left")),i=($(a).height(),Math.sin(2*b*Math.PI),Math.cos(2*b*Math.PI));$(a).css({left:h,top:g+f*i})}}),a.Animation.Model.Position=d}),define("toast/animations/Size",["../core","./Model"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,c){this._width=a.$parent.width(),this._height=a.$parent.height(),(a.model.hasChildren()||a.model.container||a.model.multilayerContainer)&&(this.options.progress=$.proxy(this._progress,this,a))},properties:function(){if(this._.properties.offset){var a={};return 0!==this._.properties.width&&(a.width=this.view.$parent.width()+this._.properties.width),0!==this._.properties.height&&(a.height=this.view.$parent.height()+this._.properties.height),a}return{width:this._.properties.width,height:this._.properties.height}},reverses:function(){return{width:this._width,height:this._height}},_progress:function(a,b,c,d,e,f){if(a&&a.model&&(a.model.hasChildren()||a.model.container||a.model.multilayerContainer)){var g=$(b).width(),h=$(b).height();a.size({width:g,height:h},{save:!1})}}}),a.Animation.Model.Size=d}),define("toast/animations/Rotate",["../core","./Model"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,c){_.isUndefined(b.currentRotate)?this._deg=a.model.rotate:this._deg=b.currentRotate},properties:function(){return{rotateZ:this._.properties.angle+"deg"}},reverses:function(){return{rotateZ:this._deg+"deg"}}}),a.Animation.Model.Rotate=d}),define("toast/animations/Zoom",["../core","./Model"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,c){this._scale=a.$parent.tt_scale()},properties:function(){return{scale:this._.properties.zoomScale/100}},reverses:function(){return{scale:this._scale}}}),a.Animation.Model.Zoom=d}),define("toast/animations/Text",["../core","./Model"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a,b,c){}}),a.Animation.Model.Text=d}),define("toast/animations",["exports","./core","./animations/Animation","./animations/Effect","./animations/Opacity","./animations/Position","./animations/Size","./animations/Rotate","./animations/Zoom","./animations/Text"],function(a,b){}),define("toast/utils/PathUtils",["../core"],function(a){"use strict";function b(){function a(a){return function(b){return c.parseUrl(b)[a]}}var b,d,e=c.parsedUrlPropNames,f=e.length;for(b=0;b<f;b++)d=e[b],c[d]||(c[d]=a(d))}var c=a.PathUtils={urlParseRE:/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#\.]*(?:\.[^\?#\.]+)*(\.[^\?#\.]+)|[^\?#]*)))?(\?[^#]+)?)(#.*)?/,parsedUrlPropNames:["href","hrefNoHash","hrefNoSearch","domain","protocol","doubleSlash","authority","userinfo","username","password","host","hostname","port","pathname","directory","filename","filenameExtension","search","hash"],defaultPorts:{http:"80",https:"443",ftp:"20",ftps:"990"},parseUrl:function(a){if(a&&"object"==typeof a)return a;var b,d=c.urlParseRE.exec(a||"")||[],e=c.parsedUrlPropNames,f=e.length,g={};for(b=0;b<f;b++)g[e[b]]=d[b]||"";return g},port:function(a){var b=c.parseUrl(a);return b.port||c.defaultPorts[b.protocol]},isSameDomain:function(a,b){return c.parseUrl(a).domain===c.parseUrl(b).domain},isRelativeUrl:function(a){return""===c.parseUrl(a).protocol},isAbsoluteUrl:function(a){return""!==c.parseUrl(a).protocol},makePathAbsolute:function(a,b){if(a&&"/"===a.charAt(0))return a;a=a||"",b=b?b.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"";for(var c=b?b.split("/"):[],d=a.split("/"),e=0;e<d.length;e++){var f=d[e];switch(f){case".":break;case"..":c.length&&c.pop();break;default:c.push(f)}}return"/"+c.join("/")},makePathRelative:function(a,b){b=b?b.replace(/^\/|\/?[^\/]*$/g,""):"",a=a?a.replace(/^\//,""):"";for(var c=b?b.split("/"):[],d=a.split("/"),e=[],f=c.length,g=!1,h=0;h<f;h++)g=g||d[0]!==c[h],g?e.push(".."):d.shift();return e.concat(d).join("/")},makeUrlAbsolute:function(a,b){if(!c.isRelativeUrl(a))return a;var d=c.parseUrl(a),e=c.parseUrl(b),f=d.protocol||e.protocol,g=d.protocol?d.doubleSlash:d.doubleSlash||e.doubleSlash,h=d.authority||e.authority,i=""!==d.pathname;return f+g+h+c.makePathAbsolute(d.pathname||e.filename,e.pathname)+(d.search||!i&&e.search||"")+d.hash}};return b(),c}),define("toast/utils/Loader",["require","exports","module","../core","./PathUtils"],function(a,b,c,d,e){"use strict";function f(a){return $("<style>").text(a).appendTo("head")[0]}function g(a,b,c){var d={type:"text/css",rel:"stylesheet",href:a},e=$("<link/>").attr(d);return c&&e.attr(c),b&&b.resolve(),e.appendTo("head"),e[0]}function h(a,b){b=_.extend({parentEl:document.head},b);var c=$(b.parentEl).find('script[src="'+a+'"]');if(!_.isUndefined(c[0]))return b.success&&b.success(),c[0];var d=document.createElement("script");return d.src=a,d.addEventListener?(b.success&&d.addEventListener("load",b.success,!1),b.error&&d.addEventListener("error",b.error,!1)):d.readyState&&b.success&&(d.onreadystatechange=b.success),b.parentEl.appendChild(d),d}function i(a,b){var c=a.uri.substr(0,a.uri.lastIndexOf("/")+1);return b&&(c+=b),c}function j(a,b){var c=encodeURI(i(a,b));return"win"===d.platform&&-1!==c.indexOf(":")&&(c="file:///"+c),c}function k(a,b){var c=e.isAbsoluteUrl(b)?b:j(a,b);return $.get(c)}function l(a,b){var c=new $.Deferred;return k(a,b).done(function(a){var b=this.url,d=new $.Deferred,e=g(b,d);d.done(function(){c.resolve(e)}).fail(c.reject)}).fail(c.reject),c.fail(function(a,c,d){void 0!==a.readyState?console.error("[Loader] Unable to read stylesheet "+b+":",c,d):console.error("[Loader] Unable to process stylesheet "+b,a)}),c.promise()}function m(a,b){var c=new $.Deferred;return k(a,b).done(function(a){var b=this.url,d=h(b,{success:function(){c.resolve(d)},error:function(){c.reject()}})}).fail(c.reject),c.fail(function(a,c,d){void 0!==a.readyState?console.error("[Loader] Unable to read script "+b+":",c,d):console.error("[Loader] Unable to process script "+b,a)}),c.promise()}function n(a){return o(a+"/package.json")}function o(b){var c=new $.Deferred;return a(["text!"+b],function(a){try{var b=JSON.parse(a);c.resolve(b)}catch(a){c.reject()}}),c.promise()}b.addEmbeddedStyleSheet=f,b.addLinkedStyleSheet=g,b.getModulePath=i,b.getModuleUrl=j,b.loadFile=k,b.loadStyleSheet=l,b.loadScript=m,b.loadJson=o,b.loadPackageJson=n,b.addJavascript=h,d.Loader=b}),define("toast/utils/Async",["../core"],function(a){"use strict";var b=a.Async={ERROR_TIMEOUT:{}};return _.extend(b,{doInParallel:function(a,b,c){var d=[],e=new $.Deferred;if(0===a.length)e.resolve();else{var f=0,g=!1;a.forEach(function(h,i){var j=b(h,i);d.push(j),j.fail(function(){c?e.reject():g=!0}),j.always(function(){++f===a.length&&(g?e.reject():e.resolve())})})}return e.promise()},doSequentially:function(a,b,c){function d(g){if(g>=a.length)return void(f?e.reject():e.resolve());var h=b(a[g],g);h.done(function(){d(g+1)}),h.fail(function(){c?e.reject():(f=!0,d(g+1))})}var e=new $.Deferred,f=!1;return d(0),e.promise()},doSequentiallyInBackground:function(a,b,c,d){c=c||15,d=d||30;var e=(new Date).getTime();return doSequentially(a,function(a,f){var g=new $.Deferred;return b(a,f),(new Date).getTime()-e>=c?window.setTimeout(function(){e=(new Date).getTime(),g.resolve()},d):g.resolve(),g},!1)},firstSequentially:function(a,b){function c(e){if(e>=a.length)return void d.reject();b(a[e],e).fail(function(){c(e+1)}).done(function(){d.resolve(a[e])})}var d=new $.Deferred;return c(0),d.promise()},withTimeout:function(a,c,d){var e,f=new $.Deferred;return c>0&&(e=window.setTimeout(function(){d?f.resolve():f.reject(b.ERROR_TIMEOUT)},c)),a.always(function(){e&&window.clearTimeout(e)}),a.then(f.resolve,f.reject),f.promise()},waitForAll:function(a,b,c){var d=new $.Deferred,e=[],f=0,g=!1;return a&&0!==a.length?(b=void 0!==b,void 0!==c&&withTimeout(d,c),a.forEach(function(c){c.fail(function(a){g=!0}).done(function(a){e.push(a)}).always(function(){++f===a.length&&(b&&g?d.reject():d.resolve(e))})}),d.promise()):(d.resolve(),d.promise())},ready:function(a,b,c){return this.waitForAll(a,b,c)},chain:function(a,b){function c(b,e){if(a.length===b)d.resolveWith(null,e);else{var f=a[b++];try{var g=f.apply(null,e);g.hasOwnProperty("done")&&g.hasOwnProperty("fail")?(g.done(function(){c(b,arguments)}),g.fail(function(){d.rejectWith(null,arguments)})):c(b,[g])}catch(a){d.reject(a)}}}var d=$.Deferred();return c(0,b||[]),d.promise()},promisify:function(a,b){var c=new $.Deferred,d=Array.prototype.slice.call(arguments,2);return d.push(function(a){a?c.reject(a):c.resolve.apply(c,Array.prototype.slice.call(arguments,1))}),a[b].apply(a,d),c.promise()}}),b}),define("toast/utils/FontLoader",["exports","../core","./Async"],function(a,b,c){"use strict";function d(a,b){function c(){if(d&&d.offsetWidth!=e&&(d.parentNode.removeChild(d),d=null),g++,!d||g>5)return d&&(d.parentNode.removeChild(d),d=null),f&&clearInterval(f),b(),!0}var d=document.createElement("span");d.innerHTML="giItT1WQy@!-/#",d.style.position="absolute",d.style.left="-10000px",d.style.top="-10000px",d.style.fontSize="300px",d.style.fontFamily="sans-serif",d.style.fontVariant="normal",d.style.fontStyle="normal",d.style.fontWeight="normal",d.style.letterSpacing="0",document.body.appendChild(d);var e=d.offsetWidth;d.style.fontFamily=a;var f,g=0;c()||(f=setInterval(c,1))}function e(a){if(b.isPreview||b.isNative){if(a.default){if(a.private){var c=window.require.s.contexts._.config.locale;return c||(c=b.config.language||(b.config.language="ko")),"extensions/FontManager/fonts/default/"+c+"/"}return"extensions/FontManager/fonts/default/common/"}return"extensions/FontManager/fonts/user/"}return b.paths.assets+"fonts/"}function f(a,b){var c=$("head").find('[webfont][name="'+a.name+'"]');if(c.length)return void b.resolve();c=$("<link/>").attr({type:"text/css",rel:"stylesheet",href:e(a)+a.foldername+"/"+a.css,name:a.name,webfont:!0}),b&&c.on("readystatechange",function(){b.resolve()}).on("load",function(){b.resolve()}).on("error",function(){b.resolve()}),c.appendTo("head")}function g(a){$("head").find('[webfont][name="'+a.name+'"]').remove()}function h(a,e){var g=new $.Deferred;return e=_.extend({reset:!0},e),e.reset&&$("head").find("[webfont]").remove(),a||(a=b.config.fonts),_.isEmpty(a)?g.resolve():c.doInParallel(a,function(a){var b=new $.Deferred;return _.isEmpty(a.foldername)?b.resolve():e.wait?(f(a),d(a.name,function(){b.resolve()})):f(a,b),b.promise()}).always(function(){g.resolve()}),g.promise()}function i(){$("head").find("webfont").remove()}a.load=h,a.setCSS=f,a.unsetCSS=g,a.unloadAll=i,b.FontLoader=a}),define("text!toast/html-templates/dialog-template.html",[],function(){return'<div class="modal fade modal-dialog-center {{modalClassName}}" role="dialog" aria-hidden="true">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="btn close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n        <h4 class="modal-title">{{title}}</h4>\n      </div>\n      <div class="modal-body">\n        {{{content}}}\n      </div>\n      <div class="modal-footer">\n        {{#buttons}}\n        <button class="dialog-button btn {{className}}" data-button-id="{{id}}">{{text}}</button>\n        {{/buttons}}\n      </div>\n    </div>\n  </div>\n</div>\n\n'}),define("text!toast/html-templates/popup-modal.html",[],function(){return'<div {{#modalWrapperId}}id="{{modalWrapperId}}"{{/modalWrapperId}} class="modal-wrapper modal-wrapper-black popup-modal-wrapper">\n<button type="button" class="close" data-dismiss="modal"><span class="glyphicon glyphicon-remove" /></button>\n  <div class="modal-inner-wrapper">\n    <div class="modal modal-dialog-center popup-modal {{#modalClassName}}{{modalClassName}}{{/modalClassName}} fade in">\n      <div class="modal-dialog" style="max-width: {{modalDialogMaxWidth}}px;">\n        <div class="modal-content">\n          \x3c!--<button type="button" class="close" data-dismiss="modal"><span class="glyphicon glyphicon-remove" /></button>--\x3e\n          <div class="modal-body">\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'}),define("text!toast/html-templates/image-viewer.html",[],function(){return'<div class="iviewer">\n  <div class="viewer-window">\n    <div class="viewer-canvas">\n      <div class="viewer-tooltip"></div>\n      <div class="side-navigate-buttons">\n        <button class="btn btn-side-previous" data-action="prev">\n          <div class="arrow_carrot-left"></div>\n        </button>\n        <button class="btn btn-side-next" data-action="next">\n          <div class="arrow_carrot-right"></div>\n        </button>\n      </div>\n    </div>\n    <div class="viewer-footer">\n      <div class="viewer-title"></div>\n      <div class="viewer-description"></div>\n      <div class="viewer-number"></div>\n      \n      <ul class="viewer-toolbar">\n        <li class="viewer-zoom-in" data-action="zoom-in" title="{{Stringss.ZOOM_IN}}"></li>\n        <li class="viewer-zoom-out" data-action="zoom-out" title="{{Stringss.ZOOM_OUT}}"></li>\n        <li class="viewer-prev" data-action="prev" title="{{Strings.PREVIOUS}}"></li>\n        <li class="viewer-play" data-action="play" title="{{Strings.PLAY}}"></li>\n        <li class="viewer-next" data-action="next" title="{{Strings.NEXT}}"></li>\n        <li class="viewer-one-to-one" data-action="one-to-one" title="{{Strings.ORIGINAL_SIZE}}"></li>\n        <li class="viewer-reset" data-action="reset" title="{{Strings.RESET}}"></li>\n      </ul>\n      \n      <div class="viewer-navbar">\n        <ul class="viewer-list"></ul>\n      </div>\n    </div>\n    <div class="viewer-player"></div>\n  </div>\n  <div class="viewer-button" title={{Strings.CLOSE}} data-action="mix"><span class="glyphicon glyphicon-remove" data-action="mix"></span></div>\n</div>'}),define("text!toast/html-templates/audioplayer.html",[],function(){return'<audio ></audio>\r\n<div class="player-controlbars" data-control-btn-width="40">\r\n\t<div class="player-controlbar">\r\n\t\t<div class="left-control-group">\r\n\t\t\t<div class="control-btn" data-action="playAndPause">\r\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="play-icon">\r\n\t\t\t    <path d="M8 5v14l11-7z"/>\r\n\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t\t</svg>\r\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="pause-icon">\r\n\t\t\t    <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>\r\n\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t\t</svg>\r\n\t\t\t</div>\r\n\t\t\t<div class="player-time">\r\n\t\t\t\t<span class="player-time-current">0:00</span>\r\n\t\t\t\t<span class="player-time-separator"> / </span>\r\n\t\t\t\t<span class="player-time-duration">0:00</span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="player-bar">\r\n\t\t\t<div class="player-bar-loaded"></div>\r\n\t\t\t<div class="player-bar-played"></div>\r\n\t\t\t<div class="player-time-slider-wrap">\r\n\t\t\t\t<input type="range" max="100" value="0" data-time-slider>\t\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="right-control-group">\r\n\t\t\t<div class="player-volume-control-group">\r\n\t\t\t\t<div class="control-btn" data-action="mute">\r\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="mute-off-icon">\r\n\t\t\t\t    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>\r\n\t\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="volume-down-icon">\r\n\t\t\t\t    <path d="M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z"/>\r\n\t\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="mute-on-icon">\r\n\t\t\t\t    <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>\r\n\t\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n'}),define("text!toast/html-templates/videoplayer.html",[],function(){return'<video ></video>\r\n<div class="player-controlbars _hide" data-control-btn-width="40">\r\n\t<div class="player-bar">\r\n\t\t<div class="player-bar-loaded"></div>\r\n\t\t<div class="player-bar-played"></div>\r\n\t\t<div class="player-time-slider-wrap">\r\n\t\t\t<input type="range" max="100" value="0" data-time-slider>\t\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="player-controlbar">\r\n\t\t<div class="left-control-group">\r\n\t\t\t<div class="control-btn" data-action="playAndPause">\r\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="play-icon">\r\n\t\t\t    <path d="M8 5v14l11-7z"/>\r\n\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t\t</svg>\r\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="pause-icon">\r\n\t\t\t    <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>\r\n\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t\t</svg>\r\n\t\t\t</div>\r\n\t\t\t<div class="player-volume-control-group">\r\n\t\t\t\t<div class="control-btn" data-action="mute">\r\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="mute-off-icon">\r\n\t\t\t\t    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>\r\n\t\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="volume-down-icon">\r\n\t\t\t\t    <path d="M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z"/>\r\n\t\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="mute-on-icon">\r\n\t\t\t\t    <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>\r\n\t\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="player-volume-bar">\r\n\t\t\t\t\t<div class="player-volume-bar-wrap">\r\n\t\t\t\t\t\t<div class="player-volume-bar-line"></div>\r\n\t\t\t\t\t\t<div class="player-volume-bar-current"></div>\r\n\t\t\t\t\t\t<input type="range" max="100" value="0" data-volume-slider>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class="player-time">\r\n\t\t\t\t<span class="player-time-current">0:0</span>\r\n\t\t\t\t<span class="player-time-separator"> / </span>\r\n\t\t\t\t<span class="player-time-duration">0:0</span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="right-control-group">\r\n\t\t\t<div class="control-btn" data-action="toggleFullScreen">\r\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="fullscreen-icon">\r\n\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t    <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>\r\n\t\t\t\t</svg>\r\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="fullscreen-exit-icon">\r\n\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t    <path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>\r\n\t\t\t\t</svg>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class="center-icon center-play-btn">\r\n\t<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 841.89 595.281" enable-background="new 0 0 841.89 595.281" xml:space="preserve" pointer-events="none" fill="#fff">\r\n\t\t<path fill="#454545" fill-opacity="0.9" d="M823.566,96.33c-9.656-36.276-30.828-66.98-67.104-76.637  C690.72,2.112,420.945,0.502,420.945,0.502s-269.776,1.61-335.518,19.19C49.151,29.35,28.104,60.054,18.323,96.33  C0.743,162.071,0,297.64,0,297.64s0.743,135.568,18.323,201.311c9.657,36.275,30.828,66.98,67.104,76.637  c65.742,17.58,335.518,19.189,335.518,19.189s269.775-1.609,335.518-19.189c36.275-9.656,57.447-40.361,67.104-76.637  c17.58-65.742,18.324-201.311,18.324-201.311S841.146,162.071,823.566,96.33z"></path>\r\n\t\t<path d="M557.132,297.64L334.28,173.833v247.614"></path>\r\n\t</svg>\r\n</div>\r\n'}),define("text!toast/html-templates/videoplayer.mini.html",[],function(){return'<video ></video>\r\n<div class="player-controlbars" data-control-btn-width="40">\r\n\t<div class="player-controlbar">\r\n\t\t<div class="player-bar">\r\n\t\t\t<div class="player-bar-loaded"></div>\r\n\t\t\t<div class="player-bar-played"></div>\r\n\t\t\t<div class="player-time-slider-wrap">\r\n\t\t\t\t<input type="range" max="100" value="0" data-time-slider>\t\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="player-time">\r\n\t\t\t<span class="player-time-current">0:0</span>\r\n\t\t\t<span class="player-time-separator"> / </span>\r\n\t\t\t<span class="player-time-duration">0:0</span>\r\n\t\t</div>\r\n\t\t<div class="right-control-group">\r\n\t\t\t<div class="control-btn" data-action="toggleFullScreen">\r\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="fullscreen-icon">\r\n\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t    <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>\r\n\t\t\t\t</svg>\r\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="fullscreen-exit-icon">\r\n\t\t\t    <path d="M0 0h24v24H0z" fill="none"/>\r\n\t\t\t    <path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>\r\n\t\t\t\t</svg>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class="center-icon center-play-btn">\r\n\t<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 841.89 595.281" enable-background="new 0 0 841.89 595.281" xml:space="preserve" pointer-events="none" fill="#fff">\r\n\t\t<path fill="#454545" fill-opacity="0.9" d="M823.566,96.33c-9.656-36.276-30.828-66.98-67.104-76.637  C690.72,2.112,420.945,0.502,420.945,0.502s-269.776,1.61-335.518,19.19C49.151,29.35,28.104,60.054,18.323,96.33  C0.743,162.071,0,297.64,0,297.64s0.743,135.568,18.323,201.311c9.657,36.275,30.828,66.98,67.104,76.637  c65.742,17.58,335.518,19.189,335.518,19.189s269.775-1.609,335.518-19.189c36.275-9.656,57.447-40.361,67.104-76.637  c17.58-65.742,18.324-201.311,18.324-201.311S841.146,162.071,823.566,96.33z"></path>\r\n\t\t<path d="M557.132,297.64L334.28,173.833v247.614"></path>\r\n\t</svg>\r\n</div>\r\n'}),define("toast/utils/HtmlLoader",["exports","text!../html-templates/dialog-template.html","text!../html-templates/popup-modal.html","text!../html-templates/image-viewer.html","text!../html-templates/audioplayer.html","text!../html-templates/videoplayer.html","text!../html-templates/videoplayer.mini.html"],function(a,b,c,d,e,f,g){"use strict";a.Dialog=b,a.Popup=c,a.ImageViewer=d,a.AudioPlayer=e,a.VideoPlayer=f,a.VideoPlayerMimi=g,Toast.HtmlLoader=a}),define("toast/utils/ThemeLoader",["exports","../core"],function(a,b){"use strict";function c(a,b){var c=new $.Deferred,d=new $.Deferred,e=TT.Loader.addLinkedStyleSheet(a,d,b);return less.sheets=[e],less.refresh(),d.done(c.resolve).fail(c.reject),c.promise()}function d(a){var b=new $.Deferred,c={MyStorage:"../html-templates/mystorage.html",Searchbar:"../html-templates/searchbar.html",Searchlist:"../html-templates/searchlist.html",TOC:"../html-templates/toc.html",Thumbnail:"../html-templates/thumbnail.html",PrintModal:"../html-templates/print-dialog.html",ZoomBar:"../html-templates/zoombar.html",Share:"../html-templates/share.html",InputBar:"../html-templates/inputbar.html",Settings:"../html-templates/settings.html"};return a(["text!theme.json"],function(d){d=JSON.parse(d),d.templates=_.extend(c,d.templates),d.baseURL=a.toUrl(""),b.resolve(d)},function(){var d={templates:c};d.baseURL=a.toUrl(""),b.resolve(d)}),b.promise()}function e(){TT.$el=$(".toast"),TT.$bookContainer=TT.$el.find(".book-container"),TT.$book=TT.$bookContainer.find(".book"),TT.$navbar=TT.$el.find(".navbar"),TT.$controlbar=TT.$el.find(".controlbar"),TT.$toggleZoom=TT.$el.find('[command="toggleZoom"]'),TT.$fullscreen=TT.$el.find('[command="fullscreen"]'),TT.$search=TT.$el.find('[command="search"]'),TT.$first=TT.$el.find('[command="firstPage"]'),TT.$prev=TT.$el.find('[command="previousPage"]'),TT.$next=TT.$el.find('[command="nextPage"]'),TT.$last=TT.$el.find('[command="lastPage"]'),TT.config.reversePageTurnDirection&&(TT.$first.attr("title",TT.Strings.LAST_PAGE),TT.$prev.attr("title",TT.Strings.NEXT_PAGE),TT.$next.attr("title",TT.Strings.PREVIOUS_PAGE),TT.$last.attr("title",TT.Strings.FIRST_PAGE)),TT.$thumbnail=TT.$el.find('[command="thumbnail"]'),TT.$moveToUserInputPage=TT.$el.find('[command="moveToUserInputPage"]'),TT.$pagelabel=TT.$moveToUserInputPage.find(".label-page"),TT.$pageInput=TT.$el.find(".input-page"),TT.$toggleBookmark=TT.$el.find('[command="toggleBookmark"]'),TT.$toggleDoublePage=TT.$el.find('[command="toggleDoublePage"]'),TT.$toggleAutoSlide=TT.$el.find('[command="toggleAutoSlide"]'),TT.$toggleBgSound=TT.$el.find('[command="toggleBgSound"]'),TT.$startMenuDropdown=TT.$el.find(".start-menu.dropdown"),TT.$toggleAutoSlide=TT.$startMenuDropdown.find('[command="toggleAutoSlide"]'),TT.$print=TT.$el.find('[command="print"]')}function f(a){var c=new $.Deferred;return d(a).done(function(d){d.config&&!_.isEmpty(d.config)&&d.config.projectConfig&&(b.config=_.extend(b.project.config,d.config.projectConfig),delete d.config.projectConfig),b.theme=d,a(["text!theme.html"],function(b){g(a,b,d,c)})}),c.promise()}function g(a,c,d,f){var g=[];_.each(Object.keys(d.templates),function(a){g.push("text!"+d.templates[a])}),a(g,function(){var a=0,g=arguments;_.each(Object.keys(d.templates),function(c){b.HtmlLoader[c]=g[a],a++}),$(document.body).append(Mustache.render(c,{Toast:b,Strings:TT.Strings,theme:d})),0!==$(document.body).find(".start-menu").length&&b.DropdownMenAutoScroller.on(),e(),$(".svg-icon").tt_replaceSvgIcon(),f&&f.resolve(d)})}function h(a,d,e,g){var g=new $.Deferred;if(!(k=b.config.moduleBaseUrl)||"./"===b.config.moduleBaseUrl){var h=decodeURI(window.location.pathname),m=h.substr(0,h.lastIndexOf("/"));k=unescape(m)+"/"}l={text:k+"thirdparty/text",i18n:k+"thirdparty/i18n"},i&&j&&(i(j).unload(),TT.$el.remove(),i.undef(j),j=null);var n=$("head > #theme");return _.isUndefined(n[0])||n.remove(),n=$("head > #mobile-theme"),_.isUndefined(n[0])||n.remove(),b.paths.themeUrl=d,c(d+e+".css",{id:"theme"}).always(function(){var h={context:a,baseUrl:d,paths:l,locale:window.require.s.contexts._.config.locale,waitSeconds:30},k=window.require.s.contexts._.config.charset;k&&(h.charset=k);var m=window.require.config(h);i=m,m([e],function(){j=e,f(m).done(function(a){b.isMobileDevice&&_.isFunction(i(j).hasMobileStyleSheet)&&i(j).hasMobileStyleSheet()?c(d+e+".mobile.css",{id:"mobile-theme"}).always(function(){b.theme._context=i(j),i(j).load(d),b.dispatchReady(b.THEME_READY,i(j)),g.resolve()}):(b.theme._context=i(j),i(j).load(d),b.dispatchReady(b.THEME_READY,i(j)),g.resolve())})},g.resolve)}),g.promise()}var i,j,k,l={};a.load=h,b.ThemeLoader=a}),define("toast/utils/ImageUtils",["../core"],function(a){"use strict";return a.ImageUtils={getImageSize:function(a){var b=new $.Deferred,c=new Image;return c.onload=function(){b.resolve(this.width,this.height)},c.onerror=function(a){b.reject("Cannot load the image!")},c.src=a,b.promise()},resizeImage:function(a,b){var c=new $.Deferred,d=new Image;return d.onload=function(){var a=document.createElement("canvas");a.webkitImageSmoothingEnabled=!0;var e=a.getContext("2d"),f=Math.max(d.width/b,d.height/b),g={};g.width=Math.round(d.width/f),g.height=Math.round(d.height/f),a.width=g.width,a.height=g.height,e.drawImage(d,0,0,d.width,d.height,0,0,g.width,g.height),c.resolve(a.toDataURL(),g.width,g.height)},d.onerror=function(){c.reject("Cannot load the image!")},d.src=a,c.promise()}}}),define("toast/utils/Rect",["../core"],function(a){"use strict";var b=a.Rect={};return _.extend(b,{union:function(a,b){var c,d,e,f;return c=a.left<b.left?a.left:b.left,e=a.left+a.width>b.left+b.width?a.left+a.width:b.left+b.width,d=a.top<b.top?a.top:b.top,f=a.top+a.height>b.top+b.height?a.top+a.height:b.top+b.height,{left:c,top:d,width:e-c,height:f-d}}}),b}),define("toast/utils/Animate",["../core","./Async"],function(a,b){"use strict";a.animateUsingClass=function(a,c,d){function e(b){b.target===a&&g.resolve()}function f(){h.removeClass(c).off("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",e)}var g=new $.Deferred,h=$(a);return d=d||400,h.is(":hidden")?g.resolve():h.addClass(c).on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",e),b.withTimeout(g.promise(),d,!0).done(f)},jQuery.fn.extend({animateUsingClass:function(b,c){return a.animateUsingClass(this[0],b,c)}})}),define("toast/utils/jquery.utils",["../core"],function(a){"use strict";var b="",c=["Moz","Webkit","Khtml","O","ms"],d=c.length;for(b="";d--;)c[d]+"Transform"in document.body.style&&(b="-"+c[d].toLowerCase()+"-");jQuery.fn.extend({tt_enable:function(){return this.removeAttr("disabled")},tt_disable:function(){return this.attr("disabled","disabled")},tt_isDisabled:function(){return"disabled"===this.attr("disabled")},tt_select:function(){return this.each(function(){var a,b,c=$(this).get(0);document.body.createTextRange?(a=document.body.createTextRange(),a.moveToElementText(c),a.select()):window.getSelection&&(b=window.getSelection(),a=document.createRange(),a.selectNodeContents(c),b.removeAllRanges(),b.addRange(a))})},tt_deselect:function(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()},tt_moveCaretToEnd:function(){var a=$(this).get(0);if(void 0!==window.getSelection&&void 0!==document.createRange){var b=document.createRange();b.selectNodeContents(a),b.collapse(!1);var c=window.getSelection();c.removeAllRanges(),c.addRange(b)}else if(void 0!==document.body.createTextRange){var d=document.body.createTextRange();d.moveToElementText(a),d.collapse(!1),d.select()}},tt_getCaretPosition:function(){var a=$(this).get(0);if(a)return document.selection&&a.focus(),"selectionStart"in a?a.selectionStart:Math.abs(document.selection.createRange().moveStart("character",-a.value.length))},tt_rotate:function(a,b){if(0==arguments.length){var c=this.css("-webkit-transform")||this.css("-moz-transform")||this.css("-ms-transform")||this.css("-o-transform")||"";if(c=c.match("matrix\\((.*)\\)")){c=c[1].split(",");var d=c[0],e=c[1],a=(c[2],c[3],Math.sqrt(d*d+e*e),Math.round(Math.atan2(e,d)*(180/Math.PI)));return parseFloat(a)}return 0}return b||(b="deg"),this.tt_transform("rotate("+a+b+")")},tt_angle:function(){var a=this.css("-webkit-transform")||this.css("-moz-transform")||this.css("-ms-transform")||this.css("-o-transform")||"",b={rad:0,deg:0};return(a=a.match("matrix\\((.*)\\)"))&&(a=a[1].split(","),void 0!==a[0]&&void 0!==a[1]&&(b.rad=Math.atan2(a[1],a[0]),b.deg=parseInt(b.rad*(180/Math.PI)))),b},tt_scale:function(a){if(0==arguments.length){var b=this.css("-webkit-transform")||this.css("-moz-transform")||this.css("-ms-transform")||this.css("-o-transform")||"";return(b=b.match("matrix\\((.*)\\)"))?(b=b[1].split(","),parseFloat(b[0])):1}return this.tt_transform("scale("+a+")")},tt_transform:function(a,c){var d={};return c&&(d[b+"transform-origin"]=c),d[b+"transform"]=a,d.transform=a,this.css(d)},tt_removeAttrsWithPrefix:function(a){return this.each(function(){var b=$.map(this.attributes,function(a){return a.name}),c=$(this);$.each(b,function(b,d){a===d.substr(0,a.length)&&c.removeAttr(d)})})},tt_highlight:function(a){function b(a,c){var d=0;if(3==a.nodeType){var e=a.data.toUpperCase().indexOf(c);if((e-=a.data.substr(0,e).toUpperCase().length-a.data.substr(0,e).length)>=0){var f=document.createElement("span");f.className="highlight";var g=a.splitText(e),h=(g.splitText(c.length),g.cloneNode(!0));f.appendChild(h),g.parentNode.replaceChild(f,g),d=1}}else if(1==a.nodeType&&a.childNodes&&!/(script|style)/i.test(a.tagName))for(var i=0;i<a.childNodes.length;++i)i+=b(a.childNodes[i],c);return d}return this.length&&a&&a.length?this.each(function(){b(this,a.toUpperCase())}):this},tt_removeHighlight:function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName,this.parentNode.replaceChild(this.firstChild,this),this.parentNode.normalize()}).end()},tt_changeTag:function(a){var b=$("<"+a+">"),c={};$.each(this.get(0).attributes,function(a,b){c[b.name]=b.value}),b.attr(c),b.data(this.data());var d=this.children().clone(!0);return b.append(d),this.replaceWith(b),b},tt_replaceSvgIcon:function(){this.each(function(){var a=jQuery(this),b=a.attr("id"),c=a.attr("class"),d=a.attr("src"),e=a.attr("data-icon-color");tt.load(["text!"+d],function(d){var f=$(d);void 0!==b&&(f=f.attr("id",b)),void 0!==c&&(f=f.attr("class",c+" replaced-svg")),f=f.removeAttr("xmlns:a"),!f.attr("viewBox")&&f.attr("height")&&f.attr("width")&&f.attr("viewBox","0 0 "+f.attr("height")+" "+f.attr("width")),e&&f.css("fill",e),a.replaceWith(f)})})}}),jQuery.fn.doubletap=jQuery.fn.doubletap||function(b,c){c=null==c?300:c,this.bind(a.__eventTypes__.end,function(a){var d=(new Date).getTime(),e=$(this).data("lastTouch")||d+1,f=d-e;f<c&&0<f?($(this).data("lastTouch",null),null!==b&&"function"==typeof b&&b(a)):$(this).data("lastTouch",d)})},jQuery.tt_getScrollbarWidth=function(){var a=document.createElement("div");a.style.visibility="hidden",a.style.width="100px",a.style.msOverflowStyle="scrollbar",document.body.appendChild(a);var b=a.offsetWidth;a.style.overflow="scroll";var c=document.createElement("div");c.style.width="100%",a.appendChild(c);var d=c.offsetWidth;return a.parentNode.removeChild(a),b-d}}),define("toast/utils/jstree.plugins",["../core"],function(a){"use strict";var b=document.createElement("DIV");b.className="jstree-pageno",b.innerHTML="&#160;",$.jstree.plugins.pageno=function(c,d){this.teardown=function(){this.element.find(".jstree-pageno").remove(),d.teardown.call(this)},this.redraw_node=function(c,e,f,g){if(c=d.redraw_node.apply(this,arguments)){var h=b.cloneNode(!0);if(!_.isEmpty($(c).attr("data-page"))){var i=a.Book.toLogicalPageNumber(Number($(c).attr("data-page")));$(h).text(a.Book.getDisplayPageNumber(i))}c.insertBefore(h,c.childNodes[0])}return c}};var c=document.createElement("DIV");c.className="toc-svg-ocl-icon",$.jstree.plugins.svgoclicon=function(a,b){this.teardown=function(){this.element.find(".toc-svg-ocl-icon").remove(),b.teardown.call(this)},this.redraw_node=function(a,d,e,f){if(a=b.redraw_node.apply(this,arguments)){var g=$(c.cloneNode(!1));if(g.append('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" preserveAspectRatio="xMidYMid meet" height="1em" width="1em" viewBox="0 0 40 40" class="sc-TOsTZ hVqsCp" style="vertical-align: middle;"><g><path d="m12.3 13l7.7 7.7 7.7-7.7 2.3 2.4-10 10-10-10z"></path></g></svg>'),!$(a).hasClass("jstree-leaf")){var h=$(a).children(".jstree-ocl");h.length&&h.append(g)}}return a}};var d=document.createElement("DIV");d.className="toc-svg-file-icon",$.jstree.plugins.svgfileicon=function(a,b){this.teardown=function(){this.element.find(".toc-svg-file-icon").remove(),b.teardown.call(this)},this.redraw_node=function(a,c,e,f){if(a=b.redraw_node.apply(this,arguments)){var g=$(a).children(".jstree-anchor"),h=g.find(".jstree-file");if(h.length){var i=$(d.cloneNode(!1));i.append('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" preserveAspectRatio="xMidYMid meet" height="1em" width="1em" viewBox="0 0 40 40" style="vertical-align: middle;"><g><path d="m21.6 15h9.3l-9.3-9.1v9.1z m-11.6-11.6h13.4l10 10v20q0 1.3-1.1 2.3t-2.3 0.9h-20q-1.3 0-2.3-0.9t-1.1-2.3l0.1-26.8q0-1.3 1-2.3t2.3-0.9z"></path></g></svg>'),h.append(i)}}return a}};var e=document.createElement("DIV");e.className="toc-svg-folder-icon",$.jstree.plugins.svgfoldericon=function(a,b){this.teardown=function(){this.element.find(".toc-svg-folder-icon").remove(),b.teardown.call(this)},this.redraw_node=function(a,c,d,f){if(a=b.redraw_node.apply(this,arguments)){var g=$(a).children(".jstree-anchor"),h=g.find(".jstree-themeicon");if(h.length){if(!g.find(".jstree-file").length){var i=$(e.cloneNode(!1));i.append('<svg xmlns="http://www.w3.org/2000/svg" class="folder-open" width="24" height="24" viewBox="0 0 24 24"><path fill="#656978" d="M20.8 5.25H12L9.8 3H3.2C1.99 3 1 4.013 1 5.25v13.5C1 19.988 1.99 21 3.2 21h17.6c1.21 0 2.2-1.012 2.2-2.25V7.5c0-1.237-.99-2.25-2.2-2.25zm0 13.5H3.2V7.5h17.6v11.25z"/></svg>'),i.append('<svg xmlns="http://www.w3.org/2000/svg" class="folder-closed" viewBox="0 0 24 24"><path d="M9.8 3L12 5.2h8.8c1.2 0 2.2 1 2.2 2.2v11.2c0 1.2-1 2.2-2.2 2.2H3.2C2 21 1 20 1 18.8V5.2C1 4 2 3 3.2 3h6.6z" fill="#656978"/></svg>'),h.append(i)}}}return a}};var f=document.createElement("DIV");f.className="jstree-wholerowex",$.jstree.plugins.wholerowex=function(a,b){this.teardown=function(){this.element.find(".jstree-wholerowex").remove(),b.teardown.call(this)},this.redraw_node=function(a,c,d,e){if(a=b.redraw_node.apply(this,arguments)){var g=$(f.cloneNode(!1)),h=$("<div />",{class:"wholerowex-inner"});g.append(h);$(a).children(".jstree-anchor").prepend(g)}return a}}}),define("toast/utils/BackboneUtils",["../core"],function(a){"use strict";function b(a,b){Object.defineProperty(a,b,{get:function(){return a.get(b)},set:function(c){return a.set(b,c),a}})}function c(a,b){Object.defineProperty(a,b,{get:function(){return a.attributes[b]},set:function(c){a.attributes[b]=c}})}_.extend(Backbone.Model.prototype,{defineProperty:function(a){_.isUndefined(this[a])&&b(this,a)}}),_.extend(Backbone.Collection.prototype,{defineProperty:function(a){_.isUndefined(this[a])&&c(this,a)}})}),define("toast/utils/DropdownMenAutoScroller",["exports","../core"],function(a,b){"use strict";function c(a){var b=$(a.target).hasClass("dropup"),c=$(a.target).find(".dropdown-toggle"),d=$(a.target).find(".dropdown-menu");if(d.hasClass("auto-scrollbar")){var e,f=c.closest(".modal-content"),h=$(window),i={left:0,top:c.offset().top},j=(d[0],$("html").scrollTop()?$("html").scrollTop():$("body").scrollTop()),k=0;d[0].hasAttribute("data-space-height")&&(k=Number(d.attr("data-space-height"))),f.length&&("hidden"!==f.css("overflow")?f=null:h=f),b?(e=i.top-(j+k+20))<0&&(e=h.innerHeight()-(i.top+c.outerHeight())-(j+k+20)):e=h.innerHeight()-(i.top+c.outerHeight())-(k+20),f&&f.length&&(e+=f.offset().top),d.outerHeight()>e?(d.addClass("auto-scrollbar-on"),d.css({width:d.outerWidth()+g+"px",height:e+"px"})):(d.removeClass("auto-scrollbar-on"),d.css({width:"",height:""}))}}function d(a){var b=$(a.target).find(".dropdown-menu");b.hasClass("auto-scrollbar")&&b.css({width:"",height:""})}function e(){g=$.tt_getScrollbarWidth(),g<1&&(g=8),$(document.body).on("show.bs.dropdown",c),$(document.body).on("hide.bs.dropdown",d)}function f(){$(document.body).off("show.bs.dropdown",c),$(document.body).off("hide.bs.dropdown",d)}var g;a.on=e,a.off=f,b.DropdownMenAutoScroller=a}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("toast/utils/iNoBounce",b):a.iNoBounce=b()}(this,function(){var a=function(a){_.extend(this,a),this.initialize.apply(this,arguments)},b=!1;try{var c=Object.defineProperty({},"passive",{get:function(){b=!0}});window.addEventListener("test",null,c)}catch(a){}return _.extend(a.prototype,{initialize:function(a){this.startY=0,this.enabled=!1},enable:function(){this.enabled||(this._handleTouchstartFn=this._handleTouchstart.bind(this),this._handleTouchmoveFn=this._handleTouchmove.bind(this),this.win.addEventListener("touchstart",this._handleTouchstartFn,!!b&&{passive:!1}),this.win.addEventListener("touchmove",this._handleTouchmoveFn,!!b&&{passive:!1}),this.enabled=!0)},disable:function(){this.enabled&&(this.win.removeEventListener("touchstart",this._handleTouchstartFn,!1),this.win.removeEventListener("touchmove",this._handleTouchmoveFn,!1),this.enabled=!1)},isEnabled:function(){return this.enabled},_handleTouchstart:function(a){this.startY=a.touches?a.touches[0].screenY:a.screenY},_handleTouchmove:function(a){var b=a.target,c=this.win.innerWidth/this.win.document.documentElement.clientWidth;if(!(a.touches.length>1||1!==c)){for(;b!==this.doc.body&&b!==this.doc;){var d=this.win.getComputedStyle(b);if(!d)break;if("INPUT"===b.nodeName&&"range"===b.getAttribute("type"))return;var e=d.getPropertyValue("-webkit-overflow-scrolling"),f=d.getPropertyValue("overflow-y"),g=parseInt(d.getPropertyValue("height"),10),h="touch"===e&&("auto"===f||"scroll"===f),i=b.scrollHeight>b.offsetHeight;if(h&&i){var j=a.touches?a.touches[0].screenY:a.screenY,k=startY<=j&&0===b.scrollTop,l=startY>=j&&b.scrollHeight-b.scrollTop===g;return void((k||l)&&a.preventDefault())}b=b.parentNode}a.preventDefault()}}}),a}),define("toast/utils/IFrameInteraction",["exports","../core","./iNoBounce"],function(a,b,c){var d=2,e=4,f=8,g=16,h=function(a){_.extend(this,a),this.window=this.$frameEl[0].contentWindow,this.document=this.$frameEl[0].contentWindow.document,this.contentDocument=this.$frameEl[0].contentDocument||this.$frameEl[0].contentWindow.document,this.initialize.apply(this,arguments)};return _.extend(h.prototype,{initialize:function(a){var d=this.contentDocument;this._gesture=new b.Hammer.Manager(d.body,{inputClass:b.isMobileDevice?b.Hammer.TouchInput:b.Hammer.MouseInput,cssProps:{userSelect:"inherit"}}),this._panRecognizer=new b.Hammer.Pan({threshold:10,pointers:0}),this._tapRecognizer=new b.Hammer.Tap({event:"doubletap",taps:2,threshold:15,posThreshold:50}),this._pinchRecognizer=new b.Hammer.Pinch({threshold:0}),this._gesture.add(this._panRecognizer),this._gesture.add(this._tapRecognizer).recognizeWith([this._gesture.get("pan")]),this._gesture.add(this._pinchRecognizer).recognizeWith([this._gesture.get("pan")]),this.$book=b.Book.$getBook(),this.$container=this.$book.parent(),this._zoomModeDidChange(b.BookZoom.isActivated()),b.isIOS&&(this._inoBounce=new c({win:this.$frameEl[0].contentWindow,doc:d})),this._on()},_on:function(){$(this.contentDocument).find("html").attr("ondragstart","event.preventDefault();"),$(this.contentDocument.body).css({padding:0,margin:0,"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none"}),$(this.contentDocument).on("gesturestart",this._preventDefault),$(this.contentDocument).on("gesturechange",this._preventDefault),this._onDoubleTapFn=$.proxy(this._onDoubleTap,this),this._onPinchStartFn=$.proxy(this._onPinchStart,this),this._onPinchFn=$.proxy(this._onPinch,this),this._onPinchEndFn=$.proxy(this._onPinchEnd,this),this._onPanStartFn=$.proxy(this._onPanStart,this),this._onPanFn=$.proxy(this._onPan,this),this._onPanEndFn=$.proxy(this._onPanEnd,this),this._onScrollFn=$.proxy(this._onScroll,this),this._onDocumentTouchEndFn=$.proxy(this._onDocumentTouchEnd,this),this._onDocumentClickedFn=$.proxy(this._onDocumentClicked,this),this._onDocumentKeyDownFn=$.proxy(this._onDocumentKeyDown,this),this._gesture.on("doubletap",this._onDoubleTapFn),this._gesture.on("pinchstart",this._onPinchStartFn),this._gesture.on("pinchmove",this._onPinchFn),this._gesture.on("pinchend pinchcancel",this._onPinchEndFn),this._gesture.on("panstart",this._onPanStartFn),this._gesture.on("panmove",this._onPanFn),this._gesture.on("panend pancancel",this._onPanEndFn),$(this.document).on(b.__eventTypes__.end,this._onDocumentTouchEndFn),$(this.document).on("click",this._onDocumentClickedFn),$(this.document).on("scroll",this._onScrollFn),$(this.document).on("mousewheel",this._onScrollFn),$(this.document).on("keydown",this._onDocumentKeyDownFn),this._inoBounce&&this._inoBounce.enable(),this._contentHeight=$(this.contentDocument.body).height()},_off:function(){$(this.contentDocument).off("gesturestart",this._preventDefault),$(this.contentDocument).off("gesturechange",this._preventDefault),this._gesture.off("doubletap",this._onDoubleTapFn),this._gesture.off("pinchstart",this._onPinchStartFn),this._gesture.off("pinchmove",this._onPinchFn),this._gesture.off("pinchend pinchcancel",this._onPinchEndFn),this._gesture.off("panstart",this._onPanStartFn),this._gesture.off("panmove",this._onPanFn),this._gesture.off("panend pancancel",this._onPanEndFn),$(this.document).off(b.__eventTypes__.end,this._onDocumentTouchEndFn),$(this.document).off("click",this._onDocumentClickedFn),$(this.document).off("scroll",this._onScrollFn),$(this.document).off("mousewheel",this._onScrollFn),$(this.document).off("keydown",this._onDocumentKeyDownFn),this._inoBounce&&this._inoBounce.disable()},_onDocumentTouchEnd:function(a){this._documentClickInterval&&clearTimeout(this._documentClickInterval);var c=this;this._documentClickInterval=setTimeout(function(){c._isDocumentDefaultPrevented||b.send("frameDocumentClicked"),c._isDocumentDefaultPrevented=!1},50)},_onDocumentClicked:function(a){this._isDocumentDefaultPrevented||(this._isDocumentDefaultPrevented=a.isDefaultPrevented())},_onDocumentKeyDown:function(a){if(0===$(".modal.in").length&&!b.isInputBoxFocused())switch(a.keyCode){case b.KeyEvent.DOM_VK_PAGE_UP:case b.KeyEvent.DOM_VK_UP:this._updateScroll();break;case b.KeyEvent.DOM_VK_PAGE_DOWN:case b.KeyEvent.DOM_VK_DOWN:this._updateScroll();break;case b.KeyEvent.DOM_VK_HOME:this._updateScroll({top:!0});break;case b.KeyEvent.DOM_VK_END:this._updateScroll({bottom:!0});break;case b.KeyEvent.DOM_VK_SPACE:this._updateScroll()}},_onScroll:function(a){this._updateScroll(),b.send("frameDocumentScroll",a)},_onTouchStart:function(a){var b=(new Date).getTime();if(this._lastTouchTime){b-this._lastTouchTime<500&&(this._isPreventDefault=!0,this._preventDefault(a))}this._lastTouchTime=b},_onTouchEnd:function(a){this._isPreventDefault&&this._preventDefault(a),this._isPreventDefault=!1},_onDoubleTap:function(a){b.config.disableDoubleTapZoomGesture||b.config.disableZoomGesture||(a.preventDefault(),b.lazy(function(){if(b.BookZoom.isActivated())b.BookZoom.deactivate();else{var c=this._windowScale(),d={};d.x=a.center.x*c.x,d.y=a.center.y*c.y-this._frameOffset().top,b.BookZoom.activate({tapPoint:d})}},50,this))},_onPinchStart:function(a){b.config.disableZoomGesture||(this._startScale=a.scale,this.pinching=!0,this._isDocumentDefaultPrevented=!0)},_onPinch:function(a){if(!b.config.disableZoomGesture){if(!b.BookZoom.isActivated()&&a.scale>this._startScale){var c=this._windowScale(),d={};return d.x=a.center.x*c.x,d.y=a.center.y*c.y-this._frameOffset().top,void b.BookZoom.activate({tapPoint:d})}if(b.BookZoom.isActivated()){var e=b.BookZoom.getCurrentScales().zoom,f=e+(a.scale-this._startScale);b.BookZoom.setZoomScale(f),b.BookZoom._limitOffset(),b.BookZoom._update({smooth:!0})}}},_onPinchEnd:function(a){b.config.disableZoomGesture||(this.pinching=!1)},_canPan:function(a){var b=$(a.target),c=!b.closest(".prevent-pan").length;return this._inoBounce&&(c?this._inoBounce.enable():this._inoBounce.disable()),c},_onPanStart:function(a){this._isDocumentDefaultPrevented=!0,this._canPan(a)&&(this._startScrollTop=$(this.window).scrollTop(),this._startMarginTop=parseInt($(this.contentDocument.body).css("marginTop")),this._currentMarginTop=this._startMarginTop,this._startOffset=b.BookZoom._bookZoomOffset(),this._maxMarginTop=this._contentHeight-this.$frameEl.parent().height(),this._isScrollEnd=-this._maxMarginTop>=this._startMarginTop+delta.y)},_onPan:function(a){if(this._canPan(a)){var c={x:a.deltaX,y:a.deltaY},d=a.direction;if(this._isPanning(d)){if(this._direction=d,this._panning=!0,b.BookZoom.isActivated()){var e=b.BookZoom._bookZoomOffset(),f={left:e.left+c.x*this.view.viewController.contentScale,top:e.top+c.y*this.view.viewController.contentScale};b.BookZoom.getScaleMode()==b.BookZoom.SCALE_MODE_HORIZONTAL&&(f.left=e.left),b.BookZoom._update({offset:f})}}else this._isScrolling(d)?(this._scrolling=!0,this._onScrollByPan(a)):this._direction=d}},_onScrollByPan:function(a){var c=b.isIOS,d={x:a.deltaX,y:a.deltaY},e=$(this.window).scrollTop(),h=parseInt($(this.contentDocument.body).css("marginTop"))+parseInt($(this.contentDocument.body).css("marginBottom")),i=Math.max(this.contentDocument.body.scrollHeight+h-$(this.window).height(),0);switch(a.direction){case f:c?(this._isScrollEnd||(this._maxMarginTop=this._contentHeight-this.$frameEl.parent().height(),this._currentMarginTop=Math.max(-this._maxMarginTop,this._startMarginTop+d.y),$(this.contentDocument.body).css("marginTop",this._currentMarginTop)),b.BookZoom.isActivated()&&this._isScrollEnd&&b.BookZoom.moveTo("down",-d.y),this._isScrollEnd=-this._maxMarginTop>=this._startMarginTop+d.y):e+2>i?b.BookZoom.isActivated()&&b.BookZoom.moveTo("down",-d.y):$(this.window).scrollTop(this._startScrollTop-d.y);break;case g:c?(this._currentMarginTop=Math.min(0,this._startMarginTop+d.y),$(this.contentDocument.body).css("marginTop",this._currentMarginTop),b.BookZoom.isActivated()&&this._startMarginTop<10&&b.BookZoom.moveTo("up",d.y),this._isScrollEnd=-this._maxMarginTop>=this._startMarginTop+d.y):e?$(this.window).scrollTop(this._startScrollTop-d.y):b.BookZoom.isActivated()&&b.BookZoom.moveTo("up",d.y)}b.send("frameDocumentScroll",a)},_onPanEnd:function(a){if(this._canPan(a)){b.isIOS?this._currentMarginTop=parseInt($(this.contentDocument.body).css("marginTop")):this._currentScrollTop=$(this.window).scrollTop(),b.BookZoom.isActivated()?(b.BookZoom._limitOffset(),b.BookZoom._update({smooth:!0})):this.pinching||this._scrolling||b.config.disablePageMoveGesture||(this._direction===d?b.executeCommand(b.Commands.NEXT_PAGE):this._direction===e&&b.executeCommand(b.Commands.PREVIOUS_PAGE)),this.pinching=!1,this._panning=!1,this._scrolling=!1,this._direction=null}},_isPanning:function(a){return!this._scrolling&&(this._panning||a==d||a==e)},_isScrolling:function(a){return!this._panning&&(this._scrolling||a==f||a==g)},_zoomModeDidChange:function(a){if(a){window.location.origin||(window.location.origin=location.protocol+"//"+location.host);var c=window.location.pathname,d=c.substring(0,c.lastIndexOf("/")),e=window.location.origin+d+"/",f={cursor:"grab"};b.isIE&&(f.cursor="url("+e+"styles/images/grab.cur), url("+e+"styles/images/grab.cur), default"),$(this.contentDocument.body).css(f)}else $(this.contentDocument.body).css("cursor","")},_updateScroll:function(a){if(this._currentScrollTop=$(this.window).scrollTop(),b.BookZoom.isActivated()){a||(a={});var c,d=$(this.window).scrollTop(),e=parseInt($(this.contentDocument.body).css("marginTop"))+parseInt($(this.contentDocument.body).css("marginBottom")),f=Math.max(this.contentDocument.body.scrollHeight+e-$(this.window).height(),0);if(d+2>f||a.bottom?c="down":d&&!a.top||(c="up"),a.bottom?c="down":a.top&&(c="up"),a.top){var g=b.BookZoom._bookZoomOffset();g.top=0,b.BookZoom._update({offset:g}),b.BookZoom._limitOffset(!0)}else if(a.bottom){var h=b.$el.find(".bookzoom"),i=(this._availableParentWindowSize(),{width:h.width(),height:h.height()});b.BookZoom.moveTo(c,i.height)}else c&&b.BookZoom.moveTo(c,150)}},_availableParentWindowSize:function(){return{width:window.innerWidth-(window.innerWidth-this.$book.parent().width()),height:window.innerHeight-(window.innerHeight-this.$book.parent().height())}},_windowScale:function(){return{x:$(window).width()/$(this.window).width(),y:$(window).height()/$(this.window).height()}},_frameOffset:function(){return this.$frameEl.offset()},_preventDefault:function(a){a.preventDefault()},willReMountAll:function(){},remountAll:function(){try{b.isIOS?$(this.contentDocument.body).css("marginTop",this._currentMarginTop):$(this.window).scrollTop(this._currentScrollTop)}catch(a){}},didUpdateLayout:function(){if(!b.BookZoom.isActivated())try{this._contentHeight=$(this.contentDocument.body).height(),b._deviceRotating&&this.scrollTop(0)}catch(a){}},scrollTop:function(a){if(b.isIOS){var c=Math.max(-($(this.contentDocument.body).height()-$(this.$frameEl.parent()).height()),a);c=Math.min(0,c),$(this.contentDocument.body).css("marginTop",a)}else $(this.window).scrollTop(Math.max(1,a))},destroy:function(){this._off(),this._gesture.remove(this._panRecognizer),this._gesture.remove(this._tapRecognizer),this._gesture.remove(this._pinchRecognizer),this._gesture.destroy(),delete this._gesture,this._inoBounce&&delete this._inoBounce}}),b.IFrameInteraction=h}),define("toast/utils/ScrollInteraction",["exports","../core"],function(a,b){var c=8,d=16,e=function(a){this._setScrollCallbacks(a),_.extend(this,a),this.$el||(this.$el=this.view.$el),this.$el&&(this.el=this.$el[0]),this.contentEl=this.$contentEl[0],this.initialize.apply(this,arguments)};return _.extend(e.prototype,{initialize:function(a){this._gesture=new b.Hammer.Manager(this.el,{inputClass:b.isMobileDevice?b.Hammer.TouchInput:b.Hammer.MouseInput,cssProps:{userSelect:"inherit"}}),this._panRecognizer=new b.Hammer.Pan({threshold:10,pointers:0}),this._gesture.add(this._panRecognizer),this.$book=b.Book.$getBook(),this.$container=this.$book.parent(),this.$el.data("scroll-interaction",this),this._on()},_on:function(){this.$el.addClass("prevent-scroll scroll-interaction-el"),this.$el.css({padding:0,margin:0,"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none"}),this._onPanStartFn=$.proxy(this._onPanStart,this),this._onPanFn=$.proxy(this._onPan,this),this._onPanEndFn=$.proxy(this._onPanEnd,this),this._onScrollFn=$.proxy(this._onScroll,this),this._gesture.on("panstart",this._onPanStartFn),this._gesture.on("panmove",this._onPanFn),this._gesture.on("panend pancancel",this._onPanEndFn),this.$el.on("scroll",this._onScrollFn),this.$el.on("mousewheel",this._onScrollFn)},_off:function(){this.$el.removeClass("prevent-scroll scroll-interaction-el"),this._gesture.off("panstart",this._onPanStartFn),this._gesture.off("panmove",this._onPanFn),this._gesture.off("panend pancancel",this._onPanEndFn),this.$el.off("scroll",this._onScrollFn),this.$el.off("mousewheel",this._onScrollFn)},_setScrollCallbacks:function(a){a.scrollStart&&(this._scrollStartFn=a.scrollStart,delete a.scrollStart),a.scrollTo&&(this._scrollToFn=a.scrollTo,delete a.scrollTo),a.scrollEnd&&(this._scrollEndFn=a.scrollEnd,delete a.scrollEnd),a.isScrollTop&&(this._isScrollTopFn=a.isScrollTop,delete a.isScrollTop),a.isScrollBottom&&(this._isScrollBottomFn=a.isScrollBottom,delete a.isScrollBottom)},_onScroll:function(a){this.el.scrollHeight&&this._updateScroll(),b.send("scroll",a)},_onPanStart:function(a){this._startScrollTop=this.$el.scrollTop(),this._startMarginTop=parseInt(this.$el.css("marginTop")),this._currentMarginTop=this._startMarginTop,this._startOffset=b.BookZoom._bookZoomOffset();var e={x:a.deltaX,y:a.deltaY};if(b.BookZoom.isActivated()&&b.BookZoom._isPageStartOrEnd()&&(this._startDeltaY||(this._startDeltaY=e.y)),this._scrollStartFn){var f,g=this._startScrollTop-e.y/this.view.viewController.contentScale;switch(a.direction){case c:f="up";break;case d:f="down"}this._scrollStartFn(g,{direction:f})}},_onPan:function(a){var c=a.direction;this._isPanning(c)?(this._direction=c,this._panning=!0):this._isScrolling(c)?(this.isScrollTop()||this.isScrollBottom()?b.IS_SCROLLING=!1:b.IS_SCROLLING=!0,this._scrolling=!0,this._onScrollByPan(a)):this._direction=c},_onScrollByPan:function(a){var e=(b.isIOS,{x:a.deltaX,y:a.deltaY}),f=this.$el.scrollTop(),g=parseInt(this.$el.css("marginTop"))+parseInt(this.$el.css("marginBottom")),h=Math.max(this.el.scrollHeight+g-this.$el.height(),0),i=this._startScrollTop-e.y/this.view.viewController.contentScale;switch(a.direction){case c:this._scrollToFn?this._scrollToFn(i,{direction:"up"}):f+2<h&&this.$el.scrollTop(i);break;case d:this._scrollToFn?this._scrollToFn(i,{direction:"down"}):f&&this.$el.scrollTop(i)}this.isScrollTop()||this.isScrollBottom()||b.send("scroll",a)},_onPanEnd:function(a){if(this._currentScrollTop=this.$el.scrollTop(),b.BookZoom.isActivated()&&(b.BookZoom._limitOffset(),b.BookZoom._update({smooth:!0})),this._scrolling&&this._scrollEndFn){var e,f={x:a.deltaX,y:a.deltaY},g=this._startScrollTop-f.y/this.view.viewController.contentScale;switch(a.direction){case c:a.preventDefault(),e="up";break;case d:a.preventDefault(),e="down"}this._scrollEndFn(g,{direction:e})}this._panning=!1,b.IS_SCROLLING=this._scrolling=!1,this._startDeltaY=null,this._direction=null},_isPanning:function(a){return!this._scrolling&&(this._panning||2==a||4==a)},_isScrolling:function(a){return!this._panning&&(this._scrolling||a==c||a==d)},_updateScroll:function(a){if(this._currentScrollTop=this.$el.scrollTop(),b.BookZoom.isActivated()){a||(a={});var c,d=this.$el.scrollTop(),e=parseInt(this.$el.css("marginTop"))+parseInt(this.$el.css("marginBottom"));if(d+2>Math.max(this.el.scrollHeight+e-this.$el.height(),0)||a.bottom?c="down":d&&!a.top||(c="up"),a.bottom?c="down":a.top&&(c="up"),a.top){var f=b.BookZoom._bookZoomOffset();f.top=0,b.BookZoom._update({offset:f}),b.BookZoom._limitOffset(!0)}else if(a.bottom){var g=b.$el.find(".bookzoom"),h={width:g.width(),height:g.height()};b.BookZoom.moveTo(c,h.height)}else c&&b.BookZoom.moveTo(c,150)}},willReMountAll:function(){},remountAll:function(){try{this.$el.scrollTop(this._currentScrollTop)}catch(a){}},scrollTop:function(a){this.$el.scrollTop(Math.max(1,a))},isScrollTop:function(){return this._isScrollTopFn?this._isScrollTopFn():!this.$el.scrollTop()},isScrollBottom:function(){if(this._isScrollBottomFn)return this._isScrollBottomFn();var a=this.$el.scrollTop(),b=parseInt(this.$el.css("marginTop"))+parseInt(this.$el.css("marginBottom"));return a+2>Math.max(this.el.scrollHeight+b-this.$el.height(),0)},destroy:function(){this._off(),this._gesture.remove(this._panRecognizer),this._gesture.destroy(),delete this._gesture}}),b.ScrollInteraction=e}),define("toast/utils/Math",["../core"],function(a){"use strict";Math.radians=function(a){return a*Math.PI/180},Math.degrees=function(a){return 180*a/Math.PI},Math.distance=function(a,b,c,d){var e=c-a,f=d-b;return e*=e,f*=f,Math.sqrt(e+f)},Math.rotatepoint=function(a,b,c,d,e){var f=Math.PI/180*e,g=Math.cos(f),h=Math.sin(f);return{x:g*(c-a)+h*(d-b)+a,y:g*(d-b)-h*(c-a)+b}}}),define("toast/utils/Matrix",["../core"],function(a){function b(a,c){return{x:a||0,y:c||0,equal:function(a){return this.x===a.x&&this.y===a.y},add:function(a){return b(this.x+a.x,this.y+a.y)},subtract:function(a){return b(this.x-a.x,this.y-a.y)},scale:function(a){return b(this.x*a,this.y*a)},magnitude:function(){return b.distance(b(0,0),this)}}}function c(a,d,e,f,g,h){return a=void 0!==a?a:1,f=void 0!==f?f:1,{a:a,b:d||0,c:e||0,d:f,tx:g||0,ty:h||0,concat:function(a){return c(this.a*a.a+this.c*a.b,this.b*a.a+this.d*a.b,this.a*a.c+this.c*a.d,this.b*a.c+this.d*a.d,this.a*a.tx+this.c*a.ty+this.tx,this.b*a.tx+this.d*a.ty+this.ty)},deltaTransformPoint:function(a){return b(this.a*a.x+this.c*a.y,this.b*a.x+this.d*a.y)},inverse:function(){var a=this.a*this.d-this.b*this.c;return c(this.d/a,-this.b/a,-this.c/a,this.a/a,(this.c*this.ty-this.d*this.tx)/a,(this.b*this.tx-this.a*this.ty)/a)},rotate:function(a,b){return this.concat(c.rotation(a,b))},scale:function(a,b,d){return this.concat(c.scale(a,b,d))},transformPoint:function(a){return b(this.a*a.x+this.c*a.y+this.tx,this.b*a.x+this.d*a.y+this.ty)},translate:function(a,b){return this.concat(c.translation(a,b))}}}b.distance=function(a,b){return Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))},b.direction=function(a,b){return Math.atan2(b.y-a.y,b.x-a.x)},c.rotation=function(a,b){var d=c(Math.cos(a),Math.sin(a),-Math.sin(a),Math.cos(a));return b&&(d=c.translation(b.x,b.y).concat(d).concat(c.translation(-b.x,-b.y))),d},c.scale=function(a,b,d){b=b||a;var e=c(a,0,0,b);return d&&(e=c.translation(d.x,d.y).concat(e).concat(c.translation(-d.x,-d.y))),e},c.translation=function(a,b){return c(1,0,0,1,a,b)},c.IDENTITY=c(),c.HORIZONTAL_FLIP=c(-1,0,0,1),c.VERTICAL_FLIP=c(1,0,0,-1),a.Point=b,a.Matrix=c}),define("toast/utils",["./core","./utils/Loader","./utils/FontLoader","./utils/HtmlLoader","./utils/ThemeLoader","./utils/StringUtils","./utils/ImageUtils","./utils/Rect","./utils/Async","./utils/Animate","./utils/jquery.utils","./utils/jstree.plugins","./utils/BackboneUtils","./utils/DropdownMenAutoScroller","./utils/PopupSubpage","./utils/IFrameInteraction","./utils/ScrollInteraction","./utils/iNoBounce","./utils/Math","./utils/Matrix"],function(a){}),define("toast/views/UIView",["../core","../core/Model","../actions","../animations","../utils"],function(a,b,c,d){"use strict";var e=(a.Strings,["viewController","$parent","style","label","$contentMount","inlineStyle"]),f=Backbone.View.prototype,g=function(a){this.__events__=[],this._currentState=void 0,this.__changeState__=null,_.extend(this,_.pick(a,e)),f.constructor.apply(this,arguments)};return _.extend(g.prototype,f,{viewController:null,tagName:"div",className:"",attributes:{},style:{},model:b,maintainRatio:!1,__events__:[],__eventTypes__:"ontouchstart"in window?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},templateHTML:function(){return""},states:function(){return[]},state:function(a,b){if(!arguments.length)return this._currentState;b||(b={});var c=this._currentState!=a;if((c||b.force)&&(this._currentState=a,this.model.__changeState__)){var d=this._conditionalChangeStates(this.model.__changeState__.actions);this.model.__changeState__&&!_.isEmpty(d)&&this._executeActions(d);var e=this._conditionalChangeStates(this.model.__changeState__.animations);this.model.__changeState__&&!_.isEmpty(e)&&this._executeAnimations(e)}return c},initialize:function(b){if(_.extend(this,_.pick(b,e)),this.model.view=this,!this.viewController){var c=new a.ViewController({el:a.$el});c._state=a.STATUS_NONE,c.index=-1,this.viewController=c}_.isUndefined(this.model.properties)&&(this.model.properties={});var d=_.extend([],this.model.states,this.states()),f=[];_.each(d,function(a){_.find(f,{value:a.value})||f.push(a)},this),this.model.states=f},render:function(a){return this.isRender=!0,this.commonRender(),this.$parent.data("view",this),this.__refreshTimeout__||(this.__refreshTimeout__={}),_.isUndefined(this.model.properties.visible)&&(this.model.properties.visible=!0),!0!==this.model.properties.visible&&this.$parent.hide(),this.renderAccessibility(),this._setStyleToParent(),_.isUndefined(this.model.properties._orgVisible)&&(this.model.properties._orgVisible=this.model.properties.visible),this},commonRender:function(){this.$el.attr("data-view-type",this.model.get("viewType")),_.isEmpty(this.inlineStyle)||(this.style=_.extend(this.inlineStyle,this.style)),this.style=_.extend({},this.style,this.model.get("style"));var a=this.model.properties.backgroundColor;_.isUndefined(a)||(this.style.backgroundColor=a),_.isEmpty(this.style)||this.$el.css(this.style),this.corners(),this.origin(this.origin(),{save:!1}),this.rotate(this.model.rotate,{save:!1}),this.viewController.print&&this.print()},renderAccessibility:function(){_.isEmpty(this.model.label)||this.$el.attr("title",this.model.label)},print:function(){if(this.style.backgroundColor){var a=this.$el.attr("style");a+="; background-color: "+this.style.backgroundColor+" !important;",this.$el.attr("style",a)}},mount:function(){},mountAll:function(){this.isViewsDidMounted=!0,this.actions={},this.animations={},this.viewController.print||(_.isEmpty(this.model.actions)||_.each(this.model.actions,function(b){b.event||(b.event={type:"click"});var c=b.event.type,d=this.actions[b.event.type];d||(d=this.actions[b.event.type]=[]),"click"===b.event.type&&this.$parent.attr("data-prevent-event","click"),"drop"!==b.event.type||_.isUndefined(b.properties.targets)||!_.isEmpty(b.properties.targets)||_.isEmpty(b.properties.dropTargets)?(b=a.Action.create(this,b,{eventType:c}))&&d.push(b):_.each(b.properties.dropTargets,function(e){if(this.viewController._deepFind({id:e})){var f=_.cloneDeep(b);f.properties.targets=[e],(f=a.Action.create(this,f,{eventType:c}))&&(f.__autoDropTarget__=!0,d.push(f))}},this)},this),_.isEmpty(this.model.animations)||_.each(this.model.animations,function(b){b.event||(b.event={type:"click"});var c=this.animations[b.event.type];c||(c=this.animations[b.event.type]=[]),"click"===b.event.type&&this.$parent.attr("data-prevent-event","click");var d=[];_.isEmpty(b.properties.targets)?"drop"!==b.event.type||_.isEmpty(b.properties.dropTargets)?d.push(this.model):_.each(b.properties.dropTargets,function(a){var b=this.viewController._deepFind({id:a});b&&b.view&&(b.__autoDropTarget__=!0,d.push(b))},this):_.each(b.properties.targets,function(a){var b=this.viewController._deepFind({id:a});b&&b.view&&d.push(b)},this),_.each(d,function(d){var e=a.Animation.create(d.view,b,{effect:b.effect,completeCallback:$.proxy(this._onAanimationCompleted,this)});e&&c.push(e)},self)},this),this._setCursor(),this.model.properties.draggable&&(this.$parent.off("draginit dragstart drag dragend"),a.isMobileDevice||this.$parent.drag("init",$.proxy(this._onDragInit,this)),this.$parent.drag("start",$.proxy(this._onDragStart,this),{distance:1,drop:!0}),this.$parent.drag("drag",$.proxy(this._onDrag,this)),this.$parent.drag("end",$.proxy(this._onDragEnd,this))),(this.actions.init||this.animations.init)&&this._execute("init"),(this.actions.showpage||this.animations.showpage)&&this._stopAnimations(null,this.animations.showpage),(this.actions.click||this.animations.click)&&this.$parent.on("click",$.proxy(this._onClick,this)),(this.actions.mouseover||this.animations.mouseover)&&this.$parent.on("mouseover",$.proxy(this._onMouseOver,this)),(this.actions.mouseout||this.animations.mouseout)&&this.$parent.on("mouseout",$.proxy(this._onMouseOut,this)))},willAppear:function(){this.isWillAppear=!0},appear:function(){this.isAppeared=!0,(this.actions.showpage||this.animations.showpage)&&this._execute("showpage",{play:!0}),(this.actions.drop||this.animations.drop)&&(this.$parent.off("drop"),this.$parent.drop($.proxy(this._onDrop,this))),this.autostart()},willDisappear:function(){this.isWillAppear=!1},disappear:function(){this.isAppeared=!1,this.animations.showpage&&this._stopAnimations("showpage"),(this.actions.hidepage||this.animations.hidepage)&&this._execute("hidepage",{stop:!0}),(this.actions.drop||this.animations.drop)&&this.$parent.off("drop"),this.autostop()},didUpdateLayout:function(){},willReMountAll:function(){},remountAll:function(){},remove:function(){this.__off__(),this.model.__changeState__&&delete this.model.__changeState__,f.remove.call(this),this.$parent.remove(),this.isViewsDidMounted=!1},show:function(){this.isVisible()||(this.$parent.show(),this._execute("show"))},hide:function(){this.isVisible()&&(this.$parent.hide(),this._execute("hide"))},toggle:function(){this.isVisible()?this.hide():this.show()},isVisible:function(){return!(!this.$parent.is(":visible")&&"none"===this.$parent.css("display"))},position:function(a,b){if(!arguments.length)return{left:this.model.left,top:this.model.top};a||(a={}),b=_.extend({save:!0,silent:!0},b);var c={};_.isUndefined(a.left)||(c.left=a.left),_.isUndefined(a.top)||(c.top=a.top),_.isEmpty(c)||(b.save&&this.model.set(c,{silent:b.silent}),this.$parent.css(c))},offset:function(){for(var a=0,b=0,c=this.viewController.topParentViewController().$el.offset(),d=this.$parent[0];d&&!isNaN(d.offsetLeft)&&!isNaN(d.offsetTop);)a+=d.offsetLeft-d.scrollLeft,b+=d.offsetTop-d.scrollTop,d=d.offsetParent;return{top:b-c.top,left:a-c.left}},size:function(a,b){if(!arguments.length)return{width:this.model.width,height:this.model.height};a||(a={}),b=_.extend({save:!0,silent:!0},b);var c={};_.isUndefined(a.width)||(c.width=a.width),_.isUndefined(a.height)||(c.height=a.height),_.isEmpty(c)||(b.save&&this.model.set(c,{silent:b.silent}),this.$parent.css(c))},rotate:function(a,b){if(!arguments.length)return this.model.rotate;b=_.extend({save:!0},b),b.save&&this.model.set("rotate",a),this.$parent.tt_rotate(a)},origin:function(a,b){if(!arguments.length)return{x:this.model.originX,y:this.model.originY};b=_.extend({save:!0},b),b.save&&(this.model.set("originX",a.x),this.model.set("originY",a.y)),_.isUndefined(a.x)||_.isUndefined(a.y)||this.$parent.css("transform-origin",a.x+"px "+a.y+"px")},autostart:function(){},autostop:function(){},update:function(a,b){return this},scaleDidChange:function(a){},reset:function(){if(this._resetStyle(),!0!==this.model.properties._orgVisible&&(this.model.properties.visible=this.model.properties._orgVisible,this.hide()),this._setStyleToParent(),!_.isEmpty(this.model.states)&&(this._currentState=void 0,this.model.__changeState__)){var a=this.model.__changeState__.actions.concat(this.model.__changeState__.animations);_.each(a,function(a){a&&a.instance.view!==this&&a.instance.view.reset()},this)}},getResponsiveProperties:function(b){if(!this.model.responsives)return null;this._sortedResponsives||(this.model.responsives=_.sortBy(this.model.responsives,function(a){return a.properties.resp_width}),this._sortedResponsives=!0);var c;return _.each(this.model.responsives,function(d){var e=d.properties;if(e.resp_enable)if("lessOrEqual"!==e.resp_cond){if("mobile"===e.resp_cond&&a.isMobile)return c=e,!1;if("phone"===e.resp_cond&&a.isMobile&&!a.isTablet)return c=e,!1;if("tablet"===e.resp_cond&&a.isMobile&&a.isTablet)return c=e,!1;if("desktop"===e.resp_cond&&!a.isMobile)return c=e,!1}else if(!_.isUndefined(b)&&b<=e.resp_width)return c=e,!1},this),c},responsiveLayoutChanged:function(a){a||(a={});var b=this.model.properties,c=b.visible,d=this.getResponsiveProperties(a.responsiveWidth);b.visible=d?d.resp_visible:b._orgVisible,c!==b.visible&&(b.visible?this.show():this.hide());var e=a.responsiveWidth;return _.isUndefined(e)||this.size(this.responsiveSize(e,d)),d},responsiveSize:function(b,c){var d=this.model.layout,e={};if("none"===d.name){var f=b/a.view.collection._orgWidth;return e.width=this.model._orgWidth*f,e.height=this.model._orgHeight*f,this.model.fixedHeight&&(e.height=this.model._orgHeight),e}var g=d.padding.left+d.padding.right;if(d.collection._orgWidth<this.model._orgWidth+g+30){var f=b/this.model._orgWidth;e.width=b,e.height=this.model._orgHeight*f}else this.model.fitWidth=!1,e.width=this.model._orgWidth,e.height=this.model._orgHeight;return this.model.fixedHeight&&(e.height=this.model._orgHeight),e},beforeAutofit:function(a){this.position(a),this.size(a)},afterAutofit:function(a){this.position(a),this.size(a),this.model.firstOfRow=a.firstOfRow}}),g.MODEL=function(){return{}},g.extend=Backbone.View.extend,a.UIView=g}),define("toast/views/UIViewPrivate",["../core","./UIView"],function(a,b){"use strict";_.extend(b.prototype,{_resetStyle:function(){var a=this.model.properties.backgroundColor;_.isUndefined(a)||(this.style.backgroundColor=a),this.style=_.extend({},this.style,this.model.get("style")),this.$el.attr("style",""),this.$parent.css({left:this.model.get("left"),top:this.model.get("top"),width:this.model.get("width"),height:this.model.get("height")}),this.$el.css(this.style)},_setCursor:function(){if(this.model.properties.draggable)return this.style.cursor="pointer",void this.$el.css("cursor","pointer");var a=_.find(this.model.actions,function(a){if("click"===a.event.type)return this.$el.css("cursor","pointer"),!0},this);a||(a=_.find(this.model.animations,function(a){if("click"===a.event.type)return this.$el.css("cursor","pointer"),!0},this))},_setStyleToParent:function(){var a=this.$el.css("opacity");a&&(this.$parent.css("opacity",a),this.$el.css("opacity",""))},__on__:function(b,c,d){d||(d=this),c=$.proxy(c,d),this.__events__.push({name:b,callback:c}),a.on(b,c,d)},__off__:function(b,c){0===arguments.length?(_.each(this.__events__,function(b){a.off(b.name,b.callback)},this),this.__events__=[]):a.off(b,c)},_onClick:function(b){a.IS_DRAGGING||a.IS_PANNING||this._execute("click")},_onMouseOver:function(a){this._execute("mouseover")},_onMouseOut:function(a){this._execute("mouseout")}})}),define("toast/views/UIViewActionAndAnimation",["../core","./UIView"],function(a,b){"use strict";_.extend(b.prototype,{_execute:function(a,b){this.actions&&this._executeActions(this.actions[a]),this.animations&&this._executeAnimations(this.animations[a],b)},_executeActions:function(a){return!_.isEmpty(a)&&(_.isArray(a)||(a=[a]),_.each(a,function(a){a.execute()},this),!0)},_executeAnimations:function(a,b){return!_.isEmpty(a)&&(b||(b={play:!0}),_.isArray(a)||(a=[a]),_.each(a,function(a){b.play?(a.model._.properties.restart&&a.stopImmediately(),a.play()):b.stop&&a.stopImmediately()},this),!0)},_stopAnimations:function(a,b){b?this._executeAnimations(b,{stop:!0}):a?this._executeAnimations(this.animations[a],{stop:!0}):_.isEmpty(this.animations)||_.each(Object.keys(this.animations),function(a){this._executeAnimations(this.animations[a],{stop:!0})},this)},_onAanimationCompleted:function(a){!_.isEmpty(a)&&a[0].drop&&a[0].drop!==this&&a[0].drop._onAanimationCompleted(a)},_conditionalChangeStates:function(a){_.isEmpty(a);var b=[];return _.each(a,function(a){this._conditionalChangeState(a)&&b.push(a.instance)},this),b},_conditionalChangeState:function(a){var b,c,d=!0,e=a.states,f=a.models;return"if"===a.condition?b=0:"if_or"===a.condition?b=1:"else"===a.condition?b=2:"else_or"===a.condition&&(b=3),_.isEmpty(e)?d=!1:_.each(e,function(a){if(c)return!1;var g=[];_.each(e,function(b){b.target===a.target&&g.push(b)},this);var h=_.find(f,{id:a.target});!h||_.isUndefined(h.view._currentState)||_.isNull(h.view._currentState)?(d=!1,c=!0):0==b?_.each(g,function(a){if(h.view._currentState!=a.value)return d=!1,c=!0,!1}):1==b?(d=!1,_.each(g,function(a){if(h.view._currentState==a.value)return d=!0,c=!0,!1})):2==b?_.each(g,function(a){if(h.view._currentState==a.value)return d=!1,c=!0,!1}):3==b&&(d=!1,_.each(g,function(a){if(h.view._currentState!=a.value)return d=!0,c=!0,!1}))},this),d}})}),define("toast/views/UIViewDragAndDrop",["../core","./UIView"],function(a,b){"use strict";_.extend(b.prototype,{_onDragInit:function(b){if(a.IS_ZOOM&&a.IS_ZOOM_DRAG_MODE)return!1},_onDragStart:function(b,c){b.stopPropagation(),c.dropActions&&delete c.dropActions,c.dropAnimations&&delete c.dropAnimations,c.dropAccepts&&delete c.dropAccepts,c.dropRejects&&delete c.dropRejects,a.isMobileDevice?a.lazy(function(){this._doDragStart(b,c)},10,this):this._doDragStart(b,c)},_doDragStart:function(b,c){if(!a.IS_ZOOM_DRAG_MODE){a.IS_DRAGGING=!0;var d=$(c.drag);c.zIndex=d.css("zIndex"),c.startOffset={left:parseInt(d.css("left"),10),top:parseInt(d.css("top"),10)},c.contentScale=this.viewController.contentScale,d.css("zIndex",9999),c.drag.view=this,this.model.__dropSuccess__&&(this.model.__dropSuccess__.__dropped__=!1,this.model.__dropSuccess__=null),this._execute("dragStart")}},_onDrag:function(b,c){if(a.IS_DRAGGING&&!a.IS_ZOOM_DRAG_MODE){var d=$(c.drag),e={};e.left=c.startOffset.left+c.deltaX/c.contentScale,e.top=c.startOffset.top+c.deltaY/c.contentScale,d.css(e)}},_onDragEnd:function(b,c){if(!a.IS_ZOOM_DRAG_MODE){$(c.drag).css("zIndex",c.zIndex),this._execute("dragEnd"),this._doDropActions(c),this._doDropAnimations(c),_.isEmpty(c.drop)&&_.isEmpty(c.dropAccepts)&&_.isEmpty(c.dropRejects)&&this._execute("dropReject"),c.dropAccepts&&(_.each(c.dropAccepts,function(a){this._onDropAccept(a)},this),delete c.dropAccepts),c.dropRejects&&(_.each(c.dropRejects,function(a){this._onDropReject(a)},this),delete c.dropRejects),a.lazy(function(){a.IS_DRAGGING=!1},5,this)}},_doDropActions:function(a){if(a.dropActions){var b=[];_.each(a.dropActions,function(c){c.__autoDropTarget__?(_.isUndefined(c.properties.targets)||-1!==c.properties.targets.indexOf(a.dropActions.drop.model.id))&&b.push(c):b.push(c)},this),this._executeActions(b),delete a.dropActions}},_doDropAnimations:function(a){if(a.dropAnimations&&!this._hasDropAcceptAnimations(a)&&!this._hasDropRejectAnimations(a)){var b=[];_.each(a.dropAnimations,function(c){c.view.model.__autoDropTarget__?c.model.view.model.id===a.dropAnimations.drop.model.id&&b.push(c):b.push(c)},this),this._executeAnimations(b),delete a.dropAnimations}},_hasDropAcceptAnimations:function(a){return!_.isEmpty(a.dropAccepts)&&_.find(a.dropAccepts,function(a){return!_.isEmpty(a.animations.dropAccept)})},_hasDropRejectAnimations:function(a){return!_.isEmpty(a.dropRejects)&&_.find(a.dropRejects,function(a){return!_.isEmpty(a.animations.dropReject)})},_onDrop:function(a,b){var c=b.drag.view,d=$(b.drag),e=d.attr("id"),f=!1,g=c.viewController._deepFind({id:this.$parent.attr("id")});if(!g)return!1;var h=g.view,i=[],j=[],k=[],l=[];return _.each(h.actions.drop,function(a){var b=_.find(a.properties.dropTargets,function(a){if(a==e)return!0});if(b){var c=h.viewController._deepFind({id:b});c&&(_.isUndefined(a.properties.dropResult)?(k.drop=c.view,k.push(a)):!a.properties.multipleDropSuccess&&a.__dropped__?j.push(c.view):a.properties.dropResult?(a.__dropped__=!0,c.__dropSuccess__=a,i.push(c.view)):j.push(c.view))}}),_.each(h.animations.drop,function(a){var b=_.find(a.model._.properties.dropTargets,function(a){if(a==e)return!0});if(b){var c=h.viewController._deepFind({id:b});c&&(l.drop=c.view,l.push(a))}}),_.isEmpty(i)||(b.dropAccepts=i),_.isEmpty(j)||(b.dropRejects=j),_.isEmpty(k)&&_.isEmpty(l)||(_.isEmpty(k)||(b.dropActions=k),_.isEmpty(l)||(b.dropAnimations=l),f=!0),f},_onDropAccept:function(a){a?a._execute("dropAccept"):this._execute("dropAccept")},_onDropReject:function(a){a?a._execute("dropReject"):this._execute("dropReject")}})}),define("toast/views/UIViewCollisionDetector",["../core","./UIView"],function(a,b){"use strict";function c(a){return Math.sin(a/180*Math.PI)}function d(a){return Math.cos(a/180*Math.PI)}function e(a,b,c,d){var e={x:a+c/2,y:b+d/2},f={x:a-e.x,y:b-e.y};return Math.sqrt(f.x*f.x+f.y*f.y)}function f(a,b,e,f,g){var h={x:a+e/2,y:b+f/2},i={x:a-h.x,y:b-h.y},j=[[d(g),-c(g)],[c(g),d(g)]],k={x:i.x*j[0][0]+i.y*j[0][1],y:i.x*j[1][0]+i.y*j[1][1]};return{x:h.x+k.x,y:h.y+k.y}}function g(a,b,c){var d,e,f=0,g=a.length;for(d=0,e=g-1;d<g;e=d++)a[d].y>c!=a[e].y>c&&b<(a[e].x-a[d].x)*(c-a[d].y)/(a[e].y-a[d].y)+a[d].x&&(f=!f);return f}function h(a,b){return 180-Math.acos(a/b)*(180/Math.PI)*2}function i(a,b){var c=!1;return a.corners().forEach(function(a){g(b.corners(),a.x,a.y)&&(c=!0)}),c}function j(a,b){return a.corners(),b.corners(),!!i(a,b)||!!i(b,a)}_.extend(b.prototype,{corners:function(a){var b=this.model.rotate,c=this.offset(),d=this.size();this.leftTopCorner=f(c.left,c.top,d.width,d.height,b);var g=e(c.left,c.top,d.width,d.height);return b+=h(d.width/2,g),this.rightTopCorner=f(c.left,c.top,d.width,d.height,b),b+=h(d.height/2,g),this.rightBottomCorner=f(c.left,c.top,d.width,d.height,b),b+=h(d.width/2,g),this.leftBottomCorner=f(c.left,c.top,d.width,d.height,b),this._corners=[this.leftTopCorner,this.rightTopCorner,this.rightBottomCorner,this.leftBottomCorner]},isCollided:function(a){return j(this,a)}})}),define("toast/views/UIGroup",["../core","./UIView"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{style:{},maintainRatio:!0,initialize:function(a){c.initialize.call(this,a)},initializeChildren:function(){this.model.orgWidth=this.model.width,this.model.orgHeight=this.model.height;var b=this.model.__children__;_.each(b,function(b){var c;this.viewController.htmlRender&&(c=this.$el.find("#"+b.get("id"))),c&&c.length||(c=this.viewController._createModelElement(b),this.$el.append(c)),b.view=a.Factory.create(this.viewController,b,c)},this)},size:function(a,b){if(!arguments.length)return c.size.call(this);c.size.call(this,a,b);var d=a.width/this.model.orgWidth,e=a.height/this.model.orgHeight,f=this.model.__children__;_.each(f,function(a){a.original||(a.original={left:a.left,top:a.top,width:a.width,height:a.height});var b={left:parseInt(a.original.left*d,10),top:parseInt(a.original.top*e,10)},c={width:parseInt(a.original.width*d,10),height:parseInt(a.original.height*e,10)};a.view.position(b),a.view.size(c)},this)},mount:function(){c.mount.apply(this,arguments),this.initializeChildren()},mountAll:function(){c.mountAll.call(this);var a=this.model.__children__;_.each(a,function(a){a.view&&a.view.mountAll(),this.viewController.__setChangeState__(a.view.actions.changeState,a,"actions"),this.viewController.__setChangeState__(a.view.animations.changeState,a,"animations")},this)},willAppear:function(){c.willAppear.call(this);var a=this.model.__children__;_.each(a,function(a){a.view&&a.view.willAppear()},this)},appear:function(){c.appear.call(this);var a=this.model.__children__;_.each(a,function(a){a.view&&a.view.appear()},this)},willDisappear:function(){c.willDisappear.call(this);var a=this.model.__children__;_.each(a,function(a){a.view&&a.view.willDisappear()},this)},disappear:function(){c.disappear.call(this);var a=this.model.__children__;_.each(a,function(a){a.view&&a.view.disappear()},this)},scaleDidChange:function(a){c.scaleDidChange.call(this,a);var b=this.model.__children__;_.each(b,function(b){b.view&&b.view.scaleDidChange(a)},this)},remove:function(){var a=this.model.__children__;_.each(a,function(a){a.view&&a.view.remove()},this),c.remove.call(this)}}),a.UIGroup=d}),define("toast/views/UIText",["../core","./UIView"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{textEditable:!0,maintainRatio:!0,attributes:{"data-text-content":!0},style:{fontFamily:"NanumGothic",whiteSpace:"normal",wordBreak:"normal"},initialize:function(a){c.initialize.call(this,a)},render:function(){return c.render.call(this),this},commonRender:function(){this.style=_.extend({},c.style,this.style),this.$textWrap=this.$el.find(".text-wrap"),this.$textWrap.length||(this.$textWrap=$("<div />",{class:"text-wrap"}),this.hasTag(this.getText())?this.$textWrap.html(this.getText()):this.$textWrap.html("<div>"+this.getText()+"</div>"),this.$el.append(this.$textWrap)),c.commonRender.call(this)},size:function(a,b){if(!arguments.length)return c.size.call(this);c.size.call(this,a,b);var d=this.model;if(d.original){var e=this.model.style,f=d.width/d.original.width;return _.isUndefined(d.original.fontSize)&&(d.original.fontSize=parseInt(this.$el.css("fontSize"))),e.fontSize=parseInt(d.original.fontSize*f),this.$el.css("fontSize",e.fontSize),this.resizeFontSize(this.$textWrap.children()),d.set("htmlText",this.$textWrap.html()),this}},resizeFontSize:function(a){var b=this,c=this.model,d=(this.model.style,c.width/c.original.width);a.children().each(function(a,c){var e=$(c),f=e.attr("data-start-font-size");f&&(f=parseInt(f)*d,e.css("fontSize",f)),e.children().length&&b.resizeFontSize(e)})},responsiveLayoutChanged:function(a){var b=c.responsiveLayoutChanged.call(this,a);this.model.properties;return b?this.$el.attr("text-align",b.resp_textAlign):this.$el[0].hasAttribute("text-align")&&this.$el.removeAttr("text-align"),b},beforeAutofit:function(a){c.beforeAutofit.call(this,a),this.autoFit({save:!0})},afterAutofit:function(a){c.afterAutofit.call(this,a),this.autoFit({save:!0})},autoFit:function(a){a=_.extend({add:0},a);var b=this.$textWrap.height(),c=Math.max(this.model.height,b+a.add);this.model.collection.block&&(c=b+a.add);var d={};if(c&&(d.height=c,a.save&&(this.model.set("height",c),this.model.__parent__&&object.initialArea&&(this.model.__extra__.initialArea.height=c))),_.isEmpty(d)||this.$parent.css(d),b)this.__clearFixedWrapHeight__&&(this.$textWrap.css("height",""),this.$textWrap.height()?this.__clearFixedWrapHeight__=!1:this.autoFit());else{this.__clearFixedWrapHeight__=!0;var e=this.$textWrap.html();this.$textWrap.html("<div> </div>"),b=this.$textWrap.height(),this.$textWrap.html(e),this.$textWrap.css("height",b)}return c},isEmpty:function(){return void 0===this.getText()||0===this.getText().replace(/(<([^>]+)>)/gi,"").replace("&nbsp;","").length},setTextStyle:function(a){_.each(Object.keys(a),function(b){this.style[b]=a[b],this.$el.css(b,a[b])},this)},getText:function(){return this.model.get("htmlText")||""},setText:function(a){this.model.set("htmlText",a)},hasTag:function(a){return new RegExp("(<(/?[^>]+)>)").test(a)}}),a.UIText=d}),define("toast/views/UIImageButton",["../core","../utils/ImageUtils","./UIText"],function(a,b,c){"use strict";var d=(a.Strings,c.prototype),e=c.extend();return _.extend(e.prototype,d,{tagName:"div",className:"image-btn text-center",style:{fontSize:"14px",width:"100%",height:"100%",minHeight:"20px",outline:"none",color:"#333"},initialize:function(a){d.initialize.call(this,a)},render:function(){return d.render.call(this),this},commonRender:function(){this.style=_.extend({},d.style,this.style),d.commonRender.call(this),this._setImageElements(),this.setState(this.model.properties.buttonState,!0)},mount:function(){d.mount.call(this),a.isMobileDevice||_.isEmpty(this.model.properties.overImage)||this.$el.hover($.proxy(this._onHover,this),$.proxy(this._onOut,this)),this.$el.on(this.__eventTypes__.start,$.proxy(this._onDown,this)),this.$el.on(this.__eventTypes__.end,$.proxy(this._onUp,this))},setState:function(a,b){if(this.buttonState!==a||b){var c;"selected"===a&&(c=this.model.properties.selectedImage,_.isEmpty(c)||this._showImage("selected")),_.isEmpty(c)&&(c=this.model.properties.normalImage,_.isEmpty(c)?this.$el.children("img[data-state]").hide():this._showImage("normal")),this.buttonState=a}},_setImageElements:function(b){b||(b={}),b.reset&&this.$el.children("img").remove();var c=this.model.properties.normalImage;_.isEmpty(c)||this.$el.find('[data-state="normal"]').length||this.$el.prepend($("<img />",{"data-state":"normal",src:a.ImageAssets.url(c)})),a.isMobileDevice||(c=this.model.properties.overImage,_.isEmpty(c)||this.$el.find('[data-state="over"]').length||this.$el.prepend($("<img />",{"data-state":"over",src:a.ImageAssets.url(c)}))),c=this.model.properties.downImage,_.isEmpty(c)||this.$el.find('[data-state="down"]').length||this.$el.prepend($("<img />",{"data-state":"down",src:a.ImageAssets.url(c)})),c=this.model.properties.selectedImage,_.isEmpty(c)||this.$el.find('[data-state="selected"]').length||this.$el.prepend($("<img />",{"data-state":"selected",src:a.ImageAssets.url(c)})),this.$el.children("img[data-state]").css("opacity",0)},_showImage:function(a){var b=this.$el.children('img[data-state="'+a+'"]');b.length&&(b.css("opacity",1),this.$el.children('img[data-state!="'+a+'"]').css("opacity",0))},_onDown:function(){this._showImage("down")},_onUp:function(){a.isMobileDevice?this._onOut():_.isEmpty(this.model.properties.overImage)?this._onOut():this._onHover()},_onOut:function(){("selected"!==this.buttonState||_.isEmpty(this.model.properties.selectedImage))&&this.setState(this.model.properties.buttonState,!0)},_onHover:function(){this._showImage("over")}}),a.UIImageButton=e}),define("toast/views/UIButton",["../core","./UIView","./UIText"],function(a,b,c){"use strict";var d=(a.Strings,b.prototype),e=c.prototype,f=c.extend();return _.extend(f.prototype,e,{tagName:"button",className:"btn",autoMaintainRatio:!1,initialize:function(a){e.initialize.call(this,a)},render:function(){return e.render.call(this),this._setIcon(),this},commonRender:function(){e.commonRender.call(this),this.setState(this.model.properties.buttonState,!0),_.isUndefined(this.model.properties.buttonStyle)&&(this.model.properties.buttonStyle="primary"),this.model.properties.buttonIconOffsetX||(this.model.properties.buttonIconOffsetX=0),this.model.properties.buttonIconOffsetY||(this.model.properties.buttonIconOffsetY=0),this.model.properties.buttonTextOffsetX||(this.model.properties.buttonTextOffsetX=0),this.model.properties.buttonTextOffsetY||(this.model.properties.buttonTextOffsetY=0),this.model.properties.buttonIconWidth||(this.model.properties.buttonIconWidth=24),this.model.properties.buttonIconHeight||(this.model.properties.buttonIconHeight=24),this._setIcon()},responsiveSize:function(a,b){return this.model.fitWidth=!1,{width:this.model._orgWidth,height:this.model._orgHeight}},beforeAutofit:function(a){d.beforeAutofit.call(this,a)},afterAutofit:function(a){d.afterAutofit.call(this,a)},autoFit:function(a){return!1},_setCursor:function(){},setState:function(a,b){(this.buttonState!==a||b)&&(this.buttonState=a)},_setIcon:function(a){this._buttonImageIcon!==this.model.properties.buttonImageIcon?(this._buttonImageIcon=this.model.properties.buttonImageIcon,this._setImageIcon(),this.$contentMount&&this.$contentMount.reject(),_.isEmpty(this._buttonImageIcon)&&this._setSvgIcon()):this._buttonSvgIcon!==this.model.properties.buttonSvgIcon?(this._buttonSvgIcon=this.model.properties.buttonSvgIcon,_.isEmpty(this.model.properties.buttonImageIcon)&&this._setSvgIcon(),_.isEmpty(this._buttonSvgIcon)&&(this._setImageIcon(),this.$contentMount&&this.$contentMount.reject())):this.$contentMount&&this.$contentMount.reject(),this._setButtonStyle(),this._setSvgIconColor(),this._setIconSize(),this._setIconAlign(),this._setTextOffset()},_setButtonStyle:function(){this.$el.attr("class","btn"),this.model.style.backgroundColor&&(this.model.properties.buttonStyle=""),_.isEmpty(this.model.properties.buttonStyle)||this.$el.addClass("btn-"+this.model.properties.buttonStyle)},_setImageIcon:function(){if(this.$iconContainer&&this.$iconContainer.remove(),_.isEmpty(this._buttonImageIcon))return void(this.$iconContainer=null);var b=a.ImageAssets.url(this._buttonImageIcon),c=$("<img />",{class:"btn-icon vertical-middle",src:b});this.$iconContainer=$("<div />",{class:"btn-icon-container"}),this.$iconContainer.append(c),this.$el.prepend(this.$iconContainer)},_setSvgIcon:function(){if(_.isEmpty(this._buttonSvgIcon))return this.$iconContainer&&this.$iconContainer.remove(),this.$svgIcon&&this.$svgIcon.remove(),this.$iconContainer=null,void(this.$svgIcon=null);var b=a.SVGAssets.url(this._buttonSvgIcon);if(a.paths.__originalAssets__){var c=a.SVGAssets._assets[this._buttonSvgIcon];c&&c.url&&(b=a.StringUtils.replaceTemplate(c.url,"ASSETS_DIR",a.paths.__originalAssets__))}b?$.ajax({type:"GET",url:b,dataType:"xml",success:$.proxy(this.svgLoaded,this),error:function(){self.$contentMount&&self.$contentMount.reject()}}):this.$svgIcon&&this.$svgIcon.remove()},svgLoaded:function(b){a.SVGAssets.url(this._buttonSvgIcon);this.$iconContainer&&this.$iconContainer.remove(),this.$svgIcon&&this.$svgIcon.remove(),this.$svgIcon=$(b),this.$svgIcon.prop("viewBox")||(this.$svgIcon=this.$svgIcon.find("svg")),this.$svgIcon.attr("class","btn-icon vertical-middle"),this.$svgIcon.attr("width","100%"),this.$svgIcon.attr("height","100%"),this.$svgIcon.get(0).setAttribute("preserveAspectRatio","none"),this.$svgIcon.attr("pointer-events","none"),this.$iconContainer=$("<div />",{class:"btn-icon-container"}),this.$iconContainer.append(this.$svgIcon),this._setIconSize(),this._setIconAlign(),this._setSvgIconColor(),this.$el.prepend(this.$iconContainer),this.$contentMount&&this.$contentMount.resolve(this.$svg)},_setSvgIconColor:function(){this.$svgIcon&&this.$svgIcon.get(0).setAttribute("fill",this.model.properties.buttonSvgIconColor)},_setIconSize:function(a){this.$iconContainer&&this.$iconContainer.css({width:this.model.properties.buttonIconWidth,height:this.model.properties.buttonIconHeight})},_setIconAlign:function(){if(this.$iconContainer){this.$iconContainer.css("top",(this.$parent.outerHeight()-this.$iconContainer.outerHeight())/2+this.model.properties.buttonIconOffsetY);var a=2;"right"===this.model.properties.buttonIconAlign?(this.$iconContainer.css("left",""),this.$iconContainer.css("right",parseInt(this.$el.css("paddingRight"))+a+this.model.properties.buttonIconOffsetX)):"center"===this.model.properties.buttonIconAlign?(this.$iconContainer.css("right",""),this.$iconContainer.css("left",(this.$parent.outerWidth()-this.$iconContainer.outerWidth())/2+this.model.properties.buttonIconOffsetX)):(this.$iconContainer.css("right",""),this.$iconContainer.css("left",parseInt(this.$el.css("paddingLeft"))+a+this.model.properties.buttonIconOffsetX))}},_setTextOffset:function(){this.$textWrap.css("left",this.model.properties.buttonTextOffsetX),this.$textWrap.css("top",this.model.properties.buttonTextOffsetY)}}),a.UIButton=f}),define("toast/views/UIImage",["../core","../utils/StringUtils","./UIView"],function(a,b,c){"use strict";var d=(a.Strings,c.prototype),e=c.extend();return _.extend(e.prototype,d,{maintainRatio:!0,initialize:function(a){d.initialize.call(this,a)},render:function(){if(this.viewController.htmlRender&&"bg"===this.model.label&&!_.isEmpty(this.model.properties.asset)){var b=a.ImageAssets.url(this.model.properties.asset);b&&(this.isDocumentBackgroundImage=!0,$(document.body).css("backgroundImage",'url("'+b+'")'),this.$parent.remove())}return d.render.call(this),this},commonRender:function(){if(!this.isDocumentBackgroundImage){if(this.$img=this.$el.children("img"),this.$img.length||(this.$img=$("<img />"),this.$el.append(this.$img)),this.$img.css("width",""),this.$img.css("height",""),_.isEmpty(this.model.properties.asset))this.showPlacehoder();else{var b=a.ImageAssets.url(this.model.properties.asset);b?(this.$el.removeClass("placeholder"),this.$img.attr("src",b)):this.showPlacehoder()}this.model.properties.contain&&this.update(),d.commonRender.call(this)}},mount:function(){d.mount.call(this)},update:function(a,b){d.update.apply(this,arguments);var c=this.model.properties.contain,e=this.model.get("imgWidth"),f=this.model.get("imgHeight");if(c&&e&&f){this.model.width/e<this.model.height/f?(this.$img.css("width",this.model.width),this.$img.css("height","auto")):(this.$img.css("width","auto"),this.$img.css("height",this.model.height)),this.$parent.addClass("image-centered")}else this.$img.css("width","100%"),this.$img.css("height","100%"),this.$parent.removeClass("image-centered");return this},responsiveSize:function(a,b){return b&&b.resp_fixed?{width:this.model._orgWidth,height:this.model._orgHeight}:d.responsiveSize.call(this,a,b)},beforeAutofit:function(a){d.beforeAutofit.call(this,a)},afterAutofit:function(a){d.afterAutofit.call(this,a)},showPlacehoder:function(){this.$el.addClass("placeholder"),this.$img.attr("src","styles/images/image-placeholder.svg")},_setHTMLAttrs:function(){d._setHTMLAttrs.call(this),this.$parent.removeClass("image-centered"),this.$img.removeAttr("width height"),this.$img.removeAttr("style")}}),a.UIImage=e}),define("toast/views/UILink",["../core","./UIView"],function(a,b){"use strict";var c=(a.Strings,b.prototype),d=b.extend();return _.extend(d.prototype,c,{style:{},initialize:function(a){c.initialize.call(this,a)},render:function(){c.render.call(this);var a=this;return a.$el.hover(function(){a.$el.css("backgroundColor",a.model.properties.hoverColor)},function(){a.$el.css("backgroundColor","")}),this},commonRender:function(){c.commonRender.call(this)},_setCursor:function(){}}),a.UILink=d}),define("toast/views/UIIcon",["../core","../utils/StringUtils","./UIView"],function(a,b,c){"use strict";var d=(a.Strings,c.prototype),e=c.extend();return _.extend(e.prototype,d,{maintainRatio:!0,initialize:function(a){d.initialize.call(this,a)},render:function(){return d.render.call(this),this},commonRender:function(){d.commonRender.call(this),this._load()},mount:function(){this.$svg=this.$el.find("svg"),this.$svg.length||this._load()},_load:function(){if(this._asset!==this.model.properties.asset){this._asset=this.model.properties.asset;var b=a.SVGAssets.url(this._asset);if(a.paths.__originalAssets__){var c=a.SVGAssets._assets[this._asset];c&&c.url&&(b=a.StringUtils.replaceTemplate(c.url,"ASSETS_DIR",a.paths.__originalAssets__))}if(b){var d=this;$.ajax({type:"GET",url:b,dataType:"xml",success:$.proxy(this._svgLoaded,this),error:function(){d.$contentMount&&d.$contentMount.reject()}})}else this.$svg&&this.$svg.remove()}},_svgLoaded:function(a){this.$svg&&this.$svg.remove(),this.$svg=$(a),this.$svg.prop("viewBox")||(this.$svg=this.$svg.find("svg")),this.$svg.attr("width","100%"),this.$svg.attr("height","100%"),this.$svg.attr("pointer-events","none"),_.isUndefined(this.model.__extra__.preserveAspectRatio)||this.$svg.get(0).setAttribute("preserveAspectRatio",this.model.__extra__.preserveAspectRatio),_.isUndefined(this.model.__extra__.fill)||this.$svg.get(0).setAttribute("fill",this.model.__extra__.fill),this.$el.prepend(this.$svg),this.$contentMount&&this.$contentMount.resolve(this.$svg)}}),a.UIIcon=e}),define("toast/views/UIMediaPlayer",["../core","./UIView"],function(a,b){"use strict";var c=a.Strings,d=b.prototype,e=b.extend();return _.extend(e.prototype,d,{className:"media-player",initialize:function(a){d.initialize.call(this,a)},render:function(){if(d.render.call(this),this.$el.find(".player-controlbars").length||this.$el.append(this.templateHTML()),__app__||!0!==a.config.disableMediaSeeking||(this.model.properties.disableMediaSeeking=!0),a.config.delegatePlayerInteractions&&a.config.delegatePlayerInteractions.userInteractionDisabled&&(this.userInteractionDisabled=!0),this._initElements(),this._initMediaElement(),a.on(a.Events.FULLSCREEN_DID_CHANGE,this._fullscreenDidChanged,this),this.$media.on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange webkitbeginfullscreen webkitendfullscreen",$.proxy(this._webkitFullscreenDidChanged,this)),a.config.progressPageControl&&a.contentStorage){var b=a.contentStorage.findWhere({id:this.model.id});b||(b={id:this.model.id,pageID:this.viewController.collection.id,progressPageControl:!0,ended:!1,alert:c.ALERT_CAN_NOT_MOVE_PAGE_UNTIL_PLAYBACK_FINISHES},a.contentStorage.addItem(b)),this._storageItem=b}return this},mount:function(){d.mount.call(this),this._initSliders(),this._initControlBarData(),this.update()},mountAll:function(){d.mountAll.call(this)},willAppear:function(){d.willAppear.call(this),this.viewController.parentViewController&&!this._initControlBarDataOnce&&(this._initControlBarData(),this._initControlBarDataOnce=!0),this.update()},appear:function(){d.appear.call(this),(this.model.properties.autoplay||a.project.config.mediaAutoPlay)&&a.lazyOnce(function(){this.isAppeared&&(this.isLoaded()?this.play():this.isLoading()||this.load())},10,this.__refreshTimeout__,this)},disappear:function(){d.disappear.call(this),this.pause()},scaleDidChange:function(a){d.scaleDidChange.apply(this,arguments),this.update(),this.isViewsDidMounted&&(this.$timeSlider&&(this.$timeSlider.closest(".contents").length?this.$timeSlider.attr("data-content-scale",this.viewController.contentScale):this.$timeSlider.attr("data-content-scale",1),this.$timeSlider.rangeslider("update",!0)),this.$volumeSlider.closest(".contents").length?this.$volumeSlider.attr("data-content-scale",this.viewController.contentScale):this.$volumeSlider.attr("data-content-scale",1),this.$volumeSlider.rangeslider("update",!0))},update:function(a,b){return d.update.apply(this,arguments),this._updateElementSize(),this},show:function(){d.show.call(this),this.update()},isPlaying:function(){return!!this.isReadyMedia()&&!!(this.$media[0].currentTime>0&&!this.$media[0].paused&&!this.$media[0].ended&&this.$media[0].readyState>2)},isPaused:function(){return!!this.isReadyMedia()&&!!(this.$media[0].currentTime>0&&this.$media[0].paused&&!this.$media[0].ended&&this.$media[0].readyState>2)},isMuted:function(){return!!this.isReadyMedia()&&this.$media[0].muted},isLoading:function(){return this._isLoading},isLoaded:function(){return this._isLoaded},isReadyMedia:function(){return _.isUndefined(this.$media[0])?-1:0!==this.$media[0].readyState||0},load:function(){if(-1===this.isReadyMedia()||this.isLoading()||this.isLoaded())this.isLoaded()&&this._sendMediaStatusChangeCallback("loaded");else{this._isLoading=!0,this.$media.load(),this.updateBuffered();this.$media.attr("src")&&(this._currentFilename=this.$media.attr("src").getBaseName().getFilenameWithoutExtension())}},updateBuffered:function(){var a=this;this.__bufferInterval=setInterval(function(){a.isReadyMedia()&&(a.$playerBarLoaded.width(a.$media[0].buffered.end(0)/a.$media[0].duration*100+"%"),a.$media[0].buffered.end(0)>=a.$media[0].duration&&clearInterval(a.__bufferInterval))},100)},fileFromAsset:function(b){return a.MovieAssets.url(b)},play:function(){return!!this.isReadyMedia()&&(this.$media[0].play(),!0)},playFile:function(a,b,c){if(!_.isEmpty(a)||!_.isEmpty(b)){c||(c={});var d;if(d=_.isEmpty(a)?b:this.fileFromAsset(a),!_.isEmpty(d)){if(!c.replay){if(d.getBaseName().getFilenameWithoutExtension()==this._currentFilename)return void(this.isReadyMedia()&&this.play())}this._isLoaded=!1,this._playAfterLoad=!0,this.$media.attr("src",d),this.load(),this.$el.hasClass("empty")&&this.$el.removeClass("empty")}}},pause:function(){return!!this.isReadyMedia()&&(this._userInteraction=!0,this.$media[0].pause(),!0)},stop:function(){return!!this.isReadyMedia()&&(this.$parent.addClass("stopped"),this.$parent.removeClass("playing paused"),this._userInteraction=!0,this.$media[0].pause(),_.isUndefined(this.$media[0].currentTime)||(this.$media[0].currentTime=0),this._sendMediaStatusChangeCallback("stopped"),!0)},mute:function(){return!!this.isReadyMedia()&&(this.$media[0].muted=!this.$media[0].muted,this.$media[0].volume||(this.$media[0].volume=.7),this._sendMediaStatusChangeCallback("muted"),this._didVolumeupdate(),!0)},end:function(){return!!this.isReadyMedia()&&(this.$media[0].currentTime=this.$media[0].duration,!0)},startFullscreen:function(){this.__isPlayingBeforeFullscreen__=this.isPlaying();var b=this.model.properties.disableMediaSeeking;if(a.isIOS&&!b&&"AUDIO"!==this.$media[0].tagName)return void this._startFullscreen();this.$parent.addClass("fullscreen");var c=this.$parent.parent(),d=$("<div />",{id:this.model.id+"_player"});return c.children().eq(this.$parent.index()).before(d),a.isIOS&&"AUDIO"!==this.$media[0].tagName&&this._startFullscreen(),$(document.body).append(this.$parent),a.isIOS&&"AUDIO"!==this.$media[0].tagName||this._startFullscreen(),this.scaleDidChange(1),this.update(),!0},_startFullscreen:function(){var b=this.model.properties.disableMediaSeeking;a.isIOS&&!b?a.requestFullScreen(this.$media[0]):a.requestFullScreen(this.$parent[0])||this._fullscreenDidChanged(!0),this.__isPlayingBeforeFullscreen__&&this.play(),this.__isPlayingBeforeFullscreen__=!1},stopFullscreen:function(){if(this.$parent.hasClass("fullscreen")){this.$parent.removeClass("fullscreen");var a=this.viewController.$el.find("#"+this.model.id+"_player");a.before(this.$parent),a.remove(),this.scaleDidChange(this.viewController.contentScale),this.update(),this._stopFullscreen()}return!0},_stopFullscreen:function(){var b=this.model.properties.disableMediaSeeking;a.isIOS&&!b?a.exitFullScreen(this.$media[0]):a.exitFullScreen(this.$parent[0])||this._fullscreenDidChanged(!1)},_initElements:function(){this.$controlBars=this.$el.find(".player-controlbars"),this.$controlBar=this.$controlBars.find(".player-controlbar"),this.$playerBar=this.$el.find(".player-bar"),this.$playerBarLoaded=this.$el.find(".player-bar-loaded"),this.$playerBarPlayed=this.$el.find(".player-bar-played"),this.$playerTime=this.$el.find(".player-time"),this.$controlBtn=this.$el.find(".control-btn"),this.$timeCurrent=this.$playerTime.find(".player-time-current"),this.$timeDuration=this.$playerTime.find(".player-time-duration"),this.$timeSlider=this.$el.find("[data-time-slider]"),this.$volumeBar=this.$el.find(".player-volume-bar"),this.$volumeCurrent=this.$volumeBar.find(".player-volume-bar-current"),this.$volumeSlider=this.$volumeBar.find("[data-volume-slider]"),this.userInteractionDisabled&&this.$controlBars.hide()},_initMediaElement:function(){this.$media=this.createMediaElement(),this.$media.on("loadeddata",$.proxy(this._didLoaded,this)),this.$media.on("play",$.proxy(this._didPlayed,this)),this.$media.on("pause",$.proxy(this._didPaused,this)),this.$media.on("timeupdate",$.proxy(this._didTimeupdate,this)),this.$media.on("ended",$.proxy(this._didEnded,this)),this.setMediaSource()},_initSliders:function(){if(!a._.forHTMLPublishing){var b=this;this.$timeSlider.rangeslider({polyfill:!1,onInit:function(){},onSlide:function(a,b){},onSlideEnd:function(c,d){a.IS_SLIDING&&(b.$media[0].currentTime=d),a.IS_SLIDING=!1,b.$parent.hasClass("time-sliding")&&b.$parent.removeClass("time-sliding")},onHandleDown:function(c){a.IS_SLIDING=!0,b.$parent.addClass("time-sliding"),b.$media[0].currentTime=c,b._didTimeupdate()},onHandleMove:function(a){b.$media[0].currentTime=a,b._didTimeupdate()}}),this.$playerTimeSlider=this.$el.find(".player-bar .rangeslider"),this.$playerTimeSliderHandle=this.$el.find(".player-bar .rangeslider__handle"),this.$volumeSlider.rangeslider({polyfill:!1,onInit:function(){},onSlide:function(a,b){},onSlideEnd:function(c,d){a.IS_SLIDING=!1,b.$parent.hasClass("volume-sliding")&&b.$parent.removeClass("volume-sliding")},onHandleDown:function(c){a.IS_SLIDING=!0,b.$parent.addClass("volume-sliding"),b.$media[0].muted=!1,b.$media[0].volume=c/100,b._didVolumeupdate()},onHandleMove:function(a){b.$media[0].muted=!1,b.$media[0].volume=a/100,b._didVolumeupdate()}}),this.$playerVolumeSliderHandle=this.$el.find(".player-volume-bar .rangeslider__handle");this.model.properties.disableMediaSeeking&&this.$timeSlider&&this.$timeSlider.length&&(this.$timeSlider.rangeslider("destroy"),this.$timeSlider=null)}},_initControlBarData:function(){a._.forHTMLPublishing||this.$controlBars.length&&(this.$controlBars.attr("data-time-slider-height",this.$playerTimeSlider.height()),this.$controlBars.attr("data-time-slider-handle-size",this.$playerTimeSliderHandle.width()),this.$controlBars.attr("data-volume-slider-handle-size",this.$playerVolumeSliderHandle.width()),this.$controlBars.attr("data-controlbars-height",this.$controlBars.height()),this.$controlBars.attr("data-controlbar-left",parseInt(this.$controlBar.css("left"))),this.$controlBars.attr("data-controlbar-right",parseInt(this.$controlBar.css("right"))),this.$controlBars.attr("data-font-size",parseInt(this.$controlBars.css("font-size"))),this.$controlBars.attr("data-control-btn-width")||this.$controlBars.attr("data-control-btn-width",this.$controlBtn.width()))},_isFullscreen:function(){return this.$parent.hasClass("fullscreen")},_secondsToTime:function(a){isNaN(a)&&(a=0);var b=Math.floor(a/3600),c=Math.floor(a%3600/60),d=Math.ceil(a%3600%60);return(0==b?"":(b>0&&b.toString().length,b+":"))+(c.toString().length,c)+":"+(d.toString().length<2?"0"+d:d)},_updateElementSize:function(){},_timeupdateCallback:function(a,b){this._timeupdateCallbackFn=a,this._timeupdateCallbackContext=b},_mediaStatusChangeCallback:function(a,b){this._mediaStatusChangeCallbackFn=a,this._mediaStatusChangeCallbackContext=b},_sendMediaStatusChangeCallback:function(b){this._mediaStatusChangeCallbackFn&&(this._mediaStatusChangeCallbackContext?this._mediaStatusChangeCallbackFn.bind(this._mediaStatusChangeCallbackContext)(b):this._mediaStatusChangeCallbackFn(b)),a.config.delegatePlayerInteractions&&a.config.delegatePlayerInteractions.statusChangeCallbackFn&&a.config.delegatePlayerInteractions.statusChangeCallbackFn(this,this.$media[0],b)},_changeFullscreenCallback:function(a,b){this._changeFullscreenCallbackFn=a,this._changeFullscreenCallbackContext=b},_didLoaded:function(){this._isLoading=!1,this._isLoaded=!0,this.$timeCurrent.text(this._secondsToTime(0)),this.$timeDuration.text(this._secondsToTime(this.$media[0].duration)),this.update();var b=this.$media[0].volume;this.$volumeSlider.attr("value",100*b),this.$volumeSlider.attr("max",100),this.$volumeSlider.rangeslider("update",!0),this._didVolumeupdate(),this.$timeSlider&&(this.$timeSlider.attr("value",0),this.$timeSlider.attr("max",Math.ceil(this.$media[0].duration))),this._loadedDuration=this.$media[0].duration,this.$timeSlider&&this.$timeSlider.rangeslider("update",!0),this._sendMediaStatusChangeCallback("loaded"),this._playAfterLoad?(this._playAfterLoad=!1,this.isAppeared&&(this.viewController.current()||a.config.sharedAudioPlayer)&&this.play()):(!0===this.model.properties.autoplay||a.project.config.mediaAutoPlay)&&this.isAppeared&&(this.viewController.current()||a.config.sharedAudioPlayer)&&(this.$media.attr("data-autoplay",!0),this.play())},_didPlayed:function(){this.$parent.addClass("playing"),this.$parent.removeClass("paused stopped"),this._sendMediaStatusChangeCallback("playing")},_didPaused:function(){this._userInteraction&&(this._userInteraction=!1,this.$parent.addClass("paused"),this.$parent.removeClass("playing stopped user-action"),this._sendMediaStatusChangeCallback("paused"))},_didTimeupdate:function(){var b=Math.ceil(this.$media[0].currentTime),c=Math.ceil(this.$media[0].duration);this._loadedDuration!==this.$media[0].duration&&(this._loadedDuration=this.$media[0].duration,this.$timeSlider&&(this.$timeSlider.attr("max",c),this.$timeSlider.rangeslider("update",!0))),!a.IS_SLIDING&&this.$timeSlider&&this.$timeSlider.val(b).change(),this._timeupdateCallbackFn&&(this._timeupdateCallbackContext?this._timeupdateCallbackFn.bind(this._timeupdateCallbackContext)(this.$media[0].currentTime):this._timeupdateCallbackFn(this.$media[0].currentTime)),a.config.delegatePlayerInteractions&&a.config.delegatePlayerInteractions.timeupdateCallbackFn&&a.config.delegatePlayerInteractions.timeupdateCallbackFn(this,this.$media[0],this.$media[0].currentTime),this.$timeCurrent.text(this._secondsToTime(this.$media[0].currentTime)),this.$timeDuration.text(this._secondsToTime(this.$media[0].duration)),this.$playerBarPlayed.width(b/c*100+"%")},_didVolumeupdate:function(){if(this.$media[0].muted)return this.$parent.removeClass("volume-down"),void this.$parent.addClass("muted");var b=100*this.$media[0].volume;a.IS_SLIDING||this.$volumeSlider.val(b).change(),this.$volumeCurrent.width(b+"%"),b>=70?this.$parent.removeClass("muted volume-down"):0==b?(this.$parent.removeClass("volume-down"),this.$parent.addClass("muted"),this.$media[0].muted=!0):(this.$parent.removeClass("muted"),this.$parent.addClass("volume-down"))},_didEnded:function(){if(this.$playerBarPlayed.width("100%"),this.$timeSlider&&!a.IS_SLIDING&&this.$timeSlider.val(Math.ceil(this.$media[0].duration)).change(),this.$parent.removeClass("playing paused stopped"),a.config.progressPageControl&&a.contentStorage){var b=a.contentStorage.findWhere({id:this.model.id});b&&(b.set("progressPageControl",!1),a.contentStorage.updateItem(b))}this._sendMediaStatusChangeCallback("end")},_webkitFullscreenDidChanged:function(){var b=a.isFullScreen(this.$media[0]);b?a.$el.addClass("fullscreen"):a.$el.removeClass("fullscreen"),a.send(a.Events.FULLSCREEN_DID_CHANGE,b)},_fullscreenDidChanged:function(a){this.$parent.hasClass("fullscreen")&&!a&&this.stopFullscreen(),this._changeFullscreenCallbackFn&&(this._changeFullscreenCallbackContext?this._changeFullscreenCallbackFn.bind(this._changeFullscreenCallbackContext)(a):this._changeFullscreenCallbackFn(a))},_onControlButtonClicked:function(a){var b=$(a.target).closest("[data-action]"),c=b.attr("data-action");c&&this._mediaControlAction(c)},_mediaControlAction:function(a){switch(a){case"playAndPause":return this.isPlaying()?this.pause():this.play(),!0;case"play":return this.play(),!0;case"replay":return _.isUndefined(this.$media[0].currentTime)||(this.$media[0].currentTime=0),this.play(),!0;case"pause":return this.pause(),!0;case"stop":return this.stop(),!0;case"mute":return this.mute(),!0;case"toggleFullScreen":return this.$parent.hasClass("fullscreen")?this.stopFullscreen():this.startFullscreen(),!0}return!1},remove:function(){this.$timeSlider&&this.$timeSlider.length&&(this.$timeSlider.rangeslider("destroy"),this.$timeSlider=null),this.$volumeSlider&&this.$volumeSlider.length&&(this.$volumeSlider.rangeslider("destroy"),this.$volumeSlider=null),d.remove.apply(this,arguments),this._isFullscreen()&&this.$parent.remove()},events:{"click .control-btn":"_onControlButtonClicked"}}),a.UIMediaPlayer=e}),define("toast/views/UIAudioPlayer",["../core","./UIMediaPlayer"],function(a,b){"use strict";var c=a.Strings,d=b.prototype,e=b.extend();return _.extend(e.prototype,d,{style:{},minsize:{width:300,height:54},controllbarMinSize:220,templateHTML:function(){return Mustache.render(a.HtmlLoader.AudioPlayer,{Strings:c})},initialize:function(a){d.initialize.call(this,a),this.$el.addClass("audio-player")},createMediaElement:function(){var a=this.$el.find("audio");return a.length||(a=$("<audio />"),this.$el.prepend(a)),a.attr({id:this.model.id+"-inner",width:"100%",preload:"auto"}),!0===this.model.properties.loop&&a.attr("loop","loop"),a},setMediaSource:function(){this.$media.empty(),_.isEmpty(this.model.properties.assets)?this.$el.addClass("empty"):this.$el.removeClass("empty"),_.each(this.model.properties.assets,function(b){var c=a.AudioAssets.url(b);if(c){var d=$("<source />",{"data-audio-id":b,src:c});this.$media.append(d)}},this);var b=0!==this.$media[0].currentTime;this.$media.children("source").length>0?this.$media.attr({"data-audio-id":this.$media.children("source").eq(0).attr("data-audio-id"),src:this.$media.children("source").eq(0).attr("src")}):this.$media.attr("src",""),this.load(),b&&(this.$media[0].currentTime=0,this._didTimeupdate())},render:function(){return d.render.call(this),this},mount:function(){d.mount.call(this),this.updateStyle()},update:function(a,b){return d.update.apply(this,arguments),this},updateStyle:function(){this.$el.css("border-radius",this.$el.height());var a=this.model.properties.backgroundColor;a&&this.$el.css("background-color",a);var b=this.model.properties.buttonIconColor;if(b){var c=this.$el.find("svg");_.each(c,function(a){$(a).find("path").get(0).setAttribute("fill",b)}),this.isRender&&this.$playerBar.find(".rangeslider__handle").css("background-color",b)}var d=this.model.properties.textColor;d&&this.$playerTime.css("color",d);var e=this.model.properties.seekbarBgColor;e&&this.$playerBar.css("background-color",e);var f=this.model.properties.seekbarColor;f&&this.isRender&&this.$playerBarPlayed.css("background-color",f)},willAppear:function(){return d.willAppear.call(this),this.updateStyle(),this},remove:function(){d.remove.apply(this,arguments)},fileFromAsset:function(b){return a.AudioAssets.url(b)},_didLoaded:function(){d._didLoaded.apply(this,arguments)},_didPlayed:function(){d._didPlayed.apply(this,arguments)},_didPaused:function(){d._didPaused.apply(this,arguments)},_didEnded:function(){d._didEnded.apply(this,arguments)},_updateElementSize:function(){if(d._updateElementSize.apply(this,arguments),this.$controlBars.length&&!a._.forHTMLPublishing){var b="",c="",e="",f="",g="",h=Number(this.$controlBars.attr("data-controlbar-left")),i=Number(this.$controlBars.attr("data-controlbar-right"));this._isFullscreen()?(h=0,i=0):(h=Math.max(h,h*(this.$el.height()/this.minsize.height)),i=Math.max(i,i*(this.$el.height()/this.minsize.height))),!this._isFullscreen()&&this.viewController.contentScale<1&&(b=this.$controlBars.attr("data-controlbars-height"),c=this.$controlBars.attr("data-control-btn-width"),e=this.$controlBars.attr("data-font-size"),f=this.$controlBars.attr("data-time-slider-height"),g=this.$controlBars.attr("data-time-slider-handle-size"),b=parseInt(b/this.viewController.contentScale)||"",c=parseInt(c/this.viewController.contentScale)||"",e=parseInt(e/this.viewController.contentScale)||"",f=parseInt(f/this.viewController.contentScale)||"",g=parseInt(g/this.viewController.contentScale)||""),this.$controlBars.css("font-size",e),this._compositionWidgetPlayer&&this.$controlBars.css("height",b),this.$controlBtn.css("width",c),this.$controlBar.css({left:h,right:i});var j=this.$controlBars.find(".left-control-group"),k=this.$controlBars.find(".right-control-group");if(j.width()&&k.width())if(this.controllbarMinSize&&this.$el.width()*this.viewController.contentScale<this.controllbarMinSize){var l=this.$controlBars.find(".player-volume-control-group");this.$playerTime.hide(),k.hide(),this.$playerBar.css({left:j.width()+15,right:l.length?l.css("margin-left"):15})}else this.$playerTime.show(),k.show(),this.$playerBar.css({left:j.width(),right:k.width()});this.$playerBar.width()<20?this.$playerBar.hide():this.$playerBar.show(),this.$playerTimeSlider.css("height",f),this.$playerTimeSliderHandle.css({width:g,height:g,marginTop:g?-g/2:""}),this.$timeSlider&&this.isRender&&this.$timeSlider.rangeslider("update",!0)}}}),a.UIAudioPlayer=e}),define("toast/views/UIMoviePlayer",["../core","./UIMediaPlayer"],function(a,b){"use strict";var c=a.Strings;a.const.MOVIE_PLAYER_CONTROLBAR_HEIGHT=44;var d=b.prototype,e=b.extend();return _.extend(e.prototype,d,{templateHTML:function(){return a.isMobileDevice?Mustache.render(a.HtmlLoader.VideoPlayerMimi,{Strings:c}):Mustache.render(a.HtmlLoader.VideoPlayer,{Strings:c})},initialize:function(a){d.initialize.call(this,a),this.$el.addClass("movie-player")},render:function(){return d.render.call(this),a.isMobileDevice&&this.$el.addClass("mini"),this.userInteractionDisabled||(this.$centerPlayBtn.on("click",$.proxy(this._onCenterPlayBtnClicked,this)),this.events.click="_onClicked",this.events.mousemove="_onMouseMove",this.events.mouseout="_onMouseout"),this.delegateEvents(),this},mount:function(){d.mount.call(this)},willAppear:function(){d.willAppear.call(this),this.viewController.parentViewController&&(this.viewController.parentViewController.$el.addClass("video-controls-fix"),this.viewController.$el.closest(".toast-object").addClass("video-controls-fix"))},willDisappear:function(){d.willAppear.call(this),this.viewController.parentViewController&&(this.viewController.parentViewController.$el.removeClass("video-controls-fix"),this.viewController.$el.closest(".toast-object").removeClass("video-controls-fix"))},update:function(b,c){d.update.apply(this,arguments);var e,f,g,h;if(e=this.$parent.width(),f=this.$parent.height(),this.$centerPlayBtn.width(),this.$centerPlayBtn.height(),h=a.isMobileDevice?90:100,this._isFullscreen()){g=Math.min(h,Math.min(e,f))-5;g*=Math.min(this.$parent.width()/this.model.width,this.$parent.height()/this.model.height),g=Math.min(80,Math.max(h,g))}else g=h/this.viewController.contentScale,g=Math.min(h,g);return!_.isUndefined(this.model.properties.centerPlayButtonBgColor)&&this.$centerPlayBtnIcon&&this.$centerPlayBtnIcon.length&&this.$centerPlayBtnIcon.find("path").get(0).setAttribute("fill",this.model.properties.centerPlayButtonBgColor),this.$centerPlayBtn.css({width:g,height:g}),this},initSubtitles:function(){},updateSubtitle:function(a){},remove:function(){d.remove.apply(this,arguments)},createMediaElement:function(){var b=this.$el.find("video");b.length||(b=$("<video />"),this.$el.prepend(b));var c=b.attr("poster");return!c&&this.model.properties.cover&&(c=a.ImageAssets.url(this.model.properties.cover)),b.attr({id:this.model.id+"-inner",type:"video/mp4",poster:c,playsinline:!0}),b.css("backgroundColor",this.model.properties.backgroundColor),b},setMediaSource:function(){this.$media.empty(),_.isEmpty(this.model.properties.asset)?this.$el.addClass("empty"):this.$el.removeClass("empty");var b="";_.isEmpty(this.model.properties.asset)?_.isEmpty(this.model.properties.url)||(b=this.model.properties.url,-1===b.indexOf("../")&&-1===b.indexOf("./")&&"http:"!==b.protocol()&&"https"!==b.protocol()&&(b="http://"+this.model.properties.url)):b=a.MovieAssets.url(this.model.properties.asset),!_.isEmpty(b)&&a.config.movieBaseUrl&&(b=a.config.movieBaseUrl+b.getBaseName()),_.isEmpty(b)||a._.forHTMLPublishing||(a.showLoading(!0,{el:this.$parent}),this._sendMediaStatusChangeCallback("loading")),this.$media.attr("src",b),this.load()},_initElements:function(){d._initElements.apply(this,arguments),this.$centerPlayBtn=this.$el.find(".center-play-btn"),this.$centerPlayBtnIcon=this.$centerPlayBtn.find("svg"),this.userInteractionDisabled&&this.$centerPlayBtn.hide()},_setControlbarHiddingInterval:function(b){if(!this.userInteractionDisabled){arguments.length||(b=3e3),this._mouseTrackingInterval&&clearTimeout(this._mouseTrackingInterval);var c=this;this._mouseTrackingInterval=setTimeout(function(){!a.IS_SLIDING&&c.isPlaying()&&c.$controlBars.addClass("_hide")},b)}},_updateElementSize:function(){if(this.$controlBars.length&&!a._.forHTMLPublishing){var b="",c="",d="",e="",f="",g="";!this._isFullscreen()&&this.viewController.contentScale<1&&(b=this.$controlBars.attr("data-controlbars-height"),c=this.$controlBars.attr("data-control-btn-width"),d=this.$controlBars.attr("data-font-size"),e=this.$controlBars.attr("data-time-slider-height"),f=this.$controlBars.attr("data-time-slider-handle-size"),g=this.$controlBars.attr("data-volume-slider-handle-size"),b=parseInt(b/this.viewController.contentScale)||"",c=parseInt(c/this.viewController.contentScale)||"",d=parseInt(d/this.viewController.contentScale)||"",e=parseInt(e/this.viewController.contentScale)||"",f=parseInt(f/this.viewController.contentScale)||"",g=parseInt(g/this.viewController.contentScale)||""),this.$controlBars.css("font-size",d),this.$controlBars.css("height",b),this.$controlBtn.css("width",c),this.isRender&&(this.$playerTimeSlider.css("height",e),this.$playerTimeSliderHandle.css({width:f,height:f,marginTop:f?-f/2:""}),this.$timeSlider&&this.$timeSlider.rangeslider("update",!0),this.$playerVolumeSliderHandle.css({width:g,height:g,marginTop:g?-g/2:""}),this.$volumeSlider&&this.$volumeSlider.rangeslider("update",!0))}},_didLoaded:function(){d._didLoaded.apply(this,arguments),a.showLoading(!1,{el:this.$parent}),this.$centerPlayBtn.removeClass("_hide")},_didPlayed:function(){d._didPlayed.apply(this,arguments),this.$centerPlayBtn.addClass("_hide"),this._setControlbarHiddingInterval()},_didPaused:function(){d._didPaused.apply(this,arguments),this.$centerPlayBtn.removeClass("_hide")},_didEnded:function(){d._didEnded.apply(this,arguments),this.$centerPlayBtn.removeClass("_hide"),this.$controlBars.removeClass("_hide")},_onCenterPlayBtnClicked:function(){this.play()},_onClicked:function(b){this.isReadyMedia()&&(a.IS_PANNING||a.IS_DRAGGING||a.IS_SCROLLING||"VIDEO"===b.target.tagName&&(this.isPlaying()?this.pause():this.play()))},_onMouseMove:function(b){this.isPlaying()&&!a.IS_SLIDING&&(this.$controlBars.hasClass("_hide")&&this.$controlBars.removeClass("_hide"),this._setControlbarHiddingInterval())},_onMouseout:function(){this.isPlaying()&&!a.IS_SLIDING&&this.$controlBars.addClass("_hide")},_mediaControlAction:function(a){return!!d._mediaControlAction.apply(this,arguments)}}),a.UIMoviePlayer=e}),define("toast/views/UIYoutubePlayer",["require","module","../core","./UIView","../utils"],function(a,b,c,d){"use strict";function e(a){f.promise().done(a),!0===f.ok&&f.resolve()}var f=(c.Strings,new $.Deferred),g=d.prototype,h=d.extend();return _.extend(h.prototype,g,{style:{},__player__:null,initialize:function(a){g.initialize.call(this,a)},render:function(){return g.render.call(this),c._.forHTMLPublishing?this:(!0!==f.ok&&$.getScript("https://www.youtube.com/iframe_api").done(function(a,b){var c=setInterval(function(){"function"==typeof YT.Player&&(clearInterval(c),f.ok=!0,f.resolve())},10)}),this)},mount:function(){this.$playerEl=this.$el.find(".youtube-player-container"),this.$playerEl.length||(this.$playerEl=$("<div />",{id:"ypc-"+this.model.id,class:"youtube-player-container"}),this.$el.append(this.$playerEl))},appear:function(){g.appear.call(this),c.showLoading(!0,{el:this.$el}),this._createPlayer(),this.$el.show()},disappear:function(){g.disappear.call(this),this._destroyPlayer(),c.showLoading(!1,{el:this.$el}),this.$el.hide()},remove:function(){this._destroyPlayer(),g.remove.call(this)},_onPlayerReady:function(a){if(c.showLoading(!1,{el:this.$el}),this.__player__.readyok=!0,!0===this.__doDestroy__)return this._destroyPlayer(),void(this.__doDestroy__=!1);this.viewController.current()&&!0===this.model.properties.autoplay&&a.target.playVideo()},_onPlayerStateChange:function(a){a.data===YT.PlayerState.ENDED&&a.target.cueVideoById(a.target.getVideoData().video_id)},_play:function(){_.isNull(this.__player__)||this.__player__.playVideo()},_stop:function(){_.isNull(this.__player__)||this.__player__.stopVideo()},_pause:function(){_.isNull(this.__player__)||this.__player__.pauseVideo()},_createPlayer:function(){if(!0!==this.__createPlayer__){this.__createPlayer__=!0;var a=this;e(function(){a.__player__=new YT.Player(a.$playerEl.attr("id"),{height:a.$playerEl.height(),width:a.$playerEl.width(),videoId:a._getVideoId(),events:{onReady:$.proxy(a._onPlayerReady,a),onStateChange:$.proxy(a._onPlayerStateChange,a)}})})}},_getVideoId:function(){var a=this.model.properties.url;if(_.isEmpty(a))return"";var b;if(-1!=a.indexOf("iframe")){var c=new RegExp(/src=(["'])(.*?)\1/),d=a.match(c);if(d.length>2){var e=d[2].split("/");-1!==e.length&&(b=e[e.length-1])}}var e=a.split("/");if(-1!==e.length&&(b=e[e.length-1]),!_.isEmpty(b)){var e=b.split("?");return-1!==e.length&&(b=e[0]),b}return""},_destroyPlayer:function(){_.isNull(this.__player__)||!0!==this.__player__.readyok?_.isNull(this.__player__)||(this.__doDestroy__=!0):(this.__player__.destroy(),this.__player__=null,this.__createPlayer__=!1,this.__doDestroy__=!1)}}),c.UIYoutubePlayer=h}),define("toast/views/UIImageSlide",["../core","../utils/StringUtils","./UIView","../actions"],function(a,b,c,d){"use strict";var e=(a.Strings,c.prototype),f=c.extend();return _.extend(f.prototype,e,{initialize:function(a){e.initialize.call(this,a)},render:function(){return e.render.call(this),this.$parent.show(),!0!==this.model.properties.visible&&this.$parent.css("opacity",0),this},commonRender:function(){this.style=_.extend({},e.style,this.style),_.isUndefined(this.model.properties.backgroundColor)||(this.style.backgroundColor=this.model.properties.backgroundColor),e.commonRender.call(this)},mount:function(){var b=this.model.properties.assets;if(!_.isUndefined(b)&&0!=b.length){var c=this;!0===this.model.properties.popupImage&&_.isUndefined(this.__action__)&&(this.$el.css("cursor","pointer"),this.__action__=TT.Action.create(this,{name:"PopupImage",properties:{title:"",assets:this.model.properties.assets}}),this.$el.on("click",function(b){a.IS_DRAGGING||a.IS_PANNING||c.__action__.execute()}));var d=this.$el.css("borderTopWidth"),e=this.$el.css("borderBottomWidth");d=parseFloat(d),e=parseFloat(e),isNaN(d)&&(d=0),isNaN(e)&&(e=0);var f=(d+e).toFixed(1),g=this.$el.parent().height()-f,h=this.$el.find("ul");h.length||(h=$("<ul />"),_.each(b,function(b){h.append('<li><img src="'+a.ImageAssets.url(b)+'"height="'+g+'" style="max-width: '+this.$el.parent().width()+'px"></li>')},this),this.$el.append(h)),a._.forHTMLPublishing||(this.$slider=h.lightSlider({mode:this.model.properties.transition,adaptiveHeight:!0,item:1,slideMargin:0,thumbMargin:0,galleryMargin:0,onSliderLoad:function(b){a.lazy(function(){c.$slider.refresh(),!0!==c.model.properties.visible&&(c.$parent.hide(),c.$parent.css("opacity",1))},500);Math.abs(c.$el.parent().width()/8);Math.min(30,Math.abs(c.$el.parent().width()/8)),c.$prev=c.$el.find(".lSPrev"),c.$prev.css({backgroundColor:c.model.properties.buttonBgColor,color:c.model.properties.buttonColor}),c.$next=c.$el.find(".lSNext"),c.$next.css({backgroundColor:c.model.properties.buttonBgColor,color:c.model.properties.buttonColor}),c.updateNavigationButtonSize(),c.$prev.on("click",$.proxy(c._preventDoubleTapDefault,c)),c.$next.on("click",$.proxy(c._preventDoubleTapDefault,c))},onBeforeSlide:function(a,b){},onAfterSlide:function(b,d){c.__action__.options.start=d,c.__isImageSlideDown__&&(c.__isImageSlideDown__=!1,c.$slider.isDisableDrag()&&c.$slider.disableDrag(!1),a.IS_DRAGGING=!1)}}),this.$el.on(a.__eventTypes__.start,function(a){c.__isImageSlideDown__=!0,c.__startPageX=a.pageX,c.__startPageY=a.pageY}),this.$el.on(a.__eventTypes__.move,function(b){c.__isImageSlideDown__&&!a.IS_DRAGGING&&(c.__slideTimeout__&&c.__slideTimeout__.id&&clearTimeout(c.__slideTimeout__.id),a.IS_DRAGGING=!0),a.IS_ZOOM&&(a.IS_ZOOM_DRAG_MODE?c.$slider.isDisableDrag()||c.$slider.disableDrag(!0):c.$slider.isDisableDrag()&&c.$slider.disableDrag(!1))}),this.$el.on(a.__eventTypes__.end,function(b){c.__isImageSlideDown__=!1,c.__slideTimeout__||(c.__slideTimeout__={});var d=b.pageX,e=b.pageY;Math.distance(c.__startPageX,c.__startPageY,d,e)>5?a.lazyOnce(function(){a.IS_DRAGGING=!1},50,c.__slideTimeout__):a.IS_DRAGGING=!1,c.$slider.isDisableDrag()&&c.$slider.disableDrag(!1)}))}},willAppear:function(){e.willAppear.call(this);var b=!1;this.$parent.is(":visible")||(this.$parent.show(),!0!==this.model.properties.visible&&(b=!0,this.$parent.css("opacity",0))),!0===b&&(this.$parent.hide(),this.$parent.css("opacity",1)),this.$slider&&a.lazy(function(){this.$slider.refresh()},100,this)},scaleDidChange:function(a){e.scaleDidChange.call(this,a),this.updateNavigationButtonSize()},updateSlideLayout:function(){this.$el.find("ul").height(this.$el.height()),this.$slider.refresh()},_preventDoubleTapDefault:function(b){a.IS_ZOOM_LOCKED=!0,this._refreshTimeout||(this._refreshTimeout={}),a.lazyOnce(function(){a.IS_ZOOM_LOCKED=!1},250,this._refreshTimeout)},updateNavigationButtonSize:function(){if(a.config.htmlRender){this.$prev=this.$el.find(".lSPrev");this.$prev.width(),this.viewController.contentScale,this.$prev.height(),this.viewController.contentScale;this.$prev.css("zoom",Math.max(Math.min(1.5,this.viewController.contentScale),1-this.viewController.contentScale+1)),this.$next=this.$el.find(".lSNext"),this.$next.css("zoom",Math.max(Math.min(1.5,this.viewController.contentScale),1-this.viewController.contentScale+1))}},responsiveLayoutChanged:function(a){e.responsiveLayoutChanged.call(this,a);var b=this.$el.find("ul");_.each(b.children(),function(a){$(a).find("img").height(this.$el.height())},this),this.updateSlideLayout()}}),a.UIImageSlide=f}),define("toast/views/UIIFrame",["../core","./UIView","../utils/IFrameInteraction","../utils/StringUtils"],function(a,b,c,d){"use strict";var e=a.Strings,f=b.prototype,g=b.extend();return _.extend(g.prototype,f,{initialize:function(a){f.initialize.call(this,a)},render:function(){return f.render.call(this),this.$el.css("backgroundColor","transparent"),this},mount:function(){if(this._$frameEl=this.$el.find("iframe"),this._$frameEl.length||(this._$frameEl=$("<iframe />"),this._$frameEl.attr("allowTransparency",!0)),_.isUndefined(this.model.properties.htmlfolder)||_.isEmpty(this.model.properties.htmlfolder))if(_.isUndefined(this.model.properties.url)||_.isEmpty(this.model.properties.url))if(_.isUndefined(this.model.properties.relativePath)||_.isEmpty(this.model.properties.relativePath)){if(!_.isUndefined(this.model.properties.html)&&!_.isEmpty(this.model.properties.html)){var b=a.HTMLAssets.url(this.model.properties.html);this._$frameEl.attr("src",b)}}else{var c=this.model.properties.relativePath,b=d.replaceTemplate("{ASSETS_DIR}"+c).encodeFilePath();this._$frameEl.attr("src",b)}else{var b=this.model.properties.url;b.isTag()&&(b=b.url()),"http:"!==b.protocol()&&"https"!==b.protocol()&&(b="http://"+this.model.properties.url),this._$frameEl.attr("src",b)}else{var e=a.FolderAssets.get(this.model.properties.htmlfolder),b=d.replaceTemplate(e.url+"/"+e.htmlFilename).encodeFilePath();this._$frameEl.attr("src",b)}!0===this.model.properties.scrollbarHidden?this._$frameEl.attr("scrolling","no"):a.isMobileDevice&&this.$el.css({overflow:"auto","-webkit-overflow-scrolling":"touch"}),a._.forHTMLPublishing?this.$el.append(this._$frameEl):(this._$iframeOverlay=$("<div />",{class:"toast-iframe-overlay"}),this.$parent.append(this._$iframeOverlay),this._$iframeOverlay.on("click",$.proxy(this._overlayClickHandler,this))),this._frameDidLoadedFn=$.proxy(this._frameDidLoaded,this),a.Book.isFirstPage()&&!a.__initFirstPageFrameOnce__&&(a.__initialFirstPagLoadFrame__=!0,this._loadPage(!0))},willReMountAll:function(){this._iframeInteraction&&this._iframeInteraction.willReMountAll()},remountAll:function(a){this._iframeInteraction&&this._iframeInteraction.remountAll()},appear:function(){f.appear.call(this),a.__initialFirstPagLoadFrame__||this._loadPage(!0),a.lazy(function(){var b=a.urlParams.get("preview");(a.player||b&&(b=b.trim().toLowerCase())&&"true"==b)&&(a.__iframePreviewAlert__||alert(e.ERROR_PREVIEW_IFRAME),a.__iframePreviewAlert__=!0)},100)},disappear:function(){f.disappear.call(this),this._loadPage(!1),a.__initialFirstPagLoadFrame__=!1},didUpdateLayout:function(){f.didUpdateLayout.call(this),this._iframeInteraction&&this._iframeInteraction.didUpdateLayout()},_loadPage:function(b){this._isFrameDidLoaded&&(this._saveFrameScrollPosition(),this._unsetFrameInteraction()),b?(this._$frameEl.on("load",this._frameDidLoadedFn),0===this.$el.find("iframe").length&&(a.showLoading(!0,{el:this.$el}),this.$el.append(this._$frameEl)),this.$parent.show()):(!0!==this.model.properties.scrollbarHidden&&this._$frameEl.off("mouseenter mouseleave"),this._$frameEl.off("load",this._frameDidLoadedFn),this._$frameEl.remove(),a.showLoading(!1,{el:this.$el}),this.$parent.hide(),this._isFrameDidLoaded=!1)},_frameDidLoaded:function(b){a.showLoading(!1,{el:this.$el});var c=a.urlParams.get("preview");a.player||c&&(c=c.trim().toLowerCase())&&"true"==c||(this._saveFrameScrollPosition(),this._setFrameInteraction())},_setFrameInteraction:function(){a.config.htmlRender||(this._isSameDomain()||!_.isUndefined(this.model.properties.htmlfolder)&&!_.isEmpty(this.model.properties.htmlfolder)||!_.isUndefined(this.model.properties.html)&&!_.isEmpty(this.model.properties.html))&&(this._iframeInteraction=new c({model:this.model,view:this,$frameEl:this._$frameEl}),this._iframeInteraction.scrollTop(this._scrollTop))},_saveFrameScrollPosition:function(){this._iframeInteraction&&(this._scrollTop=0,this._scrollTop=this._iframeInteraction._currentScrollTop,_.isUndefined(this._scrollTop)&&(this._scrollTop=this._iframeInteraction._currentMarginTop))},_unsetFrameInteraction:function(){this._iframeInteraction&&(this._iframeInteraction.destroy(),delete this._iframeInteraction)},_isSameDomain:function(){var b=this.model.properties.url;if(!b)return!1;var c=a.PathUtils.parseUrl(document.location.href);return b.isTag()&&(b=b.url()),"http:"!==b.protocol()&&"https"!==b.protocol()&&(b="http://"+this.model.properties.url),b=a.PathUtils.parseUrl(b),c.host===b.host},_overlayClickHandler:function(b){a.$el.removeClass("flipping")},remove:function(){this._unsetFrameInteraction(),this._$frameEl&&this._$frameEl.remove(),f.remove.apply(this,arguments)}}),a.UIIFrame=g}),define("toast/views/UIFlash",["../core","./UIView","../utils/StringUtils"],function(a,b,c){"use strict";var d=(a.Strings,b.prototype),e=b.extend();return _.extend(e.prototype,d,{initialize:function(a){d.initialize.call(this,a)},_swfLoadEvent:function(a){var b=this;if(!a.success||!a.ref)return!1;var c=setInterval(function(){if(void 0!==a.ref.PercentLoaded&&a.ref.PercentLoaded()){clearInterval(c);var d=setInterval(function(){100===a.ref.PercentLoaded()&&(b._swfDidLoaded(),clearInterval(d))},5)}},5)},_swfDidLoaded:function(){a.showLoading(!1,{el:this.$parent})},render:function(){return d.render.call(this),a.isMobileDevice?this:(this.$el.css("backgroundColor","transparent"),this)},mount:function(){a.showLoading(!0,{el:this.$parent}),this.fid=this.model.get("id")+"-flash",this.$flash=this.$el.find("#"+this.fid),this.$flash.length||(this.$flash=$("<div />",{id:this.fid}),this.$el.append(this.$flash));var b;if(_.isUndefined(this.model.properties.asset)||_.isEmpty(this.model.properties.asset)?_.isUndefined(this.model.properties.url)||_.isEmpty(this.model.properties.url)||(b=this.model.properties.url,"http:"!==this.model.properties.url.protocol()&&"https"!==this.model.properties.url.protocol()&&(b="http://"+this.model.properties.url)):b=a.FlashAssets.url(this.model.properties.asset),b){var c={},d={wmode:"transparent",scale:"exactFit",allowScriptAccess:"always"},e={};a.isChrome&&(swfobject.ua.pv=[100,0,0]);var f=this.$contentMount?null:$.proxy(this._swfLoadEvent,this);swfobject.embedSWF(b,this.fid,"100%","100%","10",!1,c,d,e,f),this.$contentMount&&this.$contentMount.resolve()}},willAppear:function(){d.willAppear.call(this),a.showLoading(!0,{el:this.$parent})},appear:function(){this.$el.show(),a.showLoading(!1,{el:this.$parent})},disappear:function(){d.willDisappear.call(this),this.$el.hide()}}),a.UIFlash=e}),define("toast/views/UIPartialZoom",["../core","./UIView"],function(a,b){"use strict";var c=(a.Strings,b.prototype),d=b.extend();return _.extend(d.prototype,c,{className:"ui-partial-zoom",initialize:function(a){c.initialize.call(this,a),this.events=_.extend({},c.events,this.events),this.delegateEvents(this.events)},render:function(){return c.render.call(this),(_.isUndefined(this.model.properties.zoomScale)||_.isNull(this.model.properties.zoomScale))&&(this.model.properties.zoomScale=300),!_.isNumber(this.model.properties.zoomScale)&&_.isEmpty(this.model.properties.zoomScale)&&(this.model.properties.zoomScale=300),this.model.properties.zoomScale=this.model.properties.zoomScale/100,this.__on__(a.Events.ZOOM_MODE_DID_CHANGE,this._zoomModeChanged),this},autostop:function(){this._isPartialZoomOpen()&&this.close()},appear:function(){c.appear.call(this),this._isPartialZoomOpen()&&this.close()},_zoomModeChanged:function(a){a?!0===this.model.properties.visible&&this.$el.parent().hide():!0===this.model.properties.visible&&this.$el.parent().show()},_windowResize:function(b){a.lazy(function(){var b=this._context();if(this.$modal.find(".modal-dialog").css("maxWidth",b.modalSize.width+"px"),this.$modal.find(".partial-zoom-body").css("height",b.modalSize.height+"px"),this._$pagEl){var c=this.$modal.find(".partial-page-container"),d=this.$modal.find("section");d.css("width",this.context.pageSize.width*b.zoomScale+"px"),d.css("height",this.context.pageSize.height*b.zoomScale+"px"),c.css("top",-this.context.position.top*b.zoomScale+"px"),c.css("left",-this.context.position.left*b.zoomScale+"px"),a.Book.fitPage(this.viewController)}},50,this)},open:function(){a.IS_ZOOM||this._isPartialZoomOpen()||(a.Book.$getBook().turn("stop"),a.Book.enableAction(!1),this.$parent.is(":visible")&&this.$parent.attr("data-pz-visible",!0),this.$parent.show(),this._showModal(),this._setPage(),this.$parent.hide(),$(window).on("resize",$.proxy(this._windowResize,this)))},_context:function(){this.context||(this.context={}),this._padding||(this._padding=0);var a={width:$(window).width()-2*this._padding,height:$(window).height()-60},b=Number(this.model.properties.zoomScale);this.context.bounds||(this.context.bounds={width:this.$parent[0].getBoundingClientRect().width,height:this.$parent[0].getBoundingClientRect().height});var c=this.context.bounds,d={width:this.model.get("width")*Number(this.model.properties.zoomScale),height:this.model.get("height")*Number(this.model.properties.zoomScale)},e=Math.min(a.width,a.height),f=Math.min(c.width,c.height);b=e/f;var g={};return g.width=Math.min(d.width,c.width*b),g.width=Math.min(a.width,g.width),g.height=Math.min(d.height,c.height*b),g.height=Math.min(a.height,g.height),f=Math.max(g.width,g.height),b=f/Math.max(c.width,c.height),g.width=c.width*b,g.height=c.height*b,this.context.modalSize=g,this.context.zoomScale=b,this.context},_isPartialZoomOpen:function(){return 0!==$(document.body).find(".partial-zoom-modal").length},_showModal:function(){var b={modalClassName:"partial-zoom-modal"},c=Mustache.render(a.HtmlLoader.Popup,b);this.$modal=$(c),this._padding=this.$modal.find(".modal-content").attr("data-padding");var d=this._context();this.$modal.find(".modal-dialog").css({maxWidth:d.modalSize.width+"px"});var e=$("<div />",{class:"partial-zoom-body"});e.css({height:d.modalSize.height+"px"}),this.$modal.find(".modal-body").append(e),$(document.body).append(this.$modal),this.$modal.find(".close").on("click",$.proxy(this.close,this))},_setPage:function(){if(this.viewController.modal||this.viewController.parentView)this.viewController.$$parent=this.viewController.$el.parent(),this._setPageEl(this.viewController.$el);else{var b=a.Book.getCurrentPage();_.any(b,function(a){"SECTION"!==a[0].tagName&&(a=a.find("section"));var b=a.find('.toast-ctrl[data-index="'+this.viewController.index+'"]');if(0!==b.length)return this._setPageEl(b),!0},this)}},_setPageEl:function(b){var c=$("<div />",{class:"partial-page-container"});c.css({position:"relative",width:"100%",height:"100%"});var d=this._context();d.pageSize||(this.context.pageSize={width:b.width(),height:b.height()}),d.position||(this.context.position={top:parseInt(this.$el.parent().position().top),left:parseInt(this.$el.parent().position().left)});var e=$("<section />");e.css("width",b.width()*d.zoomScale+"px"),e.css("height",b.height()*d.zoomScale+"px"),c.css("top",-this.context.position.top*d.zoomScale+"px"),c.css("left",-this.context.position.left*d.zoomScale+"px");var f=b.clone();f.addClass("clone-page"),b.before(f),e.append(b),c.append(e),this.$modal.find(".partial-zoom-body").append(c),this.viewController.parentView&&(this.viewController.scaleContent=!0),a.Book.fitPage(this.viewController),this._$pagEl=b},close:function(){this._unsetPage(),this._dismissModal(),"true"===this.$parent.attr("data-pz-visible")&&this.$parent.show(),this.$parent.removeAttr("data-pz-visible"),$(window).off("resize",$.proxy(this._windowResize,this)),a.Book.enableAction(!0),this.context&&delete this.context},_dismissModal:function(){this.$modal.find(".close").off("click",$.proxy(this.close,this)),this.$modal.remove()},_unsetPage:function(){var b,c=this.$modal.find(".partial-zoom-body").children(".partial-page-container").children(),d=c.children();b=this.viewController.modal||this.viewController.parentView?this.viewController.$$parent.find(".clone-page"):a.Book.$getBook().find('.toast-ctrl[data-index="'+this.viewController.index+'"]'),b.before(d),a.Book.fitPage(this.viewController),b.remove()},handleClick:function(b){a.isEditor||this.open()},events:{click:"handleClick"}}),a.UIPartialZoom=d}),define("toast/views/UIShape",["../core","./UIView","./UIText"],function(a,b,c){"use strict";var d=b.prototype,e=c.prototype,f=c.extend();return _.extend(f.prototype,e,{initialize:function(a){e.initialize.call(this,a)},commonRender:function(){this.style=_.extend({},this.style,this.model.get("style")),e.commonRender.call(this)},beforeAutofit:function(a){d.beforeAutofit.call(this,a)},afterAutofit:function(a){d.afterAutofit.call(this,a)},autoFit:function(a){return!1}}),a.UIShape=f}),define("toast/views/UILine",["../core","./UIView"],function(a,b){"use strict";var c=(a.Strings,b.prototype),d=b.extend();return _.extend(d.prototype,c,{style:{},initialize:function(a){c.initialize.call(this,a)},render:function(){return c.render.call(this),"bias"===this.model.direction||"horizon"===this.model.direction?this.$parent.css("height",0):"vertical"===this.model.direction&&this.$parent.css("width",0),this._setLine(),this._renderDrawLine(),this},_setLine:function(a){this.$parent.addClass(this.model.direction),a?this.$el.css("height",0):"bias"===this.model.direction||"horizon"===this.model.direction?this.$el.css("height",0):"vertical"===this.model.direction&&this.$el.css("width",0),"solid"===this.model.properties.style&&this.model.properties.round?this.$el.css("borderRadius",this.model.properties.width):this.$el.css("borderRadius",""),a||"bias"===this.model.direction||"horizon"===this.model.direction?this.$el.css("borderTop",this.model.properties.width+"px "+this.model.properties.style+" "+this.model.properties.color):this.$el.css("borderLeft",this.model.properties.width+"px "+this.model.properties.style+" "+this.model.properties.color)},_renderDrawBiasLine:function(){var a=this.model.start,b=this.model.end,c=(__app__?this.viewController.viewScale():this.viewController.contentScale,[a.x,a.y]),d=Math.sqrt(Math.pow(b.y-a.y,2)+Math.pow(b.x-a.x,2)),e=Math.atan2(b.y-a.y,b.x-a.x),f=this.model.properties.width;this.$el.css({left:c[0],top:c[1]-f/2,width:d,transform:"rotate("+e+"rad)",transformOrigin:"0 50% 0px"})},_drawHorizonLine:function(){this.$el.css("top",-this.model.properties.width/2)},_drawVerticalLine:function(){this.$el.css("left",this.model.properties.width/2)},_renderDrawLine:function(){"bias"===this.model.direction?this._renderDrawBiasLine():"horizon"===this.model.direction?this._drawHorizonLine():"vertical"===this.model.direction&&this._drawVerticalLine()}}),a.UILine=d}),define("toast/views/UITextInput",["../core","./UIView"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{tagName:"input",className:"form-control",style:{color:"#999",fontSize:"20px",fontFamily:"Nanum Gothic",padding:"10px"},attributes:{type:"text"},initialize:function(a){c.initialize.call(this,a)},render:function(){c.render.call(this),this.__storageId=a.project.config.publishUniqueId+"-"+this.$parent.attr("id");var b=a.data.get(this.__storageId);return _.isNull(b)||_.isEmpty(b)?this._setVal():this.$el.val(b),this},commonRender:function(){this.style=_.extend({},c.style,this.style),_.isUndefined(this.model.properties.padding)?this.model.properties.padding=parseInt(this.style.padding):this.style.padding=this.model.properties.padding+"px",c.commonRender.call(this)},_setVal:function(){_.isUndefined(this.model.properties.placeholder)||_.isEmpty(this.model.properties.placeholder)||this.$el.val(this.model.properties.placeholder)},_onFocus:function(){var b=a.data.get(this.__storageId);(_.isNull(b)||_.isEmpty(b))&&this.$el.val("")},_onFocusOut:function(){_.isEmpty(this.$el.val())&&this._setVal()},_onChange:function(b){a.data.set(this.__storageId,this.$el.val())},events:{focus:"_onFocus",focusout:"_onFocusOut",change:"_onChange"}}),a.UITextInput=d}),define("toast/views/UITextInputBox",["../core","./UITextInput"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{tagName:"textarea",style:{color:"#999",fontSize:"28px",padding:"10px"},initialize:function(a){c.initialize.call(this,a)},commonRender:function(){this.style=_.extend({},c.style,this.style),c.commonRender.call(this)}}),a.UITextInputBox=d}),define("toast/views",["./core","./views/UIViewPrivate","./views/UIViewActionAndAnimation","./views/UIViewDragAndDrop","./views/UIViewCollisionDetector","./views/UIGroup","./views/UIText","./views/UIImageButton","./views/UIButton","./views/UIImage","./views/UILink","./views/UIIcon","./views/UIAudioPlayer","./views/UIMoviePlayer","./views/UIYoutubePlayer","./views/UIImageSlide","./views/UIIFrame","./views/UIFlash","./views/UIPartialZoom","./views/UIShape","./views/UILine","./views/UITextInput","./views/UITextInputBox"],function(a){}),define("toast/core/Factory",["../core","../views"],function(Toast){"use strict";var Factory={create:function(viewController,model,$parent){var htmlRender=viewController.htmlRender&&$parent.children().first().length,el=htmlRender?$parent.children().first():null,View=eval("Toast.UI"+model.get("viewType")),viewInstance=new View({viewController:viewController,model:model,el:el,$parent:$parent}),doRender;return __app__&&!Toast._.forHTMLPublishing?viewInstance.__render__():(doRender=!0,viewInstance.render()),el||$parent.append(viewInstance.el),doRender?viewInstance.mount():viewInstance.__mount__(),viewInstance},has:function(viewType){var Factory=eval("Toast.UI"+viewType);return"function"==typeof Factory}};return Toast.Factory=Factory}),define("toast/core/ViewController",["../core","./Model","./Contents","./Factory"],function(a,b,c,d){"use strict";function e(){return{id:"page-b16aea9c-d10f",title:"untitled",label:"",width:595,height:845,background:{url:"",width:0,height:0,color:"#fff"},thumbnail:{width:70,height:100,src:""},config:{},properties:{},_doc:{},actions:[],contents:[],subpages:[]}}function f(){return{id:"to-"+TT.UUID6(),label:"",viewType:"View",__parent__:null,__children__:[],__extra__:{},left:0,top:0,width:100,height:100,rotate:0,properties:{},style:{},actions:[],animations:[],responsives:[],initState:null,states:[],selected:!1,fitWidth:!1,locked:!1,hidden:!1,draggable:!0,copyable:!0,removable:!0,droppable:!0,isModified:!1}}var g=["viewSelector"],h=Backbone.View.extend({collection:null,viewSelector:".toast-object",promises:[],xhrs:[],backgroundImages:[],contentScale:1,cache:{},initialize:function(d){d||(d={}),_.bindAll(this,"_responsiveLayoutDidUpdate"),_.extend(this,_.pick(d,g)),this.viewClassName=this.viewSelector.replace(/\./g,""),this.collection=new c(null,{attributes:e(),model:b.extend({defaults:f})}),this.collection.view=this,this._state=a.STATUS_NONE,this._$ready=new $.Deferred},viewScale:function(){var a=this.$el.css("-webkit-transform")||this.$el.css("-moz-transform")||this.$el.css("-ms-transform")||this.$el.css("-o-transform")||"";return(a=a.match("matrix\\((.*)\\)"))?(a=a[1].split(","),parseFloat(a[0])):1},_createView:function(a){if(void 0!==a.__attributes__)return this.updateBackground(),!1;if(!d.has(a.viewType))return!1;if(a.__parent__)return!1;var b;return this.htmlRender&&(b=this.$el.find("#"+a.get("id"))),b&&b.length?b.css(a.rect()):(this.$el.find("#"+a.get("id")).remove(),b=this._createModelElement(a),this.$contents.append(b)),a.view=d.create(this,a,b),!0},_createModelElement:function(a){return $("<div />",{class:this.viewClassName}).attr("id",a.get("id")).css({left:a.get("left"),top:a.get("top"),width:a.get("width"),height:a.get("height")})},_removeModelElement:function(a){this.$el.find("#"+a.get("id")).remove()},find:function(a,b,c){arguments.length<3&&(c=!1);var d=null;return _.find(this.collection.models,function(e){if(!e.__attributes__&&e.get(a)==b)return d=e,!0;if(c&&!e.__attributes__){var f=[];if(e.hasChildren()?this.findChildren(f,e.__children__,a,b):e.container&&!_.isEmpty(e.contents)&&e.view?e.view.containerView&&this.findChildren(f,e.view.containerView.collection.models,a,b):e.multilayerContainer&&!_.isEmpty(e.contents)&&e.view&&_.each(e.view.layers,function(c){this.findChildren(f,c.containerView.collection.models,a,b)},this),f.length>0)return d=f[0],!0}},this),d},finds:function(a,b,c){var d=[];return arguments.length<3&&(c=!0),this.collection.each(function(e){if(e.__attributes__)return!0;e.get(a)==b&&d.push(e),c&&(e.hasChildren()?this.findChildren(d,e.__children__,a,b):e.container&&!_.isEmpty(e.contents)&&e.view?e.view.containerView&&this.findChildren(d,e.view.containerView.collection.models,a,b):e.multilayerContainer&&!_.isEmpty(e.contents)&&e.view&&_.each(e.view.layers,function(c){this.findChildren(d,c.containerView.collection.models,a,b)},this))},this),d},_find:function(a){var b=_.find(this.findAll(),a);return!b&&this.parentViewController&&(b=this.parentViewController._find(a)),b},_deepFind:function(b){var c=_.find(this.findAll(),b);return!c&&this.parentViewController&&(c=this.parentViewController._find(b)),c||(c=a.api.find(b))&&(c=c.model),c},findAll:function(){var a=[];return _.each(this.collection.models,function(b){if(b.__attributes__)return!0;a.push(b),b.hasChildren()?this.findChildren(a,b.__children__):b.container&&!_.isEmpty(b.contents)&&b.view?b.view.containerView&&this.findChildren(a,b.view.containerView.collection.models):b.multilayerContainer&&!_.isEmpty(b.contents)&&b.view&&_.each(b.view.layers,function(b){b.containerView&&this.findChildren(a,b.containerView.collection.models)},this)},this),a},findChildren:function(a,b,c,d){_.each(b,function(b){if(b.__attributes__)return!0;c?b.get(c)==d&&a.push(b):a.push(b),b.hasChildren()?this.findChildren(a,b.__children__,c,d):b.container&&!_.isEmpty(b.contents)&&b.view?b.view.containerView&&this.findChildren(a,b.view.containerView.collection.models,c,d):b.multilayerContainer&&!_.isEmpty(b.contents)&&b.view&&_.each(b.view.layers,function(b){b.containerView&&this.findChildren(a,b.containerView.collection.models,c,d)},this)},this)},findProperty:function(a,b){var c=[];_.isUndefined(a.properties)||c.push(a.properties),_.each(a.actions,function(a){c.push(a.properties)}),_.each(c,function(a){_.each(Object.keys(a),function(c){var d=a[c];if(_.isEmpty(d))return!0;if(_.isArray(d))_.each(d,function(a,e){var f=b(a,c);_.isUndefined(f)||(d[e]=f)});else{var e=b(d,c);_.isUndefined(e)||(a[c]=e)}})})},findSubpage:function(a){return _.find(this.collection.subpages.models,{id:a})},updateBackground:function(b){b||(b={});var c=this._model;b.width&&(c.width=b.width),b.height&&(c.height=b.height);var d={width:c.width,height:c.height,backgroundColor:c.background.color};if(_.isEmpty(this._model.style)||(d=_.extend(d,this._model.style)),this.$el.css(d),this.collection.container&&_.isEmpty(c.background))return(new $.Deferred).resolve().promise();if(this._removeBackground(),this.updateBackgroundAttributes(),_.isEmpty(c.background.url)&&(!c._doc||_.isEmpty(c._doc.url)))return(new $.Deferred).resolve().promise();var e=new $.Deferred,f=e.promise();f.$defer=e,this.promises.push(f);var g=_tt.StringUtils.replaceTemplate(c.background.url,"ASSETS_DIR",tt.paths.assets);a._.forHTMLPublishing||(g=g.encodeFilePath());var h;return c._doc&&"svg"===c._doc.type&&!_.isEmpty(c._doc.url)&&(h=_tt.StringUtils.replaceTemplate(c._doc.url,"ASSETS_DIR",tt.paths.assets),a._.forHTMLPublishing||(h=h.encodeFilePath())),this._loadBackground(g,h,c.width,c.height,b.refresh).always(function(){e.resolve()}),f},getBackgroundSize:function(){var a=this._model;if(a.properties.customBgSize){var b="100%";_.isUndefined(a.properties.backgroundWidth)||(b=a.properties.backgroundWidth,isNaN(b)||(b+="px"));var c="auto";return _.isUndefined(a.properties.backgroundHeight)||(c=a.properties.backgroundHeight,isNaN(c)||(c+="px")),b+" "+c}return _.isUndefined(a.background.size)?"cover":a.background.size},getBackgroundPosition:function(){var a=this._model.background;return _.isUndefined(a.position)?"50% 50%":a.position},getBackgroundRepeat:function(){var a=this._model.background;return _.isUndefined(a.repeat)?"no-repeat":a.repeat},getBackgroundAttributes:function(){return{backgroundSize:this.getBackgroundSize(),backgroundPosition:this.getBackgroundPosition(),backgroundRepeat:this.getBackgroundRepeat()}},updateBackgroundAttributes:function(){this.$el.css(this.getBackgroundAttributes())},_loadBackground:function(b,c,d,e,f){var g=new $.Deferred;d||(d=this._model.width),e||(e=this._model.height);var h=(new Date).getTime();if(f&&(b+="?timestamp="+h,_.isEmpty(c)||(c+="?timestamp="+h)),a._.forHTMLPublishing){var i=$("<img />",{class:"background",src:b,border:0});return this.$el.prepend(i),g.resolve().promise()}var j=this,k=new Image;return k.onload=function(){if(j.$el.css("backgroundRepeat","no-repeat"),_.isEmpty(c)){if(j.collection.container||j.collection.multilayerContainer)j.$el.css("backgroundImage",'url("'+b+'")');else{var d=$("<img />",{class:"background",src:b,border:0});!0===a.config.brokenPageCorrection?d.css({width:"100.2%",height:"100.2%"}):d.css({width:"100%",height:"100%"}),d.mousedown(function(a){a.preventDefault()}),j.$el.prepend(d)}g.resolve()}else{var e=new Image;e.onload=function(){var b;if(j.print?b=$("<img />",{class:"background",src:e.src,border:0}):(j.$el.css("backgroundImage",'url("'+k.src+'")'),b=$("<img />",{class:"background svg-background","data-url":e.src,width:"100%",height:"100%",border:0}),a._msieVersion<10&&a.Book._isFlipTransition?b[0].src=e.src:(b[0].src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",b.css("backgroundSize","100% 100%"),b.css("backgroundRepeat","no-repeat"),b.css("backgroundPosition","50% 50%"),b.css("backgroundImage",'url("'+e.src+'")')),!0===a.config.brokenPageCorrection?j.$el.css("backgroundSize","100.4% 100.4%"):j.$el.css("backgroundSize","100% 100%"),b.mousedown(function(a){a.preventDefault()})),j.$el.prepend(b),j.print){var b=$("<img />",{class:"background",src:k.src,border:0});!0===a.config.brokenPageCorrection?b.css({width:"100.4%",height:"100.4%"}):b.css({width:"100%",height:"100%"}),j.$el.prepend(b)}g.resolve()},e.onerror=function(){g.resolve()},j.backgroundImages.push(e),e.src=c}},k.onerror=function(){g.resolve()},j.backgroundImages.push(k),k.src=b,g.promise()},_removeBackground:function(){_.each(this.backgroundImages,function(a){a.src=""}),this.backgroundImages=[],this.$el.children(".background").remove(),this.$el.css("backgroundImage",""),this.$el.css("backgroundSize",""),this.$el.css("backgroundRepeat",""),this.$el.css("backgroundPosition","")},_hasBackgroundImage:function(){if(this.$el.first().hasClass("background"))return!0;var a=this.$el.css("backgroundImage");return!_.isUndefined(a)&&!_.isEmpty(a)&&"none"!==a},state:function(){return this._state},load:function(b,c){var d={htmlRender:!1,showLoader:!1,readyonly:!1};if(c||(c={}),c=_.extend(d,c),_.extend(this,c),this.htmlRender||this.reset(),this._state=a.STATUS_LOADING,this.cache={},this.htmlRender||!0!==c.showLoader||a.showLoading(!0,{modal:!1,el:this.$el.parent()}),this.collection.load(b,{silent:!0}),this.collection._orgWidth=this.collection.width,c.readyonly&&(this.$contents=this.$el.find(".contents"),this.$contents.length||(this.$contents=$("<div />",{class:"contents"}),this.$el.append(this.$contents))),_.each(this.collection.models,function(a){this._createView(a)},this),__app__||(_.each(this.collection.models,function(a){!a.__attributes__&&a.view&&(a.view.mountAll(this),this.__setChangeState__(a.view.actions.changeState,a,"actions"),this.__setChangeState__(a.view.animations.changeState,a,"animations"))},this),_.each(this.collection.models,function(a){!a.__attributes__&&a.view&&a.initState&&a.view.state(a.initState)},this)),_.isEmpty(this.promises))a.showLoading(!1,{el:this.$el.parent()}),this._state=a.STATUS_LOADED,this._$ready.resolve();else{var e=this;a.Async.waitForAll(this.promises).then(function(){e._state===a.STATUS_LOADING&&(a.showLoading(!1,{el:e.$el.parent()}),e.promises=[],e._state=a.STATUS_LOADED,e._$ready.resolve())})}a.viewLayout({collection:this.collection})},bounds:function(){var a={left:0,top:0,width:this.collection.width,height:this.collection.height};return _.each(this.collection.models,function(b){if(b.__attributes__)return!0;var c={left:b.get("left"),top:b.get("top"),width:b.get("left")+b.get("width"),height:b.get("top")+b.get("height")};a.left=Math.min(c.left,a.left),a.top=Math.min(c.top,a.top),a.width=Math.max(c.width,a.width),a.height=Math.max(c.height,a.height)},this),a},__setChangeState__:function(b,c,d){var e;e="actions"!==d,_.each(b,function(b){var f;f=e?b.model._.properties:b.properties;var g=f.stateTargets;g||(g=[c.id]);var h=[];_.each(g,function(b){var c=this._find({id:b});!c&&this.parentViewController&&(c=this.parentViewController._find({id:b})),c?h.push(c):(c=a.api.find({id:b}))&&h.push(c.model)},this),_.each(h,function(a){a.__changeState__||(a.__changeState__={}),a.__changeState__[d]||(a.__changeState__[d]=[]),a.__changeState__[d].push({states:f.states,condition:f.condition,instance:b,models:h})},this)},this)},ready:function(a,b){switch(this._$ready.promise().state()){case"resolved":void 0===b?a():a.call(b);break;case"pending":void 0===b?this._$ready.promise().done(a):this._$ready.promise().done(a.bind(b))}},topParentViewController:function(){var a=this.parentViewController;if(!a)return this;for(;;){if(!a.parentViewController)break;a=a.parentViewController}return a},willAppear:function(){this.viewVisibilityChange(a.Events.SHOW_PAGE)},appear:function(){this.viewVisibilityChange(a.Events.SHOWN_PAGE)},willDisappear:function(){this.viewVisibilityChange(a.Events.HIDE_PAGE)},disappear:function(){this.viewVisibilityChange(a.Events.HIDDEN_PAGE)},viewVisibilityChange:function(b){_.each(this.collection.models,function(c){if(c.view&&!c.__attributes__)switch(b){case a.Events.SHOW_PAGE:c.view.willAppear();break;case a.Events.SHOWN_PAGE:c.view.appear();break;case a.Events.HIDE_PAGE:c.view.willDisappear();break;case a.Events.HIDDEN_PAGE:c.view.disappear()}},this)},willReMountAll:function(){_.each(this.collection.models,function(a){a.view&&!a.__attributes__&&a.view.willReMountAll()})},remountAll:function(){_.each(this.collection.models,function(a){a.view&&!a.__attributes__&&a.view.remountAll()})},scaleDidChange:function(a){this.contentScale=a,_.each(this.collection.models,function(b){b.view&&!b.__attributes__&&b.view.scaleDidChange(a)},this)},current:function(b){if(!arguments.length)return!!a.config.htmlRender||this.$el.hasClass(a.CURRENT_PAGE);b?this.$el.addClass(a.CURRENT_PAGE):this.$el.removeClass(a.CURRENT_PAGE)},config:function(a){if(!arguments.length)return this.collection.config;this.collection.config=_.extend(this.collection.config,a)},sizeEl:function(a){if(!arguments.length)return{width:this.$el.width(),height:this.$el.height()};this.$el.css(a)},size:function(a,b){if(!arguments.length)return{width:this.collection.width,height:this.collection.height};b||(b={modelUpdate:!0}),b.modelUpdate&&(this.collection.width=a.width,this.collection.height=a.height),this.$contents.css(a);var c=this.sizeEl(),d=Math.max(c.width/a.width,c.height/a.height);if(this.contentScale!==d){if(1===d)this.$contents.tt_transform("");else{var e=(c.width-a.width)/2/d,f=(c.height-a.height)/2/d;this.$contents.tt_transform("scale("+d+") translate("+e+"px, "+f+"px)")}this.scaleDidChange(d)}},layout:function(a){var b={width:this.collection.width,height:this.collection.height},c=Math.min(this.$el.parent().width()/b.width,this.$el.parent().height()/b.height),d=parseInt(b.width*c),e=parseInt(b.height*c);d+=d%2,Math.abs(this.$el.parent().width()-d)<=4&&(d=this.$el.parent().width()),e+=e%2,Math.abs(this.$el.parent().height()-e)<=4&&(e=this.$el.parent().height()),this.needLayout=0===d||0===e,this.sizeEl({width:d,height:e}),this.size(b,{modelUpdate:!1}),this.didUpdateLayout()},mlayout:function(){var a={width:this.collection.width,height:this.collection.height},b=this.$el.parent().width()/a.width,c=parseInt(a.width*b),d=parseInt(a.height*b);c+=c%2,Math.abs(this.$el.parent().width()-c)<=4&&(c=this.$el.parent().width()),d+=d%2,Math.abs(this.$el.parent().height()-d)<=4&&(d=this.$el.parent().height()),this.needLayout=0===c||0===d,this.sizeEl({width:c,height:d}),this.size(a,{modelUpdate:!1}),this.didUpdateLayout()},didUpdateLayout:function(a){_.each(this.collection.models,function(a){a.view&&!a.__attributes__&&a.view.didUpdateLayout()},this)},reset:function(){a.showLoading(!1,{el:this.$el.parent()}),_.each(this.xhrs,function(a){!_.isUndefined(a)&&_.isFunction(a.abort)&&a.abort()},this),this.xhrs=[],_.each(this.promises,function(a){!_.isUndefined(a.$defer)&&_.isFunction(a.$defer.reject)&&a.$defer.reject()},this),this.promises=[],this.contentScale=1,this._state=a.STATUS_NONE,this.cache={},this._removeBackground(),a.common.setActivePopupMenu(null);var b=this.findAll();_.each(b,function(a){!a.__attributes__&&a.view&&(a.view.remove(),delete a.view)},this),this.$contents&&this.$contents.children().remove(),this.$el.children().remove(),this._$ready=new $.Deferred,this.collection.reset()},output:function(a){var b=this.collection.attributes;return b.title=this._model.title,b.label=this._model.label,b.contents=this.collection.output(),b.contents.splice(0,1),a?JSON.stringify(b,null,4):b},toHTML:function(b){b||(b={});var c=new $.Deferred,d=this.$el.clone(),e=d.children(".contents");e.empty();var f=this;return a.Async.doSequentially(this.collection.models,function(a,c){var d=new $.Deferred;return!a.__attributes__&&a.view?a.view.toHTML(b).always(function(a){e.append(a),d.resolve()}):d.resolve(),d.promise()},!1).always(function(){if(a._.forNewsletter){var b,g,h=__app__.activeEditor.manager.getActivePageEditor();f.parentView?(b=f.parentView,g=b.model):(b=f,g=b._model);var i=e.children(".column"),j=f.collection.properties.itemLayout;if(f.collection.block&&!i.length&&!f.collection.column){var k,l,m,n=$("<td />",{class:"block"}),o=$("<table />",{class:"block",cellspacing:0,cellpadding:0,border:0}),p=$("<tr />"),q=$("<td />"),r=$("<div />"),s=e.children();s.length;_.each(s,function(a,b){var c=$(a),d=f.collection.at(b+1);if("none"===j)return!0;(d.block||"block"===j||d.firstOfRow)&&(l=$("<table />",{cellspacing:0,cellpadding:0,border:0}),m=$("<tr />"),m.css("borderSpacing",0),l.css("borderSpacing",0),l.css("width","auto"),l.append(m),r.append(l)),"inline"===j?b>0&&(d.firstOfRow||c.css("marginLeft",f.collection.properties.itemSpacing),d.firstOfRow?c.css("marginTop",f.collection.properties.itemSpacing):c.css("marginTop",k.css("marginTop"))):b>0&&l.css("marginTop",f.collection.properties.itemSpacing);var e=$("<td />");e.css("vertical-align","top"),e.append(c),m.append(e),k=c}),q.append(r),p.append(q),r.css("display","table"),r.css("padding",0),q.css("paddingTop",f.collection.properties.paddingTop),q.css("paddingRight",f.collection.properties.paddingRight),q.css("paddingBottom",f.collection.properties.paddingBottom),q.css("paddingLeft",f.collection.properties.paddingLeft),p.css("borderSpacing",0),p.attr("align",f.collection.properties.itemAlign),o.css("width",f._model.width),f.collection.properties.sizeByUser&&h.collection.id!==f.collection.id&&(o.removeClass("container"),o.css("marginLeft",f._model.left)),_.isEmpty(f._model.style)||o.css(f._model.style),n.css("vertical-align","top"),o.css("backgroundColor",f.$el.css("backgroundColor"));var t=g.background;if(!_.isEmpty(t)&&!_.isEmpty(t.url)){var u=_tt.StringUtils.replaceTemplate(t.url,"ASSETS_DIR",tt.paths.assets);o.css("backgroundImage",'url("'+u+'")'),o.css(b.getBackgroundAttributes())}b.collection.isEmpty()&&o.css("height",b.collection.height),o.append(p);var v;if(g.actions&&(v=_.find(g.actions,{name:"LinkUrl"})),v&&v.properties.url){var w=$("<a />"),u=v.properties.url;w.attr("href",u),v.properties.openWindow&&w.attr("target","_blank"),w.css("display","block"),w.css("text-decoration","none"),w.append(o),n.append(w)}else n.append(o);return c.resolve(n[0].outerHTML)}var o=$("<table />",{class:"container",cellspacing:0,cellpadding:0,align:"center",border:0}),p=$("<tr />"),q=$("<td />");o.css("borderSpacing",0),o.css("max-width",f._model.width),f.collection.parent?o.css("width","100%"):o.css("width",f._model.width),f.collection.properties.sizeByUser&&h.collection.id!==f.collection.id&&(o.removeClass("container"),o.css("marginLeft",f._model.left)),_.isEmpty(f._model.style)||o.css(f._model.style),o.css("backgroundColor",f.$el.css("backgroundColor"));var t=g.background;if(!_.isEmpty(t)&&!_.isEmpty(t.url)){var u=_tt.StringUtils.replaceTemplate(t.url,"ASSETS_DIR",tt.paths.assets);o.css("backgroundImage",'url("'+u+'")'),o.css(b.getBackgroundAttributes())}if(b.collection.isEmpty()&&o.css("height",b.collection.height),i.length){var l=$("<table />",{class:"container",cellspacing:0,cellpadding:0,align:"center",border:0});if("block"===$(i[0]).attr("parent-column-layout"))_.each(i,function(a,b){var c=$(a),d=$("<tr />");d.append(c),l.append(d)});else{var m=$("<tr />");_.each(i,function(a,b){var c=$(a);c.children("table");if(b>0&&f.collection.properties.itemSpacing>0){var d=$("<td />",{class:"space"});d.css("width",f.collection.properties.itemSpacing),m.append(d)}m.append(c)}),l.append(m)}q.append(l),q.css("paddingTop",f.collection.properties.paddingTop),q.css("paddingRight",f.collection.properties.paddingRight),q.css("paddingBottom",f.collection.properties.paddingBottom),q.css("paddingLeft",f.collection.properties.paddingLeft)}else{var s=e.children();_.each(s,function(a,b){$(a).css("display","table")}),e.css("max-width",f._model.width),q.append(e)}p.append(q);var x=_.filter(f.collection.models,function(a){return a.block});if(_.isEmpty(x)){o.css("width",f._model.width),o.css("marginLeft",""),o.css("backgroundColor",""),o.css("backgroundImage",""),o.css("backgroundSize",""),o.css("backgroundPosition",""),o.css("backgroundRepeat","");var y=d.children(".background");y.removeAttr("id class style"),y.attr("usemap","#map"),y.css({padding:0,margin:"auto",width:f._model.width,height:f._model.height}),q.append(y),e=e.tt_changeTag("map"),e.attr("name","map"),e.removeAttr("id class style"),e.children(".toast-object").remove()}o.append(p);var v;if(!_.isEmpty(x)&&g.actions&&(v=_.find(g.actions,{name:"LinkUrl"})),v&&v.properties.url){var w=$("<a />"),u=v.properties.url;w.attr("href",u),v.properties.openWindow&&w.attr("target","_blank"),w.css("display","block"),w.css("text-decoration","none"),w.append(o),o=w}c.resolve(o[0].outerHTML)}else d.css("width",f._model.width),d.css("height",f._model.height),c.resolve(d[0].outerHTML)}),c.promise()},updateItemLayout:function(a,b){this.collection.width=this._model.width=a.width,this.collection.height=this._model.height=a.height,this.$el.css(a)},responsiveLayout:function(b){b||(b={});var c=b.responsiveWidth;return _.isUndefined(c)||(this.collection.width=c,this.$el.css({width:c}),_.each(this.collection.models,function(a){a.view&&!a.__attributes__&&a.block&&a.view.responsiveLayoutChanged({responsiveWidth:c})},this)),b=_.extend({collection:this.collection,onUpdate:this._responsiveLayoutDidUpdate},b),a.viewLayout(b)},_responsiveLayoutDidUpdate:function(a,b){this.collection.width=b.contentSize.width,this.collection.height=b.contentSize.height,this.$el.css(b.contentSize)}});return h.getAttributes=e,a.ViewController=h}),define("toast/core/Project",["exports","../core","./Collection","./Model","./ViewController","../utils"],function(a,b,c,d,e){"use strict";function f(){return e.getAttributes()}var g,h={id:"project-213b-aa20-08344f936337",version:"5.8.351",title:"Toast Project",description:"",metadata:{},config:{language:"ko",defaultPageWidth:595,defaultPageHeight:845,userStylesheets:[],mobile:{},transition:"flip",doublepage:!0,firstPageNumber:1,print:!0,share:!0,shadow:!0,pdfUrl:"",widgetDataManager:{}},pages:[],subpages:[]},i=c.extend();_.extend(i,{initialize:function(a){return h.id=b.dateUUID().prefix("project-"),a||(a={}),_.isNull(a.attributes)||_.isUndefined(a.attributes)?a.attributes=_.clone(h):a.attributes=_.extend(_.clone(h),a.attributes),(_.isNull(a.model)||_.isUndefined(a.model))&&(a.model=d.extend({defaults:f})),g=new i(null,a),a.editor&&g.setParsedVersion(),g}});var j=c.prototype;return _.extend(i.prototype,{subpages:new c(null,{model:d.extend({defaults:f})}),getProjectPath:function(){return b.paths.projectRoot+b.paths.projectFile},load:function(a,e){this.reset(),"string"==typeof a&&(a=JSON.parse(a));var g;a.pages?(g=$.extend(!0,[],a.pages),a.pages&&delete a.pages):a.collection&&(g=$.extend(!0,[],a.collection),a.collection&&delete a.collection);var i=$.extend(!0,[],a.subpages);a.subpages&&delete a.subpages;var j=this.attributes;this.attributes=_.extend(j,a);for(var k in this.attributes)this.defineProperty(k);this.config.reversePageTurnDirection&&!__app__&&(g.reverse(),i.reverse()),_.each(g,function(a){var b=a.subpages;a.subpages&&delete a.subpages;var g=new this.model(a);this.createChildren(g,a),g.unset("children",{silent:!0}),this.add(g,e),g.subpages=new c(null,{model:d.extend({defaults:f})}),_.each(b,function(a){var b=new this.model(a);this.createChildren(b,a),b.unset("children",{silent:!0}),g.subpages.add(b,e)},this)},this),_.each(i,function(a){var b=new this.model(a);this.createChildren(b,a),b.unset("children",{silent:!0}),this.subpages.add(b,e)},this),this.config=_.extend(_.clone(h.config),this.config),this._loadUserStylesheets(!0),this.setParsedVersion(),b.Assets.load()},reset:function(a,c){return a=j._reset.call(this,a,c),this.subpages.reset(),b.Assets.load(),a},setParsedVersion:function(){var a=/([0-9]+)\.([0-9]+)\.([0-9]+)/.exec(this.version);a.VERSION_MAJOR=Number(a[1]),a.VERSION_MINOR=Number(a[2]),a.VERSION_PATCH=Number(a[3]),this.parsedVersion=a},updateVersion:function(){this.version=h.version,this.setParsedVersion()},finds:function(a,b){var e=[];return a instanceof d?a=_.isUndefined(a.contents)?[a]:a.contents:a instanceof c?a=a.models:_.isArray(a)||(a=[a]),_.each(a,function(a){b?a[b.name]===b.value&&e.push(a):e.push(a),_.isEmpty(a.children)?_.isEmpty(a.__children__)?_.isEmpty(a.contents)||this._findChildren(e,a.contents,b):this._findChildren(e,a.__children__,b):this._findChildren(e,a.children,b)},this),e},find:function(a){return _.find(this.findAll(),a)},findAll:function(a){var b=[];return _.each(this.models,function(c){c.contents&&(b=b.concat(this.finds(c.contents,a))),c.collection&&c.collection!==this&&(b=b.concat(this.finds(c.collection,a))),_.each(c.subpages.models,function(c){c.contents&&(b=b.concat(this.finds(c.contents,a)))},this)},this),_.each(this.subpages.models,function(c){c.contents&&(b=b.concat(this.finds(c.contents,a)))},this),b},_findChildren:function(a,b,c){_.each(b,function(b){c?b[c.name]===c.value&&a.push(b):a.push(b),_.isEmpty(b.children)?_.isEmpty(b.contents)||this._findChildren(a,b.contents,c):this._findChildren(a,b.children,c)},this)},findPage:function(a){var b;return a.name&&a.value?(_.each(this.models,function(c,d){if(c[a.name]===a.value)return b={page:c,index:d},!1},this),b):b},findAssets:function(a){var c=[],d=this.finds(a);return _.each(d,function(a){this.findProperty(a,function(a){if("as-"===a.substr(0,3)){var d=b.Assets.find(a);d&&c.push(d)}})},this),c},findProperty:function(a,b){var c=[];_.isUndefined(a.properties)||c.push(a.properties),_.each(a.actions,function(a){c.push(a.properties)}),_.each(c,function(a){this._findProperty(a,b)},this)},_findProperty:function(a,b){_.each(Object.keys(a),function(c){var d=a[c];if(_.isEmpty(d))return!0;if(_.isArray(d))_.each(d,function(a,e){if(_.isEmpty(a))return!0;if(_.isObject(a))this._findProperty(a,b);else{var f=b(a,c);_.isUndefined(f)||(d[e]=f)}},this);else if(_.isObject(d))this._findProperty(d,b);else{var e=b(d,c);_.isUndefined(e)||(a[c]=e)}},this)},output:function(a){var c=_.cloneDeep(this.attributes);return c.pages=this.toJSON(),c.subpages=this.subpages.toJSON(),_.each(b.Assets.collections(),function(a){c.assets[a.name]=a.output()}),tt.debug?JSON.stringify(c,null,4):JSON.stringify(c)},text:function(){var a=[];return _.each(this.models,function(b){var c={id:b.id,text:""},d=this.finds(b.contents);_.each(d,function(a){void 0!==a.htmlText&&"string"==typeof a.htmlText&&(_.isEmpty(c.text)||(c.text+=" "),c.text+=a.htmlText.removeTags()),void 0!==a.text&&"string"==typeof a.text&&(_.isEmpty(c.text)||(c.text+=" "),c.text+=a.text.removeTags())},this),a.push(c)},this),a},_loadUserStylesheets:function(a){a&&$(".userStylesheet").remove();var c=$("head");_.each(this.config.userStylesheets,function(a){if(_.isEmpty(c.children("#"+a.id))){var d={id:a.id,type:"text/css",rel:"stylesheet",href:b.paths.assets+a.src};$('<link class="userStylesheet" />').attr(d).appendTo(c)}},this)},__load__:function(a){a||(a={});var c=new $.Deferred;if(b.setPaths(),a.data)return this.load(a.data),this.__projectLoaded__(),c.resolve().promise();var d=a.url?a.url:this.getProjectPath(),e=(new Date).getTime(),f=this;return(new Backbone.Model).fetch({url:d+"?timestamp="+e,success:function(a,b){f.load(b),f.__projectLoaded__(),c.resolve()},error:function(a,b){}}),c.promise()},__projectLoaded__:function(){b.urlParams.get("doublepage")&&(this.config.doublepage="true"===b.urlParams.get("doublepage")),b.urlParams.get("publishUniqueId")&&(this.config.publishUniqueId=b.urlParams.get("publishUniqueId")),this.config.mobile||(this.config.mobile={}),b.config=_.extend(this.config,b.config),_.isUndefined(this.config.mobile.doublepage)&&(this.config.mobile.doublepage=!1),b.isMobileDevice&&(this.config.doublepage=this.config.mobile.doublepage),b.isMobileDevice&&this.config.mobile.landscapeDoublePage&&b.isLandscape()&&(this.config.doublepage=!0);var a=b.urlParams.get("language");a&&(b.config.language=a),b.config.language&&"ko"!==b.config.language?b.load(["i18n!nls/"+b.config.language+"/strings"],function(a){b.Strings=a,b.dispatchReady(b.PROJECT_LOADED)}):b.dispatchReady(b.PROJECT_LOADED)}}),i.__ATTRIBUTES__=h,i.getModelAttributes=f,b.Project=i}),define("toast/core/Assets",["exports","../core"],function(a,b){"use strict";function c(){return o}function d(a){return _.find(o,{name:a})}function e(a){var b;return a=a.toLowerCase(),_.each(c(),function(c){var d;if(_.each(c.fileTypes,function(b){if(b.toLowerCase()===a)return d=c,!1}),d)return b=c,!1}),b}function f(a){var b;return _.each(c(),function(c){if(b=c.folder(a))return!1}),b}function g(a){var b;return _.each(c(),function(c){if(b=c.get(a))return!1}),b}function h(a){var b;return _.each(c(),function(c){var d=c.values();if(_.each(d,function(c){if(c.url.getBaseName()===a)return b=c,!1}),b)return!1}),b}function i(){var a=[];return _.each(c(),function(b){a=a.concat(b.values())}),a}function j(a){_.each(c(),function(b){if(b.get(a))return b.unset(a),!1})}function k(a){a||(a=b.project);var c={image:{folders:[],assets:[]},audio:{folders:[],assets:[]},movie:{folders:[],assets:[]},svg:{folders:[],assets:[]},flash:{folders:[],assets:[]},html:{folders:[],assets:[]},file:{folders:[],assets:[]},folder:{folders:[],assets:[]},data:{folders:[],assets:[]}};if(_.isUndefined(a.assets))a.attributes.assets=c,a.defineProperty("assets");else{var d=Object.keys(c);_.each(d,function(b){a.assets[b]||(a.assets[b]=c[b])})}}function l(){k(),b.ImageAssets=new n({name:"image",fileTypes:["jpg","jpeg","png","gif"]}),b.AudioAssets=new n({name:"audio",fileTypes:["mp3"]}),b.MovieAssets=new n({name:"movie",fileTypes:["mp4","m4v"]}),b.SVGAssets=new n({name:"svg",fileTypes:["svg"]}),b.FlashAssets=new n({name:"flash",fileTypes:["swf"]}),b.HTMLAssets=new n({name:"html",fileTypes:["html","htm"]}),b.FileAssets=new n({name:"file",fileTypes:["pdf","jpg","jpeg","png","gif","mp3","ogg","mp4","swf","zip"]}),b.FolderAssets=new n({name:"folder",folderType:""}),b.DataAssets=new n({name:"data",fileTypes:["json","xml"]}),o=[],o.push(b.ImageAssets),o.push(b.AudioAssets),o.push(b.MovieAssets),o.push(b.SVGAssets),o.push(b.FlashAssets),o.push(b.HTMLAssets),o.push(b.FileAssets),o.push(b.FolderAssets),o.push(b.DataAssets)}var m=b.Strings,n=function(a){for(var b in a)this[b]=a[b];this._folders=[],this._assets=[],this.initialize.apply(this,arguments)};_.extend(n.prototype,{initialize:function(){if(_.each(b.project.assets[this.name].folders,function(a){a._default&&(this._defaultFolder=a),this._folders[a.id]=a},this),_.each(b.project.assets[this.name].assets,function(a){this._assets[a.id]=a},this),_.isEmpty(Object.keys(this._folders)))this._setDefaults();else if(!this._defaultFolder){var a=b.project.assets[this.name].folders[0];a&&(a._default=!0,this._defaultFolder=a)}},_setDefaults:function(a){a||(a={folder:!0}),a.folder&&(this._defaultFolder={id:b.UUID6().prefix("as-"),_default:!0,readonly:!0,lock:!1,name:m.DEFAULT_FOLDER},this._folders[this._defaultFolder.id]=this._defaultFolder)},_getDefaultFolder:function(){return this._defaultFolder},values:function(a){var b=[];return a||(a={folder:!1}),!0===a.folder?_.each(Object.keys(this._folders),function(a){b.push(this._folders[a])},this):a.folderId?_.each(Object.keys(this._assets),function(c){a.folderId===this._assets[c].fid&&b.push(this._assets[c])},this):_.each(Object.keys(this._assets),function(a){b.push(this._assets[a])},this),b},set:function(a,c){c||(c={folder:!1});var d;return!0===c.folder?d=this._folders:(d=this._assets,_.isUndefined(a.ref)&&(a.ref=0),_.isEmpty(a.name)&&!_.isEmpty(a.url)&&(a.name=a.url.getBaseName().getFilenameWithoutExtension()),_.isEmpty(a.fid)&&(a.fid=this._getDefaultFolder().id)),_.isEmpty(a.id)&&(a.id=b.UUID6().prefix("as-")),"as-"!==a.id.substr(0,3)&&(a.id="as-"+a.id),a=_.extend({},d[a.id],a),d[a.id]=a,a},unset:function(a,b){if(b||(b={folder:!1}),!0===b.folder){var c=this.values({folderId:a});return _.each(c,function(a){a.fid=this._defaultFolder.id},this),delete this._folders[a],this._folders}return delete this._assets[a],this._assets},folder:function(a){return this._folders[a]},get:function(a,b){return this._assets[a]},url:function(a){var c,d=this._assets[a];return d&&d.url&&(c=b.StringUtils.replaceTemplate(d.url),b._.forHTMLPublishing||(c=c.encodeFilePath())),c},allKeys:function(a){return a||(a={folder:!1}),!0===a.folder?Object.keys(this._folders):Object.keys(this._assets)},reorder:function(a,b){var c=[];b||(b={folder:!1});var d;d=!0===b.folder?this._folders:this._assets;var e=[];return _.each(a,function(a){var b=d[a];b&&(e[a]=b,c.push(b),delete d[a])},this),_.each(Object.keys(e),function(a){d[a]=e[a]},this),c},ref:function(a){var b=this._assets[a];return b&&b.ref++,b},unref:function(a){var b=this._assets[a];return b&&(b.ref=Math.min(0,b.ref--)),b},gc:function(){var a=[];return _.each(Object.keys(this._assets),function(b){var c=this._assets[b];c&&!c.ref&&a.push(c)},this),a},output:function(a){a||(a={stringify:!1});var b={folders:[],assets:[]};return b.folders=this.values({folder:!0}),b.assets=this.values(),a.stringify?JSON.stringify(b,null,4):b}});var o=[];a.load=l,a.findCollection=d,a.findCollectionByFileType=e,a.collections=c,a.folder=f,a.find=g,a.findByFilename=h,a.allAssets=i,a.unset=j,a._setAssets=k,b.Assets=a}),define("toast/core/Storage",["exports","../core","../utils/Async"],function(a,b,c){"use strict";function d(a){var c=a.attributes;return l[c.name]?c.priority>l[c.name].attributes.priority&&(delete l[c.name],delete b[c.name+"Storage"],b[c.name+"Storage"]=l[c.name]=a):b[c.name+"Storage"]=l[c.name]=a,l[c.name]}function e(a){return l[a]}function f(){var a=[];return _.each(Object.keys(l),function(b){a.push(l[b])}),a}function g(){var a=new $.Deferred;return c.doInParallel(Object.keys(l),function(a){var b=new $.Deferred,c=l[a],d=c.attributes.preload;return d||b.resolve(),c.load({done:function(){c._$ready.resolve(),d&&b.resolve()},fail:function(){c._$ready.reject(),d&&b.reject()}}),b.promise()}).always(function(){a.resolve()}),a.promise()}var h="bookmark",i="memo",j="draw",k="content",l={},m=Backbone.Model.extend({save:function(){},remove:function(){}});m.extend=Backbone.Model.extend;var n=Backbone.Collection.prototype,o=function(a,b){this._$ready=new $.Deferred,n.constructor.apply(this,arguments)};_.extend(o.prototype,n,{initialize:function(a,b){_.extend(this,b)},ready:function(a,b){a&&this._$ready.promise().done(a),b&&this._$ready.promise().fail(b),"resolved"===this._$ready.promise().state()?this._$ready.resolve():"rejected"===this._$ready.promise().state()&&this._$ready.reject()},load:function(a){},addItem:function(a,b){return a=n.add.call(this,a,b)},set:function(a,b){return b||(b={}),a=n.set.call(this,a,b),b.merge,a},updateItem:function(a){this.set(a,{merge:!0,remove:!1})},removeItem:function(a,b){return n.remove.call(this,a,b)},empty:function(){},stringify:function(){return JSON.stringify(this.toJSON())}}),o.extend=Backbone.Collection.extend,b.EventDispatcher.makeEventDispatcher(a),a.Model=m,a.Collection=o,a.register=d,a.get=e,a.getAll=f,a.loadAll=g,a.BOOKMARK=h,a.MEMO=i,a.DRAW=j,a.CONTENT=k,b.Storage=a}),define("toast/core/book/BookCommon",["require","exports","module"],function(a,b,c){"use strict";var d={has3d:null,vendor:"",PI:Math.PI,A90:Math.PI/2,isTouch:"ontouchstart"in window,events:"ontouchstart"in window?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},corners:{backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br"]},allowedCorners:null,displays:["single","double"],turnOptions:{page:1,cover:!0,gradients:!0,duration:600,acceleration:!0,display:"double",when:null},flipOptions:{folding:null,corners:"forward",cornerSize:100,gradients:!0,duration:600,acceleration:!0},pagesInDOM:6,pagePosition:{0:{top:0,left:0,right:"auto",bottom:"auto"},1:{top:0,right:0,left:"auto",bottom:"auto"}},divAtt:function(a,b,c,d){return{css:{position:"absolute",top:a,left:b,overflow:d||"hidden","z-index":c||"auto"}}},bezier:function(a,b,c,e,f){var g=1-f,h=g*g*g,i=f*f*f;return d.point2D(Math.round(h*a.x+3*f*g*g*b.x+3*f*f*g*c.x+i*e.x),Math.round(h*a.y+3*f*g*g*b.y+3*f*f*g*c.y+i*e.y))},rad:function(a){return a/180*d.PI},deg:function(a){return a/d.PI*180},point2D:function(a,b){return{x:a,y:b}},translate:function(a,b,c){return d.has3d&&c?" translate3d("+a+"px,"+b+"px, 0px) ":" translate("+a+"px, "+b+"px) "},rotate:function(a){return" rotate("+a+"deg) "},has:function(a,b){return Object.prototype.hasOwnProperty.call(b,a)},getPrefix:function(){var a=["Moz","Webkit","Khtml","O","ms"],b=a.length;for(d.vendor="";b--;)a[b]+"Transform"in document.body.style&&(d.vendor="-"+a[b].toLowerCase()+"-");return d.vendor},gradient:function(a,b,c,e,f){var g,h=[];if(a.addClass("gradient"),"-webkit-"==this.vendor){for(g=0;g<f;g++)h.push("color-stop("+e[g][0]+", "+e[g][1]+")");a.css({"background-image":"-webkit-gradient(linear, "+b.x+"% "+b.y+"%,  "+c.x+"% "+c.y+"%, "+h.join(",")+" )"})}else{b={x:b.x/100*a.width(),y:b.y/100*a.height()},c={x:c.x/100*a.width(),y:c.y/100*a.height()};var i=c.x-b.x,j=c.y-b.y,k=Math.atan2(j,i),l=k-Math.PI/2,m=Math.abs(a.width()*Math.sin(l))+Math.abs(a.height()*Math.cos(l)),n=Math.sqrt(j*j+i*i),o=d.point2D(c.x<b.x?a.width():0,c.y<b.y?a.height():0),p=Math.tan(k),q=-1/p,r=(q*o.x-o.y-p*b.x+b.y)/(q-p),s={x:r,y:q*r-q*o.x+o.y},t=Math.sqrt(Math.pow(s.x-b.x,2)+Math.pow(s.y-b.y,2));for(g=0;g<f;g++)h.push(" "+e[g][1]+" "+100*(t+n*e[g][0])/m+"%");a.css({"background-image":this.vendor+"linear-gradient("+-k+"rad,"+h.join(",")+")"})}},distanceBetween:function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)}};return $.isTouch=d.isTouch,d}),define("toast/core/book/BookZoom",["exports","../../core","./BookCommon","../../libs"],function(a,b,c){"use strict";function d(a){if(!ta){if(r())return void b.DialogBar.present({titleIcon:"glyphicon glyphicon-info-sign",autoDismiss:!1,title:b.Strings.ALERT_TITLE,content:"<b>"+b.Strings.ZOOM_FUNCTION_CAN_NOT_BE_USED_DURING_PAGE_LOADING+"</b>"});a||(a={}),b.$toggleZoom.addClass("active"),fa=!0,b.$el.addClass("bookzoom-activate"),"flip"===b.config.transition&&b.$book.turn("stop"),b.IS_ZOOM=ta=!0,b.IS_ZOOM_DRAG_MODE=Ba=!0,Ia={},sa=pa,j(),ua=Number(Math.max(ga/b.Book.$getBook().width(),ha/b.Book.$getBook().height()));var c=0;if(!0===a.pinch&&(ua=wa),b.send(b.Events.ZOOM_MODE_DID_CHANGE,ta),ya={x:0,y:0},a.setDefaultFitWidth||a.setDefaultFitHeight)za.top=0,R(a.setDefaultFitWidth?qa:ra),fa=!1;else if(a.zoomInOut)ua=Number((I().height/Ha.fit.height).toFixed(2)),ua=Math.min(va,Math.max(wa,ua)),za.left=-Ha.fit.width*ua/2,za.top=-Ha.fit.height*ua/2,h(),B(!0),fa=!1;else if(!0!==a.pinch){a.zoomScale?ua=Math.min(va,Math.max(wa,a.zoomScale)):b.isMobile&&!b.isTablet&&(ua=b.isLandscape()?Number((700/I().height).toFixed(2)):Number((700/I().width).toFixed(2)),ua=Math.min(va,Math.max(wa,ua)));var d={x:0,y:0};if(a.tapPoint){a.tapPoint.x=(a.tapPoint.x-W.$getBook().offset().left)*ua,a.tapPoint.y=(a.tapPoint.y-W.$getBook().offset().top)*ua;var e=X.width()*ua,g=X.height()*ua,i=e/2,k=g/2;d.x=i-a.tapPoint.x,d.y=k-a.tapPoint.y,ya=d,A(),d=ya}t(ua,d),c=b.isMobileDevice?100:150,b.lazy(function(){f(),B(),h({smooth:!0}),fa=!1},c)}else h(),fa=!1;W.$getBook().css("opacity",0),b.Book.enableAction(!1),b.send(b.Events.ZOOM_SCALE_DID_CHANGE,ua),b.on(b.Events.WILL_DISPLAY_PAGE,n),b.on(b.Events.WILL_MOVE_PAGE,o),b.on(b.Events.PAGE_DID_CHANGE,p),document.addEventListener("keydown",H)}}function e(){return ta}function f(){X.removeClass("animate");var a=parseFloat(X.css("marginLeft"))*ua,b=parseFloat(X.css("marginTop"))*ua;za.left=ya.x+a,za.top=ya.y+b,X.bookTransform(""),h()}function g(){Ga={width:Z.width(),height:Z.height()},Ha=b.Book.getBookSize(),wa=Math.min(Ga.width/Ha.fit.width,Ga.height/Ha.fit.height),b.isMobileDevice||(wa*=.5);var a,c;a=Ha.page.width*(xa._default/100),c=Ha.page.height*(xa._default/100),a+=a%2,a+=a/2%2*2,c+=c%2,b.Book.isDoublePage()&&!b.Book.isCoverPage()&&(a*=2),ga=a,ha=c;var d=xa._defaultMax||xa.max;_.isEmpty(Ia.url)||(d=300);var e,f;e=Ha.page.width*(d/100),f=Ha.page.height*(d/100),e+=e%2,e+=e/2%2*2,f+=f%2,Ha.page.background&&Ha.page.background.width>=e&&(xa._defaultMax||(xa._defaultMax=xa.max),d=xa.max=Ha.page.background.width/Ha.page.width*100,e=Ha.page.background.width,f=Ha.page.background.height),b.Book.isDoublePage()&&!b.Book.isCoverPage()&&(e*=2),ia=e,ja=f,va=Number(Math.max(e/b.Book.$getBook().width(),f/b.Book.$getBook().height())),ua=Number(Math.max(ga/b.Book.$getBook().width(),ha/b.Book.$getBook().height()));var g=parseInt(Math.ceil(wa/va*xa.max));g-=g%10,xa.min=g}function h(a){a=_.extend({smooth:!1,fitPage:!0},a),_.isUndefined(a.zoomScale)||(ua=a.zoomScale),a.offset&&(za=a.offset),a.smooth?X.addClass("animate"):X.removeClass("animate");var c=6,d=parseInt(Ha.fit.width*ua),e=parseInt(Ha.fit.height*ua);d+=d%2,d+=d/2%2*2,e+=e%2,e+=e/2%2*2,b._.disabledAutoZoomScaleSize||(Math.abs(ga-d)<=c&&Math.abs(ha-e)<=c?(d=ga,e=ha):Math.abs(ia-d)<=c&&Math.abs(ja-e)<=c?(d=ia,e=ja):(d>=ia||e>=ja)&&(d=ia,e=ja)),X.css({width:d,height:e,marginLeft:za.left,marginTop:za.top}),a.fitPage&&_.each(ca,function(a){W.fitPage(a)}),b.send(b.Events.ZOOM_VIEW_POSITION_AND_SIZE_DID_CHANGE)}function i(a){a||(a={}),sa==qa||sa==ra?R(sa):(a.center&&(za.left=-Ha.fit.width*ua/2),h(),B(!0)),b.send(b.Events.ZOOM_SCALE_DID_CHANGE,ua)}function j(){X=$("<div />",{class:"bookzoom grab"}),Z.append(X),b.Book.restoreLayoutFromZoomActiveState(!0),Ha=b.Book.getBookSize(),W.$getBook().css("opacity",0),la=W.isCoverPage(),ma=W.isDoublePage(),g(),k(),za.left=-Ha.fit.width/2,za.top=-Ha.fit.height/2,X.css({left:"50%",top:"50%",width:Ha.fit.width+"px",height:Ha.fit.height+"px",marginLeft:za.left+"px",marginTop:za.top+"px"}),X.tt_deselect()}function k(a){a||(a={});var c,d,e;!W.isCoverPage()&&W.$getBook().hasClass("doublepage")?(X.hasClass("doublepage")||(c=!0),X.addClass("doublepage")):(X.hasClass("doublepage")&&(c=!0),X.removeClass("doublepage"));var f=b.Book.getBookSize();W.isDoublePage()||W._isFlipTransition||c||Ha.fit.width===f.fit.width&&Ha.fit.height===f.fit.height||(c=!0,d=!0),ca=b.Book.getCurrentPageNumber(),_.each(ca,function(a){var c=b.Book.views[a-1],d=c.collection.attributes;c.willReMountAll(),c.cache&&(e=c.cache._zoomInfo),Ia=d._doc});var j=W.getCurrentPage();if(_.each(j.reverse(),function(a){var b=$("<section />");b.attr("data-page",a.attr("page")),"SECTION"!==a[0].tagName&&(a=a.find("section")),b.append(a.children()),X.prepend(b),Ca.push(b)}),_.each(ca,function(a){b.Book.views[a-1].remountAll()}),a.update){if(c){var k=ua;if(g(),d)if(e){k=e.zoomScale;var l=e.offset;ua=Math.min(Math.max(k,wa),va),S(ua),za=l,B(),h()}else i({center:!0});else ua=Math.min(Math.max(k,wa),va),S(ua)}else h();if(F()){var m={width:X.width(),height:X.height()},n=I();m.height>n.height&&(za.top=-n.height/2,h())}}da=ca}function l(){m(),W.$getBook().css("opacity",1),b.Book.restoreLayoutFromZoomActiveState(!1),X.remove()}function m(){_.each(ca,function(a){var c=b.Book.views[a-1];c.willReMountAll(),W.isDoublePage()||W._isFlipTransition?c.cache&&c.cache._zoomInfo&&delete c.cache._zoomInfo:(c.cache||(c.cache={}),c.cache._zoomInfo={zoomScale:ua,offset:_.clone(za)})});var a=W.$getBook().children().first().hasClass("container")?W.$getBook().children().first():W.$getBook();_.each(Ca,function(b){var c=Number(b.attr("data-page")),d=a.children('[page="'+c+'"]');d.length&&("SECTION"===d[0].tagName?d.prepend(b.children()):d.find("section").prepend(b.children()))}),_.each(ca,function(a){b.Book.views[a-1].remountAll()}),_.each(ca,function(a){W.fitPage(a)}),X.children().not(".__lock__").remove(),Ca=[]}function n(){m()}function o(){m(),b.showLoading(!0)}function p(a){b.Async.doInParallel(a,function(a){var c=new $.Deferred,d=b.Book.views[a-1];return _.isUndefined(d)?c.reject():d.ready(function(){c.resolve()}),c.promise()}).done(function(){k({update:!0}),la===W.isCoverPage()&&ma===W.isDoublePage()||R(Q()),ma=W.isDoublePage(),la=W.isCoverPage(),b.showLoading(!1)}).fail(function(){b.showLoading(!1)})}function q(a){ta&&(b.isMobileDevice||!1!==b.config.bookZoom.toggleZoom)&&(a||(a={animate:!0}),fa=!0,TT.$toggleZoom.removeClass("active"),L(),$(".toast").removeClass("bookzoom-activate"),Z.tt_deselect(),b.IS_ZOOM=ta=!1,b.IS_ZOOM_DRAG_MODE=Ba=!1,b.off(b.Events.WILL_DISPLAY_PAGE,n),b.off(b.Events.WILL_MOVE_PAGE,o),b.off(b.Events.PAGE_DID_CHANGE,p),l(),K(),b.Book.enableAction(!0),b.send(b.Events.ZOOM_MODE_DID_CHANGE,ta),document.removeEventListener("keydown",H),a.callback&&"function"==typeof a.callback&&a.callback(),b.lazy(function(){fa=!1},50),_.each(ca,function(a){b.Book.views[a-1].remountAll()}))}function r(){var a=!0,c=b.Book.getCurrentPageNumber();return _.each(c,function(c){if(TT.Book.views[c-1].state()!==b.STATUS_LOADED)return a=!1,!1}),!0!==a}function s(a,c){if(c||(c={}),!b.isMobileDevice&&!1===b.config.bookZoom.toggleZoom)return!1;if(b.IS_ZOOM_LOCKED)return!1;if(b.Book._zoomDisabled())return!1;if("INPUT"===a.target.tagName)return!1;var d=$(a.target);if(d.closest(".modal").length)return!1;if(d.hasClass("cl"))return!1;var e;if(b.isMobileDevice?e=d.closest(".book-container"):(e=d.closest(".toast-ctrl"),e.length||(e=d.closest("section")),e.length||(e=d.closest(".book")),e.length||(e=d.closest(".bookzoom"))),!e.length)return!1;if(c.doubletap){if(d.closest("[command]").length)return!1;if(e=d.closest(".toast-object"),0!==e.length){var f=e.data("view");if(f&&(f.actions&&f.actions.click||f.animations&&f.animations.click))return!1}}return!0}function t(a,b){X.addClass("animate"),b||(b={x:0,y:0});var c=["translate("+b.x+"px, "+b.y+"px)","scale("+a+")"];c=c.join(" "),X[0].style.webkitTransform=c,X[0].style.mozTransform=c,X[0].style.msTransform=c,X[0].style.transform=c}function u(a){if(ta&&Ba&&ta&&!Da){var c=$(a.target);c.closest(".book-container").length&&(b.IS_SLIDING||b.IS_SCROLLING||b.IS_PAINTER_ACTIVATED||(c=c.closest(".scroll-interaction-el"),ka=c.length?c.data("scroll-interaction"):null,$(document).tt_deselect(),Aa={x:parseFloat(X.css("marginLeft")),y:parseFloat(X.css("marginTop"))},X.removeClass("grab").addClass("grabbing"),ba=!0,b.IS_PANNING=!0))}}function v(a){if(ta&&Ba&&ta&&!Da&&ba&&!(b.IS_SLIDING||b.IS_SCROLLING||b.IS_PAINTER_ACTIVATED)){if(ka&&!G())switch(a.direction){case na:if(!ka.isScrollBottom())return;break;case oa:if(!ka.isScrollTop())return}za={left:Aa.x+a.deltaX,top:Aa.y+a.deltaY},sa==qa&&(za.left=Aa.x),h()}}function w(a){ta&&(b.lazy(function(){b.IS_PANNING=!1},50),Ba&&ta&&!Da&&ba&&(ba=!1,B(),h({smooth:!0}),X.removeClass("grabbing").addClass("grab")))}function x(a){if(!b.config.disableZoomGesture){if(r())return void b.DialogBar.present({titleIcon:"glyphicon glyphicon-info-sign",autoDismiss:!1,title:b.Strings.ALERT_TITLE,content:"<b>"+b.Strings.ZOOM_FUNCTION_CAN_NOT_BE_USED_DURING_PAGE_LOADING+"</b>"});if("pinchstart"==a.type){if(!s(a))return;b.IS_PINCHING=Da=!0,ta||d({tapPoint:a.center,pinch:!0}),ea=ua,Fa={x:za.left,y:za.top},Ea={x:a.center.x-(Z.offset().left+Z.width()/2),y:a.center.y-(Z.offset().top+Z.height()/2)}}else if("pinchmove"==a.type){if(!Da)return;var c=ea*a.scale;if(c>=wa&&c<=va){ua=c;var e=Ea.x*(c/ea),f=Ea.y*(c/ea),g=a.center.x-$(window).width()/2,i=a.center.y-$(window).height()/2,j=Fa.x*(c/ea),k=Fa.y*(c/ea),l=j-e+g,m=k-f+i;za.left=l,za.top=m,h(),b.send(b.Events.ZOOM_SCALE_DID_CHANGE,ua)}}else"pinchend"!=a.type&&"pinchcancel"!=a.type||(B()&&h({smooth:!0}),b.IS_PINCHING=Da=!1)}}function y(a){a||(a={});var b=parseInt(Math.ceil(ua/va*xa.max));b-=b%10,b=Math.min(xa.max,Math.max(xa.min,b)),a.zoomIn?b+=Ja:b-=Ja,xa.val=Math.min(xa.max,Math.max(xa.min,b))}function z(a,b){var c=parseInt(X.css("marginLeft")),d=parseInt(X.css("marginTop"));switch(_.isUndefined(b)&&(b=100),a){case"up":d+=b;break;case"right":c-=b;break;case"down":d-=b;break;case"left":c+=b}za={left:c,top:d},B(),h({smooth:!0})}function A(){var a={width:X.width()*ua,height:X.height()*ua},b=a.width/2>I().width/2?a.width/2-I().width/2:0;ya.x>b?ya.x=b:ya.x<0&&Math.abs(ya.x)>b&&(ya.x=-b);var c=a.height/2>I().height/2?a.height/2-I().height/2:0;c<ya.y?ya.y=c:Math.abs(ya.y)>c&&(ya.y=-c)}function B(a){var b,c,d=!1,e={width:X.width(),height:X.height()},f=I();return e.width>f.width?(b=f.width/2,d=!0):(b=e.width/2,d=!0),e.height>f.height?(c=f.height/2,d=!0):(c=e.height/2,d=!0),Math.abs(za.left)<b?(za.left=-b,d=!0):e.width+za.left<b&&(e.width<f.width?za.left=-b:za.left=f.width/2-e.width,d=!0),Math.abs(za.top)<c||f.height>e.height?(za.top=-c,d=!0):(Math.abs(e.height+za.top)<c||e.height<Math.abs(za.top))&&(e.height<f.height?za.top=-c:za.top=f.height/2-e.height,d=!0),a&&d&&X.css({marginLeft:za.left+"px",marginTop:za.top+"px"}),d}function C(a){if(!arguments.length)return za;za=a}function D(){var a,b={width:X.width(),height:X.height()},c=I();return a=b.height>c.height?c.height/2:b.height/2,Math.abs(za.top)<a}function E(){var a,b={width:X.width(),height:X.height()},c=I();return a=b.height>c.height?c.height/2:b.height/2,Math.abs(b.height+za.top)<a||b.height<Math.abs(za.top)}function F(){var a={width:X.width(),height:X.height()},c=I();if(a.height>c.height){var d=b.isMobileDevice?20:50;if(Math.abs(Math.abs(a.height+za.top)-c.height/2)<=d)return!0}return!1}function G(){return D()||E()}function H(a){a.keyCode===b.KeyEvent.DOM_VK_ESCAPE?q():a.keyCode===b.KeyEvent.DOM_VK_UP?z("up"):a.keyCode===b.KeyEvent.DOM_VK_RIGHT?z("right"):a.keyCode===b.KeyEvent.DOM_VK_DOWN?z("down"):a.keyCode===b.KeyEvent.DOM_VK_LEFT?z("left"):a.keyCode===b.KeyEvent.DOM_VK_ADD?b.BookZoom.setZoomScale(ua+.2):a.keyCode===b.KeyEvent.DOM_VK_SUBTRACT&&b.BookZoom.setZoomScale(ua-.2)}function I(){return{width:window.innerWidth-(window.innerWidth-Y.parent().width()),height:window.innerHeight-(window.innerHeight-Y.parent().height())}}function J(a){a.preventDefault(),b.config.disableDoubleTapZoomGesture||b.config.disableZoomGesture||s(a,{doubletap:!0})&&!0!==fa&&($(a.target).hasClass("gradient")||(ta?q():d({tapPoint:a.center})))}function K(){L(),aa.on("doubletap",J),aa.on("pinchstart pinchmove pinchend pinchcancel",x),aa.on("panstart",u),aa.on("panmove",v),aa.on("panend",w)}function L(){aa.off("doubletap",J),aa.off("pinchstart pinchmove pinchend pinchcancel",x),aa.off("panstart",u),aa.off("panmove",v),aa.off("panend",w)}function M(){b.config.bookZoom||(b.config.bookZoom={}),_.isUndefined(b.config.bookZoom.zoomInOutStepPercent)?b.config.bookZoom.zoomInOutStepPercent=Ja=10:Ja=b.config.bookZoom.zoomInOutStepPercent,W=b.Book,Y=W.$getBook(),Z=Y.parent(),aa=new TT.Hammer.Manager(document.body,{inputClass:b.isMobileDevice?TT.Hammer.TouchInput:TT.Hammer.MouseInput,cssProps:{userSelect:"inherit"}}),aa.add(new TT.Hammer.Pan({threshold:0,pointers:0})),aa.add(new TT.Hammer.Tap({event:"doubletap",taps:2,threshold:15,posThreshold:50})).recognizeWith([aa.get("pan")]),aa.add(new TT.Hammer.Pinch({threshold:0})).recognizeWith([aa.get("pan")]),K(),ta=!1,Ba=!0}function N(a){Ba=a,1==Ba?(X.tt_deselect(),X.find(".toast-ctrl").css(c.vendor+"user-select","none"),aa.on("pinchstart pinchmove pinchend pinchcancel",x),aa.on("panstart",u),aa.on("panmove",v),aa.on("panend",w)):(X.find(".toast-ctrl").css(c.vendor+"user-select","text"),aa.off("pinchstart pinchmove pinchend pinchcancel",x),aa.off("panstart",u),aa.off("panmove",v),aa.off("panend",w)),b.IS_ZOOM_DRAG_MODE=Ba,b.IS_ZOOM_DRAG_MODE?X.removeClass("grabbing").addClass("grab"):X.removeClass("grab grabbing")}function O(){return{min:wa,zoom:ua,max:va}}function P(a){a||(a={}),xa=_.extend({_default:150,max:200},a)}function Q(){return sa}function R(a){sa=a;sa==qa?ua=Number((I().width/Ha.fit.width).toFixed(2)):sa==ra&&(ua=Number((I().height/Ha.fit.height).toFixed(2))),ua=Math.min(va,Math.max(wa,ua)),sa==qa?za.left=-Ha.fit.width*ua/2:sa==ra&&(za.left=-Ha.fit.width*ua/2,za.top=-Ha.fit.height*ua/2),h(),B(!0),b.send(b.Events.ZOOM_SCALE_DID_CHANGE,ua)}function S(a){a=Number(a),a=Math.min(Math.max(a,wa),va);var c=Ha.fit.width*ua,d=Ha.fit.height*ua,e=Ha.fit.width*a,f=Ha.fit.height*a;ua=a,h({fitPage:!1}),za.left-=(e-c)/2,za.top-=(f-d)/2,B(),X.css({marginLeft:za.left,marginTop:za.top}),b.send(b.Events.ZOOM_VIEW_POSITION_AND_SIZE_DID_CHANGE),_.each(ca,function(a){W.fitPage(a)}),b.send(b.Events.ZOOM_SCALE_DID_CHANGE,ua)}function T(){(b.isMobileDevice||!1!==b.config.bookZoom.toggleZoom)&&!0!==fa&&(ta?q():d())}function U(){ta||d({zoomInOut:!0}),y({zoomIn:!0});var a=va*(xa.val/xa.max);a=Math.max(wa,Number(parseFloat(a).toFixed(2))),xa.val===xa.max?a=va:xa.val===xa.min&&(a=wa),ua!==a&&b.BookZoom.setZoomScale(a)}function V(){ta||d({zoomInOut:!0}),y({zoomIn:!1});var a=va*(xa.val/xa.max);a=Math.max(wa,Number(parseFloat(a).toFixed(2))),ua!==a&&b.BookZoom.setZoomScale(a)}var W,X,Y,Z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na=8,oa=16,pa=0,qa=1,ra=2,sa=pa,ta=!1,ua=1.5,va=2,wa=.5,xa={_default:150,max:200},ya={x:0,y:0},za={left:0,top:0},Aa={left:0,top:0},Ba=!0,Ca=[],Da=!1,Ea={},Fa={},Ga={},Ha={},Ia={},Ja=10;b.ready(function(){b.CommandManager.registerInternal(b.Commands.TOGGLE_ZOOM,T),b.CommandManager.registerInternal(b.Commands.ZOOM_IN,U),b.CommandManager.registerInternal(b.Commands.ZOOM_OUT,V)}),a._initialize=M,a.activate=d,a.deactivate=q,a.isActivated=e,a._setPage=k,a._unsetPage=m,a.getCurrentScales=O,a.setZoomPercents=P,a.setDragMode=N,a.setScaleMode=R,a.getScaleMode=Q,a.setZoomScale=S,a.moveTo=z,a.toggleZoom=T,a.zoomIn=U,a.zoomOut=V,a._limitOffset=B,a._bookZoomOffset=C,a._isPageStart=D,a._isPageEnd=E,a._isPageStartOrEnd=G,a._update=h,a.updateLayout=i,a._on=K,a._off=L,a.SCALE_MODE_NONE=pa,a.SCALE_MODE_HORIZONTAL=qa,a.SCALE_MODE_VERTICAL=ra,b.BookZoom=a}),define("toast/core/book/BookTransition",["../../core"],function(a){"use strict";var b=function(a,b){this.book=a,b||(b={}),this.configure.call(this,b),this.initialize.apply(this,arguments)};return _.extend(b.prototype,Backbone.Events,{initialize:function(a,b){},configure:function(b){b||(b={}),this.config=$.extend(!0,this.config,b),a.$bookContainer.removeClass(this.config.transition),a.$bookContainer.addClass(this.config.transition)},updateVisibility:function(){return!1},numberOfPageCache:function(){return 2},navigationInteraction:function(){return!1},canNavigationInteraction:function(){return!0},set:function(a){},layout:function(){},restoreLayoutFromZoomActiveState:function(){return!1},previous:function(a){},next:function(a){},move:function(a){},unset:function(a){}}),b.extend=a.extend,b}),define("toast/core/book/BookFlipPage",["./BookCommon"],function(a){"use strict";var b={init:function(a){return a.gradients&&(a.frontGradient=!0,a.backGradient=!0),this.data({f:{disabled:!1}}),this.flip("options",a),b._addPageWrapper.call(this),this},setData:function(a){var b=this.data();return b.f=$.extend(b.f,a),this},getData:function(){return this.data()},options:function(c){var d=this.data().f;return c?(b.setData.call(this,{opts:$.extend({},d.opts||a.flipOptions,c)}),this):d.opts},z:function(a){var b=this.data().f;return b.opts["z-index"]=a,b.fwrapper.css({"z-index":a||parseInt(b.parent.css("z-index"),10)||0}),this},_cAllowed:function(){return a.corners[this.data().f.opts.corners]||this.data().f.opts.corners},_cornerActivated:function(c,d){if(void 0===c.originalEvent&&!d)return!1;if(c=a.isTouch?c.originalEvent.touches:[c],!c.length)return!1;var e=this.data().f,f=e.parent.offset(),g=this.width(),h=this.height(),i=e.opts.cornerSize,j={x:Math.max(0,c[0].pageX-f.left),y:Math.max(0,c[0].pageY-f.top)};if(j.x<=0||j.y<=0||j.x>=g||j.y>=h)return!1;if(j.y<i)j.corner="t";else{if(!(j.y>=h-i))return!1;j.corner="b"}if(j.x<=i)j.corner+="l";else{if(!(j.x>=g-i))return!1;if(Toast.__nextPageMoveLocked__)return!1;j.corner+="r"}var k=b._cAllowed.call(this);return-1!=$.inArray(j.corner,k)&&j},_c:function(b,c){return c=c||0,{tl:a.point2D(c,c),tr:a.point2D(this.width()-c,c),bl:a.point2D(c,this.height()-c),br:a.point2D(this.width()-c,this.height()-c)}[b]},_c2:function(b){return{tl:a.point2D(2*this.width(),0),tr:a.point2D(-this.width(),0),bl:a.point2D(2*this.width(),this.height()),br:a.point2D(-this.width(),this.height())}[b]},_foldingPage:function(a){var b=this.data().f.opts;if(b.folding)return b.folding;if(b.turn){var c=b.turn.data();return"single"==c.display?1!==c.totalPages&&c.pageObjs[b.next]?c.pageObjs[0]:null:c.pageObjs[b.next]}},_backGradient:function(){var b=this.data().f,c=b.opts.turn,d=b.opts.backGradient&&(!c||"single"==c.data().display||2!=b.opts.page&&b.opts.page!=c.data().totalPages-1);return d&&!b.bshadow&&(b.bshadow=$("<div/>",a.divAtt(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(b.parent)),d},resize:function(a){var c=this.data().f,d=c.opts.turn,e=this.width(),f=this.height(),g=Math.round(Math.sqrt(Math.pow(e,2)+Math.pow(f,2)));a&&(c.wrapper.css({width:g,height:g}),c.fwrapper.css({width:g,height:g}).children(":first-child").css({width:e,height:f}),c.fpage.css({width:f,height:e}),c.opts.frontGradient&&(TT.isMobileDevice&&"single"==d.data().display?c.ashadow.hide():c.ashadow.css({width:f,height:e})),b._backGradient.call(this)&&c.bshadow.css({width:e,height:f})),c.parent.is(":visible")&&(c.fwrapper.css({top:c.parent.offset().top,left:c.parent.offset().left}),c.opts.turn&&c.fparent.css({top:-c.opts.turn.offset().top,left:-c.opts.turn.offset().left})),this.flip("z",c.opts["z-index"])},_addPageWrapper:function(){var c=this.data().f,d=this.parent();if(!c.wrapper){var e=(this.css("left"),this.css("top"),this.width()),f=this.height();Math.round(Math.sqrt(Math.pow(e,2)+Math.pow(f,2)));if(c.parent=d,c.fparent=c.opts.turn?c.opts.turn.data().fparent:$("#turn-fwrappers"),!c.fparent){var g=$("<div/>",{css:{"pointer-events":"none"}}).hide();g.data().flips=0,c.opts.turn?(g.css(a.divAtt(-c.opts.turn.offset().top,-c.opts.turn.offset().left,"auto","visible").css).appendTo(c.opts.turn),c.opts.turn.data().fparent=g):g.css(a.divAtt(0,0,"auto","visible").css).attr("id","turn-fwrappers").appendTo($("body")),c.fparent=g}this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"}),c.wrapper=$("<div/>",a.divAtt(0,0,this.css("z-index"))).appendTo(d).prepend(this),c.fwrapper=$("<div/>",a.divAtt(d.offset().top,d.offset().left)).hide().appendTo(c.fparent),c.fpage=$("<div/>",{css:{cursor:"default"}}).appendTo($("<div/>",a.divAtt(0,0,0,"visible")).appendTo(c.fwrapper)),c.opts.frontGradient&&(c.ashadow=$("<div/>",a.divAtt(0,0,1)).appendTo(c.fpage)),b.setData.call(this,c),b.resize.call(this,!0)}},_fold:function(c){var d,e,f,g,h,i,j=this,k=0,l=0,m=a.point2D(0,0),n=a.point2D(0,0),o=a.point2D(0,0),p=this.width(),q=this.height(),r=b._foldingPage.call(this),s=(Math.tan(l),this.data().f),t=s.opts.acceleration,u=s.wrapper.height(),v=b._c.call(this,c.corner),w="t"==c.corner.substr(0,1),x="l"==c.corner.substr(1,1),y=function(){var r,t=a.point2D(v.x?v.x-c.x:c.x,v.y?v.y-c.y:c.y),z=Math.atan2(t.y,t.x);l=a.A90-z,k=a.deg(l),r=a.point2D(x?p-t.x/2:c.x+t.x/2,t.y/2);var A=l-Math.atan2(r.y,r.x),B=Math.max(0,Math.sin(A)*Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2)));if(o=a.point2D(B*Math.sin(l),B*Math.cos(l)),l>a.A90&&(o.x=o.x+Math.abs(o.y*Math.tan(z)),o.y=0,Math.round(o.x*Math.tan(a.PI-l))<q))return c.y=Math.sqrt(Math.pow(q,2)+2*r.x*t.x),w&&(c.y=q-c.y),y();if(l>a.A90){var C=a.PI-l,D=u-q/Math.sin(C);m=a.point2D(Math.round(D*Math.cos(C)),Math.round(D*Math.sin(C))),x&&(m.x=-m.x),w&&(m.y=-m.y)}d=Math.round(o.y/Math.tan(l)+o.x);var E=p-d,F=E*Math.cos(2*l),G=E*Math.sin(2*l);n=a.point2D(Math.round(x?E-F:d+F),Math.round(w?G:q-G)),h=E*Math.sin(l);var H=b._c2.call(j,c.corner),I=Math.sqrt(Math.pow(H.x-c.x,2)+Math.pow(H.y-c.y,2));return i=I<p?I/p:1,s.opts.frontGradient&&(g=h>100?(h-100)/h:0,e=a.point2D(h*Math.sin(a.A90-l)/q*100,h*Math.cos(a.A90-l)/p*100),w&&(e.y=100-e.y),x&&(e.x=100-e.x)),b._backGradient.call(j)&&(f=a.point2D(h*Math.sin(l)/p*100,h*Math.cos(l)/q*100),x||(f.x=100-f.x),w||(f.y=100-f.y)),o.x=Math.round(o.x),o.y=Math.round(o.y),!0},z=function(c,d,h,k){var o=["0","auto"],r=(p-u)*h[0]/100,v=(q-u)*h[1]/100,y={left:o[d[0]],top:o[d[1]],right:o[d[2]],bottom:o[d[3]]},z=90!=k&&-90!=k?x?-1:1:0;h=h[0]+"% "+h[1]+"%",j.css(y).bookTransform(a.rotate(k)+a.translate(c.x+z,c.y,t),h),s.fpage.parent().css(y),s.wrapper.bookTransform(a.translate(-c.x+r-z,-c.y+v,t)+a.rotate(-k),h),s.fwrapper.bookTransform(a.translate(-c.x+m.x+r,-c.y+m.y+v,t)+a.rotate(-k),h),s.fpage.parent().bookTransform(a.rotate(k)+a.translate(c.x+n.x-m.x,c.y+n.y-m.y,t),h),s.opts.frontGradient&&a.gradient(s.ashadow,a.point2D(x?100:0,w?100:0),a.point2D(e.x,e.y),[[g,"rgba(0,0,0,0)"],[.8*(1-g)+g,"rgba(0,0,0,"+.2*i+")"],[1,"rgba(255,255,255,"+.2*i+")"]],3,l),b._backGradient.call(j)&&a.gradient(s.bshadow,a.point2D(x?0:100,w?0:100),a.point2D(f.x,f.y),[[.8,"rgba(0,0,0,0)"],[1,"rgba(0,0,0,"+.3*i+")"],[1,"rgba(0,0,0,0)"]],3)};switch(c.corner){case"tl":c.x=Math.max(c.x,1),y(),z(o,[1,0,0,1],[100,0],k),s.fpage.bookTransform(a.translate(-q,-p,t)+a.rotate(90-2*k),"100% 100%"),r.bookTransform(a.rotate(90)+a.translate(0,-q,t),"0% 0%");break;case"tr":c.x=Math.min(c.x,p-1),y(),z(a.point2D(-o.x,o.y),[0,0,0,1],[0,0],-k),s.fpage.bookTransform(a.translate(0,-p,t)+a.rotate(2*k-90),"0% 100%"),r.bookTransform(a.rotate(270)+a.translate(-p,0,t),"0% 0%");break;case"bl":c.x=Math.max(c.x,1),y(),z(a.point2D(o.x,-o.y),[1,1,0,0],[100,100],-k),s.fpage.bookTransform(a.translate(-q,0,t)+a.rotate(2*k-90),"100% 0%"),r.bookTransform(a.rotate(270)+a.translate(-p,0,t),"0% 0%");break;case"br":c.x=Math.min(c.x,p-1),y(),z(a.point2D(-o.x,-o.y),[0,1,1,0],[0,100],k),s.fpage.bookTransform(a.rotate(90-2*k),"0% 0%"),r.bookTransform(a.rotate(90)+a.translate(0,-q,t),"0% 0%")}s.point=c},_moveFoldingPage:function(a){var c=this.data().f,d=b._foldingPage.call(this);d&&(a?c.fpage.children()[c.ashadow?"1":"0"]||(b.setData.call(this,{backParent:d.parent()}),c.fpage.prepend(d)):c.backParent&&c.backParent.prepend(d))},_showFoldedPage:function(a,c){var d=b._foldingPage.call(this),e=this.data(),f=e.f;f.opts.turn;if((!f.point||f.point.corner!=a.corner)&&f.opts.next){var g=$.Event("start");if(this.trigger(g,[f.opts,a.corner,c]),this.__out=!1,g.isDefaultPrevented())return!1}if(d){if(c){var h=this,i=f.point&&f.point.corner==a.corner?f.point:b._c.call(this,a.corner,1);this.animatef({from:[i.x,i.y],to:[a.x,a.y],duration:500,frame:function(c){a.x=Math.round(c[0]),a.y=Math.round(c[1]),b._fold.call(h,a)}})}else b._fold.call(this,a),e.effect&&!e.effect.turning&&this.animatef(!1);return f.fwrapper.is(":visible")||(f.fparent.show().data().flips++,b._moveFoldingPage.call(this,!0),f.fwrapper.show(),f.bshadow&&f.bshadow.show()),!0}return!1},hide:function(){var a=this.data().f,c=(a.opts.turn,b._foldingPage.call(this));return 0==--a.fparent.data().flips&&a.fparent.hide(),this.css({left:0,top:0,right:"auto",bottom:"auto"}).bookTransform("","0% 100%"),a.wrapper.bookTransform("","0% 100%"),a.fwrapper.hide(),a.bshadow&&a.bshadow.hide(),c.bookTransform("","0% 0%"),this},hideFoldedPage:function(c){var d=this.data().f;if(d.point){var e=this,f=d.point,g=function(){d.point=null,e.flip("hide"),e.trigger("end",[!1])};if(c){var h=b._c.call(this,f.corner),i="t"==f.corner.substr(0,1),j=i?Math.min(0,f.y-h.y)/2:Math.max(0,f.y-h.y)/2,k=a.point2D(f.x,f.y+j),l=a.point2D(h.x,h.y-j);this.animatef({from:0,to:1,frame:function(c){var d=a.bezier(f,k,l,h,c);f.x=d.x,f.y=d.y,b._fold.call(e,f)},complete:g,duration:800,hiding:!0})}else this.animatef(!1),g()}},turnPage:function(c){var d=this,e=this.data().f;c={corner:e.corner?e.corner.corner:c||b._cAllowed.call(this)[0]};var f=e.point||b._c.call(this,c.corner,e.opts.turn?e.opts.turn.data().opts.elevation:0),g=b._c2.call(this,c.corner);Toast.IS_ZOOM?this.trigger("flip").trigger("end",[!0]):this.trigger("flip").animatef({from:0,to:1,frame:function(e){var h=a.bezier(f,f,g,g,e);c.x=h.x,c.y=h.y,b._showFoldedPage.call(d,c)},complete:function(){d.trigger("end",[!0])},duration:e.opts.duration,turning:!0}),e.corner=null},moving:function(){return"effect"in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},_eventStart:function(a){var c=this.data().f,d=c.opts.turn;if(b._cornerActivated.call(this,a)&&(c.pressed=!0),!c.corner&&!c.disabled&&!this.flip("isTurning")&&c.opts.page==d.data().pagePlace[c.opts.page]){if(c.corner=b._cornerActivated.call(this,a),c._startCorner={x:c.corner.x,y:c.corner.y},Toast.IS_TURNING=!1,c.corner&&b._foldingPage.call(this,c.corner))return b._moveFoldingPage.call(this,!0),this.trigger("pressed",[c.point]),!1;c.corner=null}},_eventMove:function(c){var d=this.data().f,e=d.opts.turn;if(!d.disabled){if(c=a.isTouch?c.originalEvent.touches:[c],d.corner){var f=d.parent.offset();d.corner.x=c[0].pageX-f.left,d.corner.y=c[0].pageY-f.top;var g=Math.max(Math.abs(d._startCorner.x-d.corner.x),Math.abs(d._startCorner.y-d.corner.y));return!d.flipping&&g>5&&(Toast.IS_TURNING=!0,d.flipping=!0),b._showFoldedPage.call(this,d.corner),!1}if(!this.data().effect&&this.is(":visible")){var h=b._cornerActivated.call(this,c[0]);if(h){var i=b._c.call(this,h.corner,d.opts.cornerSize);h.x=i.x,h.y=i.y;var j=d.parent.offset();return e.data()._rolloverCorner={x:c[0].pageX-j.left,y:c[0].pageY-j.top},Toast.IS_TURNING=!0,b._showFoldedPage.call(this,h,!0),!1}b.hideFoldedPage.call(this,!0)}else if(!d.corner){var h=b._cornerActivated.call(this,c[0]);if(h||this.__out)return!this.data().effect;var k=$.Event("out");this.trigger(k,[d.opts]),this.__out=!0,b.hideFoldedPage.call(this,!0)}}},_eventEnd:function(c){var d=this.data().f,e=d.opts.turn;if(!d.disabled&&d.point){var f=$.Event("released"),g=b._cornerActivated.call(this,c,!0);if(this.trigger(f,[d.point,!!g]),!f.isDefaultPrevented()){if(Toast.isMobile){var f=$.Event("out");this.trigger(f,[d.opts])}b.hideFoldedPage.call(this,!0)}}else if(d.pressed){var h=b._cornerActivated.call(this,c,!0),i=0,j=e.data()._rolloverCorner;if(j){var k=a.isTouch?c.originalEvent.touches:[c],l=d.parent.offset(),m={x:k[0].pageX-l.left,y:k[0].pageY-l.top};i=Math.max(Math.abs(j.x-m.x),Math.abs(j.y-m.y))}if(h&&i<d.opts.cornerSize){b._showFoldedPage.call(this,h,!1);var f=$.Event("released");this.trigger(f,[h,!0]),f.isDefaultPrevented()||b.hideFoldedPage.call(this,!1)}}d.corner=null,d.pressed=null,d._startCorner=null,d.flipping=!1,Toast.IS_TURNING=!1},disable:function(a){return b.setData.call(this,{disabled:a}),this}};return b}),define("toast/core/book/BookFlipManager",["./BookCommon","./BookFlipPage"],function(a,b){"use strict";var c={init:function(c){void 0!==a.has3d&&null!==a.has3d||(a.has3d="WebKitCSSMatrix"in window||"MSCSSMatrix"in window||"MozPerspective"in document.body.style,a.vendor=a.getPrefix()),!1===c.cover&&"double"===c.display&&this.prepend($("<div />",{class:"Oops"}));var d,e=this.data(),f=this.children().not(".__lock__");if(c=$.extend({width:this.width(),height:this.height()},a.turnOptions,c),e.opts=c,e.pageObjs={},e.pages={},e.pageWrap={},e.pagePlace={},e.pageMv=[],e.totalPages=c.pages||0,c.when)for(d in c.when)a.has(d,c.when)&&this.bind(d,c.when[d]);for(this.css({width:c.width,height:c.height}),this.turn("display",c.display),d=0;d<f.length;d++)this.turn("addPage",f[d],d+1);return this.prepend($("<div />",{class:"book-shadow"})),this.turn("page",c.page),a.corners=$.extend({},a.corners,c.corners),$(document).bind(a.events.start,function(c){if(!Toast.__destroy__&&!Toast.IS_ZOOM&&($(c.target).closest(".book").length?Toast.__noFlip__=!1:Toast.__noFlip__=!0,!Toast.__noFlip__))for(var d in e.pages)if(a.has(d,e.pages)&&!1===b._eventStart.call(e.pages[d],c))return a.isTouch}).bind(a.events.move,function(c){if(!Toast.__destroy__&&!Toast.IS_ZOOM&&!Toast.__noFlip__)for(var d in e.pages)a.has(d,e.pages)&&(!1!==b._eventMove.call(e.pages[d],c)||a.isTouch||c.stopPropagation())}).bind(a.events.end,function(c){if(!Toast.__destroy__&&!Toast.IS_ZOOM){if(Toast.__noFlip__)return void(Toast.__noFlip__=!1);for(var d in e.pages)a.has(d,e.pages)&&b._eventEnd.call(e.pages[d],c)}}),e.done=!0,this},addPage:function(a,b){var d,e=!1,f=this.data(),g=f.totalPages+1;if(b){if(b==g)b=g,e=!0;else if(b>g)throw new Error('It is impossible to add the page "'+b+'", the maximum value is: "'+g+'"')}else b=g,e=!0;return b>=1&&b<=g&&(d="double"==f.display?b%2?" odd":" even":"",f.done&&this.turn("stop"),b in f.pageObjs&&c._movePages.call(this,b,1),e&&(f.totalPages=g),f.pageObjs[b]=$(a).addClass("page p"+b+d),c._addPage.call(this,b),f.done&&this.turn("update"),c._removeFromDOM.call(this)),this},_addPage:function(b){var d=this.data(),e=d.pageObjs[b];if(e)if(c._necessPage.call(this,b)){if(!d.pageWrap[b]){var f="double"==d.display,g=f?this.width()/2:this.width(),h=this.height();if(e.css({width:g,height:h}),d.pagePlace[b]=b,d.pageWrap[b]=$("<div/>",{class:"page-wrapper",page:b,css:{position:"absolute",overflow:"hidden",width:g,height:h}}).css(a.pagePosition["double"==d.display?b%2:0]),this.append(d.pageWrap[b]),d.pageWrap[b].prepend(d.pageObjs[b]),!0===d.opts.shadow&&0===d.pageObjs[b].children(".shadow").length){var i=$("<div/>",{class:"shadow"});d.pageObjs[b].append(i)}this.trigger("addPage",b)}b&&1!=c._setPageLocation.call(this,b)||c._makeFlip.call(this,b)}else d.pagePlace[b]=0,d.pageObjs[b]&&d.pageObjs[b].remove()},hasPage:function(a){return a in this.data().pageObjs},_makeFlip:function(a){var b=this.data();if(!b.pages[a]&&b.pagePlace[a]==a){var d="single"==b.display,e=a%2;!1===d&&!1===b.opts.cover&&2===a?b.pages[a]=b.pageObjs[a].css({width:d?this.width():this.width()/2,height:this.height()}).flip({page:a,next:null,turn:this,duration:b.opts.duration,acceleration:b.opts.acceleration,corners:d?"all":e?"forward":"backward",cornerSize:b.opts.cornerSize,backGradient:b.opts.gradients,frontGradient:b.opts.gradients}):(b.pages[a]=b.pageObjs[a].css({width:d?this.width():this.width()/2,height:this.height()}).flip({page:a,next:d&&a===b.totalPages?a-1:e||d?a+1:a-1,turn:this,duration:b.opts.duration,acceleration:b.opts.acceleration,corners:d?"all":e?"forward":"backward",cornerSize:b.opts.cornerSize,backGradient:b.opts.gradients,frontGradient:b.opts.gradients}).flip("disable",b.disabled).bind("pressed",c._pressed).bind("released",c._released).bind("cornerReleased",c._cornerReleased).bind("start",c._start).bind("end",c._end).bind("out",c._out).bind("flip",c._flip),1!==a&&a!==b.totalPages||"double"!=b.display||!0!==b.opts.cover||b.pageObjs[a].parents(".page-wrapper").addClass("cover")),c._setPageLocation.call(this,a)}return b.pages[a]},_makeRange:function(){var a,b;if(!(this.data().totalPages<1))for(b=this.turn("range"),a=b[0];a<=b[1];a++)c._addPage.call(this,a)},range:function(b){var d,e,f,g,h=this.data();if(b=b||h.tpage||h.page||1,g=c._view.call(this,b),b<1||b>h.totalPages)throw new Error('"'+b+'" is not a valid page');return g[1]=g[1]||g[0],g[0]>=1&&g[1]<=h.totalPages?(d=Math.floor((a.pagesInDOM-2)/2),h.totalPages-g[1]>g[0]?(e=Math.min(g[0]-1,d),f=2*d-e):(f=Math.min(h.totalPages-g[1],d),e=2*d-f)):(e=a.pagesInDOM-1,f=a.pagesInDOM-1),[Math.max(1,g[0]-e),Math.min(h.totalPages,g[1]+f)]},_necessPage:function(a){if(0===a)return!0;var b=this.turn("range");return a>=b[0]&&a<=b[1]},_removeFromDOM:function(){var b,d=this.data();for(b in d.pageWrap)a.has(b,d.pageWrap)&&!c._necessPage.call(this,b)&&(this.trigger("removePage",b),c._removePageFromDOM.call(this,b))},_removePageFromDOM:function(a){var b=this.data();if(b.pages[a]){var d=b.pages[a].data();d.f&&d.f.fwrapper&&d.f.fwrapper.remove(),b.pages[a].removeData(),b.pages[a].remove(),delete b.pages[a]}b.pageObjs[a]&&b.pageObjs[a].remove(),b.pageWrap[a]&&(b.pageWrap[a].remove(),delete b.pageWrap[a]),c._removeMv.call(this,a),delete b.pagePlace[a]},removePage:function(a){var b=this.data();return b.pageObjs[a]&&(this.turn("stop"),c._removePageFromDOM.call(this,a),delete b.pageObjs[a],c._movePages.call(this,a,-1),b.totalPages=b.totalPages-1,b.page>b.totalPages?(b.page=null,c._fitPage.call(this,b.totalPages)):(c._makeRange.call(this),this.turn("update"))),this},_movePages:function(b,c){var d,e=this.data(),f="single"==e.display,g=function(b){var d=b+c,g=d%2,h=g?" odd ":" even ";e.pageObjs[b]&&(e.pageObjs[d]=e.pageObjs[b].removeClass("page"+b+" odd even").addClass("page"+d+h)),e.pagePlace[b]&&e.pageWrap[b]&&(e.pagePlace[d]=d,e.pageWrap[d]=e.pageWrap[b].css(a.pagePosition[f?0:g]).attr("page",d),e.pages[b]&&(e.pages[d]=e.pages[b].flip("options",{page:d,next:f||g?d+1:d-1,corners:f?"all":g?"forward":"backward"})),c&&(delete e.pages[b],delete e.pagePlace[b],delete e.pageObjs[b],delete e.pageWrap[b],delete e.pageObjs[b]))};if(c>0)for(d=e.totalPages;d>=b;d--)g(d);else for(d=b;d<=e.totalPages;d++)g(d)},display:function(b){var d=this.data(),e=d.display;if(b){if(-1==$.inArray(b,a.displays))throw new Error('"'+b+'" is not a value for display');if("single"==b?d.pageObjs[0]||(this.turn("stop").css({overflow:"hidden"}),d.pageObjs[0]=$("<div />",{class:"page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)):d.pageObjs[0]&&(this.turn("stop").css({overflow:""}),d.pageObjs[0].remove(),delete d.pageObjs[0]),d.display=b,e){var f=this.turn("size");c._movePages.call(this,1,0),this.turn("size",f.width,f.height).turn("update")}return this}return e},animating:function(){return this.data().pageMv.length>0},disable:function(b){var c,d=this.data(),e=this.turn("view");d.disabled=void 0===b||!0===b;for(c in d.pages)a.has(c,d.pages)&&d.pages[c].flip("disable",!!d.disabled||-1==$.inArray(parseInt(c,10),e));return this},disabled:function(a){return void 0===a?!0===this.data().disabled:(a&&this.turn("stop"),this.turn("disable",a))},getData:function(){return this.data()},size:function(b,c){if(b&&c){this.turn("stop");var d,e=this.data(),f="double"==e.display?b/2:b;this.css({width:b,height:c}),e.pageObjs[0]&&e.pageObjs[0].css({width:f,height:c});for(d in e.pageWrap)a.has(d,e.pageWrap)&&(e.pageObjs[d].css({width:f,height:c}),e.pageWrap[d].css({width:f,height:c}),e.pages[d]&&e.pages[d].css({width:f,height:c}));return this.turn("resize"),this}return{width:this.width(),height:this.height()}},resize:function(){var a,b=this.data();for(b.pages[0]&&(b.pageWrap[0].css({left:-this.width()}),b.pages[0].flip("resize",!0)),a=1;a<=b.totalPages;a++)b.pages[a]&&b.pages[a].flip("resize",!0)},_removeMv:function(a){var b,c=this.data();for(b=0;b<c.pageMv.length;b++)if(c.pageMv[b]==a)return c.pageMv.splice(b,1),!0;return!1},_addMv:function(a){var b=this.data();c._removeMv.call(this,a),b.pageMv.push(a)},_view:function(a){var b=this.data();return a=a||b.page,"double"==b.display?a%2?[a-1,a]:[a,a+1]:[a]},view:function(a){var b=this.data(),d=c._view.call(this,a);return"double"==b.display?[d[0]>0?d[0]:0,d[1]<=b.totalPages?d[1]:0]:[d[0]>0&&d[0]<=b.totalPages?d[0]:0]},stop:function(){var c,d,e=this.data(),f=e.pageMv;e.pageMv=[],e.tpage&&(e.page=e.tpage,delete e.tpage);for(c in f)a.has(c,f)&&(d=e.pages[f[c]].data().f.opts,b._moveFoldingPage.call(e.pages[f[c]],null),e.pages[f[c]].flip("hideFoldedPage"),e.pagePlace[d.next]=d.next,d.force&&(d.next=d.page%2==0?d.page-1:d.page+1,delete d.force));return this.turn("update"),this},pages:function(a){var b=this.data();if(a){if(a<b.totalPages){for(var c=a+1;c<=b.totalPages;c++)this.turn("removePage",c);this.turn("page")>a&&this.turn("page",a)}return b.totalPages=a,this}return b.totalPages},_fitPage:function(a){var b=this.data(),d=b.opts,e=this.turn("view",a);b.page!=a&&(this.trigger("turning",[a,e]),-1!=$.inArray(d.firstPage,e)&&this.trigger("first"),-1!=$.inArray(b.totalPages,e)&&this.trigger("last",a)),b.pageObjs[a]&&(b.tpage=a,this.turn("stop"),c._removeFromDOM.call(this),c._makeRange.call(this),this.trigger("turned",[a,e]),this.is(":visible")||this.show())},_turnPage:function(a){var b,d,e=this.data(),f=this.turn("view"),g=this.turn("view",a);if(e.page!=a&&(this.trigger("turning",[a,g]),-1!=$.inArray(1,g)&&this.trigger("first"),-1!=$.inArray(e.totalPages,g)&&this.trigger("last")),e.pageObjs[a]&&(e.tpage=a,this.turn("stop"),c._makeRange.call(this),"single"==e.display?(b=f[0],d=g[0]):f[1]&&a>f[1]?(b=f[1],d=g[0]):f[0]&&a<f[0]&&(b=f[0],d=g[1]),e.pages[b])){var h=e.pages[b].data().f.opts;e.tpage=d,h.next!=d&&(h.next=d,e.pagePlace[d]=h.page,h.force=!0),"single"==e.display?e.pages[b].flip("turnPage",g[0]>f[0]?"br":"bl"):e.pages[b].flip("turnPage")}},page:function(a){var b=this.data();return void 0===a?b.page:(a=parseInt(a,10),a>0&&a<=b.totalPages?(b.done&&-1==$.inArray(a,this.turn("view"))?c._turnPage.call(this,a):c._fitPage.call(this,a),this):b.page)},next:function(){var a=this.data();return this.turn("page",c._view.call(this,a.page).pop()+1)},previous:function(){var a=this.data();return this.turn("page",c._view.call(this,a.page).shift()-1)},_addMotionPage:function(){var a=$(this).data().f.opts,b=a.turn,d=b.data();a.pageMv=a.page,c._addMv.call(b,a.pageMv),d.pagePlace[a.next]=a.page,b.turn("update")},_start:function(a,b,d,e){var f=b.turn.data();if(a.stopPropagation(),b.next&&b.next>=1&&b.next<=f.totalPages){var g=$.Event("start");if(b.turn.trigger(g,[b,d,e]),g.isDefaultPrevented())return void a.preventDefault()}if("single"==f.display){var h="l"==d.charAt(1);1==b.page&&h||b.page==f.totalPages&&!h?a.preventDefault():h?(b.next=b.next<b.page?b.next:b.page-1,b.force=!0):b.next=b.next>b.page?b.next:b.page+1}c._addMotionPage.call(this)},_end:function(a,b){var d=$(this),e=d.data().f,f=e.opts,g=f.turn,h=g.data();if(a.stopPropagation(),b||h.tpage)h.tpage!=f.next&&h.tpage!=f.page||(delete h.tpage,c._fitPage.call(g,h.tpage||f.next,!0));else if(g.turn("stop"),f.next&&f.next>=1&&f.next<=h.totalPages){var i=$.Event("end");f.turn.trigger(i,[f])}},_out:function(a,b){a.stopPropagation();var c=(b.turn.data(),$.Event("out"));b.turn.trigger(c)},_pressed:function(a){var b,c=$(this),d=c.data().f,e=d.opts.turn,f=e.data().pages;for(b in f)b!=d.opts.page&&f[b].flip("disable",!0);a.stopPropagation();var g=$.Event("pressed");return e.trigger(g),d.time=(new Date).getTime()},_released:function(a,b,c){var d=$(this),e="l"==b.corner.charAt(1),f=d.data().f,g=f.opts,h=g.turn,i=(h.data(),!1);if(a.stopPropagation(),f.flipping){if("single"==h.data().display?e&&b.x>Math.floor(d.width()/2)?i=!0:!e&&b.x<Math.floor(d.width()/2)&&(i=!0):b.x<0?i=!0:b.x>d.width()/2&&(i=!0),i){a.preventDefault();var j;h.data().tpage=f.opts.next,j=h.data().page>f.opts.next?$.Event("goPrevious"):$.Event("goNext"),h.trigger(j,[{silent:!0}]),h.turn("update"),$(d).flip("turnPage")}}else if(c&&(a.preventDefault(),h.data().page!=f.opts.next)){var j;j=e?$.Event("goPrevious"):$.Event("goNext"),h.trigger(j)}var j=$.Event("released");h.trigger(j)},_flip:function(){var a=$(this).data().f.opts;a.turn.trigger("turn",[a.next])},calculateZ:function(a){var b,c,d,e,f,g=this,h=this.data(),i=this.turn("view"),j=i[0]||i[1],k={pageZ:{},partZ:{},pageV:{}},l=function(a){var b=g.turn("view",a);b[0]&&(k.pageV[b[0]]=!0),b[1]&&(k.pageV[b[1]]=!0)};for(b=0;b<a.length;b++)c=a[b],d=h.pages[c].data().f.opts.next,e=h.pagePlace[c],l(c),l(d),f=h.pagePlace[d]==d?d:c,k.pageZ[f]=h.totalPages-Math.abs(j-f),k.partZ[e]=2*h.totalPages+Math.abs(j-f);return k},update:function(){var b,d=this.data();if(d.pageMv.length&&0!==d.pageMv[0]){var e=this.turn("calculateZ",d.pageMv),f=this.turn("view",d.tpage);d.pagePlace[f[0]]==f[0]?f[0]:d.pagePlace[f[1]]==f[1]&&f[1];for(b in d.pageWrap)a.has(b,d.pageWrap)&&(d.pageWrap[b].css({display:e.pageV[b]?"":"none","z-index":e.pageZ[b]||0}),d.pages[b]&&(d.pages[b].flip("z",e.partZ[b]||null),e.pageV[b]&&d.pages[b].flip("resize"),d.tpage&&d.pages[b].flip("disable",!0)))}else for(b in d.pageWrap)if(a.has(b,d.pageWrap)){var g=c._setPageLocation.call(this,b);d.pages[b]&&d.pages[b].flip("disable",d.disabled||1!=g).flip("z",null)}},_setPageLocation:function(a){var b=this.data(),c=this.turn("view");return a==c[0]||a==c[1]?(b.pageWrap[a].css({"z-index":b.totalPages,display:""}),1):"single"==b.display&&a==c[0]+1||"double"==b.display&&a==c[0]-2||a==c[1]+2?(b.pageWrap[a].css({"z-index":b.totalPages-1,display:""}),2):(b.pageWrap[a].css({"z-index":0,display:"none"}),0)},options:function(b){var d,e,f=this.data(),g=f.opts;if(g.display!==b.display){if(c.stop.call(this),g=$.extend(f.opts,b),!1===g.cover&&"double"===g.display){var h=f.totalPages;if(f.pageObjs[1]&&!f.pageObjs[1].hasClass("Oops")){var i=$("<div />",{class:"Oops"});this.prepend(i),this.turn("addPage",i,1),h==f.totalPages&&f.totalPages++,f.page%2==0?f.page+=1:f.page+=2}}else f.pageObjs[1]&&f.pageObjs[1].hasClass("Oops")?(f.page%2==0?f.page-=1:f.page-=2,c.removePage.call(this,1)):!0===g.cover&&f.page%2!=0&&(f.page-=1);for(f.page=Math.max(1,f.page),f.page=Math.min(f.page,f.totalPages),f.pageObjs[1]&&f.pageObjs[1].hasClass("Oops")?g.firstPage=2:g.firstPage=1,this.turn("display",f.opts.display),e=this.turn("range"),d=e[0];d<=e[1];d++)a.has(d,f.pageWrap)&&c._necessPage.call(this,d)&&(this.trigger("removePage",d),c._removePageFromDOM.call(this,d));for(this.turn("page",f.page),1!==f.page&&f.page!==f.totalPages||"double"!=f.display||!0!==f.opts.cover||f.pageObjs[f.page].parents(".page-wrapper").addClass("cover"),e=this.turn("range"),d=e[0];d<=e[1];d++)a.has(d,f.pageWrap)&&c._necessPage.call(this,d)&&f.pageObjs[d].find(".loader").remove()}},clear:function(){var a=this.data();this.children();this.turn("stop");for(var b=a.totalPages;b>0;b--)a.fparent&&(a.fparent.remove(),a.fparent=null),c.removePage.call(this,b)},reset:function(a){var b,c=this.data(),d=this.children().not(".__lock__");c.opts;for(c.opts=_.extend(c.opts,a),c.done=!1,!1===c.opts.cover&&"double"===c.opts.display&&this.prepend($("<div />",{class:"Oops"})),this.turn("display",c.opts.display),b=0;b<d.length;b++)this.turn("addPage",d[b],b+1);this.prepend($("<div />",{class:"book-shadow"})),this.turn("page",a.page),c.done=!0}};return c}),define("toast/core/book/BookFlipTransition",["./BookCommon","./BookTransition","./BookFlipManager","./BookFlipPage"],function(a,b,c,d){"use strict";var e=b.prototype,f=b.extend();return _.extend(f.prototype,e,{initialize:function(a,b){if(e.initialize.call(this,a,b),!0===b.pageFlipSound){var c;c=Toast.isNative||Toast.urlParams.get("preview")?"{APP_DIR}assets/media/page-flip.mp3":"{ASSETS_DIR}media/page-flip.mp3",c=TT.StringUtils.replaceTemplate(c),this.$pageFlipSound=$('<audio src="'+c+'" style="z-index:99999" />'),this.$pageFlipSound.on("loadeddata",function(a){this.isReadyPageFlipAudio=!0}.bind(this)),this.$pageFlipSound.load()}this.initializeFlip(),this._setCornerLayers()},configure:function(a){e.configure.call(this,a);var b=this.book.$getBook(),c=b.turn("getData");if(this.$bookShadow=b.children(".book-shadow"),!0===b.turn("getData").done&&c.totalPages>0){if(this.book.isLastPage()){var d=this.book.getCurrentPageNumber();_.each(d,function(a){this.book._unloadPage(a)},this)}b.turn("options",{display:this.config.display}),this._loadPages(),this.layout(),this._setCornerLayers()}},initializeFlip:function(){var a=this,b=this.config;this.addPages=[],this.previousPage=-1,this.book.$getBook().turn({display:this.config.display,elevation:Toast.isMobileDevice?50:b.transitionConfig.elevation?b.transitionConfig.elevation:50,cover:this.config.cover,shadow:this.config.shadow,page:!1===this.config.cover&&"double"===this.config.display?2:1,firstPage:!1===this.config.cover&&"double"===this.config.display?2:1,gradients:!0,acceleration:!0,cornerSize:60,corners:Toast.isMobileDevice?null:Toast.config.corners,duration:b.transitionConfig.duration?b.transitionConfig.duration:Toast.isMobileDevice?350:400,when:{start:function(c,d,e,f){var g=$(this).data();a._loadPages(),!0===b.cover&&a.book.isDoublePage()&&(1===d.next||2===d.next?a.$bookShadow.css({width:"50%",left:"",right:0}):d.next===g.totalPages&&g.totalPages%2==0?a.$bookShadow.css({width:"50%",right:""}):d.next===g.totalPages-1&&g.totalPages%2==0&&a.$bookShadow.css({width:"50%",right:"",left:0})),!0===f&&(tt.$el.addClass("flipping"),a.book._addOverlay()),Toast.isMobileDevice&&!a.book.isDoublePage()&&a.book.$getBook().css({overflow:"hidden"}),f?Toast.send(Toast.Events.FLIP_CORNER_START_ANIMATE):Toast.send(Toast.Events.TRANSITION_START)},out:function(b){a.book._removeOverlay(),tt.$el.removeClass("flipping"),Toast.send(Toast.Events.TRANSITION_OUT)},pressed:function(a){tt.$el.addClass("flipping"),Toast.send(Toast.Events.TRANSITION_PRESSED)},released:function(a,b){},first:function(){a._loadPages()},last:function(){a._layout()},goPrevious:function(b,c){if(c||(c={}),Toast.$el.removeClass("flipping"),a.book._removeOverlay(),c.silent)a._playFlipSound(),a.book.turnByUserAction("previous");else{if(Toast.BookZoom.isActivated())return;Toast.CommandManager.execute(Toast.Commands.PREVIOUS_PAGE)}},goNext:function(b,c){if(c||(c={}),Toast.$el.removeClass("flipping"),a.book._removeOverlay(),c.silent)a._playFlipSound(),a.book.turnByUserAction("next");else{if(Toast.BookZoom.isActivated())return;Toast.CommandManager.execute(Toast.Commands.NEXT_PAGE)}},turning:function(a,b,c){},turn:function(b,c){var d=$(this).data();c=a._getCurrentPage(d,c),a._loadPages(),a._layout(),a.book._updateElements(),a.book._sendPageChangeEvent(Toast.Events.WILL_MOVE_PAGE,a.book.getCurrentPageNumber({page:c}),a.previousPage)},turned:function(b,c){var d=$(this).data();c=a._getCurrentPage(d,c),a.book._sendPageChangeEvent(Toast.Events.PAGE_DID_CHANGE,a.book.getCurrentPageNumber({page:c}),a.previousPage),a.previousPage=c},end:function(c,d){!0===b.cover&&a.book.isDoublePage()?a.$bookShadow.css({width:"",right:""}):Toast.isMobileDevice&&!a.book.isDoublePage()&&a.book.$getBook().css({overflow:""}),Toast.send(Toast.Events.TRANSITION_END)},addPage:function(b,c){c-=$(this).data().opts.firstPage-1,a.addPages.push(c);var d=Toast.Book.views[c-1];if(a.book.getTotalPageNumber()>1&&!_.isUndefined(d)&&d.state()===Toast.STATUS_NONE){0===d.$el.parent().find(".indigator").length&&Toast.showLoading(!0,{modal:!1,el:d.$el.parent()})}},removePage:function(b,c){c-=$(this).data().opts.firstPage-1,a.book._unloadPage(c)}}}),this.$bookShadow=this.book.$getBook().children(".book-shadow"),this.layout()},_getCurrentPage:function(a,b){return b-=a.opts.firstPage-1,this.book.isDoublePage()&&(Toast.config.cover?this.previousPage>b&&b>1&&(b-=b%2?1:0):b-=b%2?0:1),b},_loadPages:function(){this.addPages=this.addPages.slice(Math.max(0,this.addPages.length-a.pagesInDOM));var b=this.book.getCurrentPageNumber(),c=_.find(this.addPages,function(a){return a==b[0]});_.isUndefined(c)&&this.book._loadPage(b[0]),1!=b.length&&(c=_.find(this.addPages,function(a){return a==b[1]}),_.isUndefined(c)&&this.book._loadPage(b[1])),_.each(this.addPages,function(a){this.book._loadPage(a)},this),this.addPages=[]},updateVisibility:function(){return!0},set:function(){},layout:function(){e.layout.call(this);var a=this.book.$getBook();a.turn("getData").done&&a.turn("size",a.width(),a.height()),this._layout()},_layout:function(){"center"==this.config.coverLayout&&this._coverCenterLayout(),this._updateCoverClassName()},_updateCoverClassName:function(){this._isCover()?(TT.$bookContainer.addClass("cover"),TT.$el.addClass("cover"),this.book.isLastPage()?(TT.$bookContainer.removeClass("front-cover"),TT.$bookContainer.addClass("back-cover"),TT.$el.removeClass("front-cover"),TT.$el.addClass("back-cover")):this.book.isFirstPage()&&(TT.$bookContainer.removeClass("back-cover"),TT.$bookContainer.addClass("front-cover"),TT.$el.removeClass("back-cover"),TT.$el.addClass("front-cover"))):TT.$bookContainer.hasClass("cover")&&(TT.$bookContainer.removeClass("cover front-cover back-cover"),TT.$el.removeClass("cover front-cover back-cover"))},_isCover:function(){return!(!0!==this.config.cover||!this.config.doublepage)&&(this.book.getCurrentPageIndex()<=0||!(!this.book.isLastPage()||this.book.getTotalPageNumber()%2!=0))},_coverCenterLayout:function(){var a=Number(Toast.$book.attr("data-left")),b=Toast.$bookContainer.children(".book-bg"),c=this.config;this._isCover()?(c.useBackground&&b.hide(),this.book.isLastPage()?Toast.$book.css("left",a+TT.$book.width()/4+"px"):Toast.$book.css("left",a-TT.$book.width()/4+"px")):Toast.$bookContainer.hasClass("cover")&&(Toast.$book.css("left",a+"px"),c.useBackground&&b.show())},previous:function(a){this.book.$getBook().turn("previous"),a.silent||this._playFlipSound()},next:function(a){this.book.$getBook().turn("next"),a.silent||this._playFlipSound()},move:function(a){var b=this.book.$getBook(),c=a.page-1;if(this.previousPage=-1,c>=1&&this.config.doublepage?(c*=2,!1===this.config.cover&&this.config.doublepage&&(c+=2)):c+=1,!1===this.config.cover&&this.config.doublepage&&(c=Math.max(2,c)),b.turn("page",c),-1==this.previousPage){var d=b.turn("getData");this.previousPage=this._getCurrentPage(d,c)}a.silent||this._playFlipSound()},_setCornerLayers:function(){var a=this.book.$getBook();a.children(".cl").remove(),$("<div />",{class:"cl cl-lt"}).appendTo(a),$("<div />",{class:"cl cl-lb"}).appendTo(a),$("<div />",{class:"cl cl-rt"}).appendTo(a),$("<div />",{class:"cl cl-rb"}).appendTo(a)},unset:function(){this.book.$getBook().children(".cl").remove()},_playFlipSound:function(a){if((Toast.config.forceFlipSound||!Toast.isMobileDevice||!Toast.isIOS)&&!Toast.IS_ZOOM&&(!0===a||!0===this.config.pageFlipSound&&!0===this.isReadyPageFlipAudio)){this.$pageFlipSound[0].currentTime=0;var b=this.$pageFlipSound[0].play();void 0!==b&&"function"==typeof b.then&&b.then(function(){}).catch(function(a){})}}}),f}),define("toast/core/book/BookSlideTransition",["./BookTransition"],function(a){"use strict";var b=a.prototype,c=a.extend();return _.extend(c.prototype,b,{initialize:function(a,c){b.initialize.call(this,a,c)},configure:function(a){b.configure.call(this,a),this._initFlick()},_initFlick:function(){this._beforeFlickStartFn||(this._beforeFlickStartFn=$.proxy(this._beforeFlickStart,this)),this._flickFn||(this._flickFn=$.proxy(this._flick,this)),this._flickEndFn||(this._flickEndFn=$.proxy(this._flickEnd,this)),this._flick=new eg.Flicking(".book",{duration:300,circular:!1,bounce:[50,50],defaultIndex:Math.max(0,this.book.getCurrentPageIndex())}).on({beforeFlickStart:this._beforeFlickStartFn,flick:this._flickFn,flickEnd:this._flickEndFn}),this.config.disablePageMoveGesture&&this._flick.disableInput(),$(this._flick.$container).addClass("container"),this.layout()},numberOfPageCache:function(){return 3},navigationInteraction:function(){return!0},canNavigationInteraction:function(){return!this._flicking},_beforeFlickStart:function(a){if(this._flicking=!0,!this._silent&&!this._byButtonInteraction){var b;eg.Flicking.DIRECTION_LEFT===a.direction?b=this._flick.getNextIndex():eg.Flicking.DIRECTION_RIGHT===a.direction&&(b=this._flick.getPrevIndex());var c=this.book.getCurrentPageNumber({pageIndex:b});this.book.updatePageNo(c[0]),this.set(),this.book._sendPageChangeEvent(Toast.Events.WILL_MOVE_PAGE,this.book.getCurrentPageNumber())}},_flick:function(a){if(this._flicking=!0,!this._silent){var b;eg.Flicking.DIRECTION_LEFT===a.direction?b=this._flick.getNextIndex():eg.Flicking.DIRECTION_RIGHT===a.direction&&(b=this._flick.getPrevIndex());var c=this.book.getCurrentPageNumber({pageIndex:b});this.book._movable(c[0])||(this._flicking=this._silent=this._byButtonInteraction=!1,a.stop()),a.holding?this._distance=a.distance:this._distance&&this._flick.options.threshold>Math.abs(this._distance)&&this._resetFlickVars()}},_flickEnd:function(a){this._silent||this._byButtonInteraction||this.book._sendPageChangeEvent(Toast.Events.PAGE_DID_CHANGE,this.book.getCurrentPageNumber()),this._resetFlickVars()},_resetFlickVars:function(){this._flicking=this._silent=this._byButtonInteraction=!1},set:function(a){var b=Toast.BookZoom.isActivated();if(this.book.isDoublePage()){var c=this.book.$getBook(),d=this.book._getBestSize();d.width/=2,_.each(this.book.getVisiblePages(),function(a){var e=this.book.views[a-1];if(_.isUndefined(e)||e.state()===Toast.STATUS_NONE)return!0;var f;f=a%2?c.width()/2-d.width:c.width()/2,b?e.$el.parent().css({left:"",width:"",height:""}):this.book.getTotalPageNumber()===a&&a%2?(e.$el.parent().addClass("right-blank-page"),e.$el.parent().css({left:f,width:2*d.width,height:d.height})):e.$el.parent().css({left:f,width:d.width,height:d.height})},this)}},unset:function(){this.set(),this._flick&&(this._flick.off(),Toast.isMobileDevice&&this._flick.destroy(),delete this._flick,this._flick=null),this._resetFlickVars(),this._beforeFlickStartFn&&delete this._beforeFlickStartFn,this._flickFn&&delete this._flickFn,this._flickEndFn&&delete this._flickEndFn},layout:function(){var a=Toast.BookZoom.isActivated();if(!a){this.book.$getBook().css({left:0,top:0,width:"100%",height:"100%"})}this._flick&&(a||this._flick.resize(),this._flicking=!1),this.set()},updatePresent:function(){var a=this._flick.getIndex(),b=$(this.book.getPages()[a]);b.removeClass("past future"),b.addClass("present"),b.css("display","block");var c=this.book.getPages()[a-1];if(c){var d=$(c);d.removeClass("present future"),d.addClass("past"),d.css("display","block")}var e=this.book.getPages()[a+1];if(e){var f=$(e);f.removeClass("present past"),f.addClass("future"),f.css("display","block")}},restoreLayoutFromZoomActiveState:function(a){a?this.unset():(this._initFlick(),this.updatePresent())},previous:function(a){this._flick&&(this._byButtonInteraction=!0,"hidden"===Toast.topWindow().document.visibilityState?this._flick.prev(0):this._flick.prev())},next:function(a){this._flick&&(this._byButtonInteraction=!0,"hidden"===Toast.topWindow().document.visibilityState?this._flick.next(0):this._flick.next())},move:function(a){this._flick&&(this._silent=!0,this._flick.moveTo(a.page-1,0),this._silent=!1)}}),c}),define("toast/core/book/BookTranslucentSlideTransition",["./BookSlideTransition"],function(a){"use strict";var b=a.prototype,c=a.extend();return _.extend(c.prototype,b,{initialize:function(a,c){b.initialize.call(this,a,c)},configure:function(a){if(b.configure.call(this,a),!Toast.isMobileDevice){this.book.$getBook().closest(".book-container").addClass("visible-cache-page")}},layout:function(){var a=Toast.BookZoom.isActivated();if(Toast.isMobileDevice){var b=this.book.$getBook().closest(".book-container");Toast.isLandscape()?b.addClass("visible-cache-page"):b.removeClass("visible-cache-page")}this._flick&&(a||this._flick.resize(),this._flicking=!1),this.set()}}),c}),define("toast/core/book/BookFadeTransition",["./BookTransition"],function(a){"use strict";var b=a.prototype,c=a.extend();return _.extend(c.prototype,b,{initialize:function(a,c){b.initialize.call(this,a,c)},configure:function(a){b.configure.call(this,a)},set:function(a){this.book.layout()},resize:function(){this.set()},previous:function(a){this.set(a)},next:function(a){this.set(a)},move:function(a){this.set(a)}}),c}),define("toast/core/book/Book.jquery.plugin",["./BookCommon","./BookFlipPage","./BookFlipManager"],function(a,b,c){"use strict";var d=function(a,b,c){if(c[0]&&"object"!=typeof c[0]){if(b[c[0]]&&"_"!=c[0].toString().substr(0,1))return b[c[0]].apply(a,Array.prototype.slice.call(c,1));throw c[0]+" is an invalid value"}return b.init.apply(a,c)};$.extend($.fn,{flip:function(a,c){return d(this,b,arguments)},turn:function(a){return d(this,c,arguments)},bookTransform:function(b,c){var d={};return c&&(d[a.vendor+"transform-origin"]=c),d[a.vendor+"transform"]=b,d.transform=b,this.css(d)},animatef:function(a){var b=this.data();if(b.effect&&clearInterval(b.effect.handle),a){a.to.length||(a.to=[a.to]),a.from.length||(a.from=[a.from]),a.easing||(a.easing=function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c});var c,d=[],e=a.to.length,f=this,g=a.fps||30,h=-g,i=function(){var c,i=[];for(h=Math.min(a.duration,h+g),c=0;c<e;c++)i.push(a.easing(1,h,a.from[c],d[c],a.duration));a.frame(1==e?i[0]:i),h==a.duration&&(clearInterval(b.effect.handle),delete b.effect,f.data(b),a.complete&&a.complete())};for(c=0;c<e;c++)d.push(a.to[c]-a.from[c]);b.effect=a,b.effect.handle=setInterval(i,g),this.data(b),i()}else delete b.effect}})}),define("toast/core/book/Book",["exports","../../core","../../utils/iNoBounce","./BookCommon","./BookZoom","./BookFlipTransition","./BookSlideTransition","./BookTranslucentSlideTransition","./BookFadeTransition","./Book.jquery.plugin"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(){var a=window.location.hash,b=a.slice(2).split("/");return b[0]?parseInt(b[0],10):null}function k(){var a=b.urlParams.get("startpage");return _.isNaN(a)?null:a}function l(){if(!vb&&b.urlParams.get("startpage")){var a=parseInt(b.urlParams.get("startpage"));if(-1===jb||a!==za()[0])return ta(a,{isLogical:!0}),void(vb=!0)}var c=window.location.hash,d=c.slice(2).split("/"),a=parseInt(d[0],10);_.isNaN(a)&&(a=Fa(1)),-1!==jb&&a===za()[0]||ta(a,{isLogical:!0}),ub=!1}function m(a){!0===ub?ub=!1:l()}function n(a){var c=b.topWindow();b.isMobileDevice?p():(!b.IS_ZOOM||yb.width===c.innerWidth&&yb.height===c.innerHeight||e.updateLayout(),Ta()),yb={width:c.innerWidth,height:c.innerHeight}}function o(a){a||b.lazy(function(){p()},50)}function p(){H(),Ta()}function q(a){if(e.isActivated()){if(!$(a.target).closest(".book-container").length)return;if(Date.now()-ob>5){ob=Date.now();var c=a.detail||-a.wheelDelta;c>0?e.moveTo("down",150):e.moveTo("up",150)}}if(!fb.disablePageMoveGesture&&!0===qb&&0===$(".modal.in").length){var d=$(a.target);if((d.hasClass("book-container")||0!==d.closest(".book-container").length)&&!d.hasClass("prevent-scroll")&&0===d.closest(".prevent-scroll").length&&Date.now()-ob>500){ob=Date.now();var c=a.detail||-a.wheelDelta;c>0?b.optionalGoToNextPage():b.optionalGoToPreviousPage()}}}function r(a){if(0===$(".modal.in").length&&!b.isInputBoxFocused()&&(a.target&&a.target.blur(),!fb.disablePageMoveGesture))if(b.IS_ZOOM)switch(a.keyCode){case b.KeyEvent.DOM_VK_PAGE_UP:Date.now()-ob>300&&(ob=Date.now(),b.optionalGoToPreviousPage());break;case b.KeyEvent.DOM_VK_PAGE_DOWN:Date.now()-ob>300&&(ob=Date.now(),b.optionalGoToNextPage());break;case b.KeyEvent.DOM_VK_SPACE:a.shiftKey?b.optionalGoToPreviousPage():b.optionalGoToNextPage()}else if(!0===qb)switch(a.keyCode){case b.KeyEvent.DOM_VK_PAGE_UP:case b.KeyEvent.DOM_VK_LEFT:Date.now()-ob>300&&(ob=Date.now(),b.optionalGoToPreviousPage());break;case b.KeyEvent.DOM_VK_PAGE_DOWN:case b.KeyEvent.DOM_VK_RIGHT:Date.now()-ob>300&&(ob=Date.now(),b.optionalGoToNextPage());break;case b.KeyEvent.DOM_VK_HOME:b.config.reversePageTurnDirection?b.executeCommand(b.Commands.LAST_PAGE):b.executeCommand(b.Commands.FIRST_PAGE);break;case b.KeyEvent.DOM_VK_END:b.config.reversePageTurnDirection?b.executeCommand(b.Commands.FIRST_PAGE):b.executeCommand(b.Commands.LAST_PAGE);break;case b.KeyEvent.DOM_VK_SPACE:a.shiftKey?b.optionalGoToPreviousPage():b.optionalGoToNextPage()}}function s(){return!!b.IS_VERTICAL_SCROLLING||(_.isUndefined(qb)&&(qb=!0),!b.IS_PAINTER_ACTIVATED&&(qb&&!b.IS_ZOOM&&!b.IS_DRAGGING&&!b.IS_DRAWING&&!b.IS_TURNING&&!b.IS_SLIDING))}function t(a,b){sb.isTouched=!0,sb.startX=b.startX,sb.startY=b.startY,sb.count=b.count,sb.elapsedTime=Date.now()}function u(a,c){if(sb.isTouched){if(!b.isMobileDevice){if(a.target.firstChild&&3===a.target.firstChild.nodeType)return void(sb.isTouched=!1);if(Date.now()-sb.elapsedTime<50)return;sb.elapsedTime=Date.now()}if(!sb.captured&&0!==$(a.target).closest(".book-container").length){var d=c.x,e=c.y,f=d-sb.startX,g=e-sb.startY;f>sb.threshold&&Math.abs(f)>Math.abs(g)?(sb.captured=!0,"flip"===fb.transition?!0!==$a.turn("getData").opts.pressed&&b.executeCommand(b.Commands.PREVIOUS_PAGE):b.executeCommand(b.Commands.PREVIOUS_PAGE)):f<-sb.threshold&&Math.abs(f)>Math.abs(g)&&(sb.captured=!0,"flip"===fb.transition?!0!==$a.turn("getData").opts.pressed&&b.executeCommand(b.Commands.NEXT_PAGE):b.executeCommand(b.Commands.NEXT_PAGE))}}}function v(a){sb.captured&&a.preventDefault(),sb.isTouched=!1,sb.captured=!1}function w(a){s()&&"INPUT"!==a.target.tagName&&t(a,{startX:a.pageX,startY:a.pageY,count:1},a)}function x(a){s()&&u(a,{x:a.pageX,y:a.pageY})}function y(a){v(a)}function z(a){var b=$(a.target);if(!b.closest(".open").length){if(b.closest(".disabled").length)return void a.preventDefault();var c=b.closest("[command]");b.attr("command")||c.length||(c=b.closest(".toast-object"),b.hasClass("toast-object")||c.length||a.preventDefault())}}function A(a){(new Date).getTime()-tb<500&&z(a),tb=(new Date).getTime(),s()&&t(a,{startX:a.originalEvent.touches[0].clientX,startY:a.originalEvent.touches[0].clientY,count:a.originalEvent.touches.length})}function B(a){s()&&1===a.originalEvent.touches.length&&2!==sb.count&&u(a,{x:a.originalEvent.touches[0].clientX,y:a.originalEvent.touches[0].clientY})}function C(a){v(a)}function D(a){$(a.target).closest(".auto-scrollbar").length||b.IS_DRAGGING||a.preventDefault()}function E(a){sb.isTouched||0===$(document.body).children(".dialog, .modal").length&&b.lazyOnce(function(){H(),Ta()},150,zb)}function F(){}function G(){b.isAndroid?b.lazy(function(){H(),Ta()},1e3):(H(),Ta())}function H(){if(b.isMobileDevice){var a=b.topWindow(),c=$(a).scrollTop();$("html").css("top",c);var d=b.config.frameNavbarHeight||0;$("html").css("height",a.innerHeight-d)}}function I(a,c){var d=gb[a-1];if(!_.isUndefined(d)){if(d.state()===b.STATUS_LOADED&&(0!==d.$el.children().length||d._hasBackgroundImage()))return void(d.needLayout?Qa(a):c&&c.alwaysFit&&Qa(a));var e=b.project.models[a-1];d.load(e.toJSON(),{showLoader:!0,readyonly:!0}),-1==nb.indexOf(a)&&(nb.push(a),nb.sort(function(a,b){return a-b})),Qa(a),b.send(b.Events.PAGE_DID_LOAD,a)}}function J(a){var c=gb[a-1];_.isUndefined(c)||(c.reset(),nb=_.without(nb,a),nb.sort(function(a,b){return a-b}),b.send(b.Events.PAGE_DID_UNLOAD,a))}function K(a){var b=a-1;!0===pb&&(b/=2);var c=$(hb[b]);c.removeClass("present future past"),jb<b?c.addClass("future"):jb>b&&c.addClass("past"),c.css("display","block"),I(a,{alwaysFit:!0})}function L(a){var b=a-1;!0===pb&&(b/=2);var c=$(hb[b]);c.removeClass("present future past"),jb<b?c.addClass("future"):jb>b&&c.addClass("past"),c.css("display","none"),J(a)}function M(){for(var a=ab.numberOfPageCache(),b=[],c=Math.max(0,jb-(a-1));c<Math.min(hb.length,jb+a);c++){var d=c;if(!0===pb&&(d*=2),b.push(d+1),!0===pb){var e=Math.min(mb,d+2);e!==c&&b.push(e)}}var f=_.difference(nb,b);_.each(f,function(a){L(a)}),_.each(b,function(a){K(a)}),_.isUndefined(_a)||(_a.removeClass("present"),_.isEmpty(_a.attr("class"))&&_a.removeAttr("class")),_a=$(hb[jb]),_a.removeClass("past future"),_a.addClass("present")}function N(a,c,d){var e=[];_.each(c,function(a){var b=gb[a-1];_.isUndefined(b)||e.push(b)});var f=[];if(-1!==ib&&ib!==jb&&(d=Aa(3!==arguments.length?{pageIndex:ib}:{page:d}),_.each(d,function(a){var b=gb[a-1];_.isUndefined(b)||-1==c.indexOf(a)&&f.push(b)})),!_.isEmpty(e)){switch(b.common.setActivePopupMenu(null),_.each(e,function(c){switch(c.current(!0),a){case b.Events.WILL_MOVE_PAGE:c.willAppear();break;case b.Events.PAGE_DID_CHANGE:c.appear()}}),_.each(f,function(c){switch(c.current(!1),a){case b.Events.WILL_MOVE_PAGE:c.willDisappear();break;case b.Events.PAGE_DID_CHANGE:c.disappear()}}),a){case b.Events.WILL_MOVE_PAGE:case b.Events.PAGE_DID_CHANGE:oa()}b.send(a,za(),Ba(),e)}}function O(){var a=!1;"flip"!==b.config.transition||_.isUndefined(b.config.useCoverPage)||(a=b.config.useCoverPage);var c=b.config.reversePageTurnDirection?b.project.models.length-1:0,d={width:Math.floor(b.project.models[c].width),height:Math.floor(b.project.models[c].height)},e={history:!0,mouseWheel:!0,minScale:.2,maxScale:6,transition:"flip",display:b.config.doublepage?"double":"single",pageSize:d,cover:a,pageFlipSound:!!_.isUndefined(b.config.pageFlipSound)||b.config.pageFlipSound,coverLayout:"center",transitionConfig:{}},f=b.$bookContainer.children(".book-bg");return"true"===f.attr("data-use-book-background")&&(e.coverBackground=f.attr("data-background-color")),e}function P(){b.debug||$(document.body).attr("oncontextmenu","return false;"),$("html").attr("ondragstart","event.preventDefault();"),b.topWindow().addEventListener("resize",n,!1),document.addEventListener("keydown",r,!1),document.removeEventListener("DOMMouseScroll",q,!1),document.removeEventListener("mousewheel",q,!1),fb.mouseWheel&&(document.addEventListener("DOMMouseScroll",q,!1),document.addEventListener("mousewheel",q,!1)),window.removeEventListener("hashchange",m,!1),fb.history&&window.addEventListener("hashchange",m,!1),!0===d.isTouch?(fb.disablePageMoveGesture||ab.navigationInteraction()||($(document).on("touchstart",A),$(document).on("touchmove",B),$(document).on("touchend",C)),$(document).on("gesturestart",D),$(document).on("gesturechange",D),b.$bookContainer.on("touchmove",D),b.$navbar.on("touchmove",D),b.$controlbar.on("touchmove",D),$(document).on("scroll",E),$(document.body).on(b.Events.SHOWN_DILAOG,F),$(document.body).on(b.Events.HIDDEN_DILAOG,G),b.isIOS&&(cb=new c({win:window,doc:document}),cb.enable(),b.on(b.Events.FULLSCREEN_DID_CHANGE,o))):fb.disablePageMoveGesture||ab.navigationInteraction()||($(document).on("mousedown",w),$(document).on("mousemove",x),$(document).on("mouseup",y))}function Q(a,c){b.contentStorage&&b.contentStorage.on("change:progressPageControl",oa),yb={width:window.innerWidth,height:window.innerHeight},ib=jb=-1,ma(),b.config=_.extend(b.config,a),X(b.config),S(),T(),Ta(),la(),e._initialize(),b.CommandManager.execute(b.Commands.SHOW_INTRO),b.isMobileDevice||!b.config.setDefaultFitWidth&&!b.config.bookZoom.defaultScaleMode?c():b.config.setDefaultFitWidth?this.pageFit("screen-width",c):this.pageFit(b.config.bookZoom.defaultScaleMode,c)}function R(a,c){switch(a){case"screen-width":case"screen-height":if(e.isActivated())"screen-width"===a?e.setScaleMode(e.SCALE_MODE_HORIZONTAL):"screen-height"===a&&e.setScaleMode(e.SCALE_MODE_VERTICAL),c&&c();else{var d=b.Book.getCurrentPageNumber();b.Async.doInParallel(d,function(a){var c=new $.Deferred;return b.Book.views[a-1].ready(function(){c.resolve()}),c.promise()},!1).done(function(){"screen-width"===a?e.activate({setDefaultFitWidth:!0}):"screen-height"===a&&e.activate({setDefaultFitHeight:!0}),c&&c()})}break;default:e.isActivated()&&e.deactivate(),c&&c()}}function S(){switch(_.isUndefined(ab)||_.isNull(ab)||ab.unset(),fb.transition){case"slide":ab=new g(a,fb);break;case"translucent-slide":ab=new h(a,fb);break;case"fade":ab=new i(a,fb);break;default:ab=new f(a,fb)}}function T(){var a;b.config.startPage&&(a=Number(b.config.startPage)),(_.isUndefined(a)||_.isNull(a))&&(a=k()),(_.isUndefined(a)||_.isNull(a))&&(a=j()),(_.isUndefined(a)||_.isNull(a))&&(a=_.isUndefined(fb.firstPageNumber)?1:fb.firstPageNumber),b.config.progressPageControl&&(a=_.isUndefined(fb.firstPageNumber)?1:fb.firstPageNumber),a<fb.firstPageNumber?a=fb.firstPageNumber:a>Ca().total&&(a=Ca().total),ta(a,{isLogical:!0,force:!0,init:!0})}function U(){if(TT.$el.hasClass("has-book-bg")&&TT.$el.removeClass("has-book-bg"),bb=$(".book-bg"),0===bb.length||!0!==wb||b.isMobileDevice&&!b.isLandscape()?fb.useBackground=!1:_.isUndefined(fb.coverBackground)||_.isEmpty(fb.coverBackground)||(fb.useBackground=!0),!0===fb.useBackground&&!0===fb.useBackground){bb.css("background",fb.coverBackground);var a={left:Number(bb.attr("data-offset-left")),right:Number(bb.attr("data-offset-right")),top:Number(bb.attr("data-offset-top")),bottom:Number(bb.attr("data-offset-bottom"))};xb=b.isMobileDevice?{left:parseInt(a.left/1.3),right:parseInt(a.right/1.3),top:parseInt(a.top/1.5),bottom:parseInt(a.bottom/1.5)}:a,b.$el.addClass("has-book-bg")}}function V(c){if(void 0===c)return fb;_.isEmpty(fb)&&(fb=O());var d=!1;if(fb.doublepage!==c.doublepage&&-1!==jb){ib=-1;var e=za()[0];c.doublepage?("flip"===fb.transition&&!1===fb.cover&&(jb-=e%2==0?1:0),jb=Math.floor(jb/2),"flip"===fb.transition&&!0===fb.cover&&(jb+=e%2==0?1:0)):("flip"===fb.transition&&!1===fb.cover&&(jb+=e%2==0?1:0),jb=Math.floor(2*jb),"flip"===fb.transition&&!0===fb.cover&&(jb-=e%2==0?1:0)),jb=Math.max(0,Math.min(Ba()-1,jb)),d=!0}if(b.config=fb=_.merge(fb,c),b.config.display=b.config.doublepage?"double":"single",a._isFlipTransition=wb="flip"===fb.transition,fb.doublepage?(b.$el.addClass("doublepage"),$a.addClass("doublepage"),pb=!0):(b.$el.removeClass("doublepage"),$a.removeClass("doublepage"),pb=!1),fb.bookSize={width:pb?2*fb.pageSize.width:fb.pageSize.width,height:fb.pageSize.height},na(),ab&&!1===ab.updateVisibility()){var f=$a.children().first().hasClass("container")?$a.children().first():$a;hb=f.children("section"),mb=f.children("section").find(".toast-ctrl").length,M()}if(d&&N(b.Events.WILL_MOVE_PAGE,za()),ab&&(ab.configure(fb),d)){var c={page:jb+1,direction:null};c.prev=1===c.page?null:c.page-1,c.next=c.page===mb?null:c.page+1,ab.set(c)}U(),Ta(),_.each(nb,function(a){var c=gb[a-1];if(!_.isUndefined(c)&&c.state()===b.STATUS_NONE){0!==c.$el.parent().find(".indigator").length&&b.showLoading(!1,{modal:!1,el:c.$el.parent()})}}),d&&(la(),N(b.Events.PAGE_DID_CHANGE,za()))}function W(c){if(ab&&ab.unset(),_.isUndefined(c)&&(c=b.config.doublepage),_.each(gb,function(a){a.reset()}),a.$el=$a=b.$book,a.el=$a[0],$a.children().not(".__lock__").remove(),nb=[],gb=[],a.views=gb,"flip"===TT.config.transition)for(var d=0;d<TT.project.models.length;d++){var e=TT.project.models[d],f=$("<section />"),g=$("<div />",{id:e.id,class:"toast-ctrl","data-index":d});f.append(g),$a.append(f);var h=new TT.ViewController({el:g});h._state=b.STATUS_NONE,h.index=d,gb.push(h)}else for(var d=0;d<TT.project.models.length;d++){var e=TT.project.models[d],f=$("<section />",{page:d+1}),g=$("<div />",{id:e.id,class:"toast-ctrl","data-index":d}),h=new TT.ViewController({el:g});if(h._state=b.STATUS_NONE,h.index=d,gb.push(h),c){var i=$("<div />",{class:"wrapper"});i.append(g),f.append(i)}else f.append(g);if(c&&d+1<TT.project.models.length){e=TT.project.models[d+1];var g=$("<div />",{id:e.id,class:"toast-ctrl","data-index":d+1}),i=$("<div />",{class:"wrapper"});i.append(g),f.append(i);var h=new TT.ViewController({el:g});h._state=b.STATUS_NONE,h.index=d+1,gb.push(h),d++}$a.append(f)}}function X(a){a||(a={}),W(a.doublepage);var c=$a.children().first().hasClass("container")?$a.children().first():$a;hb=c.children("section"),mb=$a.children("section").find(".toast-ctrl").length,b.isMobileDevice&&(H(),b.lazyOnce(function(){var a=b.topWindow();yb.height!==a.innerHeight&&(H(),Ta())},100,zb)),V(a)}function Y(a){if("flip"===fb.transition&&$a.turn("clear",a),a.page&&(a.page=Math.max(1,Math.min(Ba(),a.page))),X(a),"flip"===fb.transition&&($a.turn("reset",{display:fb.display,page:a.page}),ab.configure(fb)),a.page){var b=!1;_.isUndefined(a.isLogical)&&(b=a.isLogical),jb=-1,ta(a.page,{isLogical:b})}la()}function Z(){-1!==lb&&lb!==za()[0]&&ta(lb)}function aa(){if(!0===ua())return void b.DialogBar.present({content:b.config.reversePageTurnDirection?b.Strings.ALERT_LAST_PAGE:b.Strings.ALERT_FIRST_PAGE,autoDismiss:!0,dismissInterval:3e3,middle:!0,textCenter:!0,width:320,theme:"black-translucent"});b.DialogBar.dismiss({animate:!1});var a=za()[0]-1;"double"===fb.display&&(a-=1,!0===fb.cover&&(a=Math.max(1,a))),qa(a)}function ba(){if(!0===va())return void b.DialogBar.present({content:b.config.reversePageTurnDirection?b.Strings.ALERT_FIRST_PAGE:b.Strings.ALERT_LAST_PAGE,autoDismiss:!0,dismissInterval:3e3,middle:!0,textCenter:!0,width:320,theme:"black-translucent"});b.DialogBar.dismiss({animate:!1});var a=za()[0]+1;"double"===fb.display&&("flip"!==fb.transition||!1===fb.cover||!0===fb.cover&&!0!==ua())&&(a+=1),qa(a)}function ca(){qa(1)}function da(){qa(Ba())}function ea(a){if(fa(),b.isMobileDevice){if(b.InputBar.isPresent())return;b.InputBar.present({maxWidth:320}).done(function(a){ta(a,{isLogical:!0,silent:!1})})}else{var c=TT.$el.find('[command="moveToUserInputPage"]:focus');c.length?(TT.$currentPagelabel=c.find(".label-page"),TT.$currentPageInput=c.find(".input-page")):(TT.$currentPagelabel=TT.$pagelabel,TT.$currentPageInput=TT.$pageInput),TT.$currentPagelabel.hide(),TT.$currentPageInput.show(),TT.$currentPageInput.focus(),TT.$currentPageInput.on("focusout",fa),TT.$currentPageInput.on("keydown",ha),b._msieVersion&&b._msieVersion<10&&$(document).on("click",ga)}}function fa(){$(document).off("click",ga),TT.$pageInput.off("focusout",fa),TT.$pageInput.off("keydown",ha),TT.$pagelabel.show(),TT.$pageInput.val(""),TT.$pageInput.hide()}function ga(a){$(a.target).hasClass("background")&&fa()}function ha(a){if(a.keyCode==b.KeyEvent.DOM_VK_RETURN){a.stopPropagation(),a.preventDefault();var c=$(a.target).val();fa(),_.isEmpty(c)||(c=c.replace(/<\/?[^>]+(>|$)/g,""),ta(c,{isLogical:!0,silent:!1}))}}function ia(){ja(!fb.doublepage)}function ja(a){b.send(b.Events.WILL_DISPLAY_PAGE);var c=fb.doublepage;if("flip"!==fb.transition){var d=Pa();_.each(d,function(a){!0===c&&(a*=2),J(a),!0===c&&J(a+1)}),W(a)}V({doublepage:a}),a?b.$toggleDoublePage.addClass("active"):b.$toggleDoublePage.removeClass("active"),b.send(b.Events.DOUBLEPAGE_DID_CHANGE,a)}function ka(){return pb}function la(){var a=wa();b.config.continuePageNavigation||(b.$first.tt_disable(),b.$prev.tt_disable(),b.$next.tt_disable(),b.$last.tt_disable(),a.prev&&(b.$first.tt_enable(),b.$prev.tt_enable()),a.next&&(b.$last.tt_enable(),b.$next.tt_enable()));var c=Ca();if(fb.reversePageTurnDirection){var d=c.total+fb.firstPageNumber-c.current;c.current=Math.max(fb.firstPageNumber,d-(za().length-1)),c.current=Da(c.current)}else c.current=Da(c.current);var e=[c.current];"double"===fb.display&&c.total>=e[0]+1&&(ua()&&!0===fb.cover&&"flip"===fb.transition||e.push(c.current+1)),Ea(e,c.total),fa()}function ma(a){if(b.config.progressPageControl&&b.contentStorage){if(!arguments.length){var c=b.contentStorage.findWhere({id:"lastMaxPageIndex"});a=c?c.get("lastMaxPageIndex"):0}var d=Math.max(kb,a);if(kb!==d){kb=d;var c=b.contentStorage.findWhere({id:"lastMaxPageIndex"});c?(c.set("lastMaxPageIndex",kb),b.contentStorage.updateItem(c)):b.contentStorage.addItem({id:"lastMaxPageIndex",doublepage:fb.doublepage,lastMaxPageIndex:kb})}}}function na(){if(b.config.progressPageControl&&b.contentStorage){var a=b.contentStorage.findWhere({id:"lastMaxPageIndex"});if(a&&a.get("doublepage")!==fb.doublepage){var c=za()[0];fb.doublepage?("flip"===fb.transition&&!1===fb.cover&&(kb-=c%2==0?1:0),kb=Math.floor(kb/2),"flip"===fb.transition&&!0===fb.cover&&(kb+=c%2==0?1:0)):("flip"===fb.transition&&!1===fb.cover&&(kb+=c%2==0?1:0),kb=Math.floor(2*kb),"flip"===fb.transition&&!0===fb.cover&&(kb-=c%2==0?1:0)),kb=Math.max(0,Math.min(Ba()-1,kb)),a.set("doublepage",fb.doublepage),a.set("lastMaxPageIndex",kb),b.contentStorage.updateItem(a)}}}function oa(){if(b.config.progressPageControl&&b.contentStorage){var a=za();_.each(a,function(a){var c=gb[a-1];if(db=b.contentStorage.findWhere({pageID:c.collection.id,progressPageControl:!0}))return!1}),b.__nextPageMoveLocked__=!!db}}function pa(){var a=!0;return _.each(za(),function(b){var c=gb[b-1];return!c||(_.isUndefined(c.config().zoomDisabled)||!0!==c.config().zoomDisabled?(a=!0,!1):void(a=!1))}),!a}function qa(a,c){if(!(jb>=0&&(Ba()<a||a<1))){var d=Math.max(0,Math.min(Ba()-1,a-1));if("double"===fb.display&&(d=Math.floor(d/2),"flip"===fb.transition&&!0===fb.cover&&(d+=a%2==0?1:0)),d!==jb&&ab.canNavigationInteraction()){if(fb.progressPageControl&&b.contentStorage){if(kb+1<d)return void b.DialogBar.present({autoDismiss:!0,dismissInterval:99999,titleIcon:"fa fa-info-circle",title:b.Strings.ALERT_TITLE,content:"<b>"+b.StringUtils.format(eb.ERROR_NOT_VIEWABLE_PAGE_NUMBER,za({pageIndex:d,isLogical:!0})[0])+"</b>"});if(kb<d&&db)return void b.DialogBar.present({autoDismiss:!0,dismissInterval:99999,titleIcon:"fa fa-info-circle",title:b.Strings.ALERT_TITLE,content:"<b>"+db.get("alert")+"</b>"})}e.isActivated()&&(fb.resetBookZoomOnPageChange?e.deactivate():b.isMobileDevice&&b.BookZoom.getCurrentScales().zoom<1.2&&e.deactivate()),_.isNull(rb)||Xa(),-1!==jb&&(lb=za()[0]),ib=jb,jb=d,ma(jb),!1===ab.updateVisibility()&&M(),!1!==ab.updateVisibility()&&-1!=ib||N(b.Events.WILL_MOVE_PAGE,za()),c=_.extend({},c),c.page=d+1,c.prev=1===c.page?null:c.page-1,c.next=c.page===mb?null:c.page+1,c.direction=ib>jb?"left":"right",ab.set(c),0==jb&&-1==ib?ab.move(c):ib-1===jb?ab.previous(c):ib+1===jb?ab.next(c):ab.move(c),!1===ab.updateVisibility()?(la(),N(b.Events.PAGE_DID_CHANGE,za())):-1==ib&&(ib=0,N(b.Events.PAGE_DID_CHANGE,za()))}}}function ra(a,c){if(jb>=0&&(Ba()<a||a<1))return!1;var d=Math.max(0,Math.min(Ba()-1,a-1));if("double"===fb.display&&(d=Math.floor(d/2),"flip"===fb.transition&&!0===fb.cover&&(d+=a%2==0?1:0)),fb.progressPageControl&&b.contentStorage){if(kb+1<d)return!1;if(kb<d&&db)return!1}return!0}function sa(a,b){if(!(Ba()<a||a<1)){b||(b={});var c=Math.max(0,Math.min(Ba()-1,a-1));"double"===fb.display&&(c=Math.floor(c/2),"flip"===fb.transition&&!0===fb.cover&&(c+=a%2==0?1:0)),(c!==jb||b.force)&&(fb.resetBookZoomOnPageChange&&e.isActivated()&&e.deactivate(),_.isNull(rb)||Xa(),-1!==jb&&(lb=za()[0]),ib=jb,jb=c,ma(jb),!1===ab.updateVisibility()&&(M(),la()))}}function ta(a,c){if(c=_.extend({isLogical:!1,silent:!0},c),isNaN(a)){var d=b.project.findPage({name:"label",value:a});d&&(a=d.index+1)}var e=a;if(!0===c.isLogical){e-=fb.firstPageNumber-1}if(fb.reversePageTurnDirection&&(e=mb+1-e),b.DialogBar.dismiss({animate:!1}),isNaN(Number(a))){if(c.silent)return;b.DialogBar.present({titleIcon:"fa fa-exclamation-triangle",autoDismiss:!0,dismissInterval:5e3,title:eb.ERROR,content:"<b>"+b.StringUtils.format(eb.ERROR_NOT_VALID_PAGE_NUMBER,String(a))+"</b>"})}else if(e<1||e>Ba()){if(c.silent)return;e=za()[0],b.lazy(function(){b.DialogBar.present({titleIcon:"fa fa-exclamation-triangle",autoDismiss:!0,dismissInterval:5e3,title:eb.ERROR,content:"<b>"+b.StringUtils.format(eb.ERROR_NOT_VALID_PAGE_NUMBER,a)+"</b>"})},5)}else if(!c.force&&La(e)){if(c.silent)return;b.DialogBar.present({content:b.Strings.ALERT_PAGE_ALREADY_OPEN,autoDismiss:!0,dismissInterval:3e3,middle:!0,textCenter:!0,width:250,theme:"black-translucent"})}else qa(e,c)}function ua(){return 0===jb||-1===jb}function va(){return"flip"===fb.transition&&ka()&&!0===fb.cover?za()[0]+Ba()%2===Ba():ka()&&Ba()%2==0?za()[0]+1===Ba():za()[0]===Ba()}function wa(){return{prev:jb>0,next:!va()}}function xa(a){0==arguments.length&&(a=!0),qb=a,$a&&$a.turn("disabled",!a)}function ya(a){if(b.config.htmlRender)return!0;var c=za()[0];return c===a||("flip"!==fb.transition||!ka()||!ua()||!0!==fb.cover)&&("double"===fb.display&&c+1===a)}function za(a){return Aa(_.extend({isLogical:!1,pageIndex:jb},a))}function Aa(a){a=_.extend({isLogical:!1,pageIndex:jb},a);var b,c=[];return a.page?b=Math.max(1,a.page):(b=Math.max(1,a.pageIndex+1),"double"===fb.display&&(b=2*b-1,!0===fb.cover&&"flip"===fb.transition&&(b-=1))),b=Math.max(1,Math.min(Ba(),b)),a.isLogical?c.push(Fa(b)):c.push(b),"double"===fb.display&&Ba()>=b+1&&(1===b&&!0===fb.cover&&"flip"===fb.transition||(a.isLogical?c.push(Fa(b+1)):c.push(b+1))),c}function Ba(){return mb}function Ca(){var a={current:za()[0],total:Ba()},b=fb.firstPageNumber-1;return a.current=za()[0]+b,a.total=Ba()+b,a}function Da(a){return b.hook.getDisplayPageNumber&&"function"==typeof b.hook.getDisplayPageNumber?b.hook.getDisplayPageNumber(a):a}function Ea(a,c){b.hook.setDisplayPageLabel&&"function"==typeof b.hook.setDisplayPageLabel?b.hook.setDisplayPageLabel(a,c):fb.reversePageTurnDirection?b.$pagelabel.text(c+" / "+a[0]):b.$pagelabel.text(a[0]+" / "+c)}function Fa(a){var b=fb.firstPageNumber-1;return fb.reversePageTurnDirection?mb+1-a+b:a+b}function Ga(a){var b=fb.firstPageNumber-1;return fb.reversePageTurnDirection?mb+1-(a-b):a-b}function Ha(){return $a}function Ia(a){var b={page:{width:0,height:0},fit:{width:$a.width(),height:$a.height()}},c=za();if(ka()){var d;if(1===c.length)d=gb[c[0]-1];else{var e=gb[c[0]-1],f=gb[c[1]-1];d=Math.max(e.collection.width,e.collection.height)<Math.max(f.collection.width,f.collection.height)?f:e}b.page.width=d.collection.width,b.page.height=d.collection.height,b.page.background=d.collection.background}else{var d=gb[c[0]-1];b.page.width=d.collection.width,b.page.height=d.collection.height,b.page.background=d.collection.background}return wb&&Ka()&&(b.fit.width/=2),b}function Ja(a){var b=[];if("flip"===fb.transition){var c=$a.turn("view"),d=$a.data().pages;return _.each(c,function(c){if(!_.isUndefined(d[c])){var e=d[c].closest("[page]");!0===a&&(e=e.clone(!0,!0),e.bookTransform("")),b.push(e)}}),b}if(!0===a){var e=_a.clone(!0,!0);e.bookTransform(""),b.push(e)}else _a&&b.push(_a);return b}function Ka(){return $a.parent().hasClass("cover")}function La(a){return isNaN(a)||(a=Number(a)),!!_.find(za(),function(b){if(b===a)return!0})}function Ma(){return hb}function Na(){return jb}function Oa(a){ib=jb,"previous"===a?jb-=1:"next"===a&&(jb+=1)}function Pa(){return nb}function Qa(a,c){if(!b.config.htmlRender){var d;if(d=a instanceof b.ViewController?a:gb[a-1],!_.isUndefined(d)&&d.state()!==b.STATUS_NONE&&!Ra(d))return d.parentView&&!d.scaleContent?(d.$el.css({width:"100%",height:"100%"}),void d.$contents.css({width:"100%",height:"100%"})):void d.layout()}}function Ra(c){return!(!b.theme||!b.theme._context.layoutPage)&&b.theme._context.layoutPage(a,c)}function Sa(){var a=$a.parent(),b={width:a.width(),height:a.height()},c={width:fb.bookSize.width,height:fb.bookSize.height};if(!wb&&!pb){var d;d=pb?2*Na():Na();var e=gb[d];e&&(c.width=e.collection.width,c.height=e.collection.height)}var f=Math.min(b.width/c.width,b.height/c.height),g=parseInt(c.width*f);g+=g%2,g+=g/2%2*2;var h=parseInt(c.height*f);return h+=h%2,{width:g,height:h}}function Ta(){if($a){if(!Va()){var a=$a.parent(),b=Sa(),c=b.width,d=b.height,e=parseInt((a.width()-c)/2);e+=e%2;var f=parseInt((a.height()-d)/2);if(f+=f%2,$a.css({left:e+"px",top:f+"px",width:c+"px",height:d+"px"}),$a.attr({"data-left":e,"data-top":f,"data-width":c,"data-height":d}),fb.useBackground){var g,h,i,j;g=e-xb.left,h=f-xb.top,i=c+xb.left+xb.right,j=d+xb.top+xb.bottom,bb.css({left:g+"px",top:h+"px",width:i+"px",height:j+"px"}),bb.children().eq(0).css({left:i-(c+xb.left+10)+"px",right:i-(c+xb.right+10)+"px",top:j-(d+xb.top-12)+"px",bottom:j-(d+xb.top-12)+"px"}),bb.children().eq(1).css({left:i-(c+xb.left+8)+"px",right:i-(c+xb.right+8)+"px",top:j-(d+xb.top-8)+"px",bottom:j-(d+xb.top-8)+"px"}),bb.children().eq(2).css({left:i-(c+xb.left+5)+"px",right:i-(c+xb.right+5)+"px",top:j-(d+xb.top-5)+"px",bottom:j-(d+xb.top-5)+"px"}),bb.is(":visible")||bb.show()}else bb.is(":visible")&&bb.hide();_.isUndefined(ab)||_.isNull(ab)||ab.layout()}var k=_.difference(za(),nb);k=nb.concat(k),_.each(k,function(a){Qa(a)})}}function Ua(a){ab.restoreLayoutFromZoomActiveState(a),Ta()}function Va(){if(!b.theme||!b.theme._context.layoutBook)return!1;var c=[];return _.each(za(),function(a){var d=gb[a-1];d&&d.state()!==b.STATUS_NONE&&c.push(d)}),b.theme._context.layoutBook(a,c)}function Wa(){_.isNull(rb)&&(rb=$a.children(".book-overlay"),_.isUndefined(rb[0])&&(rb=$("<div />",{class:"book-overlay"}),$a.append(rb),rb.on("click",Ya)))}function Xa(){_.isNull(rb)||(rb.off("click",Ya),rb.remove(),rb=null)}function Ya(){rb&&(rb.off("click",Ya),rb.remove(),rb=null)}function Za(a){var c;return b.view?c=b.view._find(a):_.each(gb,function(b){if(c=b._find(a))return!1}),!c&&b.popups&&_.each(b.popups,function(b){if(c=b.viewController._find(a))return!1}),c}var $a,_a,ab,bb,cb,db,eb=b.Strings,fb={},gb=[],hb=[],ib=-1,jb=0,kb=-1,lb=-1,mb=0,nb=[],ob=0,pb=!1,qb=!0,rb=null,sb={startX:0,startY:0,count:0,captured:!1,threshold:b.isMobileDevice?40:100},tb=(new Date).getTime(),ub=!1,vb=!1,wb=!0,xb={left:0,right:0,top:0,bottom:0},yb={},zb={};b.ready(function(){b.config.htmlRender||(P(),b.CommandManager.registerInternal(b.Commands.MOVE_TO_USER_INPUT_PAGE,ea),b.CommandManager.registerInternal(b.Commands.PREVIOUS_PAGE,aa),b.CommandManager.registerInternal(b.Commands.NEXT_PAGE,ba),b.CommandManager.registerInternal(b.Commands.FIRST_PAGE,ca),b.CommandManager.registerInternal(b.Commands.LAST_PAGE,da),b.CommandManager.registerInternal(b.Commands.TOGGLE_DOUBLEPAGE,ia),b.CommandManager.registerInternal(b.Commands.DOUBLEPAGE,ja))}),b.Book=a,b.Book.BookCommon=d,a.start=Q,a.set=X,a.configure=V,a.reset=Y,a.back=Z,a.previous=aa,a.next=ba,a.moveToFirst=ca,a.moveToLast=da,a.move=ta,a._movable=ra,a.updatePageNo=sa,a.views=gb,a.find=Za,a.getCurrentPageNumber=za,a.getTotalPageNumber=Ba,a.getLogicalPageNumber=Ca,a.toLogicalPageNumber=Fa,a.pageFromLogicalPageNumber=Ga,a.getDisplayPageNumber=Da,a.isFirstPage=ua,a.isLastPage=va,a.isDoublePage=ka,a.availablePageNavigation=wa,a.availableCurrentPage=ya,a.enableAction=xa,a.$getBook=Ha,a.getCurrentPage=Ja,a.isCoverPage=Ka,a.getPages=Ma,a.getCurrentPageIndex=Na,a.getVisiblePages=Pa,a.getBookSize=Ia,a._getBestSize=Sa,a.turnByUserAction=Oa,a.fitPage=Qa,a.layout=Ta,a.restoreLayoutFromZoomActiveState=Ua,a._changeSize=p,a._loadPage=I,a._unloadPage=J,a._addOverlay=Wa,a._removeOverlay=Xa,a._isFlipTransition=wb,a._updateElements=la,a.pageFit=R,a._sendPageChangeEvent=N,a._updateProgressPageControl=oa,a._zoomDisabled=pa}),define("toast/core2",["./core","./core/Model","./core/Collection","./core/Contents","./core/Project","./core/Assets","./core/Storage","./core/Factory","./core/ViewController","./core/book/Book"],function(a){a.dispatchReady(a.CORE_READY)}),define("toast/dialogs/DefaultDialogs",["exports","../core"],function(a,b){"use strict";a.DIALOG_ID_ERROR="error-dialog",a.DIALOG_ID_INFO="error-dialog",a.DIALOG_ID_SAVE_CLOSE="save-close-dialog",a.DIALOG_ID_OK_CANCEL="ok-cancel-dailog",a.DIALOG_ID_OK="ok-dailog",b.DefaultDialogs=a}),define("toast/dialogs/Dialog",["exports","../core","./DefaultDialogs"],function(a,b,c){"use strict";function d(a,b){a.data("buttonId",b),a.modal("hide")}function e(a,b,c){c?d(a,b):a.triggerHandler("buttonClick",b)}function f(a,b,c){if(this._$dlg=a,this._promise=b,c){var d={isMouseDown:!1,mouseOffset:{}},e=this.getElement();this.getElement().find(".modal-header").addClass("draggable").on("mousedown",function(a){d.isMouseDown=!0;var b=e.offset();d.mouseOffset={top:a.clientY-b.top,left:a.clientX-b.left}}),this.getElement().on("mouseup mouseleave",function(a){d.isMouseDown=!1}),$(document.body).on("mousemove",{dialog:this},function(a){d.isMouseDown&&e.offset({top:a.clientY-d.mouseOffset.top,left:a.clientX-d.mouseOffset.left})})}}function g(){var a,b,c=$(".modal-inner-wrapper > .instance");c.length>0&&(a=$("body").width(),b=$("body").height(),c.css({"max-width":a,"max-height":b,overflow:"auto"}))}function h(a,b,d){var e=new $.Deferred,f=[],g=d.className;return g===c.DIALOG_ID_OK_CANCEL&&f.push({className:r,id:n,text:m.CANCEL}),f.push({className:q,id:o,text:m.OK}),j(g,b,a,f).done(function(a){a===n?e.reject():a===o?e.resolve(a):e.reject()}),e.promise()}function i(a,b,c,d){void 0===b&&(b=!0);var h=$("<div />",{class:"modal-wrapper"});d&&h.addClass("modal-wrapper-black"),h.append('<div class="modal-inner-wrapper"></div>'),$("body").append(h);var i=new $.Deferred,j=i.promise(),k=$(a).addClass("instance").appendTo(".modal-inner-wrapper:last");return g(),k.data("promise",j),k.one("hidden.bs.modal",function(){var a=k.data("buttonId");a||(a=n),window.setTimeout(function(){i.resolve(a)},0),k.remove(),$(".modal-wrapper:last").remove()}).one("shown.bs.modal",function(){var a=k.find(".primary:enabled"),b=k.find(".modal-footer .dialog-button:enabled:eq(0)");a.length?a.focus():b.length?b.focus():document.activeElement.blur()}),k.on("click.bs.modal",".dialog-button",function(a){e(k,$(this).attr("data-button-id"),b)}),k.modal({backdrop:"static",show:!0,selector:".modal-inner-wrapper:last",keyboard:!1}).css("z-index",t+1).next().css("z-index",t),t+=2,new f(k,j,c)}function j(a,c,d,e,f,g,h){var j={modalClassName:a,title:c||"",content:d||"",buttons:e||[{className:q,id:o,text:m.OK}]};return _.each(e,function(a){a.className&&a.className===s&&(a.className=r+" "+s)}),i(Mustache.render(b.HtmlLoader.Dialog,j),f,g,h)}function k(a,b,d){return h(a,b,{className:c.DIALOG_ID_OK_CANCEL})}function l(a,b,d){return b||(b=m.ALERT_TITLE),h(a,b,{className:c.DIALOG_ID_OK})}var m=b.Strings,n="cancel",o="ok",p="_canceled",q="btn-primary",r="btn-default",s="pull-left",t=1050;f.prototype.getElement=function(){return this._$dlg},f.prototype.getPromise=function(){return this._promise},f.prototype.close=function(){this._$dlg.is(":visible")&&d(this._$dlg,p)},f.prototype.done=function(a){this._promise.done(a)},window.addEventListener("resize",g),a.DIALOG_BTN_CANCEL=n,a.DIALOG_BTN_OK=o,a.DIALOG_BTN_DONTSAVE="dontsave",a.DIALOG_BTN_CLOSE_AFTER_SAVE="close_after_save",a.DIALOG_BTN_SAVE_AS="save_as",a.DIALOG_CANCELED=p,a.DIALOG_BTN_DOWNLOAD="download",a.DIALOG_BTN_CLASS_PRIMARY=q,a.DIALOG_BTN_CLASS_SUCCESS="btn-success",a.DIALOG_BTN_CLASS_DANGER="btn-danger",a.DIALOG_BTN_CLASS_NORMAL=r,a.DIALOG_BTN_CLASS_LEFT=s,a.showModalDialog=j,a.showModalDialogUsingTemplate=i,a.confirm=k,a.alert=l,b.Dialog=a}),define("text!toast/html-templates/spin-dialog-template.html",[],function(){return'<div class="spinner-wrap">\n\t<div class="spinner-container" style="height:44px;"></div>\n\t<div class="message" style="text-align:center"></div>\n\t<div class="progress">\n\t\t<div class="progress-bar" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">\n\t\t\t<span class="sr-only">0% Complete</span>\n\t\t</div>\n\t</div>\n</div>\n\n'}),define("toast/dialogs/SpinDialog",["../core","./Dialog","text!toast/html-templates/spin-dialog-template.html"],function(a,b,c){"use strict";var d=a.Strings,e=a.Spinner,f={dialog:null,$template:null,options:{width:400}};return _.extend(f,{show:function(f,g,h,i){i=i||{cancel:null};var j=new $.Deferred;if(void 0!=$(".spin-dialog").get(0))return setTimeout(function(){j.reject()},1),j.promise();var k=Mustache.render(c);this.$template=$(k),f&&f.length>0&&this.$template.find(".message").html(f);var l={width:2,top:f&&0!=f.length||g&&0!=g.length?"30%":"50%"},m=this.$template.find(".spinner-container"),n=new e(l).spin();m.append(n.el);var o=null;return i.cancel&&(o=[{className:b.DIALOG_BTN_CLASS_NORMAL,id:b.DIALOG_BTN_CANCEL,text:d.CANCEL}]),this.dialog=b.showModalDialog("spin-dialog",g,this.$template[0].outerHTML,o,!i.cancel),a._msieVersion&&a._msieVersion<10?a.lazy(function(){j.resolve()},5):this.dialog.getElement().one("shown.bs.modal",function(){j.resolve()}),g&&0!=g.length?this.dialog.getElement().find(".close").remove():this.dialog.getElement().find(".modal-header").remove(),this.$progress=this.dialog.getElement().find(".progress"),this.$progressbar=this.$progress.find(".progress-bar"),h||this.$progress.css("display","none"),i.cancel?(this.dialog.getElement().find(".modal-footer").css("textAlign","center"),this.dialog.getElement().on("buttonClick",$.proxy(this._onCancelClick,this,i.cancel))):this.dialog.getElement().find(".modal-footer").remove(),this.dialog.getElement().children(".modal-dialog").css("width",this.options.width),j.promise()},showProgress:function(){this.$progress.css("display","")},hideProgress:function(){this.$progressbar.attr("aria-valuenow",0),this.$progressbar.css("width","0%"),this.$progressbar.find(".sr-only").text(""),this.$progress.css("display","none")},updateProgress:function(a){"none"==this.$progress.css("display")&&this.showProgress(),this.$progressbar.attr("aria-valuenow",a),this.$progressbar.css("width",a+"%"),this.$progressbar.children().text(a+"% Complete")},updateMessage:function(a,b){this.dialog.getElement().find(".modal-header .modal-title").html(b),this.dialog.getElement().find(".modal-body .message").html(a)},enableCancelButton:function(a){!0===a?this.dialog.getElement().find('.modal-footer [data-button-id"'+b.DIALOG_BTN_CANCEL+'"]').find("#"+b.DIALOG_BTN_CANCEL).tt_enable():this.dialog.getElement().find('.modal-footer [data-button-id="'+b.DIALOG_BTN_CANCEL+'"]').tt_disable()},hideCancelBlock:function(){this.dialog.getElement().find(".modal-footer").remove()},hide:function(){var a=new $.Deferred;return this.dialog.getElement().is(":visible")?(this.dialog.getElement().one("hidden.bs.modal",function(){a.resolve()}),this.dialog.close()):a.resolve(),a.promise()},_onCancelClick:function(a,b,c){a&&a()}}),a.SpinDialog=f}),define("toast/dialogs",["./core","./dialogs/DefaultDialogs","./dialogs/Dialog","./dialogs/SpinDialog"],function(a){}),define("toast/views_/DialogBar",["exports","../core"],function(a,b){"use strict";function c(a){switch(a.keyCode){case b.KeyEvent.DOM_VK_ESCAPE:l()}}function d(a){$(a.target).closest(".dialog-bar-content").length||q.autoDismiss&&l()}function e(){q.autoDismissWhenChangingOrientation&&($("input, textarea").blur(),l())}function f(a){l()}function g(a){window.innerHeight<p.height()?p.css({overflow:"auto",height:window.innerHeight}):q.modal?p.height("100%"):p.css({overflow:"",height:""})}function h(a){l({buttonId:a})}function i(i){if(i=_.extend({autoDismissWhenChangingOrientation:!0},i),q=i,r){if(!i.dismiss)return;l({animate:!1})}m=new $.Deferred,n&&(clearTimeout(n),n=null),_.isUndefined(p)||_.isNull(p)||0===p.length||(p.remove(),p=null);var j={modalClassName:i.modalClassName||"",maxWidth:i.maxWidth||"",titleIcon:i.titleIcon||"",title:i.title||"",content:i.content||"",leftButtons:i.leftButtons||[],rightButtons:i.rightButtons||[]},k=Mustache.render(o,j);if(p=$(k),$(document.body).append(p),_.isEmpty(j.leftButtons)&&_.isEmpty(j.rightButtons)&&p.find(".footer").hide(),_.isEmpty(j.title)&&p.find(".header").hide(),$(document.body).addClass("show-bookmark-dialog-bar"),i.attrs&&_.each(i.attrs,function(a){p.attr(a)}),i.maxWidth&&p.css("maxWidth",i.maxWidth),i.theme&&p.addClass(i.theme),i.width&&p.find(".container").css("width",i.width),i.textCenter&&p.find(".body").addClass("text-center"),i.middle?(p.addClass("vertical-middle"),p.css("opacity",0)):p.css("top",-p.height()+"px"),!b.isMobileDevice&&b.$el){var s=(b.$el.width()-b.$bookContainer.width())/2;s-=b.$bookContainer.offset().left,p.css("marginLeft",-s)}p.show();var t=$.Event(b.Events.SHOW_DILAOG);return p.trigger(t),q.autoDismiss&&$(document).on(b.__eventTypes__.start,d),$(document).on("keydown",c),p.find(".dialog-button").on("click",function(a){h($(this).attr("data-button-id"))}),p.find(".close").on("click",f),b.on(b.Events.ORIENTATION_DID_CHANGE,e),$(window).on("resize",g),g(),i.middle?p.animate({opacity:1},250,function(){if(p){var a=$.Event(b.Events.SHOWN_DILAOG);p.trigger(a)}}):p.animate({top:0},250,function(){if(p){var a=$.Event(b.Events.SHOWN_DILAOG);p.trigger(a)}}),r=!0,i.dismissInterval&&(n=setTimeout(function(){n=null,r&&l()},i.dismissInterval)),a.$el=p,m.promise()}function j(){return r}function k(a){if(m.resolve(a.buttonId),p){var c=$.Event(b.Events.HIDDEN_DILAOG);p.trigger(c),p.remove(),p=null}$(document.body).removeClass("show-bookmark-dialog-bar"),r=!1}function l(a){if(r){a=_.extend({animate:!0},a),n&&(clearTimeout(n),n=null),q.autoDismiss&&$(document).off(b.__eventTypes__.start,d),$(document).off("keydown",c),$(window).off("resize",g),b.off(b.Events.ORIENTATION_DID_CHANGE,e);var f=$.Event(b.Events.HIDE_DILAOG);p.trigger(f),q.middle?a.animate?p.animate({opacity:0},250,function(){k(a)}):k(a):a.animate?p.animate({top:-(p.height()+5)},250,function(){k(a)}):k(a)}}a.DIALOG_BAR_ID_INFO="info-dailog-bar",a.DIALOG_BAR_ID_OK_CANCEL="ok-cancel-dailog-bar",a.DIALOG_BAR_ID_OK="ok--dailog-bar";var m,n,o=(b.Strings,'<div class="dialog dialog-bar {{modalClassName}}"><div class="container"><div class="dialog-bar-content"><div class="header"><span class="title-icon {{titleIcon}}"></span><div class="title">{{title}}</div><button type="button" class="btn close"><span class="icon_close"></span></button><hr></div><div class="body">{{{content}}}</div><div class="footer"><div class="btn-group">{{#leftButtons}}<button class="dialog-button btn {{className}}" data-button-id="{{id}}">{{#icon}}<span class="{{icon}}"></span>{{/icon}} <span class="btn-title">{{text}}</span></button>{{/leftButtons}}</div><div class="btn-group pull-right">{{#rightButtons}}<button class="dialog-button btn {{className}}" data-button-id="{{id}}">{{#icon}}<span class="{{icon}}"></span>{{/icon}} <span class="btn-title">{{text}}</span></button>{{/rightButtons}}</div></div></div></div></div>'),p=null,q={},r=!1;a.$el=p,a.present=i,a.isPresent=j,a.dismiss=l,b.DialogBar=a}),define("toast/views_/InputBar",["exports","../core"],function(a,b){"use strict";function c(a){switch(a.keyCode){case b.KeyEvent.DOM_VK_RETURN:a.preventDefault(),d();break;case b.KeyEvent.DOM_VK_ESCAPE:g()}}function d(){k=h.find("input").val(),j=!0,g()}function e(a){a||(a={}),i=new $.Deferred,b.Book.enableAction(!1),j=!1,k="",_.isUndefined(h)||_.isNull(h)||0===h.length||(h.remove(),h=null);var e=Mustache.render(b.HtmlLoader.InputBar,{Strings:TT.Strings,theme:TT.theme});return h=$(e),a.maxWidth&&h.css("maxWidth",a.maxWidth),TT.$el.append(h),h.find(".btn-ok").on("click",d),h.find("input").on("keydown",c),h.find(".close").on("click",g),TT.$navbar.addClass("hide"),h.animate({top:0},250,function(){h.find("input").focus()}),l=!0,i.promise()}function f(){return l}function g(){l&&(h.find("input").blur(),b.Book.enableAction(!0),h.find("input").val(""),h.animate({top:-(h.height()+5)},250,function(){TT.$navbar.removeClass("hide"),h.remove(),h=null,b.lazy(function(){j&&!_.isEmpty(k)?i.resolve(k):i.reject(),l=!1},50)}))}var h,i,j,k,l=!1;a.present=e,a.isPresent=f,a.dismiss=g,b.InputBar=a}),define("toast/views_",["./core","./views_/DialogBar","./views_/InputBar"],function(a){}),define("toast/widgets/WidgetDataManager",["exports","../core"],function(a,b){function c(){var a;a=b.hook.widgetDataManager&&b.hook.widgetDataManager.loadAll&&"function"==typeof b.hook.widgetDataManager.loadAll?b.hook.widgetDataManager.loadAll({url:b.config.widgetDataManager.url,projectID:b.project.id}):$.ajax({url:b.config.widgetDataManager.url,type:"POST",data:{command:"list",projectID:b.project.id},dataType:"html"}),a.done(function(a){try{a&&"string"==typeof a&&(a=JSON.parse(a),a.pages||(a.pages=[]),i=new Backbone.Model(a))}catch(a){i.set("projectID",b.project.id)}d(b.Book.getCurrentPageNumber())}),a.fail(function(){i.set("projectID",b.project.id),d(b.Book.getCurrentPageNumber())})}function d(a){h&&e(h),_.isEmpty(i.get("pages"))||_.each(a,function(a){var c=b.Book.views[a-1];c.ready(function(){var a=_.find(i.get("pages"),{pageID:c._model.id});a&&a.contents&&a.contents.length&&_.each(a.contents,function(a){var b=c.find("id",a.widgetId);b&&b.view&&b.view.setWidgetData(a)})})}),h=a}function e(a){var c,d={projectID:b.project.id,pages:[]};if(_.each(a,function(a){var e=b.Book.views[a-1];c={pageID:e._model.id,pageNo:a,contents:[]};var f;_.each(e.findAll(),function(a){if(a.widget){f||(f=a.view.widgetDataModifed());var b=a.view.getWidgetData();a.view.widgetDataModifed(!1),_.isEmpty(b)||c.contents.push(b)}}),f&&d.pages.push(c)}),!_.isEmpty(d.pages)){var e={projectID:d.projectID,pages:[]};if(_.each(d.pages,function(a){var b=_.find(i.get("pages"),{pageID:a.pageID});b?(!a.contents.length&&b.contents.length?e.pages.push(_.extend({empty:!0},a)):e.pages.push(a),_.extend(b,a)):a.contents.length&&(e.pages.push(a),i.get("pages").push(a))}),!e.pages.length)return;$.ajax({url:b.config.widgetDataManager.url,type:"POST",data:{command:"update",data:JSON.stringify(e)},dataType:"html"}).done(function(a){}).fail(function(){})}}function f(a,b){d(a)}function g(){_.isEmpty(b.config.widgetDataManager)||_.isEmpty(b.config.widgetDataManager.url)||(b.on(b.Events.WILL_MOVE_PAGE,f),c(),$(window).blur(function(){e(b.Book.getCurrentPageNumber())}))}var h,i=new Backbone.Model({pages:[]});b.projectLoaded(function(){__app__||_.isEmpty(b.config.widgetDataManager.url)||-1===b.config.widgetDataManager.url.indexOf("://")&&"//"!==b.config.widgetDataManager.url.substr(0,2)&&(b.config.widgetDataManager.url="//"+b.config.widgetDataManager.url)}),b.ready(function(){g()})}),define("toast/widgets/UIWidgetPrivate",["../core","../views/UIView"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a){this.style=_.extend({},c.style,this.style),this.label=this.model.label,this.$el.attr("data-widget-private-id",this.model.widgetPrivateID),c.initialize.call(this,a)}}),a.UIWidgetPrivate=d}),define("toast/widgets/UIWidget",["../core","../views/UIView"],function(a,b){"use strict";var c=(a.Strings,b.prototype),d=b.extend();return _.extend(d.prototype,c,{widget:!0,widgetDataModifed:function(a){if(!arguments.length)return this._isWidgetDataModifed;this._isWidgetDataModifed=a},setWidgetData:function(a){},getWidgetData:function(){return{}},findWidgetUserProperty:function(a){var b;return _.each(this.model.properties.widgetUserProperty,function(c){if(c.name===a)return b=c,!1}),b},initialize:function(a){c.initialize.call(this,a)},render:function(){return c.render.call(this),this}}),d.MODEL=function(){return _.merge(b.MODEL(),{widget:!0})},a.UIWidget=d}),define("toast/widgets/UIWidgetContainer",["../core","./UIWidget"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{style:{backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"50% 50%"},maintainRatio:!0,initialize:function(a){c.initialize.call(this,a)},render:function(){return c.render.call(this),this},commonRender:function(){c.commonRender.call(this);var b=this.$el.attr("class")||"";this.$el.attr("class",b),this.$el.addClass("container"),this.containerView&&this.containerView.reset();var d=new a.ViewController({el:this.$el});d.parentViewController=this.viewController,d.parentView=this,this.containerView=d,this.collection=this.containerView.collection},renderContainer:function(){var b=this.model.toJSON();return b.background={},this.containerView.load(b,{showLoader:!0,readyonly:!0,htmlRender:this.viewController.htmlRender,print:this.viewController.print}),a.Book.fitPage(this.containerView),this._setContainerBackground(),this},mount:function(){c.mount.call(this),this.renderContainer()},willAppear:function(){c.willAppear.call(this),this.containerView.willAppear()},appear:function(){c.appear.call(this),this.containerView.appear()},willDisappear:function(){c.willDisappear.call(this),this.containerView.willDisappear()},disappear:function(){c.disappear.call(this),this.containerView.disappear()},scaleDidChange:function(a){c.scaleDidChange.call(this,a),this.containerView.scaleDidChange(a)},size:function(a,b){if(!arguments.length)return c.size.call(this);c.size.call(this,a,b),this.containerView.layout()},remove:function(){this.containerView.reset(),c.remove.call(this)},getBackgroundUrl:function(){var b=this.model.background.url;if(!_.isEmpty(b)){var c=_tt.StringUtils.replaceTemplate(b,"ASSETS_DIR",tt.paths.assets);return a._.forHTMLPublishing||(c=c.encodeFilePath()),'url("'+c+'")'}return""},getBackgroundSize:function(){var a=this.model;if(a.properties.customBgSize){var b="100%";_.isUndefined(a.properties.backgroundWidth)||(b=a.properties.backgroundWidth,isNaN(b)||(b+="px"));var c="auto";return _.isUndefined(a.properties.backgroundHeight)||(c=a.properties.backgroundHeight,isNaN(c)||(c+="px")),b+" "+c}return _.isUndefined(a.background.size)?"cover":a.background.size},getBackgroundPosition:function(){var a=this.model.background;return _.isUndefined(a.position)?"50% 50%":a.position},getBackgroundRepeat:function(){var a=this.model.background;return _.isUndefined(a.repeat)?"no-repeat":a.repeat},getBackgroundAttributes:function(a){return{backgroundSize:this.getBackgroundSize(),backgroundPosition:this.getBackgroundPosition(),backgroundRepeat:this.getBackgroundRepeat()}},_setContainerBackground:function(){if(this.model.background){this.style.backgroundColor="";var a=this.model.background.color;_.isEmpty(a)?this.style.backgroundColor="transparent":this.style.backgroundColor=a,this.style.backgroundImage=this.getBackgroundUrl(),this.style=_.extend(this.style,this.getBackgroundAttributes()),this.$el.css(this.style)}}}),d.MODEL=function(){return _.merge({container:!0,background:{color:""},contents:[],states:[]},b.MODEL(),{})},a.UIWidgetContainer=d}),define("toast/widgets/UIWidgetMultiLayerContainer",["../core","./UIWidget","./UIWidgetContainer"],function(a,b,c){"use strict";var d=(a.Strings,b.prototype),e=b.extend();return _.extend(e.prototype,d,{className:"container widget-multi-layer-container",style:{backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"50% 50%"},maintainRatio:!0,initialize:function(a){d.initialize.call(this,a)},state:function(a){var b=d.state.call(this,a);return 0!==arguments.length&&b&&this.showLayer(this._currentState,{force:!0}),b},render:function(){return d.render.call(this),this},commonRender:function(){this.style=_.extend({},d.style,this.style),d.commonRender.call(this);var a=this.$el.attr("class")||"";this.$el.attr("class",a),this.$el.addClass("container"),this.renderLayers()},size:function(a,b){if(!arguments.length)return d.size.call(this);d.size.call(this,a,b),_.each(this.layers,function(c){c.size(a,b)},this)},mount:function(){d.mount.call(this)},willAppear:function(){d.willAppear.call(this),this.activeLayer&&this.activeLayer.willAppear()},appear:function(){d.appear.call(this),this.activeLayer&&this.activeLayer.appear()},willDisappear:function(){d.willDisappear.call(this),this.activeLayer&&this.activeLayer.willDisappear()},disappear:function(){d.disappear.call(this),this.activeLayer&&this.activeLayer.disappear()},scaleDidChange:function(a){d.scaleDidChange.call(this,a),_.each(this.layers,function(b){b.scaleDidChange(a)})},renderLayers:function(){this._setContainerBackground();var b=[];return _.each(this.model.contents,function(d,e){d.background={},d.width=this.model.width,d.height=this.model.height;var f=new a.project.model(d),g=this.$el.find("#"+f.get("id"));g.length||(g=this.viewController._createModelElement(f),this.$el.append(g));var h=this.viewController.htmlRender?g.children().first():null,i=new c({viewController:this.viewController,model:f,el:h,$parent:g,__events__:[]});i.index=e,i.label=f.label;var j;__app__&&!a._.forHTMLPublishing?i.__render__():(j=!0,i.render()),h||g.append(i.el),j?(i.mount(),i.mountAll()):i.__mount__(),i.$parent.hide(),b.push(i)},this),this.layers=b,this},showLayer:function(a,b){if(b||(b={}),this._currentState!==a||b.force){this.hideLayer(this.activeLayer);var c=_.find(this.layers,{label:a});if(c){c.$parent.show();var e=this.viewController.current();e&&(c.containerView.current(!0),c.willAppear()),e&&c.appear(),d.state.call(this,a)}this.activeLayer=c,this.hideAllLayer()}},hideLayer:function(a){if(a){var b=this.viewController.current();b&&(a.containerView.current(!1),a.willDisappear()),a.$parent.hide(),b&&a.disappear()}},hideAllLayer:function(){_.each(this.layers,function(a){this.activeLayer&&a.label===this.activeLayer.label||a.$parent.hide()},this)},previousLayer:function(a){if(this.activeLayer){var b=this.layers.indexOf(this.activeLayer);if(-1!==b){if(b--,a&&0>b)b=this.layers.length-1;else if(0>b)return;this.state(this.layers[b].label)}}},nextLayer:function(a){if(this.activeLayer){var b=this.layers.indexOf(this.activeLayer);if(-1!==b){if(b++,a&&this.layers.length<=b)b=0;else if(this.layers.length<=b)return;this.state(this.layers[b].label)}}},_setContainerBackground:function(){if(this.model.background){this.style.backgroundColor="";var a=this.model.background.color;_.isEmpty(a)||(this.style.backgroundColor=a),this.style.backgroundImage="";var b=this.model.background.url;if(!_.isEmpty(b)){var c=_tt.StringUtils.replaceTemplate(b,"ASSETS_DIR",tt.paths.assets).encodeFilePath();this.style.backgroundImage='url("'+c+'")'}this.$el.css(this.style)}}}),e.MODEL=function(){return _.merge(b.MODEL(),{initState:"",_labelSuffixIndex:1,multilayerContainer:!0,background:{color:""},contents:[],states:[]})},a.UIWidgetMultiLayerContainer=e}),define("toast/widgets/UIWidgetSlideContainer",["../core","./UIWidgetMultiLayerContainer","./UIWidgetContainer"],function(a,b,c){"use strict";var d=(a.Strings,b.prototype),e=b.extend();return _.extend(e.prototype,d,{className:"widget-slide-container",initialize:function(a){d.initialize.call(this,a)},render:function(){return d.render.call(this),this},commonRender:function(){d.commonRender.call(this),this.model.initState||(this.model.initState=this.model.states[0].value)},renderLayers:function(){if(!this.isRender||a._.forHTMLPublishing)return void d.renderLayers.call(this);this.$sliderContainer&&this.$sliderContainer.append(this.$el),this._setContainerBackground();var b=[],e=this.$el.find("ul");e.length||(e=$("<ul />"),this.$el.append(e)),_.each(this.model.contents,function(d,f){d.background={},this.renderLayerSize(d);var g=new a.project.model(d),h=this.$el.find("#"+g.get("id"));h.length?h.show():(h=this.viewController._createModelElement(g),this.$el.append(h));var i=this.viewController.htmlRender?h.children().first():null,j=new c({viewController:this.viewController,model:g,el:i,$parent:h,__events__:[]});j.index=f,j.label=g.label,i?j.render():h.append(j.render().el),j.mount(),j.mountAll();var k=e.children().eq(f);k.length||(k=$("<li />"),"vertical"===this.model.properties.direction?k.css("top",g.height*f):k.css("left",g.width*f),k.css("height","100%"),k.append(h),e.append(k)),b.push(j)},this),this.layers=b;var f=this,g=_.find(this.layers,{label:this.model.initState});g||(g=this.layers[0]);var h=this.layers.indexOf(g);return this.$slider=e.lightSlider({mode:"slide",itemFixedWidth:this.model.width,itemFixedHeight:this.model.height,vertical:"vertical"===this.model.properties.direction,verticalHeight:this.model.height,adaptiveHeight:!1,controls:!this.model.properties.buttonHidden,pager:!1,item:1,slideMargin:0,thumbMargin:0,galleryMargin:0,speed:300,onSliderLoad:function(a){f.$prev=f.$el.find(".lSPrev"),f.$prev.css({backgroundColor:f.model.properties.buttonBgColor,color:f.model.properties.buttonColor}),"vertical"===f.model.properties.direction&&f.$prev.attr("data-direction","vertical"),f.$next=f.$el.find(".lSNext"),f.$next.css({backgroundColor:f.model.properties.buttonBgColor,color:f.model.properties.buttonColor}),"vertical"===f.model.properties.direction&&f.$next.attr("data-direction","vertical"),f.$prev.on("click",$.proxy(f._arrowButtonTapped,f)),f.$next.on("click",$.proxy(f._arrowButtonTapped,f))},onBeforePrevSlide:function(a,b){f.__slidingInteraction=!0},onBeforeNextSlide:function(a,b){f.__slidingInteraction=!0},onBeforeSlide:function(a,b){f.$el.closest(".video-controls-fix").removeClass("video-controls-fix")},onAfterSlide:function(b,c){f.state(f.layers[c].label);f.__slidingInteraction?a.lazy(function(){a.IS_DRAGGING=f.__slidingInteraction=!1},f.$slider.settings().speed):f.__isSliderContainerDown__&&(a.IS_DRAGGING=!1,f.$slider.isDisableDrag()&&f.$slider.disableDrag(!1),f.__startActiveLayerCID==f.activeLayer.cid&&f.$el.closest(".current").addClass("video-controls-fix"),f.controlsFix=!1,f.__isSliderContainerDown__=!1)}}),this.$el.on(a.__eventTypes__.start,function(a){f.__isSliderContainerDown__=!0,f.__startPageX=a.pageX,f.__startPageY=a.pageY,f.__startActiveLayerCID=f.activeLayer.cid}),this.$el.on(a.__eventTypes__.move,function(b){if(f.__isSliderContainerDown__&&!a.IS_DRAGGING&&(f.__slideTimeout__&&f.__slideTimeout__.id&&clearTimeout(f.__slideTimeout__.id),a.IS_DRAGGING=!0,f.__slidingInteraction=!0),a.IS_ZOOM&&(a.IS_ZOOM_DRAG_MODE?f.$slider.isDisableDrag()||f.$slider.disableDrag(!0):f.$slider.isDisableDrag()&&f.$slider.disableDrag(!1)),f.__isSliderContainerDown__){var c=b.pageX,d=b.pageY;f.__startPageX,f.__startPageY;if(Math.max(Math.abs(c-f.__startPageX),Math.abs(d-f.__startPageY))>f.$slider.settings().swipeThreshold){var e=f.$el.closest(".video-controls-fix");e.length&&(f.controlsFix=!0,e.removeClass("video-controls-fix"))}}}),this.$el.on(a.__eventTypes__.end,function(b){f.__slideTimeout__||(f.__slideTimeout__={});var c=b.pageX,d=b.pageY,e=Math.distance(f.__startPageX,f.__startPageY,c,d);if(e>5?a.lazyOnce(function(){a.IS_DRAGGING=!1},50,f.__slideTimeout__):a.IS_DRAGGING=!1,f.$slider.isDisableDrag()&&f.$slider.disableDrag(!1),f.__isSliderContainerDown__&&f.controlsFix){var g=b.pageX,h=b.pageY,e=(f.__startPageX,f.__startPageY,Math.max(Math.abs(g-f.__startPageX),Math.abs(h-f.__startPageY)));e>f.$slider.settings().swipeThreshold&&a.lazy(function(){f.__startActiveLayerCID==f.activeLayer.cid&&f.$el.closest(".current").addClass("video-controls-fix")},f.$slider.settings().speed)}f.controlsFix=!1,f.__isSliderContainerDown__=!1}),f.goToSlide(h),this},renderLayerSize:function(a){a.width=this.model.width,a.height=this.model.height},willAppear:function(){d.willAppear.call(this),a.lazy(function(){this.updateSlideLayout()},50,this)},show:function(){d.show.call(this),this.updateSlideLayout()},hide:function(){d.hide.call(this)},updateSlideLayout:function(){this.$el.find("ul").height(this.$el.height()),this.$slider&&this.$slider.refresh()},goToSlide:function(a){this.getActiveSlideIndex()!==a&&(this.$slider.goToSlide(a),this._sliderChangeCallbackFn&&(this._sliderChangeCallbackContext?this._sliderChangeCallbackFn.bind(this._sliderChangeCallbackContext)(a):this._sliderChangeCallbackFn(a)))},getActiveSlideIndex:function(){return this.activeLayer?this.activeLayer.index:0},showLayer:function(a,b){if(b||(b={}),this._currentState!==a||b.force){var c=_.find(this.layers,{label:a});c||(c=this.layers[0]),this.hideLayer(this.activeLayer);var d=this.viewController.current();d&&(c.containerView.current(!0),c.willAppear()),this.$slider&&this.goToSlide(c.index),d&&c.appear(),this.activeLayer=c,this.hideAllLayer()}},hideLayer:function(a){if(a){this.viewController.current()&&(a.containerView.current(!1),a.willDisappear(),a.disappear())}},hideAllLayer:function(){},_sliderChangeCallback:function(a,b){this._sliderChangeCallbackFn=a,this._sliderChangeCallbackContext=b},_arrowButtonTapped:function(b){a.IS_ZOOM_LOCKED=!0,this._refreshTimeout||(this._refreshTimeout={}),a.lazyOnce(function(){a.IS_ZOOM_LOCKED=!1},250,this._refreshTimeout)}}),e.MODEL=function(){return _.merge(b.MODEL(),{properties:{buttonBgColor:"rgba(0, 0, 0, 0.40)",buttonColor:"#fff"}})},a.UIWidgetSlideContainer=e}),define("toast/widgets/UIWidgetScrollContainer",["../core","./UIWidgetContainer"],function(a,b){"use strict";var c=(a.Strings,b.prototype),d=b.extend();return _.extend(d.prototype,c,{className:"container widget-scroll-container",initialize:function(a){c.initialize.call(this,a)},render:function(){return c.render.call(this),this},renderContainer:function(){return c.renderContainer.call(this),this._renderScrollbar(),this},_renderScrollbar:function(){var b=this.containerView,c=b.bounds();if(b.$contents.css("width",c.width),b.$contents.css("height",c.height),a.isMobileDevice)return this.$el.css("overflow-y","auto"),void(a.config.htmlRender||(this._scrollInteraction=new a.ScrollInteraction({view:this,$contentEl:b.$contents})));a.lazy(function(){this._setCustomScrollbar(),a.config.htmlRender||this._setScrollInteraction()},5,this)},_setCustomScrollbar:function(){this.model.properties.theme||(this.model.properties.theme="drak"),this.containerView.$el.addClass("prevent-scroll"),this.containerView.$el.addClass("prevent-pan"),this.containerView.$el.mCustomScrollbar({axis:"y",scrollButtons:{enable:!1},theme:"drak"===this.model.properties.theme?"dark-thin":"light-thick",scrollbarPosition:"inside",autoExpandScrollbar:!0,advanced:{autoExpandHorizontalScroll:!0}})},_setScrollInteraction:function(){var b,c=this,d=this.containerView.$el.children(".mCustomScrollBox"),e=d.find(".mCSB_container"),f=d.find(".mCSB_dragger"),g=[d.height()-e.outerHeight(!1),f.parent().height()-f.height()];this._scrollInteraction=new a.ScrollInteraction({view:this,$el:d,$contentEl:e,scrollStart:function(a,c){b=parseInt(e.css("top"))},scrollTo:function(a,d){switch(a=b-a,d.direction){case"up":a<g[0]&&(a=g[0]);break;case"down":a>0&&(a=0)}e.css("top",a),c.containerView.$el.mCustomScrollbar("update")},scrollEnd:function(a,b){},isScrollTop:function(){var a=parseInt(e.css("top"));return!a||a>0},isScrollBottom:function(){var a=parseInt(e.css("top"));return(a=Math.abs(a))+2>=Math.abs(g[0])}})},remove:function(){this._scrollInteraction&&(this._scrollInteraction.destroy(),delete this._scrollInteraction),c.remove.call(this)}}),d.MODEL=function(){return _.merge({},b.MODEL(),{})},a.UIWidgetScrollContainer=d}),define("toast/widgets/UIWidgetSceneAnimation",["../core","./UIWidgetContainer"],function(a,b){"use strict";var c=a.Strings,d=[{value:"Play",label:c.PLAY,readonly:!0,checkable:!1},{value:"Pause",label:c.PAUSE,readonly:!0,checkable:!1},{value:"Stop",label:c.STOP,readonly:!0,checkable:!1},{value:"Finish",label:c.FINISH,readonly:!0,checkable:!1}],e=b.prototype,f=b.extend();return _.extend(f.prototype,e,{className:"container widget-scene-animation",maintainRatio:!1,initialize:function(a){e.initialize.call(this,a),this._repeatCount=0},states:function(){return e.states.call(this).concat(d)},state:function(b){if(!arguments.length)return this._currentState;if(a._.forHTMLPublishing)return e.state.call(this,b);var c=e.state.call(this,b);if(0!==arguments.length&&c)switch(this._currentState){case this.model.states[0].value:this._delayInterval&&clearTimeout(this._delayInterval);var d=this.model.properties.delay;String(d).length&&!isNaN(d)?this._delayInterval=setTimeout(function(){this._playAll()}.bind(this),d):this._playAll();break;case this.model.states[1].value:this.containerView.collection.each(function(a){if(a.__attributes__)return!0;this._pause(a)},this);break;case this.model.states[2].value:this.containerView.collection.each(function(a){if(a.__attributes__)return!0;this._stop(a)},this);break;case this.model.states[3].value:this.containerView.collection.each(function(a){if(a.__attributes__)return!0;this._finish(a)},this)}return c},render:function(){return e.render.call(this),this.model.properties.reverse&&(this.model.properties.count*=2),this},autostart:function(){this.model.properties.autoplay&&(this.isPlaying()||this.state(this.model.states[0].value))},autostop:function(){this.model.properties.autoplay&&(this.state()!==this.model.states[1].value&&this.state(this.model.states[1].value),this.reset())},reset:function(){e.reset.call(this),this.containerView.collection.each(function(a){if(a.__attributes__)return!0;this._reset(a)},this),this._isPaused=!1},play:function(){return this.state(this.model.states[0].value),this},_playAll:function(){this.containerView.collection.each(function(a){if(a.__attributes__)return!0;this._isPaused?this._resume(a):this._play(a)},this),this._isPaused=!1},_play:function(a){this._reset(a),a.view.$parent.data("model",a),_.each(this.model.scenes,function(b,c){if(0===c)return!0;var d=this.model.scenes[c-1].duration,e=b[a.id];e.rotateZ=e.rotate,_.isUndefined(e.originX)||_.isUndefined(e.originY)||(e.transformOriginX=e.originX,e.transformOriginY=e.originY);var f={easing:b.easing,duration:1e3*d,complete:$.proxy(this._complete,this)};(a.hasChildren()||a.container||a.multilayerContainer||!_.isEmpty(String(e.curve))&&!isNaN(e.curve))&&(f.progress=$.proxy(this._progress,this,a,e)),a.view.$parent.velocity(e,f)},this)},_resume:function(a){a.view.$parent.velocity("resume")},isPlaying:function(){return this.state()===this.model.states[0].value},pause:function(){this.state(this.model.states[1].value)},_pause:function(a){this._isPaused=!0,a.view.$parent.velocity("pause")},isPaused:function(){return this._isPaused},stop:function(){return this.state(this.model.states[2].value),this},_stopAll:function(){this.containerView.collection.each(function(a){if(a.__attributes__)return!0;this._stop(a)},this)},_stop:function(a){a.view.$parent.velocity("stop",!0),a.view.$parent.data("count",0),this._repeatCount=0,this._reset(a)},isStopped:function(){return this.state()===this.model.states[2].value},finish:function(){return this.state(this.model.states[3].value),this},_finish:function(a){a.view.$parent.velocity("stop",!0);var b=this.model.scenes[this.model.scenes.length-1];a.view.$parent.data("model",a);var c=b[a.id];c.rotateZ=c.rotate,_.isUndefined(c.originX)||_.isUndefined(c.originY)||(c.transformOriginX=c.originX,c.transformOriginY=c.originY),a.view.$parent.velocity(c,{easing:b.easing,duration:0}),a.view.$parent.velocity("finish",!0),a.view.$parent.data("count",0)},finishAfterRepeatCount:function(a){this._repeatCount++,this.model.properties.count>this._repeatCount?(this.model.properties.reverse&&(this.model.scenes=this.model.scenes.reverse()),this.containerView.collection.each(function(a){if(a.__attributes__)return!0;a.view.$parent.data("count",0),this._play(a)},this)):this.state()!==this.model.states[3].value&&(this._repeatCount=0,e.state.call(this,this.model.states[3].value))},_reset:function(a){a.view.$parent.velocity("stop",!0);var b=this.model.scenes[0],c=b[a.id];c.rotateZ=c.rotate,_.isUndefined(c.originX)||_.isUndefined(c.originY)||(c.transformOriginX=c.originX,c.transformOriginY=c.originY),a.view.$parent.velocity(c,{easing:b.easing,duration:0})},_complete:function(a){var b=$(a),c=this.model.scenes.length-1,d=b.data("count")||0;if(d++,b.data("count",d),!this.isStopped())return!this.model.properties.loop&&d>=c?void this.finishAfterRepeatCount(b):void(this.model.properties.loop&&d===c&&(this.model.properties.reverse&&(this.model.scenes=this.model.scenes.reverse()),this.containerView.collection.each(function(a){if(a.__attributes__)return!0;a.view.$parent.data("count",0),this._play(a)},this)))},_progress:function(a,b,c,d,e,f,g){if(a&&a.view&&(a.hasChildren()||a.container||a.multilayerContainer)){var h=$(c).width(),i=$(c).height();a.view.size({width:h,height:i},{save:!1})}if(!_.isUndefined(b.curve)&&!_.isEmpty(String(b.curve))&&!isNaN(b.curve)){var j=b.curve,k=parseInt($(c).css("top"))-j,l=parseInt($(c).css("left")),i=$(c).height(),m=(Math.sin(2*d*Math.PI),Math.cos(2*d*Math.PI));$(c).css({left:l,top:k+j*m})}},remove:function(){this._stopAll(),e.remove.call(this)}}),f.MODEL=function(){return _.merge({initState:"",sceneAnimation:!0,scenes:[{easing:"ease-in-out",duration:.5}],background:{color:""}},b.MODEL(),{})},a.UIWidgetSceneAnimation=f}),define("toast/widgets/UIWidgetSpriteAnimation",["../core","./UIWidgetMultiLayerContainer"],function(a,b){"use strict";var c=a.Strings,d=[{value:"Play",label:c.PLAY,readonly:!0},{value:"Stop",label:c.STOP,readonly:!0},{value:"Loop",label:c.REPEAT_PLAYBACK,readonly:!0}],e=b.prototype,f=b.extend();return _.extend(f.prototype,e,{className:"widget-sprite-animation",initialize:function(a){e.initialize.call(this,a)},states:function(){return e.states.call(this).concat(d)},state:function(b){if(!arguments.length)return this._currentState;if(a._.forHTMLPublishing)return e.state.call(this,b);var c=e.state.call(this,b);if(0!==arguments.length&&c&&!a.isEditor)switch(this._currentState){case this.model.states[0].value:this._play();break;case this.model.states[1].value:this._stop();break;case this.model.states[2].value:this._loop()}return c},render:function(){return e.render.call(this),this},commonRender:function(){e.commonRender.call(this)},autostart:function(){this.current=0,this.model.initState===this.model.states[2].value&&(this.isLooping()?this.isPlaying()||this.play():this.loop())},autostop:function(){this.isPlaying()?this.stop():this._stop()},renderLayers:function(){return e.renderLayers.call(this),this.showLayer(0),this},showLayer:function(a,b){b||(b={});var c=this.layers[a];if(c){this.hideAllLayer(a),c.$parent.show();var d=this.viewController.current();d&&(c.containerView.current(!0),c.willAppear()),d&&c.appear()}},hideLayer:function(a){var b=this.layers[a];if(b){var c=this.viewController.current();c&&(b.containerView.current(!1),b.willDisappear()),b.$parent.hide(),c&&b.disappear()}},hideAllLayer:function(a){_.each(this.layers,function(b,c){if(!_.isUndefined(a)&&a==c)return!0;this.hideLayer(c)},this)},play:function(){return this.state(this.model.states[0].value),this},_play:function(){_.isUndefined(this.current)&&(this.current=0),this._stop(),this.timer()},isPlaying:function(){return this.state()===this.model.states[0].value||this.isLooping()},stop:function(){return this.state(this.model.states[1].value),this},_stop:function(a){this._stopTimer(),this.current=0,this.showLayer(0)},_stopTimer:function(){this._timerObject&&(clearTimeout(this._timerObject),this._timerObject=null)},isStopped:function(){return this.state()===this.model.states[1].value},loop:function(){return this.state(this.model.states[2].value),this},_loop:function(a){this.__loop=!0,this.current=0,this._play()},isLooping:function(){return this.state()===this.model.states[2].value},timer:function(){this._timerObject=setTimeout(function(){if(!this.isStopped()){if(this.current++,this.model.sprites.length<=this.current){if(!this.__loop)return void this.stop();this.current=0}this.showLayer(this.current),this.timer()}}.bind(this),1e3*this.model.sprites[this.current].duration)},remove:function(){e.remove.call(this),this._stopTimer()}}),f.MODEL=function(){return _.merge(b.MODEL(),{animationLayers:!0,sprites:[{duration:.1}]})},a.UIWidgetSpriteAnimation=f}),define("toast/widgets/UIWidgetAudio",["../core","./UIWidget"],function(a,b){"use strict";var c=a.Strings,d=[{value:"Play",label:c.PLAY,readonly:!0,checkable:!1},{value:"Pause",label:c.PAUSE,readonly:!0,checkable:!1},{value:"Stop",label:c.STOP,readonly:!0,checkable:!1},{value:"End",label:c.END,readonly:!0,checkable:!1}],e=b.prototype,f=b.extend();return _.extend(f.prototype,e,{tagName:"audio",initialize:function(a){e.initialize.call(this,a)},states:function(){return e.states.call(this).concat(d)},state:function(a){var b=e.state.apply(this,arguments);if(0!==arguments.length&&b)switch(a){case this.model.states[0].value:this._play();break;case this.model.states[1].value:this._pause();break;case this.model.states[2].value:this._stop();break;case this.model.states[3].value:this._end()}return b},render:function(){e.render.call(this),this.$parent.hide(),a.config.sharedAudioPlayer||(this.$el.attr({src:this._getUrl()}),this.$el.on("loadeddata",$.proxy(this._onLoaded,this)),this.$el.on("ended",$.proxy(this._onEnded,this)),this.$el.load(),this.__on__(a.Events.STOP_ALL_SOUND,this._onStopAllSound))},autostart:function(){a.config.sharedAudioPlayer||this.model.properties.autoplay&&(this.isReadyMedia()||(this._playAfterLoad=!0),this.state()!==this.model.states[0].value?this.state(this.model.states[0].value):this.isReadyMedia()&&this._play())},autostop:function(){a.config.sharedAudioPlayer||(a.common.removeActiveAudio(this),this._playAfterLoad=!1,this.state()!==this.model.states[2].value?this.state(this.model.states[2].value):this._stop())},_onLoaded:function(){this._isLoaded=!0,this._playAfterLoad&&(this._playAfterLoad=!1,this._play())},_onEnded:function(){this.state()!==this.model.states[3].value&&(this.isWillAppear||this.isAppeared)&&this.state(this.model.states[3].value)},_getUrl:function(){var b;return this.model.properties.asset?b=a.AudioAssets.url(this.model.properties.asset):this.model.properties.url&&(b=this.properties.url,-1===b.indexOf("../")&&-1===b.indexOf("./")&&"http:"!==b.protocol()&&"https"!==b.protocol()&&(b="http://"+this.model.properties.url)),b&&(b=a.StringUtils.replaceTemplate(b).encodeFilePath()),b},play:function(){return this.state(this.model.states[0].value),this},_play:function(){this.isReadyMedia()&&(a.common.setActiveAudio(this),this.$el[0].play())},pause:function(){return this.state(this.model.states[1].value),this},_pause:function(){this._playAfterLoad&&(this._playAfterLoad=!1),this.$el[0].pause()},stop:function(a){return this.state(this.model.states[2].value),this},_stop:function(){this._playAfterLoad&&(this._playAfterLoad=!1),this.$el[0].pause(),0===this.$el[0].readyState||_.isUndefined(this.$el[0].currentTime)||(this.$el[0].currentTime=0)},toggle:function(){this.isReadyMedia()&&(this.state()===this.model.states[0].value?this.pause():this.play())},end:function(){this.state(this.model.states[3].value)},_end:function(){this._playAfterLoad&&(this._playAfterLoad=!1),this.$el[0].pause(),0===this.$el[0].readyState||_.isUndefined(this.$el[0].currentTime)||(this.$el[0].currentTime=0)},isPlaying:function(){return!!this.isReadyMedia()&&!!(this.$el[0].currentTime>0&&!this.$el[0].paused&&!this.$el[0].ended&&this.$el[0].readyState>2)},isPaused:function(){return!!this.isReadyMedia()&&!!(this.$el[0].currentTime>0&&this.$el[0].paused&&!this.$el[0].ended&&this.$el[0].readyState>2)},isLoaded:function(){return this._isLoaded},isReadyMedia:function(){return _.isUndefined(this.$el[0])?-1:0!==this.$el[0].readyState||0},onActiveAudioChange:function(){if(this.isWillAppear){switch(this.model.properties.actionOnActiveAudioChange){case"pause":this.pause();break;case"stop":this.stop()}}},remove:function(){a.common.removeActiveAudio(this),e.remove.apply(this,arguments)}}),f.MODEL=function(){return _.merge(b.MODEL(),{})},a.UIWidgetAudio=f});define("toast/widgets/UIWidgetMediaPlayer",["../core","./UIWidget","../views/UIMediaPlayer"],function(a,b,c){"use strict";var d=a.Strings,e=[{value:"Play",label:d.PLAY,readonly:!0,checkable:!1},{value:"Pause",label:d.PAUSE,readonly:!0,checkable:!1},{value:"Stop",label:d.STOP,readonly:!0,checkable:!1},{value:"End",label:d.END,readonly:!0,checkable:!1},{value:"Mute",label:d.MUTE,readonly:!0,checkable:!1}],f=c.prototype,g=b.prototype,h=b.extend();return _.extend(h.prototype,f,{className:"widget-media-player",initialize:function(a){f.initialize.call(this,a)},states:function(){var a=f.states.call(this);return a=a.concat(g.states.call(this)),a.concat(e)},state:function(b){if(0===arguments.length||a._.forHTMLPublishing)return f.state.call(this,b);if(this._currentState!=b)switch(b){case this.model.states[0].value:if(!this.play())return this._currentState;break;case this.model.states[1].value:if(!this.pause())return this._currentState;break;case this.model.states[2].value:if(!this.stop())return this._currentState;break;case this.model.states[3].value:if(!this.end())return this._currentState;break;case this.model.states[4].value:if(!this.mute())return this._currentState}return f.state.call(this,b)}}),h.MODEL=function(){return _.merge(b.MODEL(),{})},a.UIWidgetMediaPlayer=h}),define("toast/widgets/UIWidgetAudioPlayer",["../core","./UIWidgetMediaPlayer","../views/UIAudioPlayer"],function(a,b,c){"use strict";var d=(a.Strings,c.prototype),e=b.prototype,f=b.extend();return _.extend(f.prototype,d,{className:"widget-audio-player",initialize:function(a){d.initialize.call(this,a)},states:function(){var a=d.states.call(this);return a=a.concat(e.states.call(this)),a.concat([])},state:function(a){return e.state.call(this,a)},render:function(){return d.render.call(this),this},_startFullscreen:function(){a.requestFullScreen(this.$parent[0])||this._fullscreenDidChanged(!0)},_stopFullscreen:function(){a.exitFullScreen(this.$parent[0])||this._fullscreenDidChanged(!1)},play:function(){return!!d.play.apply(this,arguments)&&(d.state.call(this,this.model.states[0].value),!0)},pause:function(a){return!!d.pause.apply(this,arguments)&&(d.state.call(this,this.model.states[1].value),!0)},stop:function(a){return!!d.stop.apply(this,arguments)&&(d.state.call(this,this.model.states[2].value),!0)},mute:function(a){return!!d.mute.apply(this,arguments)&&(d.state.call(this,this.model.states[4].value),!0)},end:function(a){if(!d.end.apply(this,arguments))return!1;d.state.call(this,this.model.states[3].value)},_didEnded:function(){d._didEnded.apply(this,arguments),d.state.call(this,this.model.states[3].value)}}),f.MODEL=function(){return _.merge(b.MODEL(),{})},a.UIWidgetAudioPlayer=f}),define("toast/widgets/UIWidgetMoviePlayer",["../core","./UIWidgetMediaPlayer","../views/UIMoviePlayer"],function(a,b,c){"use strict";var d=a.Strings,e=[{value:"StartFullscreen",label:d.START_FULL_SCREEN,readonly:!0,checkable:!1},{value:"StopFullscreen",label:d.STOP_FULL_SCREEN,readonly:!0,checkable:!1}],f=c.prototype,g=b.prototype,h=b.extend();return _.extend(h.prototype,f,{className:"widget-movie-player",initialize:function(a){f.initialize.call(this,a)},states:function(){var a=f.states.call(this);return a=a.concat(g.states.call(this)),a.concat(e)},state:function(b){if(0===arguments.length||a._.forHTMLPublishing)return f.state.call(this,b);var c=g.state.call(this,b);if(c)switch(b){case this.model.states[5].value:f.startFullscreen.call(this);break;case this.model.states[6].value:f.stopFullscreen.call(this)}return c},render:function(){return f.render.call(this),this},play:function(){return!!f.play.apply(this,arguments)&&(f.state.call(this,this.model.states[0].value),!0)},pause:function(a){return!!f.pause.apply(this,arguments)&&(f.state.call(this,this.model.states[1].value),!0)},stop:function(a){return!!f.stop.apply(this,arguments)&&(f.state.call(this,this.model.states[2].value),!0)},mute:function(a){return!!f.mute.apply(this,arguments)&&(f.state.call(this,this.model.states[4].value),!0)},end:function(a){return!!f.end.apply(this,arguments)&&(f.state.call(this,this.model.states[3].value),!0)},startFullscreen:function(){return!!f.startFullscreen.apply(this,arguments)&&(f.state.call(this,this.model.states[5].value),!0)},stopFullscreen:function(){return!!f.stopFullscreen.apply(this,arguments)&&(f.state.call(this,this.model.states[6].value),!0)},_didEnded:function(){f._didEnded.apply(this,arguments),f.state.call(this,this.model.states[3].value)}}),h.MODEL=function(){return _.merge(b.MODEL(),{})},a.UIWidgetMoviePlayer=h}),define("toast/widgets/UIWidgetTextInput",["../core","./UIWidget"],function(a,b){"use strict";var c=a.Strings,d=[{value:"RightAnswer",label:c.RIGHT_ANSWER,readonly:!0,checkable:!1},{value:"WrongAnswer",label:c.WRONG_ANSWER,readonly:!0,checkable:!1}],e=b.prototype,f=b.extend();return _.extend(f.prototype,e,{tagName:"input",className:"form-control",style:{color:"#999",fontSize:"20px",fontFamily:"Nanum Gothic",padding:"10px"},attributes:{type:"text"},initialize:function(a){_.bindAll(this,"_onRightAnswerInputClicked"),e.initialize.call(this,a)},states:function(){return e.states.call(this).concat(d)},setWidgetData:function(b){if(b||(b={}),"string"==typeof b&&(b=JSON.parse(b)),!(b.widgetId&&b.widgetId!==this.model.id||(this.widgetDataModifed(!1),_.isUndefined(b.userInputValue)))){var c=b.userInputValue;this.$el.val(c),this._check(),a.data.set(this.__storageId,c),(this.actions.enter||this.animations.enter)&&this._execute("enter")}},getWidgetData:function(){return this.$el.val()?{widgetId:this.model.id,userInputValue:this.$el.val()}:{}},render:function(){return e.render.call(this),this._action="hidden",this.widgetDataModifed(!1),this},commonRender:function(){this.style=_.extend({},e.style,this.style),_.isUndefined(this.model.properties.padding)?this.model.properties.padding=parseInt(this.style.padding):this.style.padding=this.model.properties.padding+"px",e.commonRender.call(this)},mountAll:function(){if(e.mountAll.call(this),this.$el.css("cursor",""),a.config.widgetDataManager&&!_.isEmpty(a.config.widgetDataManager.url))return this;this.__storageId=a.project.config.publishUniqueId+"-"+this.$parent.attr("id");var b=a.data.get(this.__storageId);return _.isNull(b)||_.isEmpty(b)?this._setVal():(this.$el.val(b),a.lazy(function(){this._check()},5,this)),this},reset:function(){e.reset.call(this),this.$el.val(""),a.data.set(this.__storageId,this.$el.val()),this._removeRightAnswerEl()},showRightAnswer:function(a){switch(a){case"toggle":var b;b=this.$rightAnswerEl?"hidden":"visible",this.executeWidgetAction(b);break;case"visible":this.executeWidgetAction("visible");break;case"hidden":this.executeWidgetAction("hidden")}},executeWidgetAction:function(a){switch(a){case"visible":this.$rightAnswerEl||(this.$rightAnswerEl=this.$el.clone(),this.$rightAnswerEl.on("click",this._onRightAnswerInputClicked),this.$parent.append(this.$rightAnswerEl)),this.$rightAnswerEl.val(this.model.properties.rightAnswer),this.model.properties.rightAnswerColor&&this.$rightAnswerEl.css("color",this.model.properties.rightAnswerColor),this.model.properties.rightAnswerBold&&"bold"!==this.$rightAnswerEl.attr("data-font-weight")&&(this._bold=!0,this.$rightAnswerEl.attr("data-font-weight","bold"),this.$rightAnswerEl.css("fontWeight","bold"));break;case"hidden":this.$rightAnswerEl&&(this.$rightAnswerEl.remove(),this.$rightAnswerEl=null),this._bold=!1}},_update:function(a){this.minsize.width=2*this.model.properties.padding,this.minsize.height=2*this.model.properties.padding,this._setVal(),this.model.get("width")<Number(parseFloat(this.$el.css("width")).toFixed(1))&&this.$parent.css("width",this.$el.css("width")),this.model.get("height")<Number(parseFloat(this.$el.css("height")).toFixed(1))&&this.$parent.css("height",this.$el.css("height")),this.$el.css("pointer-events","none")},_setVal:function(){_.isUndefined(this.model.properties.placeholder)||_.isEmpty(this.model.properties.placeholder)||this.$el.val(this.model.properties.placeholder)},_check:function(){var a=this.model.properties.rightAnswer;if(a&&(a=String(a)),!_.isEmpty(a)&&!_.isEmpty(this.$el.val())){var a=a.toLowerCase(),b=this.$el.val().toLowerCase(),c=!1;switch(this.model.properties.condition){case"equal":a==b&&(c=!0),c||_.each(this.model.properties.rightAnswerList,function(a){if((a=String(a))==b)return c=!0,!1});break;case"contain":-1!=a.indexOf(b)&&(c=!0),c||_.each(this.model.properties.rightAnswerList,function(a){if(a=String(a),-1!=a.indexOf(b))return c=!0,!1})}c?this.state(this.model.states[0].value,{force:!0}):this.state(this.model.states[1].value,{force:!0})}},_onRightAnswerInputClicked:function(){this._removeRightAnswerEl(),this.$el.focus()},_removeRightAnswerEl:function(){this.$rightAnswerEl&&(this.$rightAnswerEl.remove(),this.$rightAnswerEl=null)},_onClick:function(){this.$el.focus()},_onFocus:function(b){a.IS_ZOOM||a.BookZoom._off(),this.$el.val()===this.model.properties.placeholder&&this.$el.val("")},_onFocusOut:function(){a.IS_ZOOM||a.BookZoom._on(),_.isEmpty(this.$el.val())&&this._setVal()},_onChange:function(b){this._check(),a.data.set(this.__storageId,this.$el.val()),this.widgetDataModifed(!0),(this.actions.enter||this.animations.enter)&&this._execute("enter")},events:{focus:"_onFocus",focusout:"_onFocusOut",change:"_onChange"}}),f.MODEL=function(){return _.merge(b.MODEL(),{})},a.UIWidgetTextInput=f}),define("toast/widgets/UIWidgetTextInputBox",["../core","./UIWidgetTextInput"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{tagName:"textarea",style:{color:"#999",fontSize:"28px",padding:"10px"},initialize:function(a){c.initialize.call(this,a)},commonRender:function(){this.style=_.extend({},c.style,this.style),c.commonRender.call(this)}}),a.UIWidgetTextInputBox=d}),define("toast/widgets/UIWidgetCheckBox",["../core","./UIWidget"],function(a,b){"use strict";var c=(a.Strings,[{value:"Check",label:a.Strings.CHECK,readonly:!0},{value:"Uncheck",label:a.Strings.UNCHECK,readonly:!0}]),d=b.prototype,e=b.extend();return _.extend(e.prototype,d,{style:{backgroundSize:"100% 100%",backgroundRepeat:"no-repeat",backgroundPosition:"50% 50%"},initialize:function(a){this.style=_.extend({},d.style,this.style),this.$input=$("<input />",{type:"checkbox",checked:!0}),this.$input.hide(),this.$parent.prepend(this.$input),d.initialize.call(this,a)},states:function(){return d.states.call(this).concat(c)},state:function(a){var b=d.state.call(this,a);return 0!==arguments.length&&b&&(this._currentState===this.model.states[0].value?this.checked(!0):this._currentState===this.model.states[1].value&&this.checked(!1)),b},_setImage:function(b){var c;if(this.model.properties.checked||_.isEmpty(this.model.properties.uncheckImage)||(c=this.model.properties.uncheckImage,this._uncheckImage=this.model.properties.uncheckImage),this.model.properties.checked&&!_.isEmpty(this.model.properties.checkImage)&&(c=this.model.properties.checkImage,this._checkImage=this.model.properties.checkImage),b||c||(c=_.isEmpty(this.model.properties.checkImage)?this.model.properties.uncheckImage:this.model.properties.checkImage),c){var d=a.ImageAssets.url(c);this.style.backgroundImage='url("'+d+'")',this.$el.css("backgroundImage",this.style.backgroundImage)}else this.style.backgroundImage="",this.$el.css("backgroundImage","")},render:function(){return d.render.call(this),this._setImage(!0),0===this.$el.parents('[data-view-type="WidgetGroupCheckBox"]').length&&this.$el.on("click",$.proxy(this.handleClick,this)),this},checked:function(a){if(0===arguments.length)return this.model.properties.checked;this.model.properties.checked!==a&&(this.model.properties.checked=a,this.model.properties.checked?(this.$input.attr("checked",!0),d.state.call(this,this.model.states[0].value)):(this.$input.removeAttr("checked"),d.state.call(this,this.model.states[1].value)),this._setImage(!0))},handleClick:function(a){this.checked(!this.model.properties.checked)}}),a.UIWidgetCheckBox=e}),define("toast/widgets/UIWidgetGroupCheckBox",["../core","./UIWidgetContainer"],function(a,b){"use strict";var c=(a.Strings,[{value:"RightAnswer",label:a.Strings.RIGHT_ANSWER,readonly:!0,checkable:!1},{value:"WrongAnswer",label:a.Strings.WRONG_ANSWER,readonly:!0,checkable:!1}]),d=b.prototype,e=b.extend();return _.extend(e.prototype,d,{initialize:function(a){d.initialize.call(this,a)},states:function(){return d.states.call(this).concat(c)},setWidgetData:function(a){if(a||(a={}),"string"==typeof a&&(a=JSON.parse(a)),this.widgetDataModifed(!1),!(a.widgetId&&a.widgetId!==this.model.id||_.isUndefined(a.selectedTarget))){var b=a.selectedTarget;this._check(b)}},getWidgetData:function(){return this._widgetData&&this._widgetData.selectedTarget?_.extend(this._widgetData,{widgetId:this.model.id}):{}},render:function(){return d.render.call(this),this},mount:function(){d.mount.call(this),this._elements=this.containerView.$contents.children(".toast-object"),_.each(this._elements,function(a){var b=$(a);0!==b.find('[data-view-type="WidgetCheckBox"]').length&&b.addClass("check-group")}),this._elements.on("click",$.proxy(this._handleClick,this))},reset:function(){d.reset.call(this),this._checkAll(!1)},showRightAnswer:function(a){if(this.model.properties.targets&&this.model.properties.targets.length)switch(a){case"toggle":this.containerView.find("id",this.model.properties.targets[0],!0).view.checked()?this._checkAll(!1):this._check(this.model.properties.targets[0],{silent:!0});break;case"visible":this._check(this.model.properties.targets[0],{silent:!0});break;case"hidden":this._checkAll(!1)}},_checkAll:function(a,b){b||(b={}),_.each(this._elements,function(c){var d=$(c),e=d.find('[data-view-type="WidgetCheckBox"]');if(0!==e.length){if(e=e.parents(".toast-object"),b.excludes){var f=e.attr("id");if(_.find(b.excludes,function(a){if(a===f)return!0}))return!0}var g=this.containerView.find("id",e.attr("id"),!0);g&&(g.view.checked(a),g.view.$el.css("opacity",""))}},this)},_check:function(a,b){b||(b={}),this._checkAll(!1,{excludes:[a]});var c=this.containerView.find("id",a,!0);if(c||c.view._silent)if(c.view.checked(!0),c.view._silent=b.silent,b.silent)c.view.$el.css("opacity",.35);else{var d=c.view.$el.closest(".check-group");d.length&&(a=d.attr("id")),c.view.$el.css("opacity","");var e=_.find(this.model.properties.targets,function(b){if(b===a)return!0});e?this.state(this.model.states[0].value):this.state(this.model.states[1].value)}this._widgetData||(this._widgetData={}),this._widgetData.selectedTarget=a},_click:function(a){this.containerView.find("id",a,!0)&&(_.find(this.model.properties.targets,function(b){if(b===a)return!0})?this.state(this.model.states[0].value):this.state(this.model.states[1].value));this._widgetData||(this._widgetData={}),this._widgetData.selectedTarget=a},_handleClick:function(a){var b=$(a.currentTarget),c=b.find('[data-view-type="WidgetCheckBox"]');0!==c.length?(b=c.closest(".toast-object"),this._check(b.attr("id")),this.widgetDataModifed(!0)):(this._click(b.attr("id")),this.widgetDataModifed(!0))}}),e.MODEL=function(){return _.merge(b.MODEL(),{})},a.UIWidgetGroupCheckBox=e}),define("toast/widgets/UIWidgetDragLineConnector",["../core","./UIWidget","../utils/ImageUtils"],function(a,b,c){"use strict";var d=(a.Strings,[{value:"Success",label:a.Strings.SUCCESS,readonly:!0},{value:"Failure",label:a.Strings.FAILURE,readonly:!0}]),e=b.prototype,f=b.extend();return _.extend(f.prototype,e,{maintainRatio:!0,initialize:function(a){this.style=_.extend({},e.style,this.style),e.initialize.call(this,a)},states:function(){return e.states.call(this).concat(d)},render:function(){if(e.render.call(this),this.model.properties.dlc_handleImage){var b=a.ImageAssets.url(this.model.properties.dlc_handleImage);this.$el.css("backgroundImage",'url("'+b+'")')}var c={left:parseInt(this.$parent[0].style.left),top:parseInt(this.$parent[0].style.top),width:parseInt(this.$parent[0].style.width),height:parseInt(this.$parent[0].style.height)};return this._orgRect=c,this._$line=$("<div />",{class:"line"}),this._$line.css({position:"absolute",left:c.left+(c.width-this.model.properties.dlc_lineWidth)/2,top:c.top+(c.height-this.model.properties.dlc_lineWidth)/2,width:this.model.properties.dlc_lineWidth,height:this.model.properties.dlc_lineWidth,backgroundColor:this.model.properties.dlc_lineColor}),this.$parent.before(this._$line),this._$normalImage=$("<img />",{src:a.ImageAssets.url(this.model.properties.dlc_normalImage)}),this._$normalImage.css({position:"absolute",left:c.left,top:c.top,width:c.width,height:c.height}),this.$parent.before(this._$normalImage),this._$ghost=$("<div />",{id:this.$parent.attr("id")}),this._$ghost.css({position:"absolute",left:c.left,top:c.top,width:c.width,height:c.height,cursor:"pointer"}),this.$parent.before(this._$ghost),this._$ghost.drag("start",$.proxy(this._onGhostDragStart,this),{distance:1,drop:!0}),this._$ghost.drag("drag",$.proxy(this._onGhostDrag,this)),this._$ghost.drag("end",$.proxy(this._onGhostDragEnd,this)),this},reset:function(){if(e.reset.call(this),this.model.properties.dlc_handleImage){var b=a.ImageAssets.url(this.model.properties.dlc_handleImage);this.$el.css("backgroundImage",'url("'+b+'")')}this._resetDrag()},_onDragStart:function(a,b){e._onDragStart.call(this,a,b)},_onDrag:function(a,b){e._onDrag.call(this,a,b),this._draw()},_onDragEnd:function(a,b){e._onDragEnd.call(this,a,b),this._dragEndHandler()},_doDropAnimations:function(a){if(a.dropAnimations){var b=[];_.each(a.dropAnimations,function(c){c.view.model.__autoDropTarget__?c.model.view.model.id===a.dropAnimations.drop.model.id&&b.push(c):b.push(c)},this),this._executeAnimations(b),delete a.dropAnimations}else if(!this._hasDropAcceptAnimations(a)&&!this._hasDropRejectAnimations(a)){var c={left:this.model.left,top:this.model.top};this.$parent.velocity(c)}},_onDrop:function(b,c){var d=e._onDrop.call(this,b,c);if(d){var f=$(c.drag),g=f.attr("id");a.$el.data(this.model.id+"-drop",g)}return d},_onDropAccept:function(){e._onDropAccept.call(this),this.state(d[0].value)},_onDropReject:function(){e._onDropReject.call(this),this.state(d[1].value)},_onGhostDragStart:function(a,b){e._onDragStart.call(this,a,b),this._resetDrag()},_onGhostDrag:function(a,b){e._onDrag.call(this,a,b);var c={left:parseInt(this._$ghost[0].style.left),top:parseInt(this._$ghost[0].style.top),width:parseInt(this._$ghost[0].style.width),height:parseInt(this._$ghost[0].style.height)};this.$parent.css(c),this._draw()},_onGhostDragEnd:function(a,b){this._dragEndHandler(),this._$ghost.css(this._orgRect),e._onDragEnd.call(this,a,b)},_dragEndHandler:function(){this._update()},_onAanimationCompleted:function(a){_.each(a,function(a){if(a.view===this)return this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null),!1},this)},_update:function(){this._intervalId&&clearInterval(this._intervalId);var a=this;this._intervalId=setInterval(function(){a._draw()},10)},_resetDrag:function(a){this.$parent.css(this._orgRect),this._draw()},_draw:function(){var b=this._$normalImage[0].getBoundingClientRect(),c=this.$parent[0].getBoundingClientRect(),d=(b.left,b.top,Math.sqrt(Math.pow(c.top-b.top,2)+Math.pow(c.left-b.left,2))),e=Math.atan2(c.top-b.top,c.left-b.left);this._$line.css({width:d/this.viewController.contentScale,transform:"rotate("+e+"rad)",transformOrigin:this.model.properties.dlc_lineWidth/2+"px 50% 0px"}),a.$el.data(this.model.id+"-angle",e)}}),a.UIWidgetDragLineConnector=f}),define("toast/widgets/UIWidgetSketchPad",["../core","./UIWidgetContainer","../libs/Sketchpad"],function(a,b,c){"use strict";var d=(a.Strings,b.prototype),e=b.extend();return _.extend(e.prototype,d,{initialize:function(a){d.initialize.call(this,a)},widgetDataModifed:function(a){if(!arguments.length)return this._sketchpad.isModified();this._sketchpad._isModified=a},setWidgetData:function(b){b||(b={}),"string"==typeof b&&(b=JSON.parse(b)),b.drawData&&(b.widgetId&&b.widgetId!==this.model.id||("string"==typeof b.drawData&&(b.drawData=JSON.parse(b.drawData)),a.lazy(function(){this._sketchpad.clear(),this._sketchpad.redraw(b.drawData.strokes)},10,this)))},getWidgetData:function(){return this._sketchpad.isEmpty()?{}:_.extend({},{widgetId:this.model.id,drawData:this._sketchpad.toJSON()})},render:function(){return d.render.call(this),this},commonRender:function(){this.style=_.extend({},this.style,this.model.get("style")),d.commonRender.call(this)},mount:function(){if(d.mount.call(this),this.isRender){this._$canvasContainer=this.$el.find('[data-widget-private-id="SketchPad_Canvas_Container"]'),this._$canvasContainer.css({overflow:"hidden"});var b=this._$canvasContainer.find(".SketchPad_Canvas");if(b.length||(b=$("<canvas />",{class:"SketchPad_Canvas"}),this._$canvasContainer.append(b)),a._.forHTMLPublishing)return this;var e=a.project.finds(this.viewController.collection.models,{name:"widgetPrivateID",value:"SketchPad_Canvas_Container"},!0);this._sketchpad=new c({element:b,width:e[0].width,height:e[0].height}),this._sketchpad.scale=this.viewController.contentScale,this.changePenMode(this.model.properties.changePenMode),this.changeColor(this.model.properties.changeColor),this.changePenSize(this.model.properties.changePenSize),this.changeEraserSize(this.model.properties.changeEraserSize)}},scaleDidChange:function(a){d.scaleDidChange.call(this,a),this._sketchpad.scale=a,this._sketchpad.element.attr("data-scale",a)},changePenMode:function(a){var b,c;"eraser"===a?(b=this._sketchpad.penModes.eraser,c=2*this._penSize):(b=this._sketchpad.penModes.draw,c=this._penSize),b!==this._sketchpad.penMode&&(this._sketchpad.penMode=b,this._sketchpad.penSize=c,this.trigger("changeState","changePenMode",a))},changeColor:function(a){this._sketchpad.color!==a&&(this._sketchpad.color=a,this.trigger("changeState","changeColor",a))},changePenSize:function(a){this._penSize!==a&&(this._penSize=a,this._sketchpad.penSize=this._penSize,this.trigger("changeState","changePenSize",a))},changeEraserSize:function(a){this.trigger("changeState","changeEraserSize",a)},reset:function(){this.trigger("reset"),this._sketchpad.clear({force:!0})}}),e.MODEL=function(){return _.merge(b.MODEL(),{})},a.UIWidgetSketchPad=e}),define("toast/widgets/UIWidgetTimer",["../core","./UIWidget"],function(a,b){"use strict";var c=a.Strings,d=[{value:"Start",label:c.START,readonly:!0},{value:"Stop",label:c.STOP,readonly:!0}],e=b.prototype,f=b.extend();return _.extend(f.prototype,e,{initialize:function(a){e.initialize.call(this,a),this._count=0},states:function(){return e.states.call(this).concat(d)},state:function(){var a=e.state.apply(this,arguments);if(arguments.length&&a)switch(this._currentState){case this.model.states[0].value:this.start();break;case this.model.states[1].value:this.stop()}return a},render:function(){return e.render.call(this),this.$parent.hide(),this},autostart:function(){this.model.properties.autostart&&a.lazyOnce(function(){this.state()!==this.model.states[0].value&&this.state(this.model.states[0].value)},5,this.__refreshTimeout__,this)},autostop:function(){this.state()!==this.model.states[1].value?this.state(this.model.states[1].value):this.stop()},start:function(){var a=this.model.properties.waitForInterval;a>0?this._waitTimerObject=setTimeout(function(){this._start()}.bind(this),a):this._start()},_start:function(){var a=this.model.properties.interval;_.isUndefined(a)||(this.stop(),this._executeActions(this.actions.timer),this._executeAnimations(this.animations.timer),this.model.properties.count>1&&this.timer())},stop:function(){this._waitTimerObject&&(clearTimeout(this._waitTimerObject),this._waitTimerObject=null),this._timerObject&&(clearTimeout(this._timerObject),this._timerObject=null),this._count=0,_.isEmpty(this.animations)||this._executeAnimations(this.animations.timer,{stop:!0})},timer:function(){if(this._count++,!this.model.properties.repeat&&this.model.properties.count<=this._count)this.state(this.model.states[1].value);else{var a=this.model.properties.interval,b=this.model.properties.intervalOffset;0!==b&&(a=this.makeRandom(a-b,a)),this._timerObject=setTimeout(function(){this._executeActions(this.actions.timer),this._executeAnimations(this.animations.timer),this.timer()}.bind(this),a)}},makeRandom:function(a,b){var c=Math.random()*(b-a)+a;return Math.floor(c)},remove:function(){this.stop(),e.remove.call(this)}}),a.UIWidgetTimer=f}),define("toast/widgets/UIWidgetTouchGesture",["../core","./UIWidget"],function(a,b){"use strict";var c=(a.Strings,b.prototype),d=b.extend();return _.extend(d.prototype,c,{className:"widget-touch-gesture",initialize:function(a){c.initialize.call(this,a)},render:function(){return c.render.call(this),this.$parent.hide(),this},autostart:function(){this._start()},autostop:function(){this._stop()},_start:function(){if(!(this.model.properties.userSelectionEnabled&&_.isEmpty(this.model.properties.userTargets)||_.isEmpty(this.model.properties.constTarget))){var b=[];if(this.model.properties.userSelectionEnabled)_.each(this.model.properties.userTargets,function(c){var d=a.Book.find({id:c});d&&d.view&&b.push(d.view.$parent[0])},this);else switch(this.model.properties.constTarget){case"window":b.push(document.body);break;case"book":b.push(a.$book[0]);break;case"currentpage":b.push(this.viewController.$el[0])}_.isEmpty(b)||(this._stop(),this._gestures=[],_.each(b,function(b){var c={},d=new a.Hammer.Manager(b,{inputClass:a.isMobileDevice?a.Hammer.TouchInput:a.Hammer.MouseInput,cssProps:{userSelect:"inherit"}});(this.actions.tap||this.animations.tap)&&(c._tapRecognizer=new Hammer.Tap({event:"tap",taps:1}),c._tapFn=$.proxy(this._handleTap,this),d.add(c._tapRecognizer),d.on("tap",c._tapFn)),(this.actions.doubletap||this.animations.doubletap)&&(c._doubleTapRecognizer=new Hammer.Tap({event:"doubletap",taps:2}),c._doubleTapFn=$.proxy(this._handleDoubleTap,this),d.add(c._doubleTapRecognizer),d.on("doubletap",c._doubleTapFn)),(this.actions.swipeleft||this.animations.swipeleft||this.actions.swiperight||this.animations.swiperight||this.actions.swipeup||this.animations.swipeup||this.actions.swipedown||this.animations.swipedown)&&(c._swipeRecognizer=new Hammer.Swipe({direction:Hammer.DIRECTION_ALL}),c._swipeLeftFn=$.proxy(this._handleSwipeLeft,this),c._swipeRightFn=$.proxy(this._handleSwipeRight,this),c._swipeUpFn=$.proxy(this._handleSwipeUp,this),c._swipeDownFn=$.proxy(this._handleSwipeDown,this),d.add(c._swipeRecognizer),d.on("swipeleft",c._swipeLeftFn),d.on("swiperight",c._swipeRightFn),d.on("swipeup",c._swipeUpFn),d.on("swipedown",c._swipeDownFn)),c.mc=d,this._gestures.push(c)},this))}},_stop:function(){_.isUndefined(this._gestures)||_.isEmpty(this._gestures)||(_.each(this._gestures,function(a){a._swipeLeftFn&&(a.mc.off("swipeleft",a._swipeLeftFn),delete a._swipeLeftFn),a._swipeRightFn&&(a.mc.off("swiperight",a._swipeRightFn),delete a._swipeRightFn),a._swipeUpFn&&(a.mc.off("swipeup",a._swipeUpFn),delete a._swipeUpFn),a._swipeDownFn&&(a.mc.off("swipedown",a._swipeDownFn),delete a._swipeDownFn),a._tapFn&&(a.mc.off("tap",a._tapFn),delete a._tapFn),a._doubleTapFn&&(a.mc.off("doubletap",a._doubleTapFn),delete a._doubleTapFn),a._swipeRecognizer&&a.mc.remove(a._swipeRecognizer),a._doubleTapRecognizer&&a.mc.remove(a._doubleTapRecognizer),a._tapRecognizer&&a.mc.remove(a._tapRecognizer),a.mc.destroy(),delete a.mc},this),this._gestures=[])},_executes:function(a){this.isAppeared&&(this._doExecutes(this.actions[a],"actions"),this._doExecutes(this.animations[a]))},_doExecutes:function(b,c){if(!_.isEmpty(b)){_.isArray(b)||(b=[b]);var d;d="actions"!==c;var e=[];_.each(b,function(b){var c;c=d?b.model._.properties:b.properties;var f=c.stateTargets;if(f){var g=[];_.each(f,function(b){var c=a.api.find({id:b});c&&g.push(c.model)},this),b.states=c.states,b.condition=c.condition,b.models=g,this._conditionalChangeState(b)&&e.push(b)}else e.push(b)},this),_.each(e,function(a){d?this._executeAnimations(a):this._executeActions(a)},this)}},_handleSwipeLeft:function(a){this._executes("swipeleft")},_handleSwipeRight:function(a){this._executes("swiperight")},_handleSwipeUp:function(a){this._executes("swipeup")},_handleSwipeDown:function(a){this._executes("swipedown")},_handleTap:function(b){a._isPreventDefault(b)||this._executes("tap")},_handleDoubleTap:function(b){a._isPreventDefault(b)||this._executes("doubletap")},remove:function(){this._stop(),c.remove.call(this)}}),a.UIWidgetTouchGesture=d}),define("toast/widgets/UIWidgetMediaSyncScene",["../core","./UIWidgetSlideContainer"],function(a,b){"use strict";var c=a.Strings,d=(c.PLAY,c.PAUSE,c.STOP,c.END,b.prototype),e=b.extend();return _.extend(e.prototype,d,{className:"container widget-media-sync-screen",templateCenterPlayButtonHTML:function(){return'<div class="center-icon center-play-btn"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 841.89 595.281" enable-background="new 0 0 841.89 595.281" xml:space="preserve" pointer-events="none" fill="#fff"><path fill="#454545" fill-opacity="0.9" d="M823.566,96.33c-9.656-36.276-30.828-66.98-67.104-76.637  C690.72,2.112,420.945,0.502,420.945,0.502s-269.776,1.61-335.518,19.19C49.151,29.35,28.104,60.054,18.323,96.33  C0.743,162.071,0,297.64,0,297.64s0.743,135.568,18.323,201.311c9.657,36.275,30.828,66.98,67.104,76.637  c65.742,17.58,335.518,19.189,335.518,19.189s269.775-1.609,335.518-19.189c36.275-9.656,57.447-40.361,67.104-76.637  c17.58-65.742,18.324-201.311,18.324-201.311S841.146,162.071,823.566,96.33z"></path><path d="M557.132,297.64L334.28,173.833v247.614"></path></svg></div>'},initialize:function(a){d.initialize.call(this,a)},render:function(){return d.render.call(this),a.config.delegatePlayerInteractions&&a.config.delegatePlayerInteractions.userInteractionDisabled&&(this.userInteractionDisabled=!0),this},commonRender:function(){d.commonRender.call(this)},renderMediaPlayer:function(){},getMediaPlayerInstance:function(){return this._widgetMediaPlayer},renderLayerSize:function(a){},mount:function(){d.mount.call(this),this._widgetMediaPlayer||(this._widgetMediaPlayer=this.renderMediaPlayer()),this._widgetMediaPlayer._timeupdateCallback(this.mediaTimeupdate,this),this._widgetMediaPlayer._mediaStatusChangeCallback(this.mediaStatusChange,this),this._widgetMediaPlayer._changeFullscreenCallback(this.changeFullscreen,this),this._widgetMediaPlayer.mount(),_.each(this.layers,function(a){a.containerView.scaleContent=!0},this),this.updateSlideLayout(),this.updateCenterPlayButton()},mountAll:function(){d.mountAll.call(this),this._widgetMediaPlayer.mountAll()},willAppear:function(){d.willAppear.call(this),this._widgetMediaPlayer.willAppear()},appear:function(){d.appear.call(this),this._widgetMediaPlayer.appear()},willDisappear:function(){d.willDisappear.call(this),this._widgetMediaPlayer.willDisappear()},disappear:function(){d.disappear.call(this),this._widgetMediaPlayer.disappear()},scaleDidChange:function(b){d.scaleDidChange.call(this,b),this._widgetMediaPlayer.scaleDidChange(b),this.isRender&&this.getMediaPlayerInstance().$controlBars&&a.lazy(function(){this.updateSlideLayout()},50,this),this.updateCenterPlayButton()},mediaTimeupdate:function(a){if(!this._reverseContent){this._reverseContent=[];for(var b=this.model.contents.length-1;b>=0;b--)this._reverseContent.push(this.model.contents[b])}var c=_.find(this._reverseContent,function(b){return b.syncTime<=a});if(c&&!this.__slidingInteraction){var d=this.model.contents.indexOf(c);this.goToSlide(d,a)}},mediaStatusChange:function(a){this._hasCenterPlayButton},updateSlideLayout:function(){if(d.updateSlideLayout.call(this),this.getMediaPlayerInstance()){this.getMediaPlayerInstance().update(),this.model.playerControlBarHeight=this.getMediaPlayerInstance().$controlBars.height(),a.config.delegatePlayerInteractions&&(this.model.playerControlBarHeight=0);var b=this.model.width,c=this.model.height-this.model.playerControlBarHeight;this.$el.height(c);if(this.$el.find("ul").height("100%"),_.each(this.layers,function(d){d.$parent.width(b),d.$parent.height(c),a.Book.fitPage(d.containerView),d.$el.css({left:(d.$parent.width()-d.$el.width())/2,top:(d.$parent.height()-d.$el.height())/2})},this),this.fullscreenSlideCtrl){var e=this.model.playerControlBarHeight,f=this.$parent,g={height:f.height()-e};this.fullscreenSlideCtrl.$el.parent().css(g),a.Book.fitPage(this.fullscreenSlideCtrl),this._fullscreenSliderModel.view.updateSlideLayout()}}},goToSlide:function(a,b){if(d.goToSlide.call(this,a),this._widgetMediaPlayer&&this.getActiveSlideIndex()!==a&&this._widgetMediaPlayer.isReadyMedia()&&(this._fullscreenSliderModel&&this._fullscreenSliderModel.view.goToSlide(a),this.__slidingInteraction)){var c=this.model.contents[a];c&&!_.isUndefined(c.syncTime)&&String(c.syncTime).length&&(this._widgetMediaPlayer.$media[0].currentTime=Number(c.syncTime))}},fullscreenSliderChange:function(a){if(this.getActiveSlideIndex()!==a&&this._widgetMediaPlayer.isReadyMedia()&&this._fullscreenSliderModel.view.__slidingInteraction){var b=this.model.contents[a];b&&!_.isUndefined(b.syncTime)&&String(b.syncTime).length&&(this._widgetMediaPlayer.$media[0].currentTime=Number(b.syncTime))}},startFullscreenSlide:function(){this.fullscreenSlideCtrl&&(this.fullscreenSlideCtrl.reset(),this.fullscreenSlideCtrl.$el.parent().remove(),this.fullscreenSlideCtrl=null);var b=this.getMediaPlayerInstance().$controlBars.height();a.config.delegatePlayerInteractions&&(b=0);var c=this.$parent,d={height:c.height()-b},e=$("<div />",{class:"widget-media-sync-screen-slider-container"}),f=$("<div />",{class:"toast-ctrl"}),g=this.model.background.color;e.append(f),e.css(d),e.css("backgroundColor",g),this.$parent.append(e);var h={width:this.model.width,height:this.model.contents[0].height,contents:[_.extend(this.model.toJSON(),{viewType:"WidgetSlideContainer",left:0,top:0,height:this.model.contents[0].height})]},i=new a.ViewController({el:f});i._state=a.STATUS_NONE,i.index=-1,i.load(h,{showLoader:!1,readyonly:!0}),this.fullscreenSlideCtrl=i,a.Book.fitPage(i),this._fullscreenSliderModel=i.find("id",this.model.id),this._fullscreenSliderModel.view.goToSlide(this.getActiveSlideIndex()),this._fullscreenSliderModel.view._sliderChangeCallback(this.fullscreenSliderChange,this),i.willAppear(),i.appear(),this.updateSlideLayout()},stopFullscreenSlide:function(){this.fullscreenSlideCtrl&&(this.goToSlide(this._fullscreenSliderModel.view.getActiveSlideIndex()),this.fullscreenSlideCtrl.reset(),this.fullscreenSlideCtrl.$el.parent().remove(),this.fullscreenSlideCtrl=null),this._fullscreenSliderModel=null,this.updateSlideLayout()},changeFullscreen:function(a){a?this.startFullscreenSlide():this.stopFullscreenSlide()},setCenterPlayButton:function(){this._hasCenterPlayButton=!0,this.$el.append(this.templateCenterPlayButtonHTML()),this.$centerPlayBtn=this.$el.find(".center-play-btn"),this.$centerPlayBtnIcon=this.$centerPlayBtn.find("svg"),this.userInteractionDisabled&&this.$centerPlayBtn.hide()},updateCenterPlayButton:function(){if(this._hasCenterPlayButton){var b,c,d,e;if(b=this.$parent.width(),c=this.$parent.height(),this.$centerPlayBtn.width(),this.$centerPlayBtn.height(),e=a.isMobileDevice?60:80,this._widgetMediaPlayer&&this._widgetMediaPlayer._isFullscreen()){d=Math.min(e,Math.min(b,c))-5;d*=Math.min(this.$parent.width()/this.model.width,this.$parent.height()/this.model.height),d=Math.min(120,Math.max(e,d))}else d=e/this.viewController.contentScale,d=Math.min(80,d);!_.isUndefined(this.model.properties.centerPlayButtonBgColor)&&this.$centerPlayBtnIcon&&this.$centerPlayBtnIcon.length&&this.$centerPlayBtnIcon.find("path").get(0).setAttribute("fill",this.model.properties.centerPlayButtonBgColor),this.$centerPlayBtn.css({width:d+"px",height:d+"px"})}},centerPlayBtnClicked:function(){this.getMediaPlayerInstance().play()},remove:function(){this.stopFullscreenSlide(),this._widgetMediaPlayer&&this._widgetMediaPlayer.remove(),d.remove.call(this)}}),e.MODEL=function(){return _.merge(b.MODEL(),{sceneSync:!0})},a.UIWidgetMediaSyncScene=e}),define("toast/widgets/UIWidgetAudioSyncScene",["../core","./UIWidgetMediaSyncScene"],function(a,b){"use strict";a.Strings;a.const.AUDIO_SYNC_SCENE_PLAYER_CONTROLBAR_HEIGHT=50;var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{className:"container widget-slide-container widget-audio-sync-screen",style:{backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"50% 0%"},templateToggleFullscreenButtonHTML:function(){return'<div class="control-btn" data-action="toggleFullScreen"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="fullscreen-icon"><path d="M0 0h24v24H0z" fill="none"/><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" pointer-events="none" viewBox="0 0 24 24" class="fullscreen-exit-icon"><path d="M0 0h24v24H0z" fill="none"/><path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/></svg></div>'},initialize:function(b){this.model.playerControlBarHeight=a.const.AUDIO_SYNC_SCENE_PLAYER_CONTROLBAR_HEIGHT,a.config.delegatePlayerInteractions&&(this.model.playerControlBarHeight=0),c.initialize.call(this,b)},render:function(){return c.render.call(this),this.setCenterPlayButton(),this},renderMediaPlayer:function(){var b=$("<div />",{class:"widget-audio-sync-scene-player-container"});b.height(this.model.playerControlBarHeight),this.$playerContainer=b,this.$parent.append(b);var c=_.extend(a.UIWidgetAudioPlayer.MODEL(),{id:"player-"+this.model.id,width:this.model.width,height:this.model.height}),d=new a.Model(c);d.properties=_.extend({assets:[this.model.properties.audioFile],autoplay:this.model.properties.playerAutoplay,loop:this.model.properties.playerLoop,disableMediaSeeking:this.model.properties.playerDisableMediaSeeking,backgroundColor:this.model.properties.playerBackgroundColor,buttonIconColor:this.model.properties.playerButtonIconColor,textColor:this.model.properties.playerTextColor,seekbarBgColor:this.model.properties.playerSeekbarBgColor,seekbarColor:this.model.properties.playerSeekbarColor});var e=new a.UIWidgetAudioPlayer({viewController:this.viewController,model:d,$parent:this.$parent});return b.append(e.render().el),e.$el.find(".right-control-group").append(this.templateToggleFullscreenButtonHTML()),e._compositionWidgetPlayer=!0,e._initElements(),e},mount:function(){this.$centerPlayBtn.on("click",$.proxy(this.centerPlayBtnClicked,this)),c.mount.call(this)},scaleDidChange:function(b){this.setPlayerBarHeight(),this.getMediaPlayerInstance().controllbarMinSize=null,c.scaleDidChange.call(this,b),this.isRender&&this.getMediaPlayerInstance().$controlBars&&a.isIOS&&this.fullscreenSlideCtrl&&a.lazy(function(){this.updateSlideLayout()},50,this)},mediaStatusChange:function(a){switch(c.mediaStatusChange.call(this,a),a){case"playing":this.$centerPlayBtn.addClass("_hide");break;default:this.$centerPlayBtn.removeClass("_hide")}},setPlayerBarHeight:function(){var a;this.viewController.contentScale<1&&(a=this.getMediaPlayerInstance().$controlBars.attr("data-controlbars-height"),a=parseInt(a/this.viewController.contentScale)||""),this.getMediaPlayerInstance().$controlBars.css("height",a)},updateSlideLayout:function(){c.updateSlideLayout.call(this),this.$playerContainer.height(this.model.playerControlBarHeight)},startFullscreenSlide:function(){c.startFullscreenSlide.call(this),this.$parent.addClass("show-slide"),this.$parent.css("backgroundColor","black")},stopFullscreenSlide:function(){c.stopFullscreenSlide.call(this),this.$parent.removeClass("show-slide"),this.$parent.css("backgroundColor","")}}),d.MODEL=function(){return _.merge(b.MODEL(),{audioSyncScene:!0})},a.UIWidgetAudioSyncScene=d}),define("toast/widgets/UIWidgetMovieSyncScene",["../core","./UIWidgetMediaSyncScene"],function(a,b){"use strict";var c=(a.Strings,b.prototype),d=b.extend();return _.extend(d.prototype,c,{className:"container widget-slide-container widget-movie-sync-screen",initialize:function(b){this.model.playerControlBarHeight=a.const.MOVIE_PLAYER_CONTROLBAR_HEIGHT,c.initialize.call(this,b)},templateShowSlideButtonHTML:function(){return'<div class="control-btn" data-action="toggleShowSlide"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M14 17H4v2h10v-2zm6-8H4v2h16V9zM4 15h16v-2H4v2zM4 5v2h16V5H4z"/></svg></div>'},render:function(){return c.render.call(this),this},renderMediaPlayer:function(){var b=_.extend(a.UIWidgetMoviePlayer.MODEL(),{id:"player-"+this.model.id,width:this.model.width,height:this.model.height}),c=new a.Model(b);c.properties=_.extend({asset:this.model.properties.movieFile,autoplay:this.model.properties.playerAutoplay,disableMediaSeeking:this.model.properties.playerDisableMediaSeeking,backgroundColor:this.model.properties.playerBackgroundColor,cover:this.model.properties.playerCover,centerPlayButtonBgColor:this.model.properties.playerCenterPlayButtonBgColor});var d=new a.UIWidgetMoviePlayer({viewController:this.viewController,model:c,$parent:this.$parent});return this.$parent.prepend(d.render().el),d.$el.find(".right-control-group").append(this.templateShowSlideButtonHTML()),d.$el.find('[data-action="toggleShowSlide"]').on("click",$.proxy(this.toggleShowSlide,this)),d._initElements(),d},disappear:function(){c.disappear.call(this),this.$parent.hasClass("show-slide")&&this.getMediaPlayerInstance().$controlBars.removeClass("_hide")},toggleShowSlide:function(){this.$parent.hasClass("show-slide")?(this.$parent.removeClass("hide-video"),this.$parent.addClass("show-video"),this.$parent.removeClass("show-slide")):(this.$parent.removeClass("show-video"),this.$parent.addClass("hide-video"),this.$parent.addClass("show-slide"))}}),d.MODEL=function(){return _.merge(b.MODEL(),{})},a.UIWidgetMovieSyncScene=d}),define("toast/widgets/UIWidgetPartialZoom",["../core","./UIWidget"],function(a,b){"use strict";var c=a.Strings,d=[{value:"Start",label:c.START,readonly:!0,checkable:!1},{value:"Exit",label:c.EXIT,readonly:!0,checkable:!1}],e=b.prototype,f=b.extend();return _.extend(f.prototype,e,{initialize:function(a){e.initialize.call(this,a),this._currentState=this.model.states[1].value},states:function(){return e.states.call(this).concat(d)},state:function(b,c){if(!arguments.length)return this._currentState;if(a._.forHTMLPublishing)return e.state.call(this,b,c);var d=e.state.call(this,b);if(0!==arguments.length&&d&&!a.isEditor)switch(this._currentState){case this.model.states[0].value:this._start(c);break;case this.model.states[1].value:this._exit(c)}return d},render:function(){return e.render.call(this),this.$parent.css("zIndex",-1),this._startAnimationCompleteFn=$.proxy(this._startAnimationComplete,this),this._exitAnimationCompleteFn=$.proxy(this._exitAnimationComplete,this),this},autostop:function(){this.model.properties.autoexit&&this.state()===this.model.states[0].value&&this.state(this.model.states[1].value,{animation:!1})},scaleDidChange:function(a){e.scaleDidChange.apply(this,arguments),this.state()==this.model.states[0].value&&this._start({animation:!1})},start:function(){return this.state(this.model.states[0].value),this},_start:function(a){a=_.extend({},a);var b,c=this.viewController.$el,d=c.parent(),e=this.viewController.$contents,f=(c.width(),c.height(),{width:this.viewController.collection.width,height:this.viewController.collection.height}),g=this.model.rect();g.left<0&&(this.model.width=g.width=g.width-g.left,this.model.left=g.left=0,b=!0),g.top<0&&(this.model.height=g.height=g.height-g.top,this.model.top=g.top=0,b=!0),g.top+g.height>f.height&&(g.height-=g.top+g.height-f.height,this.model.height=g.height,b=!0),b&&this.$parent.css(g);var h=Math.min(e.width()/this.$parent.width(),e.height()/this.$parent.height()),i={x:f.width/2,y:f.height/2},j={x:g.left+g.width/2,y:g.top+g.height/2},k=this.viewController.contentScale,l=(i.x-j.x)*(k*h),m=(i.y-j.y)*(k*h),n=this._animationOptions();(!1===a.animation||c.hasClass("partial-zoom-on"))&&(n.duration=0),n.complete=this._startAnimationCompleteFn;var o={x:(d.width()-c.width())/2,y:(d.height()-c.height())/2};this._isAnimating()||!1===a.animation||(c.css({left:o.x,top:o.y}),c.tt_transform("translate(0, 0)"));var p={left:o.x+l,top:o.y+m,scale:h},q={width:c.width()*h,height:c.height()*h};q.left=(d.width()-q.width)/2,q.top=(d.height()-q.height)/2,q.height-Math.abs(q.top+p.top)<d.height()?p.top+=d.height()-(q.height-Math.abs(q.top+p.top)):q.top+p.top>0&&(p.top-=q.top+p.top),q.width<d.width()?p.left=(d.width()-q.width/h)/2:q.width-Math.abs(q.left+p.left)<d.width()&&(p.left+=d.width()-(q.width-Math.abs(q.left+p.left))),c.addClass("animating"),c.velocity("stop",!0),c.velocity(p,n),c.addClass("partial-zoom-on")},exit:function(){return this.state(this.model.states[1].value),this},_exit:function(a){a=_.extend({},a);var b=this.viewController.$el,c=b.parent();if(b.hasClass("partial-zoom-on")){var d=this._animationOptions();!1===a.animation&&(d.duration=0),d.complete=this._exitAnimationCompleteFn;var e={x:(c.width()-b.width())/2,y:(c.height()-b.height())/2},f={left:e.x,top:e.y,scale:1};b.addClass("animating"),b.velocity("stop",!0),b.velocity(f,d),b.removeClass("partial-zoom-on")}},_animationOptions:function(){var b={},c=this.model;if(c.properties.easing&&(b.easing=c.properties.easing),c.properties.inputDuration)b.duration=c.properties.duration;else if(c.properties.namedDurations)switch(c.properties.namedDurations){case"fast":b.duration=300;break;case"normal":b.duration=a.Animation.DURATION_DEFAULT;break;case"slow":b.duration=800;break;default:b.duration=a.Animation.DURATION_DEFAULT}return b},_isAnimating:function(){return this.viewController.$el.hasClass("animating")},_startAnimationComplete:function(){this.viewController.$el.removeClass("animating")},_exitAnimationComplete:function(){var a=this.viewController.$el;a.removeClass("animating"),a.css({left:"",top:""}),a.tt_transform("")},remove:function(){this._startAnimationCompleteFn&&delete this._startAnimationCompleteFn,this._exitAnimationCompleteFn&&delete this._exitAnimationCompleteFn,this._exit({animation:!1}),this._exitAnimationComplete(),e.remove.call(this)}}),f.MODEL=function(){return _.merge(b.MODEL(),{})},a.UIWidgetPartialZoom=f}),define("toast/widgets/UIWidgetUserComponent",["../core","./UIWidget"],function(a,b){"use strict";var c=b.prototype,d=b.extend({initialize:function(a){c.initialize.call(this,a)},render:function(){c.render.call(this),this._componentStep="render";var b=this.model.properties.component;if(b){var d=this,e=_.extend(window.require.s.contexts._.config,{useXhr:!0}),f=a.FolderAssets.url(b)+"/";window.require.config(e)([f+"component.js"],function(a){if(d._component=new a({view:d,baseUrl:f,properties:d.model.properties}),d._component.render(),d._component.version)switch(d._componentStep){case"mount":d._component.mount();break;case"mountAll":d._component.mount(),d._component.mountAll();break;case"willAppear":d._component.mount(),d._component.mountAll(),d._component.willAppear();break;case"appear":d._component.mount(),d._component.mountAll(),d._component.willAppear(),d._component.appear();break;case"willDisappear":d._component.mount(),d._component.mountAll(),d._component.willDisappear();break;case"disappear":d._component.mount(),d._component.mountAll(),d._component.willDisappear(),d._component.disappear()}else switch(d._componentStep){case"mount":d._component.viewDidMount();break;case"mountAll":d._component.viewDidMount(),d._component.viewsDidMount();break;case"willAppear":d._component.viewDidMount(),d._component.viewsDidMount(),d._component.viewWillShow();break;case"appear":d._component.viewDidMount(),d._component.viewsDidMount(),d._component.viewWillShow(),d._component.viewDidShow();break;case"willDisappear":d._component.viewDidMount(),d._component.viewsDidMount(),d._component.viewWillHide();break;case"disappear":d._component.viewDidMount(),d._component.viewsDidMount(),d._component.viewWillHide(),d._component.viewDidHide()}})}return this},mount:function(){return c.mount.call(this),this._component?this._component.version?this._component.mount():this._component.viewDidMount():this._componentStep="mount",this},mountAll:function(){return c.mountAll.call(this),this._component?this._component.version?this._component.mountAll():this._component.viewsDidMount():this._componentStep="mountAll",this},willAppear:function(){c.willAppear.call(this),this._component?this._component.version?this._component.willAppear():this._component.viewWillShow():this._componentStep="willAppear"},appear:function(){c.appear.call(this),this._component?this._component.version?this._component.appear():this._component.viewDidShow():this._componentStep="appear"},willDisappear:function(){c.willDisappear.call(this),this._component?this._component.version?this._component.willDisappear():this._component.viewWillHide():this._componentStep="willDisappear"},disappear:function(){c.disappear.call(this),this._component?this._component.version?this._component.disappear():this._component.viewDidHide():this._componentStep="disappear"},remove:function(){this._$componentCSS&&this._$componentCSS.remove(),this._component?this._component.remove():this._componentStep="remove",c.remove.call(this)}});return a.UIWidgetUserComponent=d}),define("toast/widgets",["./core","./widgets/WidgetDataManager","./widgets/UIWidgetPrivate","./widgets/UIWidgetSlideContainer","./widgets/UIWidgetScrollContainer","./widgets/UIWidgetMultiLayerContainer","./widgets/UIWidgetSceneAnimation","./widgets/UIWidgetSpriteAnimation","./widgets/UIWidgetAudio","./widgets/UIWidgetAudioPlayer","./widgets/UIWidgetMoviePlayer","./widgets/UIWidgetTextInput","./widgets/UIWidgetTextInputBox","./widgets/UIWidgetCheckBox","./widgets/UIWidgetGroupCheckBox","./widgets/UIWidgetDragLineConnector","./widgets/UIWidgetSketchPad","./widgets/UIWidgetTimer","./widgets/UIWidgetTouchGesture","./widgets/UIWidgetAudioSyncScene","./widgets/UIWidgetMovieSyncScene","./widgets/UIWidgetPartialZoom","./widgets/UIWidgetUserComponent"],function(a){}),define("toast/blocks/UIWidgetBlockBase",["../widgets/UIWidgetContainer"],function(a){"use strict";var b=a.prototype,c=a.extend();return _.extend(c.prototype,b,{properties:function(){return b.properties.call(this).concat([])},resetProperties:function(){return b.resetProperties.call(this).concat([{name:"draggable",hidden:!0}])},render:function(){switch(b.render.call(this),_.isUndefined(this.model.properties._orgItemLayout)&&(this.model.properties._orgItemLayout=this.model.properties.itemLayout),_.isUndefined(this.model.properties._orgItemAlign)&&(this.model.properties._orgItemAlign=this.model.properties.itemAlign),_.isUndefined(this.model.properties._orgPaddingLeft)&&(this.model.properties._orgPaddingLeft=this.model.properties.paddingLeft),_.isUndefined(this.model.properties._orgPaddingRight)&&(this.model.properties._orgPaddingRight=this.model.properties.paddingRight),_.isUndefined(this.model.properties._orgPaddingTop)&&(this.model.properties._orgPaddingTop=this.model.properties.paddingTop),_.isUndefined(this.model.properties._orgPaddingBottom)&&(this.model.properties._orgPaddingBottom=this.model.properties.paddingBottom),_.isUndefined(this.model.properties._orgItemSpacing)&&(this.model.properties._orgItemSpacing=this.model.properties.itemSpacing),this.model.properties.fixed){case"topFixed":this.$parent.addClass("top-fixed");break;case"bottomFixed":break;default:this.$parent.removeClass("top-fixed")}return this},commonRender:function(){b.commonRender.call(this),this.$parent.addClass("block"),this.model.properties.overflow?this.$el.css("overflow","visible"):this.$el.css("overflow",""),this.$parent.css("zIndex",this.model.properties.zIndex)},size:function(a,b){if(!arguments.length)return{width:this.model.width,height:this.model.height};a||(a={}),b=_.extend({save:!0},b);var c={};_.isUndefined(a.width)||(c.width=a.width),_.isUndefined(a.height)||(c.height=a.height),_.isEmpty(c)||(b.save&&this.model.set(c),this.$parent.css(c),this.$el.css(c),_.isUndefined(c.width)||(this.containerView.collection.width=c.width),_.isUndefined(c.height)||(this.containerView.collection.height=c.height))},responsiveLayoutChanged:function(a){var c=b.responsiveLayoutChanged.call(this,a),d=this.model.properties;return c?(d.itemLayout=c.resp_itemLayout,d.itemAlign=c.resp_itemAlign,_.isUndefined(c.resp_paddingLeft)||(d.paddingLeft=c.resp_paddingLeft),_.isUndefined(c.resp_paddingRight)||(d.paddingRight=c.resp_paddingRight),_.isUndefined(c.resp_paddingTop)||(d.paddingTop=c.resp_paddingTop),_.isUndefined(c.resp_paddingBottom)||(d.paddingBottom=c.resp_paddingBottom),_.isUndefined(c.resp_itemSpacing)||(d.itemSpacing=c.resp_itemSpacing),this.$el.attr("text-align",c.resp_textAlign)):(d.itemLayout=d._orgItemLayout,d.itemAlign=d._orgItemAlign,d.paddingLeft=d._orgPaddingLeft,d.paddingRight=d._orgPaddingRight,d.paddingTop=d._orgPaddingTop,d.paddingBottom=d._orgPaddingBottom,d.itemSpacing=d._orgItemSpacing,this.$el[0].hasAttribute("text-align")&&this.$el.removeAttr("text-align")),_.each(this.collection.models,function(b){b.view&&!b.__attributes__&&b.view.responsiveLayoutChanged(a)},this),c},responsiveLayout:function(a){return this.viewController.responsiveLayout(a)},responsiveSize:function(a,b){var c=this.model,d=c.layout,e={};if("none"===d.name||c.properties.sizeByUser){var f=a/Toast.view.collection._orgWidth;return e.width=c._orgWidth*f,e.height=c._orgHeight*f,c.properties.sizeByUser&&this.position({left:c._orgLeft*f,top:c._orgTopt},{save:!0}),c.fixedHeight&&(e.height=c._orgHeight),e}var g=d.padding.left+d.padding.right;if(d.collection._orgWidth<this.model._orgWidth+g+30){var f=a/this.model._orgWidth;e.width=a,e.height=this.model._orgHeight*f}else this.model.fitWidth=!1,e.width=this.model._orgWidth,e.height=this.model._orgHeight;return this.model.fixedHeight&&(e.height=this.model._orgHeight),e}}),c.MODEL=function(){return _.merge(a.MODEL(),{block:!0,background:{size:"cover",position:"50% 50%",repeat:"no-repeat"}})},Toast.UIWidgetBlockBase=c}),define("toast/blocks/UIWidgetBlock",["../core","./UIWidgetBlockBase"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a){c.initialize.call(this,a)},responsiveLayout:function(a){return c.responsiveLayout.call(this,a)}}),d.MODEL=function(){return _.merge(b.MODEL())},a.UIWidgetBlock=d}),define("toast/blocks/UIWidgetColumn",["../core","./UIWidgetBlock"],function(a,b){"use strict";var c=b.prototype,d=b.extend();return _.extend(d.prototype,c,{initialize:function(a){c.initialize.call(this,a)}}),d.MODEL=function(){return _.merge(b.MODEL(),{copyable:!1,removable:!1,column:!0})},a.UIWidgetColumn=d}),define("toast/blocks/UIWidgetColumns",["../core","./UIWidgetBlockBase","./UIWidgetColumn"],function(a,b,c){"use strict";var d=b.prototype,e=b.extend();return _.extend(e.prototype,d,{initialize:function(a){d.initialize.call(this,a),_.isUndefined(this.model.properties.itemLayout)&&(this.model.properties.itemLayout="column"),this.columns=[]},render:function(){return d.render.call(this),this},commonRender:function(){d.commonRender.call(this),this.initializeColumns()},renderContainer:function(){_.each(this.model.contents,function(a,b){a.properties||(a.properties={}),a.properties.percent=this.model.columns[b]},this),d.renderContainer.call(this)},initializeColumns:function(){if(_.isEmpty(this.model.contents)){var b=this.model.columns;_.each(b,function(b){var d=_.extend(c.MODEL(),{});d.id="column-"+a.UUID4(),d.viewType="WidgetColumn",d.top=d.left=0,d.width=this.model.width,d.height=this.model.height,d.properties||(d.properties={}),d.properties.percent=b,this.model.contents.push(d)},this)}},responsiveLayoutChanged:function(a){return d.responsiveLayoutChanged.call(this,a)},responsiveLayout:function(a){return this.viewController.responsiveLayout(a)}}),e.MODEL=function(){return _.merge(b.MODEL(),{droppable:!1,columns:[50,50]})},a.UIWidgetColumns=e}),define("toast/blocks/UIWidgetDivisionLineBlock",["../core","./UIWidgetBlockBase","../views/UIShape"],function(a,b,c){"use strict";var d=b.prototype,e=b.extend();return _.extend(e.prototype,d,{initialize:function(a){d.initialize.call(this,a),this.model.properties.itemLayout="block",this.model.properties.itemAlign="center"},render:function(){return d.render.call(this),this},commonRender:function(){var b=_.extend(c.MODEL(),{});b.id="shape-"+a.UUID4(),b.viewType="Shape",b.top=b.left=0,b.width=this.model.width,b.resp_width=100,b.height=this.model.properties.lineWidth,b.fixedHeight=!0,b.style={backgroundColor:this.model.properties.lineColor},this.model.contents=[b],d.commonRender.call(this)}}),e.MODEL=function(){return _.merge(b.MODEL(),{droppable:!1,editable:!1})},a.UIWidgetDivisionLineBlock=e}),define("toast/blocks",["./core","./blocks/UIWidgetBlock","./blocks/UIWidgetColumns","./blocks/UIWidgetDivisionLineBlock"],function(a){}),define("toast/layouts/Layout",["require","exports","module"],function(a,b,c){"use strict";Toast.layout={};var d=function(a){_.extend(this,a),this.initialize.apply(this,arguments)};return _.extend(d.prototype,{itemSpacing:0,initialize:function(a){var b=this.collection;b.block;this.parentView=b.view.parentView,this.itemAlign=b.properties.itemAlign||"left",this.itemSpacing=b.properties.itemSpacing||0,this.padding={top:b.properties.paddingTop||0,right:b.properties.paddingRight||0,bottom:b.properties.paddingBottom||0,left:b.properties.paddingLeft||0},this.border={top:0,right:0,bottom:0,left:0},b.style&&(_.isUndefined(b.style.borderTopWidth)||(this.border.top=parseFloat(b.style.borderTopWidth)),_.isUndefined(b.style.borderRightWidth)||(this.border.right=parseFloat(b.style.borderRightWidth)),_.isUndefined(b.style.borderBottomWidth)||(this.border.bottom=parseFloat(b.style.borderBottomWidth)),_.isUndefined(b.style.borderLeftWidth)||(this.border.left=parseFloat(b.style.borderLeftWidth)))},update:function(){var a=this.collection,b=a.models,c=a.block,d=a.properties.itemLayout;return d||(d=c?"inline":"block"),b=c?Array.prototype.slice.call(b,1):_.filter(b,function(a){return!a.__attributes__&&a.block&&a.view}),this._models=b,b=[],_.each(this._models,function(a){a.layout=this,_.isUndefined(a._orgLeft)&&(a._orgLeft=a.left),_.isUndefined(a._orgTop)&&(a._orgTop=a.top),_.isUndefined(a._orgWidth)&&(a._orgWidth=a.width),_.isUndefined(a._orgHeight)&&(a._orgHeight=a.height),(__app__||a.properties.visible)&&b.push(a)},this),this._models=b,_.isUndefined(a._orgLeft)&&(a._orgLeft=a.left),_.isUndefined(a._orgTop)&&(a._orgTop=a.top),_.isUndefined(a._orgWidth)&&(a._orgWidth=a.width),_.isUndefined(a._orgHeight)&&(a._orgHeight=a.height),this},autofit:function(a){var b=this.collection,c=b.block,d=a.model,e=a.props,f=a.size,g=a.innerWidth,h=a.padding,i=a.border,j=(d.properties.keepLayout,20);if(d.block&&d.view.containerView){d.properties.sizeByUser?this.interaction&&j>e.left&&-j<e.left&&g-j<d.width+e.left&&g+j>d.width+e.left?(d.left=d.view.containerView.collection.left=e.left=0,d.width=d.view.containerView.collection.width=e.width=f.width-(h.left+h.right+i.left+i.right),d.fitWidth=e.fitWidth=!0):this.interaction&&g-j<d.width+e.left&&g+j>d.width+e.left?d.width=d.view.containerView.collection.width=e.width=f.width-e.left:this.interaction&&j>e.left&&-j<e.left?d.left=d.view.containerView.collection.left=e.left=0:this.interaction?(d.view.containerView.collection.width=e.width=d.width,d.view.containerView.collection.height=e.height=d.height,d.fitWidth=e.fitWidth=!1):(d.view.containerView.collection.width=e.width=d.width,d.view.containerView.collection.height=e.height=d.height):d.width=d.view.containerView.collection.width=e.width=c?f.width-(h.left+h.right+i.left+i.right):f.width;var k=d.view.containerView.collection;return Toast.viewLayout({sizeUpdated:this.sizeUpdated,fromParent:this.fromParent,collection:k,onUpdate:function(a,b){e.width=b.contentSize.width,e.height=b.contentSize.height,d.set(e),d.view.$parent.css(e),d.view.$el.height("100%")}}),!0}return this.sizeUpdated&&d.fitWidth?(_.extend(e,this.setNaturalHeight(d,g,d.prevInnerWidth)),d.fitWidth=e.fitWidth=!0,!0):this.sizeUpdated&&!1!==d.view.autoMaintainRatio?(_.extend(e,this.setNaturalSize(d,g,d.prevInnerWidth)),parseInt(g)<=d.width+2?d.fitWidth=e.fitWidth=!0:d.fitWidth=e.fitWidth=!1,!0):void 0},align:function(a,b,c){if(_.isEmpty(b))return this;var d=b[0],e=(b[b.length-1],b.length,this.itemSpacing);if("center"===a)if(1===b.length){var f={left:d.left+(c.width-d.width)/2,top:d.top};d.set(f),d.view.$parent.css(f)}else{var g=0;_.each(b,function(a,b){g+=a.width,b>0&&(g+=e)});var h,i=d.left+(c.width-g)/2;_.each(b,function(a,b){var c;c=h?{left:h.left+e+h.width,top:a.top}:{left:i,top:a.top},a.set(c),a.view.$parent.css(c),h=a},this)}else if("right"===a){var h,i=parseInt(d.left+c.width);_.each(b.reverse(),function(a){var b={left:i-a.width,top:a.top};a.set(b),a.view.$parent.css(b),i-=a.width+e},this)}return this},setNaturalHeight:function(a,b,c){a.width=parseInt(b);var d=b/c;return a.height=parseInt(a.height*d),{width:a.width,height:a.height}},setNaturalSize:function(a,b,c){var d=b/c,c=a.width;return a.width=parseInt(a.width*d),d=a.width/c,a.height=parseInt(a.height*d),{width:a.width,height:a.height}},empty:function(){return!!_.isEmpty(this._models)}}),d.extend=Toast.extend,Toast.layout.Layout=d}),define("toast/layouts/Block",["./Layout"],function(a){"use strict";var b=a.prototype,c=a.extend({initialize:function(a){b.initialize.call(this,a)},update:function(){if(b.update.call(this),this.empty())return this;var a,c,d=Toast.project.at(0),e=this.collection,f=(e.block,this.padding),g=this.border,h=this.itemSpacing,i={width:e.width,height:0},j=i.width-(g.left+g.right+f.left+f.right);return _.each(this._models,function(b,c){var k={left:b.properties.sizeByUser?b.left:f.left};a?k.top=a.top+a.height+h:b.properties.sizeByUser&&d.id!==e.id?k.top=b.top:k.top=f.top,__app__?b.view.__beforeAutofit__(k):b.view.beforeAutofit(k),this.autofit({model:b,props:k,size:i,innerWidth:j,padding:f,border:g}),__app__?b.view.__afterAutofit__(k):b.view.afterAutofit(k),i.height<k.top+b.height&&(i.height=k.top+b.height),b.properties.sizeByUser||this.align(this.itemAlign,[b],{left:k.left,top:k.top,width:j,height:i.height-k.top}),b.prevInnerWidth=j,a=b},this),i.height+=f.bottom+g.top+g.bottom,(e.height<i.height||e.parent)&&(c=!0,e.view.updateItemLayout({width:Number(i.width),height:Number(i.height)},{silent:!0})),!this.fromParent&&this.onUpdate&&this.onUpdate(this,{contentSize:i,doResize:c}),e.parent&&e.parent.view.responsiveLayout({fromParent:!0,sizeUpdated:this.sizeUpdated}),this},autofit:function(a){var c=this.collection,d=(c.block,a.model),e=a.props,f=(a.size,a.innerWidth),g=a.padding,h=a.border,i=20;if(d.resp_width)return d.width=e.width=c.width*(d.resp_width/100)-(g.left+g.right+h.left+h.right),!0;if(b.autofit.call(this,a))return!0;if(this.interaction&&f-i<d.width&&f+i>d.width||f<=d.width+1||d.fitWidth&&!this.interaction){var j=d.width,k=f;return d.width=e.width=k,d.fitWidth=e.fitWidth=!0,this.interaction&&this.interactionMaintainRatio?_.extend(e,this.setNaturalHeight(d,k,j)):this.interaction||!1===d.view.autoMaintainRatio||_.extend(e,this.setNaturalHeight(d,k,j)),!0}this.interaction&&(d.fitWidth=e.fitWidth=!1)},align:function(a,b,c){var d=b[0],e=this.padding,f=this.border,g={};return"center"===a?g={left:d.left+(c.width-d.width)/2,top:d.top}:"right"===a&&(g={left:f.left+e.left+c.width-d.width,top:d.top}),d.set(g),d.view.$parent.css(g),this}},{NAME:"block"});return Toast.layout.Block=c}),define("toast/layouts/Inline",["./Layout"],function(a){"use strict";var b=a.prototype,c=a.extend({initialize:function(a){b.initialize.call(this,a)},update:function(){if(b.update.call(this),this.empty())return this;var a,c,d,e=this.collection,f=(e.block,this.padding),g=this.border,h=this.itemSpacing,i={width:e.width,height:0},j=i.width-(g.left+g.right+f.left+f.right),k=this._models.length,l=[];return _.each(this._models,function(b,d){var e,m={};a?(m.left=a.left+a.width+h,m.top=a.top,m.firstOfRow=b.firstOfRow=!1):(c=m.left=f.left,m.top=f.top,m.firstOfRow=b.firstOfRow=!0),__app__?b.view.__beforeAutofit__(m):b.view.beforeAutofit(m),this.autofit({model:b,props:m,size:i,innerWidth:j,padding:f,border:g}),i.width<b.width+m.left+f.right&&(b.properties.sizeByUser&&!d?m.top=i.height:m.top=i.height+h,m.left=f.left,m.firstOfRow=b.firstOfRow=!0,e=!0),__app__?b.view.__afterAutofit__(m):b.view.afterAutofit(m),i.height<m.top+b.height&&(i.height=m.top+b.height),e?(this.align(this.itemAlign,l,{left:c,top:m.top,width:j,height:i.height-m.top}),l=[b]):l.push(b),k===d+1&&l.length&&this.align(this.itemAlign,l,{left:c,top:m.top,width:j,height:i.height-m.top}),b.prevInnerWidth=j,a=b},this),i.height+=f.bottom+g.bottom+g.top,(e.height<i.height||e.parent)&&(d=!0,e.view.updateItemLayout({width:Number(i.width),height:Number(i.height)},{silent:!0})),!this.fromParent&&this.onUpdate&&this.onUpdate(this,{contentSize:i,doResize:d}),e.parent&&e.parent.view.responsiveLayout({fromParent:!0,sizeUpdated:this.sizeUpdated}),this},autofit:function(a){if(b.autofit.call(this,a))return!0;var c=this.collection,d=(c.block,a.model),e=a.props,f=(a.size,a.innerWidth),g=(a.padding,a.border,20);if(this.interaction&&f-g<e.left+d.width&&f+g>e.left+d.width||f<=d.width+1||d.fitWidth){var h=d.width;f<d.width+1||d.fitWidth&&!this.interaction?(d.width=e.width=f,d.fitWidth=e.fitWidth=!0):f>d.width+1&&(d.fitWidth=e.fitWidth=!1);var i=d.width;return d.width!==h&&(this.interaction&&this.interactionMaintainRatio?_.extend(e,this.setNaturalHeight(d,i,h)):this.interaction||!1===d.view.autoMaintainRatio||_.extend(e,this.setNaturalHeight(d,i,h))),!0}e.fitWidth=!1}},{NAME:"inline"});return Toast.layout.Inline=c}),define("toast/layouts/Column",["./Layout"],function(a){"use strict";var b=a.extend({initialize:function(b){a.prototype.initialize.call(this,b)},update:function(){if(a.prototype.update.call(this),this.empty())return this;var b,c,d=this.collection,e=(d.block,this.padding),f=this.border,g=this.itemSpacing,h={width:d.width,height:0},i=this._models.length,j=(d.columns,h.width-(f.left+f.right+e.left+e.right)-(i-1)*g),k=0;_.each(this._models,function(a){k+=a.properties.percent});var l=Number(((100-k)/this._models.length).toFixed(3)),m=0;return _.each(this._models,function(a,c){var d={};b?(d.left=b.left+b.width+g,d.top=b.top):(d.left=e.left,d.top=e.top),d.width=parseFloat(Math.min(j,(a.properties.percent+l)/100*j)),__app__?a.view.__beforeAutofit__(d):a.view.beforeAutofit(d),this.autofit({model:a,props:d}),__app__?a.view.__afterAutofit__(d):a.view.afterAutofit(d),m<a.height&&!a.view.collection.isEmpty()&&(m=a.height),h.height<d.top+a.height&&(h.height=d.top+a.height),a.prevInnerWidth=j,b=a},this),_.each(this._models,function(a,b){a.height<m||m>0&&a.view.collection.isEmpty()?a.view.size({height:m},{save:!1}):_.isUndefined(a.beforeAutoHeight)?a.beforeAutoHeight=a.height:(a.view.size({height:a.beforeAutoHeight},{save:!1}),delete a.beforeAutoHeight)}),h.height+=e.bottom+f.bottom+f.top,(d.height<h.height||d.parent)&&(c=!0,d.view.updateItemLayout({width:Number(h.width),height:Number(h.height)},{silent:!0})),!this.fromParent&&this.onUpdate&&this.onUpdate(this,{contentSize:h,doResize:c}),d.parent&&d.parent.view.responsiveLayout({fromParent:!0,sizeUpdated:this.sizeUpdated}),this},autofit:function(a){var b=this.collection,c=(b.block,a.model),d=a.props;if(c.block&&c.view.containerView){c.view.containerView.collection.width=d.width;var e=c.view.containerView.collection;return Toast.viewLayout({sizeUpdated:this.sizeUpdated,fromParent:this.fromParent,collection:e,onUpdate:function(a,b){d.width=b.contentSize.width,d.height=b.contentSize.height,c.set(d),c.view.$parent.css(d),c.view.$el.height("100%")}}),!0}}},{NAME:"column"});return Toast.layout.Column=b}),define("toast/layouts/Grid",["./Layout"],function(a){"use strict";var b=a.extend({initialize:function(b){a.prototype.initialize.call(this,b)},update:function(){if(a.prototype.update.call(this),this.empty())return this;var b=this.collection,c=(this.padding,this.itemSpacing,{width:b.width,height:0});return _.each(this._models,function(a,b){var d={};c.height<d.top+a.height&&(c.height=d.top+a.height)},this),this}},{NAME:"grid"});return Toast.layout.Grid=b}),define("toast/layouts/None",["./Layout"],function(a){"use strict";var b=a.extend({initialize:function(b){a.prototype.initialize.call(this,b)},update:function(){if(a.prototype.update.call(this),this.empty())return this;if(this.interaction)return _.each(this._models,function(a,b){if(a._orgLeft=a.left,a._orgTop=a.top,a._orgWidth=a.width,a._orgHeight=a.height,a.block&&a.view.containerView){var c=a.view.containerView.collection;Toast.viewLayout({sizeUpdated:this.sizeUpdated,fromParent:this.fromParent,collection:c,onUpdate:function(b,d){d.contentSize.width=c.width,a.set(d.contentSize),a.view.$parent.css(d.contentSize),a.view.$el.height("100%")}})}},this),this;var b,c=this.collection,d=(c.block,c.properties.keepLayout),e=(this.padding,this.itemSpacing,{width:c.width,height:0}),f=c.width/c._orgWidth,g=100;return __app__||(c.height=c._orgHeight,c.view.$el.css({height:c.height}),c.view.$contents&&c.view.$contents.css({height:c.height})),__app__?this:(_.each(this._models,function(a,b){var h={};if(h.left=a._orgLeft*f,h.top=a._orgTop*f,d&&!__app__){h.width=a._orgWidth,h.height=a._orgHeight;var i=(a._orgLeft+a._orgWidth/2)/c._orgWidth;a._orgTop,a._orgHeight,c._orgHeight;h.left=c.width*i-a._orgWidth/2,h.top=a._orgTop,a._orgLeft<=g&&(h.left=a._orgLeft),a._orgLeft+a._orgWidth+g>=c._orgWidth&&(h.left=c.width-(c._orgWidth-a._orgLeft))}if(a.block&&d&&(a._orgWidth<c._orgWidth?h.width=a._orgWidth:(a._orgLeft>=0&&a._orgLeft<=5&&(h.left=0),c._orgWidth<a._orgWidth?h.width=a._orgWidth:(f=e.width/a._orgWidth,h.width=a._orgWidth*f)),h.height=a._orgHeight),__app__?a.view.__beforeAutofit__(h):a.view.beforeAutofit(h),a.block&&a.view.containerView){var j=a.view.containerView.collection;Toast.viewLayout({sizeUpdated:this.sizeUpdated,fromParent:this.fromParent,collection:j,onUpdate:function(b,c){c.contentSize.width=j.width,a.set(c.contentSize),a.view.$parent.css(c.contentSize),a.view.$el.height("100%")}})}if(__app__?a.view.__afterAutofit__(h):a.view.afterAutofit(h),!a.block)return!0;e.height<h.top+a.height&&(e.height=h.top+a.height)},this),__app__?this:(e.height||(e.height=c.height),c.height<e.height&&(e.height=e.height),(c.height<e.height||c.parent)&&(b=!0,c.view.updateItemLayout({width:Number(e.width),height:Number(e.height)},{silent:!0})),!this.fromParent&&this.onUpdate&&this.onUpdate(this,{contentSize:e,doResize:b}),c.parent&&c.parent.view.responsiveLayout({fromParent:!0,sizeUpdated:this.sizeUpdated}),this))}},{NAME:"none"});return Toast.layout.None=b}),define("toast/layouts",["./core","./layouts/Block","./layouts/Inline","./layouts/Column","./layouts/Grid","./layouts/None"],function(a){"use strict";var b={};_.each(Array.prototype.slice.call(arguments,1),function(a,c){b[a.NAME]=a}),a.viewLayout=function(a){a=_.extend({},a);var c=a.collection,d=c.block,e=c.properties.itemLayout;e||(e=d?"inline":"block");var f=b[e]||b.none;return new f(_.extend({name:f.NAME},a)).update()}}),define("toast/functions/_prepare",["exports","../core"],function(a,b){function c(a,c){c||(c={});var e=new $.Deferred;if(d(),a&&e.promise().done(a),b.RUNENV_ERROR!==b.RUNENV_ERROR_NO)return void e.reject();var f=[],g=new $.Deferred;if(f.push(g.promise()),b.config.htmlRender)g.resolve();else if(b.load(["text!"+b.config.moduleBaseUrl+"config.json"],function(a){try{b.config=_.extend(JSON.parse(a),b.config)}catch(a){}g.resolve()},function(){g.resolve()}),__app__)return b.Async.waitForAll(f).done(function(){e.resolve()}),void e.resolve();var h=new $.Deferred;if(f.push(h.promise()),g.always(function(){b.project=b.Project.initialize(),b.config.projectLoader?b.load([b.config.projectLoader],function(a){a.init().done(function(){h.resolve()})}):_.isUndefined(window.project)?b.project.__load__().done(function(){h.resolve()}):b.project.__load__({data:window.project}).done(function(){h.resolve()})}),!b.config.htmlRender){var i=new $.Deferred;f.push(i.promise()),h.always(function(){b.FontLoader.load().always(function(){i.resolve()})})}b.Async.waitForAll(f).done(function(){e.resolve()})}function d(){if(b.isNative){var a=window.require.s.contexts._.config.locale;$("html").attr("lang",a)}else $("html").attr("lang",b.config.language);var c=b.urlParams.get("preview");c&&(c=c.trim().toLowerCase())&&"true"===c&&(b.isPreview=!0)}return c}),define("toast/functions/mobile",["exports","../core"],function(a,b){function c(){$(".navbar-collapse").css("top",$(".navbar").outerHeight()),$(".main-navbar-nav").css("margin-bottom",$(".navbar").outerHeight()),$(".main-cont").css("padding-top",$(".navbar").outerHeight())}function d(){var a=($(event.currentTarget),$(document.body)),b="navbar-collapse-open";a.hasClass(b)?a.removeClass(b):a.addClass(b)}function e(){window.location.hash&&(window.location.hash="")}function f(){b.view.mlayout()}function g(){$(document).ready(c),$(".navbar-toggle").on("click",d),$(document.body).on("scroll",e),$(window).on("resize",f)}a.start=g}),define("toast/functions/responsive",["exports","../core"],function(a,b){function c(){var a=$(".navbar");a.length&&($(".navbar-collapse").css("top",a.outerHeight()),$(".main-navbar-nav").css("margin-bottom",a.outerHeight()),$(".main-cont").css("padding-top",a.outerHeight()),$(".navbar-toggle").on("click",d))}function d(){var a=($(event.currentTarget),$(document.body)),b="navbar-collapse-open";a.hasClass(b)?a.removeClass(b):a.addClass(b)}function e(){window.location.hash&&(window.location.hash="")}function f(){var a;window.innerHeight<h.height()&&(a=!0);var c=Math.min(b.view.collection._orgWidth,h.width());b.isMobile&&(c=h.width()),b.view.responsiveLayout({responsiveWidth:c});var d;window.innerHeight<h.height()&&(d=!0),b.isMobile||a||!d||(c=Math.min(b.view.collection._orgWidth,h.width()),b.view.responsiveLayout({responsiveWidth:c}))}function g(){h=$(".main-cont"),b.view.collection._orgWidth=b.view.collection.width,$(document).ready(c),f(),$(document.body).on("scroll",e),$(window).on("resize",f)}var h;a.start=g}),define("toast/functions/start",["exports","../core","./_prepare","./mobile","./responsive"],function(a,b,c,d,e){function f(){$(document.body).attr("data-version",b.version),b.isMobileDevice?(b.$el&&b.$el.addClass("mobile"),$(document.body).addClass("mobile"),b.isTablet?(b.$el&&b.$el.addClass("tablet"),$(document.body).addClass("tablet")):(b.$el&&b.$el.addClass("phone"),$(document.body).addClass("phone"))):(b.$el&&b.$el.addClass("desktop"),$(document.body).addClass("desktop"))}function g(a){(_.isEmpty(window.document.title)||-1!==window.document.title.indexOf("{title}"))&&(window.document.title=b.project.title),f();var c=b.urlParams.get("hiddenbar");c&&(c=c.trim().toLowerCase())&&"true"===c&&b.$el.addClass("hiddenbar"),b.isMobileDevice&&b._setOrientation(b.orientation()),b.config.print||b.$el.addClass("no-print"),b.config.share||b.$el.addClass("no-share"),_.isEmpty(b.config.pdfUrl)||b.$el.addClass("pdf-url");var d=["toast/extensions"];_.isUndefined(b.config.extensions)||_.isEmpty(b.config.extensions)||(d=d.concat(b.config.extensions)),b.load(d,function(){b.dispatchReady(b.EXTENSIONS_LOADED),b.Storage.loadAll().always(function(){b.Book.start(a,function(){b.hook.dispatchReady?b.hook.dispatchReady(function(){b.$el.css("opacity",1),$(document.body).find(".custom-indigator").remove(),b.showLoading(!1)}):(b.dispatchReady(b.READY),b.$el.css("opacity",1),$(document.body).find(".custom-indigator").remove(),b.showLoading(!1))})})})}function h(a){(_.isEmpty(window.document.title)||-1!==window.document.title.indexOf("{title}"))&&(window.document.title=b.project.title),f();var c=$(document.body).hasClass("responsive"),g=$(document.body).hasClass("for-mobile");b.view=new b.ViewController({el:$(".toast-ctrl")}),b.view.load(b.project.models[0].toJSON(),{htmlRender:!0,showLoader:!0,_reset:!1,readyonly:!0}),b.view.willAppear(),b.view.ready(function(){g&&b.view.mlayout(),$(document.body).addClass("ready"),b.view.$el.css("opacity",1),b.view.appear(),b.dispatchReady(b.READY),$(document.body).find(".custom-indigator").remove(),b.showLoading(!1)}),g?d.start():c&&e.start()}b.start=function(a){a||(a={}),$(document).ready(function(){if(a.module){if(window.__app__=TT,!b.__dev__&&b.inBrowser)return void $("html").remove()}else window.__app__=void 0;c(function(){a.module?(_.isArray(a.module)||(a.module=[a.module]),a.preload?(_.isArray(a.preload)||(a.preload=[a.preload]),require(a.preload,function(){b.load(a.module)})):b.load(a.module)):b.config.htmlRender?h(a):b.ThemeLoader.load(b.config.theme,b.config.moduleBaseUrl+"styles/themes/"+b.config.theme+"/","theme").done(function(){g(a)})})})}}),define("toast/functions/paths",["exports","../core"],function(a,b){function c(){var a=decodeURI(window.location.pathname),b=a.substr(0,a.lastIndexOf("/"));return b=unescape(b),-1!==b.indexOf(":")&&"/"===b[0]&&(b=b.substr(1)),b}b.setPaths=function(a){a||(a={}),b.paths||(b.paths={});var d=b.urlParams;if(b.paths.projectRoot="",b.paths.projectFile="project.json",b.paths.assetsDirectoryName="assets",b.paths=_.extend(b.paths,a),d.get("projectRoot")&&(b.paths.projectRoot=d.get("projectRoot")),d.get("projectFile")){var e=d.get("projectFile");b.paths.projectFile=e;var f=e,g=f.lastIndexOf(".");-1!==g&&(f=f.slice(0,g)),b.paths.assetsDirectoryName=f}__app__||"true"==d.get("preview")?(b.paths.assets=b.paths.projectRoot+b.paths.assetsDirectoryName+"/",b.paths.data=b.paths.assets):(_.isEmpty(b.config.dataBaseUrl)||(b.paths.projectRoot=b.config.dataBaseUrl),b.paths.assets=b.paths.projectRoot+"assets/",b.paths.data=b.paths.projectRoot+"data/"),b.paths.shared=b.paths.assets+"shared/",b.paths.workspace=b.paths.assets+"workspace/",_.isUndefined(b.paths.application_dir)&&(b.paths.application_dir=c()+"/"),b.StringUtils.templateStrings.APP_DIR=b.paths.application_dir,b.StringUtils.templateStrings.ASSETS_DIR=b.paths.assets,b.StringUtils.templateStrings.DATA_DIR=b.paths.data,b.StringUtils.templateStrings.SHARED_DIR=b.paths.shared}}),define("toast/functions/common",["exports","../core"],function(a,b){"use strict";b.common.setActiveAudio=function(a){b.common.activeAudio&&b.common.activeAudio!==a&&"function"==typeof b.common.activeAudio.onActiveAudioChange&&b.common.activeAudio.onActiveAudioChange(),b.common.activeAudio=a},b.common.removeActiveAudio=function(a){b.common.activeAudio===a&&(b.common.activeAudio=null)},b.common.setActivePopupMenu=function(a){b.common.popupmenu&&b.common.popupmenu!==a&&"function"==typeof b.common.popupmenu.close&&b.common.popupmenu.close(),b.common.popupmenu=a},$(document).on("click",function(a){var c=$(a.target),d=c.closest(".toast-object");if(d.length){var e=d.data("view");if(e&&e.actions&&(e.actions.click||e.actions.mouseover))return}d=c.closest(".__popup__"),d.length||b.common.popupmenu&&b.common.setActivePopupMenu(null)})}),define("toast/functions/orientation",["exports","../core"],function(a,b){b.orientation=function(){return b.isAndroid?screen.width>screen.height?"landscape":"portrait":window.innerWidth>window.innerHeight?"landscape":"portrait"},b.isLandscape=function(){return"landscape"===b.orientation()},b._setOrientation=function(a){b.$el.removeClass("portrait landscape"),b.$el.addClass(a),b.$el.attr("data-orientation",a),$(document.body).addClass(a),b._orientation=a,b.send(b.Events.ORIENTATION_DID_CHANGE,a)},b.ready(function(){function a(a){c&&clearTimeout(c),b._deviceRotating=!0,b.isInputBoxFocused()&&$("input, textarea").blur();var d=b.orientation();b._setOrientation(d),b.Book._changeSize(),b.lazy(function(){d!==b.orientation()&&(b._setOrientation(b.orientation()),b.Book._changeSize())},150),c=setTimeout(function(){d!==b.orientation()&&(b._setOrientation(b.orientation()),b.Book._changeSize()),b._deviceRotating=!1,c=null},500)}if(!b.config.htmlRender){var c,d="onorientationchange"in window,e=d?"orientationchange":"resize";window.innerWidth,window.innerHeight;b.isMobileDevice&&window.addEventListener(e,a,!1)}})}),define("toast/functions/fullscreen",["exports","../core"],function(a,b){b.executeToggleFullScreen=function(){b.isFullScreen()?b.exitFullScreen():b.requestFullScreen()},b.isFullScreen=function(a){return arguments.length||(a=parent?parent.document:document),a.fullscreenElement?a.fullscreenElement:a.msFullscreenElement?a.msFullscreenElement:a.mozFullScreenElement?a.mozFullScreenElement:a.webkitFullscreenElement?a.webkitFullscreenElement:!!a.webkitDisplayingFullscreen&&a.webkitDisplayingFullscreen},b.requestFullScreen=function(a){return arguments.length||(a=parent?parent.document.documentElement:document.documentElement),a.requestFullscreen?(a.requestFullscreen(),!0):a.msRequestFullscreen?(a.msRequestFullscreen(),!0):a.mozRequestFullScreen?(a.mozRequestFullScreen(),!0):a.webkitRequestFullscreen?(a.webkitRequestFullscreen(),!0):a.webkitRequestFullScreen?(a.webkitRequestFullScreen(),!0):a.webkitEnterFullscreen?(a.webkitEnterFullscreen(),!0):void 0},b.exitFullScreen=function(a){return arguments.length||(a=parent?parent.document:document),a.exitFullscreen?(a.exitFullscreen(),!0):a.msExitFullscreen?(a.msExitFullscreen(),!0):a.mozCancelFullScreen?(a.mozCancelFullScreen(),!0):a.webkitExitFullscreen?(a.webkitExitFullscreen(),!0):void 0},b.ready(function(){function a(a){b.isFullScreen()?b.$el.addClass("fullscreen"):b.$el.removeClass("fullscreen"),b.$fullscreen.hasClass("btn-toggle-active")&&(b.isFullScreen()?b.$fullscreen.addClass("active"):b.$fullscreen.removeClass("active")),b.send(b.Events.FULLSCREEN_DID_CHANGE,b.isFullScreen())}if(!b.config.htmlRender){"function"!=typeof b.hook[b.Commands.FULLSCREEN]&&((b.isMobileDevice||b._msieVersion&&b._msieVersion<11)&&b.$fullscreen.hide(),b.CommandManager.registerInternal(b.Commands.FULLSCREEN,b.executeToggleFullScreen));var c=parent?parent.document:document;$(c).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",a)}})}),define("toast/functions/commands",["exports","../core"],function(a,b){"use strict";function c(a){a.preventDefault();var c=$(a.currentTarget),d=c.attr("command"),e=c.attr("parameters");if(!c.hasClass("disabled")&&!c.attr("disabled")&&!_.isUndefined(d))if(_.isEmpty(e))b.executeCommand(d);else{e=e.split(",");var f=[d];_.each(e,function(a){a=a.trim(),"true"===a||"false"===a?f.push("true"===a):isNaN(a)?f.push(a):f.push(Number(a))}),e=f,b.executeCommand.apply(b,Array.prototype.slice.call(e,0))}}function d(){if(!_.isEmpty(b.config.bgSound)&&_.isUndefined(k)){var a=b.StringUtils.replaceTemplate(b.config.bgSound.url).encodeFilePath();k=$("<audio>",{id:"tt-bgsound",src:a,loop:"loop"}),$(".toast").append(k),f()}}function e(a){b.isMobileDevice&&(b.$startMenuDropdown.hasClass("open")&&b.$startMenuDropdown.children(".dropdown-toggle").dropdown("toggle"),b.BookZoom.isActivated()&&b.BookZoom.deactivate(),b.config.mobile.landscapeDoublePage&&!0!==b.config.mobile.doublepage?"landscape"===a?b.executeCommand(b.Commands.DOUBLEPAGE,!0):b.executeCommand(b.Commands.DOUBLEPAGE,!1):b.Book.layout())}function f(){k.attr("data-playing",!0),k[0].play(),b.$toggleBgSound&&b.$toggleBgSound.addClass("on")}function g(){k.attr("data-playing",""),k[0].pause(),b.$toggleBgSound&&b.$toggleBgSound.removeClass("on")}function h(){"true"===k.attr("data-playing")?g():f()}function i(){if(!_.isEmpty(b.config.pdfUrl)){var a=b.StringUtils.replaceTemplate(b.config.pdfUrl),c=a.getBaseName();b.SaveToDisk(a,c)}}function j(){b.topWindow().close()}var k;b.themeReady(function(){}),b.ready(function(){b.$el&&b.$el.find("[command]").on("click",c),b.isMobileDevice||_.isEmpty(b.config.bgSound)?b.$toggleBgSound&&b.$toggleBgSound.remove():_.isEmpty(b.config.bgSound)||d(),b.CommandManager.registerInternal(b.Commands.PLAY_BGSOUND,f),b.CommandManager.registerInternal(b.Commands.PAUSE_BGSOUND,g),b.CommandManager.registerInternal(b.Commands.TOGGLE_BGSOUND,h),b.CommandManager.registerInternal(b.Commands.PDF_DOWNLOAD,i),b.CommandManager.registerInternal(b.Commands.CLOSE_POPUP_WINDOW,j),b.on(b.Events.ORIENTATION_DID_CHANGE,e)})}),define("toast/functions/config_disposer",["exports","../core"],function(a,b){"use strict";function c(){if(!_.isEmpty(b.config.logo)){var a=$("<img />");if(void 0!==b.config.logo.src)a[0].src=b.config.logo.src;else if(void 0!==b.config.logo.url){var c=b.StringUtils.replaceTemplate(b.config.logo.url).encodeFilePath();a[0].src=c}var d=$(".toast").find(".navbar-brand");d.length&&d.html(a)}}function d(){if(!_.isEmpty(b.config.bgImage)){var a=$(".toast");if(!a.length)return;var c=b.StringUtils.replaceTemplate(b.config.bgImage.url).encodeFilePath();!0===b.config.bgImage.pattern?a.css({backgroundImage:'url("'+c+'")',backgroundPosition:"50% 50%",backgroundRepeat:"repeat"}):a.css({backgroundImage:'url("'+c+'")',backgroundSize:"cover",backgroundPosition:"50% 50%",backgroundRepeat:"no-repeat"})}}function e(){b.$el.css("backgroundColor",b.config.bgColor)}b.themeReady(function(){b.config.doublepage?b.$toggleDoublePage&&b.$toggleDoublePage.addClass("active"):b.$toggleDoublePage&&b.$toggleDoublePage.removeClass("active"),b.isMobileDevice&&b.$print&&b.$print.remove(),_.isEmpty(b.config.logo)||c(),_.isEmpty(b.config.bgImage)||d(),_.isEmpty(b.config.bgColor)||e()})}),define("toast/functions/LocalStorage",["exports","../core2"],function(a){"use strict";function b(a,b){1!=e?f.set(a,b):window.localStorage.setItem(a,b)}function c(a){1!=e?f.unset(a,{silent:!0}):window.localStorage.removeItem(a)}function d(a){return 1!=e?f.get(a):window.localStorage.getItem(a)}var e=void 0!==window.localStorage,f=new Backbone.Model({}),g=Toast.Storage.Collection.prototype,h=Toast.Storage.Collection.extend();_.extend(h.prototype,g,{load:function(a){var b=d(this.attributes.id);b&&this.reset(JSON.parse(b)),a.done&&a.done()},addItem:function(a,c){return a=g.add.call(this,a,c),b(this.attributes.id,this.stringify()),a},updateItem:function(a){this.set(a,{merge:!0,remove:!1}),b(this.attributes.id,this.stringify())},removeItem:function(a,c){var a=g.remove.call(this,a,c);return b(this.attributes.id,this.stringify()),a},empty:function(){this.reset(),c(this.attributes.id)}}),Toast.projectLoaded(function(){__app__||(Toast.Storage.register(new h(null,{attributes:{id:Toast.config.publishUniqueId+"-"+Toast.Storage.BOOKMARK,name:Toast.Storage.BOOKMARK,priority:0},model:Toast.Storage.Model.extend()})),Toast.Storage.register(new h(null,{attributes:{id:Toast.config.publishUniqueId+"-"+Toast.Storage.MEMO,name:Toast.Storage.MEMO,priority:0},model:Toast.Storage.Model.extend()})),Toast.Storage.register(new h(null,{attributes:{id:Toast.config.publishUniqueId+"-"+Toast.Storage.CONTENT,name:Toast.Storage.CONTENT,priority:0,preload:!0},model:Toast.Storage.Model.extend()})))}),a.set=b,a.remove=c,a.get=d,Toast.LocalStorage=a}),define("toast/functions/native_helper",["exports","../core"],function(a,b){"use strict";function c(a){if(!external.isFullscreen()||!0===e){var c=a.target;c.fullscreenElement||c.msFullscreenElement||c.mozFullScreenElement||c.webkitFullscreenElement?(external.requestFullscreen(),e=!0,b.$el.addClass("fullscreen")):(e=!1,external.exitFullscreen(),b.$el.removeClass("fullscreen"))}}function d(){jQuery.ajaxSettings.xhr=function(){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){}};var a=0,b={},c={0:200,1223:204};jQuery.ajaxTransport("* text html xml json svg data",function(d,e,f){var g;return{send:function(e,f){var h,i=d.xhr(),j=++a;if(i.open(d.type,d.url,d.async,d.username,d.password),d.xhrFields)for(h in d.xhrFields)i[h]=d.xhrFields[h];d.mimeType&&i.overrideMimeType&&i.overrideMimeType(d.mimeType),d.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(h in e)i.setRequestHeader(h,e[h]);g=function(a){return function(){if(4===i.readyState){var a,d=i.status||0;/^(file):/.test(window.location.protocol)&&(0===d||d>=200&&d<300)||d>=200&&d<300||(a="error"),g&&(delete b[j],g=null,"abort"===a?i.abort():"error"===a?f(i.status,i.statusText):f(c[i.status]||i.status,i.statusText,"string"==typeof i.responseText?{text:i.responseText}:void 0,i.getAllResponseHeaders()))}}},i.onreadystatechange=g(),g=b[j]=g("abort");try{i.send(null)}catch(a){if(g)throw a}},abort:function(){g&&g()}}})}if(!b.config.htmlRender&&"undefined"!=typeof external&&void 0!==external.isNative&&external.isNative()){var e=!1;$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",c),d()}}),define("toast/functions/api",["exports","../core"],function(a,b){"use strict";b.api.gotoPage=function(a){b.Book.move(a,{isLogical:!0,silent:!1})},b.api.find=function(a){var c=b.Book.find(a);return c?c.view:null}}),define("toast/functions",["./functions/start","./functions/paths","./functions/common","./functions/orientation","./functions/fullscreen","./functions/commands","./functions/config_disposer","./functions/LocalStorage","./functions/native_helper","./functions/api"],function(){Toast.executeCommand=function(a){if("function"==typeof Toast.hookExecuteCommand){var b=Toast.hookExecuteCommand.apply(Toast,Array.prototype.slice.call(arguments,0));return!1===b?Toast.CommandManager.execute(a,arguments):b}if("function"==typeof Toast.hook[a])return Toast.hook[a](a,arguments);var c=Toast.CommandManager.get(a);return c?c.execute.apply(c,Array.prototype.slice.call(arguments,1)):(new $.Deferred).reject().promise()},Toast.cookie={},Toast.cookie.set=function(a,b,c){c||(c=365);var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3),document.cookie=a+"="+b+";expires="+d.toUTCString()+";path=/"},Toast.cookie.get=function(a){var b=document.cookie.match("(^|;) ?"+a+"=([^;]*)(;|$)");return b?b[2]:null},Toast.cookie.remove=function(a){document.cookie=a+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;";var b=document.cookie.match("(^|;) ?"+a+"=([^;]*)(;|$)");return b?b[2]:null},Toast.optionalGoToPreviousPage=function(){Toast.config.reversePageTurnDirection?Toast.executeCommand(Toast.Commands.NEXT_PAGE):Toast.executeCommand(Toast.Commands.PREVIOUS_PAGE)},Toast.optionalGoToNextPage=function(){Toast.config.reversePageTurnDirection?Toast.executeCommand(Toast.Commands.PREVIOUS_PAGE):Toast.executeCommand(Toast.Commands.NEXT_PAGE)},Toast.isDownloadFileType=function(a){return!!a&&-1!==["pdf","mp3","ogg","mp4","swf","zip"].indexOf(a.toLowerCase())},Toast._isPreventDefault=function(a){var b=$(a.target);return!!b.closest("[command]").length||(!!b.closest('.toast-object[data-prevent-event="click"]').length||!(!b.closest(".modal").length&&!b.closest(".dialog").length))}}),define("toast",["exports","toast/core","toast/core2","toast/utils","toast/dialogs","toast/views","toast/views_","toast/widgets","toast/blocks","toast/layouts","toast/actions","toast/animations","toast/functions"],function(a,b){return b}),define("toast/extensions/defaults/Thumbnail",["exports","../../core"],function(a,b){"use strict";function c(){o=[];var a=[],c=$("<div />",{class:"toast-thumbnail"});b.$el.append(c);var f=Math.min(c.height(),150);c.remove(),i=$("<div />",{class:"overlay"}),_.each(b.project.models,function(c,d){var e,g=$.extend(!0,{},c.get("thumbnail"));e=g.url?b.StringUtils.replaceTemplate(g.url):g.src,(_.isEmpty(e)||_.isUndefined(e))&&(g.backgroundColor=c.background.color?c.background.color:"#fff"),g.url=e,g.width=g.width,g.height=g.height;var h=g.height/f;if(g.width=g.width/h,g.height=g.height/h,g._displayPageNumber=b.Book.toLogicalPageNumber(d+1),g.displayPageNumber=b.Book.getDisplayPageNumber(g._displayPageNumber),a.push(g),!b.config.doublepage||b.config.cover&&0===d)o.push({itemWidth:"100%",width:g.width,height:g.height,items:a}),a=[];else if(2===a.length||d===b.project.length-1){var i=g.width,j=g.height;a.length&&a[0].width>g.width&&(i=a[0].width,j=a[0].height),o.push({itemWidth:"50%",width:i*Math.min(2,a.length),height:j,items:a}),a=[]}});var n=Mustache.render(g,{Strings:b.Strings,theme:b.theme,thumbs:o});h=b.$el.find(".toast-thumbnail"),k=h.length,k?h.append($(n).html()):(h=$(n),b.$el.append(h));var p=h.find(".thumb-nav-prev");p.length&&(l||(l=p[0].outerHTML),p.remove());var q=h.find(".thumb-nav-next");q.length&&(m||(m=q[0].outerHTML),q.remove());var r=b.Book.getCurrentPageNumber()[0];return b.config.doublepage&&(r=parseInt(r/2+.5),!b.Book.isCoverPage()&&b.config.cover&&(r+=1)),j=h.find(".carousel").lightSlider({autoWidth:!0,pager:!1,slideMargin:5,slideMove:5,thumbMargin:50,prevHtml:l||"",nextHtml:m||"",onSliderLoad:function(){h.find(".close").on("click",d),h.animate({bottom:0},200,function(){j.refresh()}),j.children().eq(r-1).append(i),e()}}),h.find(".svg-icon").tt_replaceSvgIcon(),b.config.reversePageTurnDirection?j.goToSlide(o.length-1):j.goToSlide(r-1),b.Book.$getBook().turn("disabled",!0),b.$thumbnail.hasClass("btn-toggle-active")&&b.$thumbnail.addClass("active"),b.$el.addClass("present-thumbnail"),h}function d(){b.$el.removeClass("present-thumbnail"),h.animate({bottom:-h.height()+"px"},200,function(){j.destroy(),i.remove(),i=null,k?h.empty():h.remove(),h=null,o=[],b.Book.$getBook().turn("disabled",!1),b.$thumbnail.hasClass("btn-toggle-active")&&b.$thumbnail.removeClass("active")})}function e(){var a,c=-1,d=-1;j.children("li").on(n.start,function(b){a=b.clientX;var d=j.children(".item.active");c=d.index()}).on(n.end,function(e){if(!(Math.abs(e.clientX-a)>=5)){var f=$(e.currentTarget);d=f.index();var g=j.children(".item.active"),h=g.index();c===h&&(f.append(i),b.Book.move(o[d].items[0]._displayPageNumber,{isLogical:!0,silent:!1}))}})}function f(a){_.isUndefined(g)&&(g=b.HtmlLoader.Thumbnail),h?d():c()}var g,h,i,j,k,l,m,n="ontouchstart"in window?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},o=[];b.CommandManager.registerInternal(b.Commands.THUMBNAIL,f)}),define("toast/extensions/defaults/TOC",["exports","../../core"],function(a,b){"use strict";function c(){return l=$(k),b.$el.append(l),m=l.find(".container"),e().done(function(a){m.append(a),m.jstree({core:{animation:0,themes:{icons:q.icons},dblclick_toggle:!1},plugins:["wholerow","wholerowex","pageno","svgoclicon","svgfileicon","svgfoldericon"]}).on("ready.jstree",function(){!0===b.config.tocOpenAll&&m.jstree("open_all"),b.isMobileDevice||m.jScrollPane({resizeSensor:!0})})}).fail(function(a){l.animate({left:0},250)}),b.lazy(function(){l.animate({left:0},250)},100),m.css("height",$(window).innerHeight()-m.offset().top+"px"),$(window).on("resize",d),l}function d(){var a=b.isMobileDevice?50:0;b.lazy(function(){m.css("height",$(window).innerHeight()-m.offset().top+"px")},a)}function e(){function a(b,c){b.children("toc").each(function(b,d){var e=$(d),f=$("<li />");if(f.html("<span>"+e.children("subject").text()+"</span>"),e.attr("pageNo")?f.attr("data-page",e.attr("pageNo")):f.attr("data-page",e.children("pageNo").text().trim()),c.append(f),e.children("toc").length>0){var g=$("<ul />");f.append(g),a(e,g)}else f.attr("data-jstree",'{"icon": "jstree-file"}')})}function c(c){$(c).find(":root").children().each(function(c,d){var g,h=$(d);if(g=b.isMobileDevice?$('<li data-jstree={"opened":true} />'):$("<li />"),g.html("<span>"+h.children("subject").text()+"</span>"),h.attr("pageNo")?g.attr("data-page",h.attr("pageNo")):g.attr("data-page",h.children("pageNo").text().trim()),e.append(g),h.children("toc").length>0){!0!==f&&(m.addClass("has-folder"),f=!0);var i=$("<ul />");g.append(i),a(h,i)}else g.attr("data-jstree",'{"icon": "jstree-file"}')})}var d=new $.Deferred,e=$("<ul />"),f=!1;return n?(c(n),d.resolve(e)):!0!==p?$.ajax({type:"GET",url:o,dataType:"xml",success:function(a){c(a),d.resolve(e)},error:function(a,b,c){d.reject("code: "+a.status+"\nmessage: "+a.responseText+"\nerror: "+c)}}):d.resolve(e),d.promise()}function f(){l.animate({left:-l.width()},250,function(){$(window).off("resize",d),l.remove(),l=null})}function g(a){var c=$(a.target);if(!(c.hasClass("jstree-ocl")||c.closest(".toc-svg-ocl-icon").length||c.closest(".toc-svg-folder-icon").length)){var d;d="LI"==a.target.tagName?$(a.target):$(a.target).parents("li");var e=d.attr("data-page");_.isUndefined(e)||(isNaN(e)?b.Book.move(e,{silent:!1}):b.Book.move(Number(e),{isLogical:!0,silent:!1}),b.isMobileDevice&&f())}}function h(){if(o||(o=q.toclistUrl?q.toclistUrl:b.paths.data+"toclist.xml"),p=(_.isUndefined(n)||_.isNull(n))&&!0!==b.config.toclist,_.isNumber(b.config.tocPageNumber)&&(!b.isMobileDevice||p))return void b.Book.move(Number(b.config.tocPageNumber),{isLogical:!0,silent:!1});_.isUndefined(k)&&(k=Mustache.render(b.HtmlLoader.TOC,{Strings:b.Strings,theme:b.theme})),l||(c().children(".panel-heading").find(".close").on("click",f),m.on("click.jstree",g))}function i(a){a||(a={}),q=_.extend(q,a)}function j(a){n=a}var k,l,m,n,o,p,q=(b.Strings,{icons:!0});b.CommandManager.registerInternal(b.Commands.TOC,h),a.configure=i,a.setXMLData=j,b.extensions.TOC=a}),define("toast/extensions/defaults/Search",["exports","../../core"],function(a,b){"use strict";function c(a,b){var c,d,e,f=a,g=b||"EM",h=new RegExp("^(?:"+g+"|SCRIPT|FORM)$"),i=["#ff6","#a0ffff","#9f9","#f99","#f6f"],j=[],k=0,l="";this.setRegex=function(a){l=new RegExp("("+a+")","i"),c=a},this.getRegex=function(){return l.toString().replace(/^\/\\b\(|\)\\b\/i$/g,"").replace(/\|/g," ")},this.hiliteWords=function(a){if(void 0!=a&&a&&l&&!h.test(a.nodeName)){if(a.hasChildNodes())for(var b=0;b<a.childNodes.length;b++)this.hiliteWords(a.childNodes[b]);if(3==a.nodeType&&(d=a.nodeValue)&&(e=l.exec(d))){j[e[0].toLowerCase()]||(j[e[0].toLowerCase()]=i[k++%i.length]);var c=document.createElement(g);c.appendChild(document.createTextNode(e[0])),c.style.backgroundColor=j[e[0].toLowerCase()],c.style.fontStyle="inherit",c.style.color="#000";var f=a.splitText(e.index);f.nodeValue=f.nodeValue.substring(e[0].length),a.parentNode&&a.parentNode.insertBefore(c,f)}}},this.remove=function(){for(var a,b=document.getElementsByTagName(g);b.length&&(a=b[0]);)a.parentNode.replaceChild(a.firstChild,a)},this.apply=function(a){if(void 0!=a&&a){this.remove();var b=a.split(" ");_.each(b,function(a){this.setRegex(a),_.isArray(f)?_.each(f,function(a){this.hiliteWords(a[0])},this):this.hiliteWords(f[0])},this)}}}function d(){var a,c;$("<ul />");this.apply=function(d){var e,f,g,h,i,j=[],k=0,l=d.toLowerCase().split(" ");_.each(B,function(a){_.any(l,function(c){try{if("?"===c.substr(0,1)&&(c=c.substr(1)),e=new RegExp("("+c+")","i"),f=a.get("text"),g=e.exec(f)){h=Math.max(0,g.index-50),i=Math.min(f.length-h,100),f=f.substr(h,i)+" ...";var d=document.createTextNode(f),l=$("<span />");l.append(d);var m={};m.index=k;var n,o=b.project.models[a.get("index")].get("thumbnail");return n=o.url?b.StringUtils.replaceTemplate(o.url):o.src,m.thumbUrl=n,m.thumbWidth=o.width,m.thumbHeight=o.height,m.html=l.html(),m.displayPageNumber=b.Book.getDisplayPageNumber(b.Book.toLogicalPageNumber(a.get("index")+1)),j.push(m),k++,!0}}catch(a){}})});var m=Mustache.render(r,{searchResults:b.config.reversePageTurnDirection?j.reverse():j,Strings:TT.Strings,theme:TT.theme});a=$(m),$(".toast").append(a),c=a.find(".container"),_.each(l,function(b){a.find(".panel-body > .container").tt_highlight(b)}),a.find(".panel-heading .btn.close").on("click",this.hide),a.find(".panel-body > .container > .row").on("click",this.click),c.css("height",$(window).height()-c.offset().top+"px"),$(window).on("resize",this.windowRsize)},this.click=function(a){var c=$(a.currentTarget);x=Number(c.attr("data-index"));var d=B[x].get("index");b.Book.move(b.Book.toLogicalPageNumber(d+1),{isLogical:!0,silent:!1}),i(d),m()},this.show=function(){a.animate({left:0},250)},this.hide=function(){a.animate({left:-(a.width()+100)},250)},this.remove=function(){$(window).off("resize",this.windowRsize),a.remove()},this.windowRsize=function(){c.css("height",$(window).height()-c.offset().top+"px")}}function e(){n(function(){if(E=s.find(".searchinput").val(),!_.isEmpty(E)){x=0,k(),w&&(w.remove(),w=null),B=[];var a=E.toLowerCase().split(" ");_.each(A.models,function(b){var c=b.get("text").toLowerCase(),d=0;_.any(a,function(a){!0===_.contains(c,a)&&d++}),d===a.length&&B.push(b)}),_.isEmpty(B)?(b.DialogBar.present({autoDismiss:!0,dismissInterval:3e3,titleIcon:"glyphicon glyphicon-info-sign",title:y.ALERT_TITLE,content:"<b>"+y.ALERT_NO_SEARCH_RESULT+"</b>"}),s.removeClass("has-search-result")):(w=new d,w.apply(E),g(),i(),s.addClass("has-search-result"),TT.isMobileDevice&&s.find(".searchinput").blur()),m()}})}function f(a){switch(a.keyCode){case b.KeyEvent.DOM_VK_RETURN:a.preventDefault(),e();break;case b.KeyEvent.DOM_VK_ESCAPE:l()}}function g(){w.show()}function h(){b.Book.enableAction(!1),b.__resizeBlock__=!0,_.isUndefined(s)||_.isUndefined(s[0])||(s.remove(),s=null),r=b.HtmlLoader.Searchlist;var a=Mustache.render(b.HtmlLoader.Searchbar,{Strings:b.Strings,theme:b.theme});if(s=$(a),s.find(".btn-search").on("click",e),s.find(".searchinput").on("keydown",f),s.find(".btn.close").on("click",l),!b.isMobileDevice){var c=(b.$el.width()-b.$bookContainer.width())/2;c-=b.$bookContainer.offset().left,s.css("marginLeft",-c)}b.$el.append(s),b.$el.addClass("show-searchbar"),t=s.find(".btn-list"),u=s.find(".badge"),t.on("click",g),b.$navbar.addClass("hide"),s.animate({top:0},100),b.lazy(function(){s.find(".searchinput").focus()},100),z=!0}function i(a){if(a||(a=p(b.Book.getCurrentPageNumber())),-1!=a)if(!0!==b.Book.isDoublePage()){var c=b.Book.views[a];c.ready(function(){j()})}else{var d=b.Book.views[a],e=Math.min(b.project.models.length-1,a+1);if(e!==a){var f=b.Book.views[e];f.ready(function(){d.ready(function(){j()})})}else d.ready(function(){j()})}}function j(){var a=b.Book.getCurrentPage();if(a.length>0&&z)if(a.length>1){if(_.isUndefined(a[0].html())||_.isUndefined(a[1].html()))return void TT.lazy(j,10)}else if(_.isUndefined(a[0].html()))return void TT.lazy(j,10);v=new c(a),v.apply(E)}function k(){v&&(v.remove(),v=null),_.isUndefined(D)||_.isNull(D)||(clearInterval(D),D=null)}function l(){z&&(s.find(".searchinput").blur(),b.Book.enableAction(!0),TT.__resizeBlock__=!1,k(),w&&(w.remove(),w=null),B=[],s.find(".searchinput").val(""),s.animate({top:-(s.height()+5)},100),b.lazy(function(){TT.$navbar.removeClass("hide")},50),b.$el.removeClass("show-searchbar"),z=!1)}function m(){_.isEmpty(B)?(t.hide(),u.text("0")):(t.show(),u.text(B.length))}function n(a){if(C.promise().done(a),C._success_)return void C.resolve();var c=[],d=new $.Deferred,e=new $.Deferred;A.reset();var f=0;_.each(b.project.models,function(a){A.add({index:f,text:""}),f++});var g=new Backbone.Collection;c.push(d.promise()),_.each(b.project.models,function(a){g.add({text:""})}),(new Backbone.Collection).fetch({url:b.paths.data+"searchwords.json",success:function(a,c){g.reset(b.config.reversePageTurnDirection?a.models.reverse():a.models),d.resolve()},error:function(a,b){d.reject()}});var h=new Backbone.Collection;c.push(e.promise()),_.each(b.project.models,function(a){h.add({text:""})}),(new Backbone.Collection).fetch({url:b.paths.data+"searchwords-extra.json",success:function(a,c){h.reset(b.config.reversePageTurnDirection?a.models.reverse():a.models),e.resolve()},error:function(a,b){e.reject()}}),TT.Async.waitForAll(c).always(function(){o(g,h),C._success_=!0,C.resolve()})}function o(a,c){for(var d,e,f=b.project.models.length,g=0;g<f;g++)e="",d=A.at(g),_.isUndefined(a.at(g))||(e=a.at(g).get("text")),_.isUndefined(c.at(g))||_.isEmpty(c.at(g).get("text"))||(e+=" "+c.at(g).get("text")),d.set("text",e);d=A.at(0)}function p(a){var b=-1;return _.any(B,function(c){return c.get("index")===a[0]-1?(b=c.get("index"),!0):a.length>1&&c.get("index")===a[1]-1?(b=c.get("index"),!0):void 0}),b}function q(){b.CommandManager.execute(b.Commands.STOP_AUTO_SLIDE),z?l():h()}var r,s,t,u,v,w,x,y=b.Strings,z=!1,A=new Backbone.Collection,B=[],C=new $.Deferred,D=null,E="";b.on(b.Events.PAGE_DID_LOAD,function(a){z&&!_.isEmpty(B)&&_.each(B,function(b){b.get("index")===a-1&&i()})}),b.on(b.Events.PAGE_DID_CHANGE,function(a,b){z&&!_.isEmpty(B)&&_.any(B,function(b){return b.get("index")===a[0]-1?(i(),!0):a.length>1&&b.get("index")===a[1]-1?(i(),!0):void 0})}),b.on(b.Events.ORIENTATION_DID_CHANGE,function(a){l(),b.isMobileDevice&&b.lazy(function(){b.Book.layout()},150)}),b.ready(function(){n(),b.CommandManager.registerInternal(b.Commands.SEARCH,q)})}),define("toast/extensions/defaults/Bookmark",["exports","../../core"],function(a,b){"use strict";function c(a,b){var c=q.findWhere({page:a});_.isUndefined(c)||(c.set("text",b),q.updateItem(c))}function d(a){var b=q.findWhere({page:a});return _.isUndefined(b)?"":b.get("text")}function e(){TT.$toggleBookmark.removeClass("on"),f()&&TT.$toggleBookmark.addClass("on")}function f(){var a=b.Book.getCurrentPageNumber(),c=q.findWhere({page:a[0]});return!_.isUndefined(c)||1!=a.length&&(c=q.findWhere({page:a[1]}),!_.isUndefined(c))}function g(a,b){q.addItem({page:a,text:b}),e()}function h(a){var b=q.findWhere({page:a});_.isUndefined(b)||(q.removeItem(b),e())}function i(){q.empty(),e(),TT.send(b.Events.BOOKMARK_DID_CHANGE,q)}function j(){return q.toJSON()}function k(){if(r){var a=[],c=b.Book.getCurrentPageNumber(),e=[],f=b.DialogBar.$el.find('input[type="checkbox"]');_.each(c,function(b,c){q.findWhere({page:b})?(a.push(b),f[c].checked=!0,e.push(f[c])):f[c].checked=!1}),!b.config.doublepage||b.Book.isCoverPage()?(b.DialogBar.$el.find(".body .page-form-group").hide(),f[0].checked=!0,f[1].checked=!1):b.DialogBar.$el.find(".body .page-form-group").show(),0===a.length?(0===e.length?b.DialogBar.$el.find(".header .title").text(t.BOOKMARK):b.DialogBar.$el.find(".header .title").text(t.ADD_BOOKMARK_TITILE),b.DialogBar.$el.find(".header .title-icon").css("color",""),b.DialogBar.$el.find('.btn[data-button-id="remove"]').hide(),b.DialogBar.$el.find("textarea").val(s)):(b.DialogBar.$el.find(".header .title-icon").css("color","red"),b.DialogBar.$el.find(".header .title").text(t.MODIFY_BOOKMARK_TITILE),b.DialogBar.$el.find('.btn[data-button-id="remove"]').show(),b.DialogBar.$el.find("textarea").val(d(a[0]))),!b.config.doublepage||b.Book.isCoverPage()||e.length>0?b.DialogBar.$el.find('.btn[data-button-id="'+b.Dialog.DIALOG_BTN_OK+'"]').tt_enable():b.DialogBar.$el.find('.btn[data-button-id="'+b.Dialog.DIALOG_BTN_OK+'"]').tt_disable()}}function l(){f()||(s=$(this).val())}function m(a){var c=[],e=b.Book.getCurrentPageNumber(),g=[],h=b.DialogBar.$el.find('input[type="checkbox"]');_.each(h,function(a,b){var d=$(a);if(d[0].checked){g.push(d);q.findWhere({page:e[b]})&&c.push(e[b])}}),f()||(s=b.DialogBar.$el.find("textarea").val()),0===c.length?(0===g.length?b.DialogBar.$el.find(".header .title").text(t.BOOKMARK):b.DialogBar.$el.find(".header .title").text(t.ADD_BOOKMARK_TITILE),b.DialogBar.$el.find('.btn[data-button-id="remove"]').tt_disable(),b.DialogBar.$el.find(".header .title-icon").css("color",""),b.DialogBar.$el.find('.btn[data-button-id="remove"]').hide(),b.DialogBar.$el.find("textarea").val(s)):(b.DialogBar.$el.find('.btn[data-button-id="remove"]').tt_enable(),b.DialogBar.$el.find(".header .title-icon").css("color","red"),b.DialogBar.$el.find(".header .title").text(t.MODIFY_BOOKMARK_TITILE),b.DialogBar.$el.find('.btn[data-button-id="remove"]').show(),b.DialogBar.$el.find("textarea").val(d(c[0]))),!b.config.doublepage||g.length>0?b.DialogBar.$el.find('.btn[data-button-id="'+b.Dialog.DIALOG_BTN_OK+'"]').tt_enable():b.DialogBar.$el.find('.btn[data-button-id="'+b.Dialog.DIALOG_BTN_OK+'"]').tt_disable()}function n(a){if(r=!1,s="",a&&_.isString(a)&&a!==b.Dialog.DIALOG_BTN_CANCEL){var d=b.DialogBar.$el.find("textarea"),e=d.val();e=e.replace(/<\/?[^>]+(>|$)/g,"");var f=[],i=b.Book.getCurrentPageNumber(),j=b.DialogBar.$el.find('input[type="checkbox"]');_.each(j,function(a){var b=$(a);b[0].checked&&"left-page"===b.attr("name")?f.push(i[0]):b[0].checked&&"right-page"===b.attr("name")&&i.length>1&&f.push(i[1])}),0!==f.length&&(a===b.Dialog.DIALOG_BTN_OK?_.each(f,function(a){var b=q.findWhere({page:a});_.isObject(b)?c(a,e):g(a,e)}):"remove"===a&&_.each(f,function(a){h(a)}),b.send(b.Events.BOOKMARK_DID_CHANGE,q))}}function o(a){if(!r){var c='<form class="form-horizontal"><textarea class="form-control" placeholder="'+t.ENTER_TEXT+'"></textarea><div class="form-group page-form-group"><label class="col-sm-3 page-title">'+t.SELECT_PAGE_TITLE+'</label><div class="col-sm-8"><div class="input-group"><label class="checkbox-label"><input type="checkbox" name="left-page"><span class="checkbox"><span class="check-icon  glyphicon glyphicon-ok"></span></span><span class="checkbox-title">'+t.LEFT_PAGE_TITLE+'</span></label><label class="checkbox-label"><input type="checkbox" name="right-page"><span class="checkbox"><span class="check-icon  glyphicon glyphicon-ok"></span></span><span class="checkbox-title">'+t.RIGHT_PAGE_TITLE+"</span></label></div></div></div></form>",e={modalClassName:"bookmarks",titleIcon:"fa fa-bookmark",title:t.BOOKMARK,content:c},g=[{className:b.Dialog.DIALOG_BTN_CLASS_NORMAL,id:b.Dialog.DIALOG_BTN_CANCEL,text:t.CANCEL}];f()&&(g.push({className:b.Dialog.DIALOG_BTN_CLASS_DANGER,id:"remove",text:t.DELETE,icon:"glyphicon glyphicon-trash"}),e.title=t.MODIFY_BOOKMARK_TITILE);var h=[{className:b.Dialog.DIALOG_BTN_CLASS_PRIMARY,id:b.Dialog.DIALOG_BTN_OK,text:t.OK}];e.leftButtons=g,e.rightButtons=h,e.dismiss=!0,e.modal=!0;var i=b.DialogBar.present(e);i.done(n),i.fail(n),b.DialogBar.$el.find('input[type="checkbox"]').on("change",m),b.DialogBar.$el.find("textarea").on("change",l),b.DialogBar.$el.find("textarea").val(d(b.Book.getCurrentPageNumber()[0])),b.DialogBar.$el.find("textarea").focus(),r=!0,k()}}function p(){e(),b.on(b.Events.PAGE_DID_CHANGE,function(a,b){e(),r&&(s="",k())}),b.on(b.Events.DOUBLEPAGE_DID_CHANGE,function(a){e(),r&&(s="",k())}),b.CommandManager.registerInternal(b.Commands.TOGGLE_BOOKMARK,o)}var q,r,s,t=b.Strings;b.ready(function(){q=b.Storage.get(b.Storage.BOOKMARK),q.ready(function(){p()})}),a.addItem=g,a.removeItem=h,a.empty=i,a.getAll=j,a.has=f,b.Bookmark=a}),define("toast/extensions/defaults/Memo",["exports","toast/core/book/BookZoom"],function(a,b){"use strict";function c(a){a=_.isArray(a)?a:[a];var b=[];_.each(a,function(a){var c=x.where({page:a},!1);c&&(b=b.concat(c))});var c=0;_.each(b,function(a){var b=a.attributes,d=Toast.Book.views[b.page-1];if(0!==d.$contents.children("#"+b.id).length)return!0;var e=$('<div class="memo-icon" />');e.attr("id",b.id),e.css({position:"absolute",left:b.offset.left+"px",top:b.offset.top+"px",width:"60px",height:"60px",zIndex:999+c}),d.$contents.append(e),k(e),c++})}function d(a){var b=[];if(a){a=!_.isArray(a)?[a]:a,_.each(a,function(a){var c=x.where({page:a},!1);c&&(b=b.concat(c))})}else b=x.models;_.each(b,function(a){var b=a.attributes,c=Toast.Book.views[b.page-1],d=c.$contents.find(".memo-icon");d.off("draginit drag dragstart dragend click dblclick"),d.remove()})}function e(a,b){var c=Toast.Book.views[a-1],d=parseInt(c._model.width/2-30),e=parseInt(c._model.height/2-30),f={id:Toast.UUID8(),page:a,text:b,offset:{left:d,top:e}},g=$('<div class="memo-icon" />'),h=c.$contents.children(".memo-icon").length>0?Number(c.$contents.children(".memo-icon").last().css("zIndex"))+1:999;g.attr("id",f.id),g.css({position:"absolute",left:d,top:e,width:"60px",height:"60px",zIndex:h}),c.$contents.append(g),k(g);var i=x.addItem(f);if(i){var j=i.get("offset");j.left==d&&j.top==e||g.css({left:j.left,top:j.top})}}function f(a,b){var c=x.findWhere({id:b});_.isUndefined(c)||(c.set("text",a),x.updateItem(c))}function g(a){var b=x.findWhere({id:a.attr("id")});_.isUndefined(b)||(b.set("offset",{left:parseInt(a.css("left"),10),top:parseInt(a.css("top"),10)}),x.updateItem(b))}function h(a){var b=x.findWhere({id:a});_.isUndefined(b)||(x.removeItem(b),m().find("#"+a).remove())}function i(){return x.toJSON()}function j(){d(),x.empty(),TT.send(Toast.Events.MEMO_DID_CHANGE,x)}function k(a){l(a),a.on("click",n),a.on("dblclick",o),a.drag("init",p),a.drag("start",q,{distance:1}),a.drag("drag",r),a.drag("end",s)}function l(a){a.off("draginit drag dragstart dragend click dblclick")}function m(){return Toast.IS_ZOOM?$(".bookzoom"):$(".book")}function n(a){var b=$(a.currentTarget),c=x.findWhere({id:b.attr("id")});_.isUndefined(c)||v(c.get("text"),c.get("id"))}function o(a){}function p(a,b){}function q(a,b){var c=$(b.drag);c.closest("section");b.__startLeft__=parseInt(c.css("left"),10),b.__startTop__=parseInt(c.css("top"),10),b.__bookScale__=m().tt_scale(),b.__pageScale__=c.parent().tt_scale(),Toast.IS_DRAGGING=!0}function r(a,b){var c=$(b.drag),d={};d.left=b.__startLeft__+b.deltaX/b.__bookScale__/b.__pageScale__,d.top=b.__startTop__+b.deltaY/b.__bookScale__/b.__pageScale__,c.css(d)}function s(a,b){var c=$(b.drag);b.translate&&delete b.translate,g(c),Toast.IS_DRAGGING=!1}function t(a){var b=$(a.currentTarget),c=(b.attr("name"),b[0].checked),d=Toast.DialogBar.$el.find('input[type="radio"]');_.each(d,function(a){$(a)[0].checked=!1}),b[0].checked=c}function u(a){if(y=!1,a&&_.isString(a)&&a!==Toast.Dialog.DIALOG_BTN_CANCEL){var b=Toast.DialogBar.$el.find("textarea"),c=b.val();c=c.replace(/<\/?[^>]+(>|$)/g,"");var d=Toast.Book.getCurrentPageNumber(),g=Toast.DialogBar.$el.find('input[type="radio"]');_.each(g,function(a){var b=$(a);b[0].checked&&"left-page"===b.attr("name")?d=d[0]:b[0].checked&&"right-page"===b.attr("name")&&(d=d[1])});var i=Toast.DialogBar.$el.attr("data-id");a===Toast.Dialog.DIALOG_BTN_OK?i?f(c,i):e(d,c):"remove"===a&&h(i),TT.send(Toast.Events.MEMO_DID_CHANGE,x)}}function v(a,b){if(!y){var c='<form class="form-horizontal"><textarea class="form-control" placeholder="'+z.ENTER_TEXT+'"></textarea><div class="form-group page-form-group"><label class="col-sm-3 page-title">'+z.SELECT_PAGE_TITLE+'</label><div class="col-sm-8"><div class="input-group"><label class="checkbox-label"><input type="radio" name="left-page" checked><span class="radio"></span><span class="checkbox-title">'+z.LEFT_PAGE_TITLE+'</span></label><label class="checkbox-label"><input type="radio" name="right-page"><span class="radio"></span><span class="checkbox-title">'+z.RIGHT_PAGE_TITLE+"</span></label></div></div></div></form>",d={modalClassName:b?"memos modify":"memos",titleIcon:"fa fa-sticky-note",title:b?z.MODIFY_MEMO_TITILE:z.ADD_MEMO_TITILE,content:c},e=[{className:Toast.Dialog.DIALOG_BTN_CLASS_NORMAL,id:Toast.Dialog.DIALOG_BTN_CANCEL,text:z.CANCEL}];b&&(d.attrs=[{"data-id":b}],e.push({className:Toast.Dialog.DIALOG_BTN_CLASS_DANGER,id:"remove",text:z.DELETE,icon:"glyphicon glyphicon-trash"}));var f=[{className:Toast.Dialog.DIALOG_BTN_CLASS_PRIMARY,id:Toast.Dialog.DIALOG_BTN_OK,text:z.OK}];d.leftButtons=e,d.rightButtons=f,d.dismiss=!0,d.modal=!0;var g=Toast.DialogBar.present(d);g.done(u),g.fail(u),Toast.DialogBar.$el.find('input[type="radio"]').on("change",t),Toast.DialogBar.$el.find("textarea").val(a),Toast.isAndroid&&!Toast.isChrome||Toast.DialogBar.$el.find("textarea").focus(),(b||!Toast.config.doublepage||Toast.Book.isCoverPage())&&Toast.DialogBar.$el.find(".body .page-form-group").hide(),y=!0}}function w(){function a(){Toast.CommandManager.execute(Toast.Commands.STOP_AUTO_SLIDE),v()}var b=Toast.Book.getVisiblePages();_.each(b,function(a){c(a)}),Toast.on(Toast.Events.PAGE_DID_LOAD,function(a){c(a)}),Toast.on(Toast.Events.PAGE_DID_UNLOAD,function(a){d(a)}),Toast.on(Toast.Events.PAGE_DID_CHANGE,function(a,b){y&&Toast.DialogBar.dismiss()}),Toast.on(Toast.Events.DOUBLEPAGE_DID_CHANGE,function(a){y&&Toast.DialogBar.dismiss()}),Toast.on(Toast.Events.ZOOM_MODE_DID_CHANGE,function(a){var b=Toast.Book.getCurrentPageNumber();d(b),c(b)}),Toast.CommandManager.registerInternal(Toast.Commands.ADD_MEMO,a)}var x,y,z=Toast.Strings;Toast.Book;Toast.ready(function(){x=Toast.Storage.get(Toast.Storage.MEMO),x.ready(function(){w()})}),a.getAll=i,a.empty=j}),define("toast/extensions/defaults/Share",["exports","../../core"],function(a,b){function c(){var a=b.PathUtils.parseUrl(document.location.href).hrefNoSearch;return a+="?startpage="+b.Book.getCurrentPageNumber({isLogical:!0})[0]}function d(a){var b=a;return b.lastIndexOf("/")===b.length-1?b:b.substring(0,b.lastIndexOf("/",b.length-2)+1)}function e(a){a.preventDefault(),a.stopPropagation();var c=$(a.currentTarget).attr("command");c&&b.executeCommand(c)}function f(a){a.preventDefault(),a.stopPropagation(),b.isMobileDevice&&!b.isAndroid||(o.find(".input-url").focus(),o.find(".input-url").select(),document.execCommand("Copy"),alert(p.COPY_URL_SUCCESS_ALERT))}function g(a){var b=$(a.target).parents(".modal-content");($(a.target).hasClass("close")||_.isUndefined(b[0]))&&o.remove()}function h(){var a,c,e=window.document.title,f=$('meta[property="og:description"]').attr("content"),g=$('meta[property="og:image"]').attr("content"),h=b.config.kakaotalk_sender;h||(h="http://itoast.kr/webservices/sendkakaotalk");var i=b.PathUtils.parseUrl(document.location.href).hrefNoSearch,j="url="+i;if(j+="&startpage="+b.Book.getCurrentPageNumber({isLogical:!0})[0],j+="&title="+e,j+="&text="+f,b.me)a=b.project.config.thumbnail.width,c=b.project.config.thumbnail.height;else if(_.isEmpty(g))if(b.project.config.thumbnail&&!_.isEmpty(b.project.config.thumbnail.url))g=b.StringUtils.replaceTemplate(b.project.config.thumbnail.url).encodeFilePath(),a=b.project.config.thumbnail.width,c=b.project.config.thumbnail.height;else{var k=b.project.at(0);k&&!_.isEmpty(k.thumbnail.url)&&(g=b.StringUtils.replaceTemplate(k.thumbnail.url).encodeFilePath())}b.me&&"http"!==g.substr(0,4)&&"//"!==g.substr(0,2)?g=window.location.host+"/"+g:_.isEmpty(g)||"http"!==g.substr(0,4)&&"//"!==g.substr(0,2)&&(g=window.location.host+d(window.location.pathname)+g),_.isEmpty(g)||(j+="&imageUrl="+g),_.isUndefined(a)||_.isUndefined(c)||(j+="&imageWidth="+a+"&imageHeight="+c),window.open(h+"?"+j)}function i(){m("https://story.kakao.com/share?url="+c())}function j(){m("https://www.facebook.com/sharer/sharer.php?u="+c())}function k(){m("https://twitter.com/intent/tweet?text="+encodeURIComponent(window.document.title)+"&url="+c())}function l(){m("https://plus.google.com/share?url="+c())}function m(a){window.open(a,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600")}function n(){if(_.isEmpty($(document.body).children(".share-modal-wrapper"))){if(o=$(Mustache.render(b.HtmlLoader.Share,{Strings:TT.Strings,theme:TT.theme})),!b.isMobileDevice){var a=(b.$el.width()-b.$bookContainer.width())/2;a-=b.$bookContainer.offset().left,o.find(".modal-content").css("left",-a)}$(document.body).append(o),b.isMobileDevice&&!b.isAndroid&&(o.find(".group-copy-url").hide(),o.find(".group-copy-url-ios").show()),o.click(g),o.find(".close").click(g),o.find(".btn-group > button").on("click",e),o.find(".input-url").val(c()),o.find(".btn-copy-url").attr("href",c()),o.find(".btn-copy-url").text(c()),!b.isMobileDevice||b.isAndroid?o.find(".copy-url-addon").on("click",f):(o.find(".copy-url-addon").hide(),o.find(".btn-copy-url").on("click",function(a){a.preventDefault(),a.stopPropagation()}))}}var o,p=TT.Strings;b.CommandManager.registerInternal("share",n),b.CommandManager.registerInternal("sendGoogleplus",l),b.CommandManager.registerInternal("sendFacebook",j),b.CommandManager.registerInternal("sendTwitter",k),b.CommandManager.registerInternal("sendKakaotalk",h),b.CommandManager.registerInternal("sendKakaostory",i)}),define("toast/extensions/defaults/Draw",["exports"],function(a){"use strict"}),define("toast/extensions/defaults/MyStorage",["require","exports","module","./Bookmark","./Memo","./Draw"],function(a,b,c,d,e,f){"use strict";function g(){return p=$(Mustache.render(o,{Strings:TT.Strings,theme:TT.theme})),q=p.find(".container"),TT.$el.append(p),i(),p.animate({left:0},250),TT.on(Toast.Events.BOOKMARK_DID_CHANGE,i),TT.on(Toast.Events.MEMO_DID_CHANGE,i),$(document.body).addClass("show-mystorage"),p.children(".panel-heading").find(".close").on("click",j),p.children(".panel-heading").find(".trash").on("click",k),p}function h(){q.css("height",$(window).height()-q.offset().top+"px")}function i(){var a=_.clone(d.getAll());_.each(a,function(a){if(Toast.project.models.length<a.page)return!0;var b,c=Toast.project.models[a.page-1].get("thumbnail");b=c.url?Toast.StringUtils.replaceTemplate(c.url):c.src,a.displayPageNumber=Toast.Book.getDisplayPageNumber(Toast.Book.toLogicalPageNumber(a.page)),a.thumbUrl=b,a.thumbWidth=c.width,a.thumbHeight=c.height});var b=_.clone(e.getAll());_.each(b,function(a){if(Toast.project.models.length<a.page)return!0;var b,c=Toast.project.models[a.page-1].get("thumbnail");b=c.url?Toast.StringUtils.replaceTemplate(c.url):c.src,a.displayPageNumber=Toast.Book.getDisplayPageNumber(Toast.Book.toLogicalPageNumber(a.page)),a.thumbUrl=b,a.thumbWidth=c.width,a.thumbHeight=c.height});var c={bookmarks:a,memos:b,Strings:Toast.Strings},f=$(Mustache.render(o,c)),g=f.find("#mystorage-bookmarks > .container").children();p.find("#mystorage-bookmarks > .container").children().remove(),p.find("#mystorage-bookmarks > .container").append(g),p.find("#mystorage-bookmarks > .container > .row").on("click",l);var h=f.find("#mystorage-memos > .container").children();p.find("#mystorage-memos > .container").children().remove(),p.find("#mystorage-memos > .container").append(h),p.find("#mystorage-memos > .container > .row").on("click",m),_.isEmpty(a)&&_.isEmpty(b)?p.children(".panel-heading").find(".trash").tt_disable():p.children(".panel-heading").find(".trash").tt_enable()}function j(){p.animate({left:-500},250,function(){$(window).off("resize",h),p.remove(),p=null}),$(document.body).removeClass("show-mystorage"),TT.off(Toast.Events.BOOKMARK_DID_CHANGE,i),TT.off(Toast.Events.MEMO_DID_CHANGE,i)}function k(a){Toast.DialogBar.present({dismiss:!0,titleIcon:"glyphicon glyphicon-inbox",title:r.ALERT_TITLE,leftButtons:[{className:Toast.Dialog.DIALOG_BTN_CLASS_NORMAL,id:Toast.Dialog.DIALOG_BTN_CANCEL,text:r.CANCEL}],rightButtons:[{className:Toast.Dialog.DIALOG_BTN_CLASS_DANGER,id:Toast.Dialog.DIALOG_BTN_OK,text:r.DELETE,icon:"glyphicon glyphicon-trash"}],content:"<b>"+r.REMOVE_ALL_MY_STORAGE+"</b>"}).done(function(a){a===Toast.Dialog.DIALOG_BTN_OK&&(d.empty(),e.empty())})}function l(a){var b=$(a.currentTarget).closest(".row");Toast.Book.move(b.attr("data-page"),{isLogical:!1,silent:!1}),Toast.isMobileDevice&&j()}function m(a){var b=$(a.currentTarget).closest(".row");Toast.Book.move(b.attr("data-page"),{isLogical:!1,silent:!1}),Toast.isMobileDevice&&j()}function n(){_.isUndefined(o)&&(o=Toast.HtmlLoader.MyStorage),p||g()}var o,p,q,r=Toast.Strings;Toast.Dialog;Toast.CommandManager.registerInternal(Toast.Commands.MY_STORAGE,n)}),define("toast/extensions/defaults/AutoSlide",["exports","../../core"],function(a,b){"use strict";function c(a,b){this.requestAnimationFrameMethod=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,this.diameter=50,this.thickness=2,this.playing=!1,this.progress=0,this.progressOffset=1,this.progressCheck=b,null!==a&&(this.canvas=a,this.canvas.width=this.diameter,this.canvas.height=this.diameter,this.context=this.canvas.getContext("2d"),this.thickness=Number(a.getAttribute("data-thickness")||2),this.backgroundColor=a.getAttribute("data-background-color")||"rgba( 255, 255, 255, 0.4 )",this.strokeColor=a.getAttribute("data-stroke-color")||"#ddd",this.fillStrokeColor=a.getAttribute("data-fill-stroke-color")||"#3f3f3f",this.canvas.style.display="block"),this.render()}function d(){g();var a=r,c=b.Book.getCurrentPage();_.each(c,function(a){var b=a.find("video, audio");b.length>0&&_.each(b,function(a){a.hasAttribute("data-autoplay")&&r&&1e3*a.duration>r&&(r=1e3*a.duration+1e3)})}),b.config.reversePageTurnDirection?!r||q||!b.Book.availablePageNavigation().prev&&!0!==s?b.Book.availablePageNavigation().prev||(g(),i()):(o=setTimeout(b.Book.availablePageNavigation().prev?b.Book.previous:b.Book.moveToLast,r),p=Date.now()):!r||q||!b.Book.availablePageNavigation().next&&!0!==s?b.Book.availablePageNavigation().next||(g(),i()):(o=setTimeout(b.Book.availablePageNavigation().next?b.Book.next:b.Book.moveToFirst,r),p=Date.now()),n&&n.setPlaying(-1!==o),r=a}function e(){r&&!q&&(q=!0,b.send(b.Events.AUTOSLIDE_DID_PAUSE),clearTimeout(o),n&&n.setPlaying(!1))}function f(){r&&q&&(q=!1,b.send(b.Events.AUTOSLIDE_DID_RESUME),d())}function g(){clearTimeout(o),o=-1}function h(){return o>0}function i(){n&&(n.destroy(),n=null)}function j(){b.Book.getTotalPageNumber()<1||(h()?l():k())}function k(){b.Book.getTotalPageNumber()<1||h()||(TT.$toggleAutoSlide.addClass("on"),(!b._msieVersion||b._msieVersion&&b._msieVersion>9)&&(i(),n=new c(document.querySelector(".toast").querySelector(".autoslide"),function(){return Math.min(Math.max((Date.now()-p)/r,0),1)}),n.on("click",m)),q=!1,d())}function l(){b.Book.getTotalPageNumber()<1||h()&&(TT.$toggleAutoSlide.removeClass("on"),g(),i())}function m(a){b.Book.isLastPage()&&!1===s?(b.Book.moveToFirst(),f()):q?f():e()}b.Strings;c.prototype.setPlaying=function(a){var b=this.playing;this.playing=a,!b&&this.playing?this.animate():this.render()},c.prototype.animate=function(){var a=this.progress;this.progress=this.progressCheck(),a>.8&&this.progress<.2&&(this.progressOffset=this.progress),this.render(),this.playing&&this.requestAnimationFrameMethod.call(window,this.animate.bind(this))},c.prototype.render=function(){if(this.context){var a=this.playing?this.progress:0,b=this.diameter/2-this.thickness,c=this.diameter/2,d=this.diameter/2,e=14;this.progressOffset+=.1*(1-this.progressOffset);var f=-Math.PI/2+a*(2*Math.PI),g=-Math.PI/2+this.progressOffset*(2*Math.PI);this.context.save(),this.context.clearRect(0,0,this.diameter,this.diameter),this.context.beginPath(),this.context.arc(c,d,b+2,0,2*Math.PI,!1),this.context.fillStyle=this.backgroundColor,this.context.fill(),this.context.beginPath(),this.context.arc(c,d,b,0,2*Math.PI,!1),this.context.lineWidth=this.thickness,this.context.strokeStyle=this.strokeColor,this.context.stroke(),this.playing&&(this.context.beginPath(),this.context.arc(c,d,b,g,f,!1),this.context.lineWidth=this.thickness+this.thickness/2,this.context.strokeStyle=this.fillStrokeColor,this.context.stroke()),this.context.translate(c-e/2,d-e/2),this.playing?(this.context.fillStyle="#3f3f3f",this.context.fillRect(0,0,2*this.thickness,e),this.context.fillRect(e/2+2,0,2*this.thickness,e)):(this.context.beginPath(),this.context.translate(2,0),this.context.moveTo(0,0),this.context.lineTo(e-2,e/2),this.context.lineTo(0,e),this.context.fillStyle="#3f3f3f",this.context.fill()),this.context.restore()}},c.prototype.on=function(a,b){this.canvas&&this.canvas.addEventListener(a,b,!1)},c.prototype.off=function(a,b){this.canvas&&this.canvas.removeEventListener(a,b,!1)},c.prototype.destroy=function(){this.playing=!1,this.canvas&&(this.canvas.style.display="none")};var n=null,o=0,p=-1,q=!1,r=3e3,s=!0;b.on(b.Events.PAGE_DID_CHANGE,function(a,b){h()&&d()}),b.on(b.Events.ZOOM_MODE_DID_CHANGE,function(a){h()&&l()}),b.CommandManager.registerInternal(b.Commands.TOGGLE_AUTO_SLIDE,j),b.CommandManager.registerInternal(b.Commands.START_AUTO_SLIDE,k),b.CommandManager.registerInternal(b.Commands.STOP_AUTO_SLIDE,l),a.isAutoSliding=h}),define("toast/extensions/defaults/Print",["exports","../../core"],function(a,b){"use strict";function c(){var a=u.find("#print-document-container");v=a.find("#print-document"),v.on("load",d)}function d(){f(),g(),k(),u.find("#orientation-menu").children("li").on("click",e)}function e(a){var b=$(a.currentTarget),c=b.attr("data-orientation"),d=u.find("#orientation-menu");d.attr("data-orientation",c),d.children("li").find("a > span").removeClass("fa fa-check-square-o"),b.find("a > span").addClass("fa fa-check-square-o"),u.find(".btn-orientation").html(b.children("a").text()+' <span class="caret">'),k()}function f(){var a=v.contents().find("head");window.location.origin||(window.location.origin=location.protocol+"//"+location.host);var c;if(b.me)c=window.location.origin+b.config.moduleBaseUrl;else{var d=window.location.pathname,e=d.substring(0,d.lastIndexOf("/"));c=window.location.origin+e+"/"}var f=$("<base />",{href:c});a.append(f);var g=["styles/toast.css"];b.debug&&g.push("styles/publish.css"),_.each(g,function(b){var c=$("<link/>").attr({type:"text/css",rel:"stylesheet",href:b});a.append(c)}),_.each(b.config.userStylesheets,function(c){if(_.isEmpty(a.children("#"+c.id))){var d={id:c.id,type:"text/css",rel:"stylesheet",href:b.paths.assets+c.src};$link=$('<link class="userStylesheet" />').attr(d),$link.appendTo(a)}})}function g(){var a="portrait",c=b.Book.getCurrentPageNumber()[0],d=b.Book.views[c-1];d.collection.width>d.collection.height&&(a="landscape");var e=u.find("#orientation-menu"),f=e.find('li[data-orientation="'+a+'"]');e.attr("data-orientation",a),e.children("li").find("a > span").removeClass("fa fa-check-square-o"),f.find("a > span").addClass("fa fa-check-square-o"),u.find(".btn-orientation").html(f.children("a").text()+' <span class="caret">')}function h(){var a=new $.Deferred,c=u.find("#orientation-menu"),d=c.attr("data-orientation"),e=v.contents().find("head"),f=e.find("#page-orientation");return 0===f.length&&(f=$("<style />",{id:"page-orientation"}),e.append(f)),"landscape"===d?f.html("@page { size: landscape; }"):f.html("@page { size: portrait; }"),b.lazy(function(){a.resolve(d)},5),a.promise()}function i(){var a=new $.Deferred;return h().then(function(b){var c=v.contents().find("body"),d=$("<page />");c.attr("data-orientation",b),c.addClass(b),c.append(d);var e={width:d.width(),height:d.height()};d.remove(),a.resolve(e)}),a.promise()}function j(a){if(a||(a={}),x=[],w){x=[];for(var c=1;c<=b.Book.getTotalPageNumber();c++)x.push(c);b.config.reversePageTurnDirection&&x.reverse()}else{var d=u.find('input[name="input-pages"]').val();d=d.split(","),_.each(d,function(a){a=a.trim();var c="";"-"===a.substr(0,1)&&(c="-",a=a.substr(1));var d=a.split("-"),e=c+d[0],f=d[1];if(e&&(e=e.trim()),f&&(f=f.trim()),"-"===f&&(f="-"+d[2]),e&&!isNaN(e)){e=Number(e);var g=b.Book.pageFromLogicalPageNumber(e);g>=1&&g<=b.Book.getTotalPageNumber()&&x.push(g)}if(!isNaN(e)&&f&&!isNaN(f)){f=Number(f);for(var h=e+1;h<=f;h++){var g=b.Book.pageFromLogicalPageNumber(h);g=Math.max(1,Math.min(g,b.Book.getTotalPageNumber())),g>=1&&g<=b.Book.getTotalPageNumber()&&x.push(g)}}})}if(u.find("header .print-total-page").html(x.length+b.Strings.PAGE),x.length?u.find(".btn-print").tt_enable():u.find(".btn-print").tt_disable(),!x.length&&!a.silent){u.find('input[name="input-pages"]').focus().select();var e=u.find('input[name="input-pages"]').val();b.DialogBar.present({titleIcon:"fa fa-exclamation-triangle",autoDismiss:!0,dismissInterval:5e3,title:z.ERROR,content:"<b>"+b.StringUtils.format(z.ERROR_NOT_VALID_PAGE_NUMBER,e)+"</b>"})}}function k(){j(),x.length&&i().then(function(a){l();var c=v.contents().find("body");c.addClass("preview"),c.children("page").remove();var d=b.project.models.length;_.each(x,function(e,f){if(e>d)return!1;var g=b.project.models[e-1];if(!g)return!0;var h=(g.attributes,$("<page />",{"data-page-no":e}));c.append(h);var i=$("<section />"),j=$("<div />",{id:g.id,class:"toast-ctrl","data-index":f}),k=new b.ViewController({el:j}),l=new $.Deferred,n=l.promise();n.view=k,A.push(n),i.css("width",a.width+"px"),i.css("height",a.height+"px"),i.append(j),h.append(i),k._state=b.STATUS_NONE,k.index=f,k.load(g.toJSON(),{showLoader:!1,readyonly:!0,print:!0}),m(j,{width:k.collection.width,height:k.collection.height})})})}function l(){_.each(A,function(a){a.view&&a.view.reset(),a.$defer&&a.$defer.reject()}),A=[]}function m(a,b){var c=Math.min(a.parent().width()/b.width,a.parent().height()/b.height),d=Math.round(b.width*c),e=Math.round(b.height*c);a.css({left:(a.parent().width()-d)/2+"px",top:(a.parent().height()-e)/2+"px",width:d+"px",height:e+"px"});var f=a.children(".contents");f.css({width:b.width+"px",height:b.height+"px"}),c=Math.max(d/b.width,e/b.height);var g=(d-b.width)/2/c,h=(e-b.height)/2/c;return f.tt_transform("scale("+c+") translate("+g+"px, "+h+"px)"),c}function n(){u.hide(),b.SpinDialog.show(b.Strings.PREPARE_PRINTING).always(function(){v.contents().find("body").removeClass("preview"),b.Async.doInParallel(A,function(a){var b=new $.Deferred;return a.view&&a.view.ready(function(){b.resolve()}),b.promise()}).always(function(){var a=v[0].contentWindow;a.onafterprint=o,b.isFirefox&&"function"==typeof a.print?a.print():a.document.execCommand("print",!1,null)})})}function o(){b.lazy(function(){b.SpinDialog.hide().always(function(){l(),r()})},100)}function p(a){var b=$(a.currentTarget).find('input[name="print-target-pages"]');u.find('input[name="print-target-pages"]').prop("checked",!1),b.prop("checked",!0);var c=b.attr("value");"all"===c&&w||"all"!==c&&!w||(w="all"===c,j({silent:!0}),x.length&&k())}function q(a){a.keyCode===b.KeyEvent.DOM_VK_RETURN||a.keyCode===b.KeyEvent.DOM_VK_ENTER?(j({silent:!0}),x.length&&k()):(y=a.currentTarget.value,b.lazyOnce(function(){a.currentTarget.value===y&&(j({silent:!0}),x.length&&k())},500,B))}function r(){u.remove(),u=null,b.Book.enableAction(!0)}function s(){w=!1,l(),_.isUndefined(t)&&(t=b.HtmlLoader.PrintModal),u=$(Mustache.render(t,{Strings:b.Strings,theme:b.theme})),$(document.body).append(u),u.on("mousemove",function(a){a.stopPropagation()}),u.find(".btn-print").on("click",n),u.find(".btn-cancel").on("click",r),u.find(".form-group-print-target-pages").on("click",p),u.find('input[name="input-pages"]').on("keyup",q);var a=b.Book.getCurrentPageNumber({isLogical:!0});b.config.reversePageTurnDirection&&a.reverse(),a=a.join("-"),u.find('input[name="input-pages"]').val(a),l(),j(),c(),b.Book.enableAction(!1)}var t,u,v,w,x,y,z=b.Strings,A=(TT.Dialog,[]),B={};b.CommandManager.registerInternal(b.Commands.PRINT,s)}),define("toast/extensions/defaults/ZoomBar",["exports","../../core"],function(a,b){"use strict";function c(){n||(n=Mustache.render(b.HtmlLoader.ZoomBar,{Strings:b.Strings,theme:b.theme})),o=b.$el.find(".zoom-bar"),p=o.length,p?o.append($(n).html()):(o=$(n),b.$el.append(o)),o.find(".svg-icon").tt_replaceSvgIcon(),o.find(".location-btn-group .btn").on("mousedown",e),o.find(".location-btn-group .btn").on("mouseup",f),o.find(".location-btn-group .btn").on("mouseout",f),o.find("[data-drag-mode]").on("click",h),o.find("[data-scale-mode]").on("click",i),o.find(".btn-zoombar-plus").on("click",j),o.find(".btn-zoombar-minus").on("click",k),o.find(".btn-zoombar-exit").on("click",l),o.find(".btn-zoombar-plus").attr("title","+"+b.config.bookZoom.zoomInOutStepPercent+"%"),o.find(".btn-zoombar-minus").attr("title","-"+b.config.bookZoom.zoomInOutStepPercent+"%"),b.lazy(function(){(t=b.BookZoom.getScaleMode())!==s&&o.find('[data-scale-mode="'+t+'"]').addClass("active")},50);var a=b.BookZoom.getCurrentScales(),c=1-(a.zoom-a.min)/(a.max-a.min);q=new b.Dragdealer("zoom-slider",{horizontal:!1,vertical:!0,y:c,dragStartCallback:function(a,b){},dragStopCallback:function(a,b){},animationCallback:function(a,b){g(a,b)}}),u=!0,v=!0}function d(){p?o.empty():o.remove(),o=null,v=!1}function e(a){var c,d=$(a.currentTarget);d.hasClass("btn-move-up")?c="up":d.hasClass("btn-move-down")?c="down":d.hasClass("btn-move-left")?c="left":d.hasClass("btn-move-right")&&(c="right"),r&&(clearInterval(r),r=null),r=setInterval(function(){b.BookZoom.moveTo(c)},50)}function f(a){r&&(clearInterval(r),r=null)}function g(a,c){if(v){t!==s&&(t=s,b.BookZoom.setScaleMode(t),o.find("[data-scale-mode]").removeClass("active"));var d=b.BookZoom.getCurrentScales(),e=d.max-d.min,f=Number(d.max+d.min-(c*e+d.min));b.BookZoom.setZoomScale(f)}}function h(a){u=!u,u?$(a.currentTarget).addClass("active"):$(a.currentTarget).removeClass("active"),b.BookZoom.setDragMode(u)}function i(a){o.find("[data-scale-mode]").not($(a.currentTarget)).removeClass("active"),$(a.currentTarget).hasClass("active")?($(a.currentTarget).removeClass("active"),t=s):($(a.currentTarget).addClass("active"),t=$(a.currentTarget).attr("data-scale-mode")),b.BookZoom.setScaleMode(t)}function j(){t!==s&&(t=s,b.BookZoom.setScaleMode(t),o.find("[data-scale-mode]").removeClass("active"));var a=b.BookZoom.getCurrentScales(),c=Math.min(a.max,Number(parseFloat(a.zoom+a.max/10).toFixed(2)));a.zoom!==c&&b.BookZoom.zoomIn()}function k(){t!==s&&(t=s,b.BookZoom.setScaleMode(t),o.find("[data-scale-mode]").removeClass("active"));var a=b.BookZoom.getCurrentScales(),c=Math.max(a.min,Number(parseFloat(a.zoom-a.max/10).toFixed(2)));a.zoom!==c&&b.BookZoom.zoomOut()}function l(){b.BookZoom.deactivate()}function m(){var a=o.find(".vertical-bar"),c=o.find(".handle-drag"),d=b.BookZoom.getCurrentScales(),e=parseFloat(d.zoom/d.max*100),f=parseFloat(100-d.min/d.max*100),g=parseFloat(d.min/d.max*100);e=parseFloat((e-g)/f);var h=a.height()-c.height()/2,i=h-h*e;c.css("transform","translateY("+i+"px)")}var n,o,p,q,r,s=0,t=s,u=!0,v=!1;b.on(b.Events.ZOOM_MODE_DID_CHANGE,function(a){a?c():d()}),b.on(b.Events.ZOOM_SCALE_DID_CHANGE,function(a){m()})}),define("toast/extensions/defaults/Help",["exports","module","../../core"],function(a,b,c){function d(){h.remove(),c.$el.removeClass("help"),h.off("click",d),c.off(c.Events.ORIENTATION_DID_CHANGE,f),c.lazy(function(){c.send(c.Events.HIDDEN_HELP)},10)}function e(){i.contents().find("body").removeClass("landscape"),i.contents().find("body").removeClass("portrait"),i.contents().find("body").addClass(c._orientation)}function f(a){e()}function g(){h=$("<div />",{class:"help"}),c.isMobileDevice&&h.addClass("mobile"),i=$('<iframe src="'+c.paths.themeUrl+"help/"+c.config.language+'.html" frameborder="0">'),i.load(function(a){c.isMobileDevice&&(i.contents().find("body").addClass("mobile"),e())}),h.append(i),h.append('<div class="backdrop"></div>'),$(document.body).append(h),c.$el.addClass("help"),h.on("click",d),c.on(c.Events.ORIENTATION_DID_CHANGE,f),c.send(c.Events.SHOWN_HELP)}var h,i;c.ready(function(){if(!c.CommandManager.get(c.Commands.HELP)){!!c.theme.config.help&&c.theme.config.help[c.config.language]?(c.CommandManager.registerInternal(c.Commands.HELP,g),c.cookie.get("toast.shown.help")||(c.cookie.set("toast.shown.help","true"),g())):c.$el.find('[command="help"]').remove()}})}),define("toast/extensions/defaults/Settings",["exports","../../core"],function(a,b){function c(a){var c=$(a.target).closest(".input-group").find("[data-pagefit-mode]");switch(h=c.attr("data-pagefit-mode"),g.find(".pagefit-mode-form-group input").prop("checked",!1),c.prop("checked",!0),h){case"view-all":b.Book.pageFit("view-all");break;case"screen-width":b.Book.pageFit("screen-width")}}function d(a){var b=$(a.target).parents(".modal-content");($(a.target).hasClass("close")||_.isUndefined(b[0]))&&g.remove()}function e(){h||(h=!b.isMobileDevice&&b.config.setDefaultFitWidth?"screen-width":"view-all")}function f(){g=$(Mustache.render(b.HtmlLoader.Settings,{Strings:b.Strings,theme:b.theme})),$(document.body).append(g),g.find('[data-pagefit-mode="'+h+'"]').prop("checked",!0),g.find(".pagefit-mode-form-group .input-group").on("click",c),g.click(d),g.find(".close").click(d)}var g,h;b.Strings;b.projectLoaded(function(){e(),"screen-width"===h&&(b.config.setDefaultFitWidth=!0)}),b.CommandManager.registerInternal("settings",f)}),define("toast/extensions",["./extensions/defaults/Thumbnail","./extensions/defaults/TOC","./extensions/defaults/Search","./extensions/defaults/Bookmark","./extensions/defaults/Memo","./extensions/defaults/Share","./extensions/defaults/Draw","./extensions/defaults/MyStorage","./extensions/defaults/AutoSlide","./extensions/defaults/Print","./extensions/defaults/ZoomBar","./extensions/defaults/Help","./extensions/defaults/Settings"],function(){});